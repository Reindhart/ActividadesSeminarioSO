function W_(s,o){for(var n=0;n<o.length;n++){const l=o[n];if(typeof l!="string"&&!Array.isArray(l)){for(const d in l)if(d!=="default"&&!(d in s)){const m=Object.getOwnPropertyDescriptor(l,d);m&&Object.defineProperty(s,d,m.get?m:{enumerable:!0,get:()=>l[d]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))l(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const h of m.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function n(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(d){if(d.ep)return;d.ep=!0;const m=n(d);fetch(d.href,m)}})();function Wg(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var dm={exports:{}},pi={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Df;function K_(){if(Df)return pi;Df=1;var s=Symbol.for("react.transitional.element"),o=Symbol.for("react.fragment");function n(l,d,m){var h=null;if(m!==void 0&&(h=""+m),d.key!==void 0&&(h=""+d.key),"key"in d){m={};for(var x in d)x!=="key"&&(m[x]=d[x])}else m=d;return d=m.ref,{$$typeof:s,type:l,key:h,ref:d!==void 0?d:null,props:m}}return pi.Fragment=o,pi.jsx=n,pi.jsxs=n,pi}var zf;function Y_(){return zf||(zf=1,dm.exports=K_()),dm.exports}var e=Y_(),um={exports:{}},qt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qf;function X_(){if(qf)return qt;qf=1;var s=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),h=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),b=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),N=Symbol.iterator;function j(A){return A===null||typeof A!="object"?null:(A=N&&A[N]||A["@@iterator"],typeof A=="function"?A:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,C={};function E(A,$,se){this.props=A,this.context=$,this.refs=C,this.updater=se||_}E.prototype.isReactComponent={},E.prototype.setState=function(A,$){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,$,"setState")},E.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function z(){}z.prototype=E.prototype;function P(A,$,se){this.props=A,this.context=$,this.refs=C,this.updater=se||_}var V=P.prototype=new z;V.constructor=P,w(V,E.prototype),V.isPureReactComponent=!0;var Z=Array.isArray;function oe(){}var O={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function ge(A,$,se){var k=se.ref;return{$$typeof:s,type:A,key:$,ref:k!==void 0?k:null,props:se}}function J(A,$){return ge(A.type,$,A.props)}function W(A){return typeof A=="object"&&A!==null&&A.$$typeof===s}function ne(A){var $={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(se){return $[se]})}var Ee=/\/+/g;function Ce(A,$){return typeof A=="object"&&A!==null&&A.key!=null?ne(""+A.key):$.toString(36)}function Le(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(oe,oe):(A.status="pending",A.then(function($){A.status==="pending"&&(A.status="fulfilled",A.value=$)},function($){A.status==="pending"&&(A.status="rejected",A.reason=$)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function I(A,$,se,k,K){var M=typeof A;(M==="undefined"||M==="boolean")&&(A=null);var D=!1;if(A===null)D=!0;else switch(M){case"bigint":case"string":case"number":D=!0;break;case"object":switch(A.$$typeof){case s:case o:D=!0;break;case v:return D=A._init,I(D(A._payload),$,se,k,K)}}if(D)return K=K(A),D=k===""?"."+Ce(A,0):k,Z(K)?(se="",D!=null&&(se=D.replace(Ee,"$&/")+"/"),I(K,$,se,"",function(be){return be})):K!=null&&(W(K)&&(K=J(K,se+(K.key==null||A&&A.key===K.key?"":(""+K.key).replace(Ee,"$&/")+"/")+D)),$.push(K)),1;D=0;var q=k===""?".":k+":";if(Z(A))for(var G=0;G<A.length;G++)k=A[G],M=q+Ce(k,G),D+=I(k,$,se,M,K);else if(G=j(A),typeof G=="function")for(A=G.call(A),G=0;!(k=A.next()).done;)k=k.value,M=q+Ce(k,G++),D+=I(k,$,se,M,K);else if(M==="object"){if(typeof A.then=="function")return I(Le(A),$,se,k,K);throw $=String(A),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return D}function Q(A,$,se){if(A==null)return A;var k=[],K=0;return I(A,k,"","",function(M){return $.call(se,M,K++)}),k}function F(A){if(A._status===-1){var $=A._result;$=$(),$.then(function(se){(A._status===0||A._status===-1)&&(A._status=1,A._result=se)},function(se){(A._status===0||A._status===-1)&&(A._status=2,A._result=se)}),A._status===-1&&(A._status=0,A._result=$)}if(A._status===1)return A._result.default;throw A._result}var de=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},ze={map:Q,forEach:function(A,$,se){Q(A,function(){$.apply(this,arguments)},se)},count:function(A){var $=0;return Q(A,function(){$++}),$},toArray:function(A){return Q(A,function($){return $})||[]},only:function(A){if(!W(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return qt.Activity=f,qt.Children=ze,qt.Component=E,qt.Fragment=n,qt.Profiler=d,qt.PureComponent=P,qt.StrictMode=l,qt.Suspense=g,qt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,qt.__COMPILER_RUNTIME={__proto__:null,c:function(A){return O.H.useMemoCache(A)}},qt.cache=function(A){return function(){return A.apply(null,arguments)}},qt.cacheSignal=function(){return null},qt.cloneElement=function(A,$,se){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var k=w({},A.props),K=A.key;if($!=null)for(M in $.key!==void 0&&(K=""+$.key),$)!T.call($,M)||M==="key"||M==="__self"||M==="__source"||M==="ref"&&$.ref===void 0||(k[M]=$[M]);var M=arguments.length-2;if(M===1)k.children=se;else if(1<M){for(var D=Array(M),q=0;q<M;q++)D[q]=arguments[q+2];k.children=D}return ge(A.type,K,k)},qt.createContext=function(A){return A={$$typeof:h,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:m,_context:A},A},qt.createElement=function(A,$,se){var k,K={},M=null;if($!=null)for(k in $.key!==void 0&&(M=""+$.key),$)T.call($,k)&&k!=="key"&&k!=="__self"&&k!=="__source"&&(K[k]=$[k]);var D=arguments.length-2;if(D===1)K.children=se;else if(1<D){for(var q=Array(D),G=0;G<D;G++)q[G]=arguments[G+2];K.children=q}if(A&&A.defaultProps)for(k in D=A.defaultProps,D)K[k]===void 0&&(K[k]=D[k]);return ge(A,M,K)},qt.createRef=function(){return{current:null}},qt.forwardRef=function(A){return{$$typeof:x,render:A}},qt.isValidElement=W,qt.lazy=function(A){return{$$typeof:v,_payload:{_status:-1,_result:A},_init:F}},qt.memo=function(A,$){return{$$typeof:b,type:A,compare:$===void 0?null:$}},qt.startTransition=function(A){var $=O.T,se={};O.T=se;try{var k=A(),K=O.S;K!==null&&K(se,k),typeof k=="object"&&k!==null&&typeof k.then=="function"&&k.then(oe,de)}catch(M){de(M)}finally{$!==null&&se.types!==null&&($.types=se.types),O.T=$}},qt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},qt.use=function(A){return O.H.use(A)},qt.useActionState=function(A,$,se){return O.H.useActionState(A,$,se)},qt.useCallback=function(A,$){return O.H.useCallback(A,$)},qt.useContext=function(A){return O.H.useContext(A)},qt.useDebugValue=function(){},qt.useDeferredValue=function(A,$){return O.H.useDeferredValue(A,$)},qt.useEffect=function(A,$){return O.H.useEffect(A,$)},qt.useEffectEvent=function(A){return O.H.useEffectEvent(A)},qt.useId=function(){return O.H.useId()},qt.useImperativeHandle=function(A,$,se){return O.H.useImperativeHandle(A,$,se)},qt.useInsertionEffect=function(A,$){return O.H.useInsertionEffect(A,$)},qt.useLayoutEffect=function(A,$){return O.H.useLayoutEffect(A,$)},qt.useMemo=function(A,$){return O.H.useMemo(A,$)},qt.useOptimistic=function(A,$){return O.H.useOptimistic(A,$)},qt.useReducer=function(A,$,se){return O.H.useReducer(A,$,se)},qt.useRef=function(A){return O.H.useRef(A)},qt.useState=function(A){return O.H.useState(A)},qt.useSyncExternalStore=function(A,$,se){return O.H.useSyncExternalStore(A,$,se)},qt.useTransition=function(){return O.H.useTransition()},qt.version="19.2.0",qt}var Uf;function Ri(){return Uf||(Uf=1,um.exports=X_()),um.exports}var c=Ri();const ga=Wg(c),Kg=W_({__proto__:null,default:ga},[c]);var mm={exports:{}},hi={},pm={exports:{}},hm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bf;function Q_(){return Bf||(Bf=1,(function(s){function o(I,Q){var F=I.length;I.push(Q);e:for(;0<F;){var de=F-1>>>1,ze=I[de];if(0<d(ze,Q))I[de]=Q,I[F]=ze,F=de;else break e}}function n(I){return I.length===0?null:I[0]}function l(I){if(I.length===0)return null;var Q=I[0],F=I.pop();if(F!==Q){I[0]=F;e:for(var de=0,ze=I.length,A=ze>>>1;de<A;){var $=2*(de+1)-1,se=I[$],k=$+1,K=I[k];if(0>d(se,F))k<ze&&0>d(K,se)?(I[de]=K,I[k]=F,de=k):(I[de]=se,I[$]=F,de=$);else if(k<ze&&0>d(K,F))I[de]=K,I[k]=F,de=k;else break e}}return Q}function d(I,Q){var F=I.sortIndex-Q.sortIndex;return F!==0?F:I.id-Q.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;s.unstable_now=function(){return m.now()}}else{var h=Date,x=h.now();s.unstable_now=function(){return h.now()-x}}var g=[],b=[],v=1,f=null,N=3,j=!1,_=!1,w=!1,C=!1,E=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function V(I){for(var Q=n(b);Q!==null;){if(Q.callback===null)l(b);else if(Q.startTime<=I)l(b),Q.sortIndex=Q.expirationTime,o(g,Q);else break;Q=n(b)}}function Z(I){if(w=!1,V(I),!_)if(n(g)!==null)_=!0,oe||(oe=!0,ne());else{var Q=n(b);Q!==null&&Le(Z,Q.startTime-I)}}var oe=!1,O=-1,T=5,ge=-1;function J(){return C?!0:!(s.unstable_now()-ge<T)}function W(){if(C=!1,oe){var I=s.unstable_now();ge=I;var Q=!0;try{e:{_=!1,w&&(w=!1,z(O),O=-1),j=!0;var F=N;try{t:{for(V(I),f=n(g);f!==null&&!(f.expirationTime>I&&J());){var de=f.callback;if(typeof de=="function"){f.callback=null,N=f.priorityLevel;var ze=de(f.expirationTime<=I);if(I=s.unstable_now(),typeof ze=="function"){f.callback=ze,V(I),Q=!0;break t}f===n(g)&&l(g),V(I)}else l(g);f=n(g)}if(f!==null)Q=!0;else{var A=n(b);A!==null&&Le(Z,A.startTime-I),Q=!1}}break e}finally{f=null,N=F,j=!1}Q=void 0}}finally{Q?ne():oe=!1}}}var ne;if(typeof P=="function")ne=function(){P(W)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Ce=Ee.port2;Ee.port1.onmessage=W,ne=function(){Ce.postMessage(null)}}else ne=function(){E(W,0)};function Le(I,Q){O=E(function(){I(s.unstable_now())},Q)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(I){I.callback=null},s.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<I?Math.floor(1e3/I):5},s.unstable_getCurrentPriorityLevel=function(){return N},s.unstable_next=function(I){switch(N){case 1:case 2:case 3:var Q=3;break;default:Q=N}var F=N;N=Q;try{return I()}finally{N=F}},s.unstable_requestPaint=function(){C=!0},s.unstable_runWithPriority=function(I,Q){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var F=N;N=I;try{return Q()}finally{N=F}},s.unstable_scheduleCallback=function(I,Q,F){var de=s.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?de+F:de):F=de,I){case 1:var ze=-1;break;case 2:ze=250;break;case 5:ze=1073741823;break;case 4:ze=1e4;break;default:ze=5e3}return ze=F+ze,I={id:v++,callback:Q,priorityLevel:I,startTime:F,expirationTime:ze,sortIndex:-1},F>de?(I.sortIndex=F,o(b,I),n(g)===null&&I===n(b)&&(w?(z(O),O=-1):w=!0,Le(Z,F-de))):(I.sortIndex=ze,o(g,I),_||j||(_=!0,oe||(oe=!0,ne()))),I},s.unstable_shouldYield=J,s.unstable_wrapCallback=function(I){var Q=N;return function(){var F=N;N=Q;try{return I.apply(this,arguments)}finally{N=F}}}})(hm)),hm}var Vf;function Z_(){return Vf||(Vf=1,pm.exports=Q_()),pm.exports}var xm={exports:{}},$a={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $f;function J_(){if($f)return $a;$f=1;var s=Ri();function o(g){var b="https://react.dev/errors/"+g;if(1<arguments.length){b+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)b+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+g+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var l={d:{f:n,r:function(){throw Error(o(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},d=Symbol.for("react.portal");function m(g,b,v){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:f==null?null:""+f,children:g,containerInfo:b,implementation:v}}var h=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function x(g,b){if(g==="font")return"";if(typeof b=="string")return b==="use-credentials"?b:""}return $a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,$a.createPortal=function(g,b){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)throw Error(o(299));return m(g,b,null,v)},$a.flushSync=function(g){var b=h.T,v=l.p;try{if(h.T=null,l.p=2,g)return g()}finally{h.T=b,l.p=v,l.d.f()}},$a.preconnect=function(g,b){typeof g=="string"&&(b?(b=b.crossOrigin,b=typeof b=="string"?b==="use-credentials"?b:"":void 0):b=null,l.d.C(g,b))},$a.prefetchDNS=function(g){typeof g=="string"&&l.d.D(g)},$a.preinit=function(g,b){if(typeof g=="string"&&b&&typeof b.as=="string"){var v=b.as,f=x(v,b.crossOrigin),N=typeof b.integrity=="string"?b.integrity:void 0,j=typeof b.fetchPriority=="string"?b.fetchPriority:void 0;v==="style"?l.d.S(g,typeof b.precedence=="string"?b.precedence:void 0,{crossOrigin:f,integrity:N,fetchPriority:j}):v==="script"&&l.d.X(g,{crossOrigin:f,integrity:N,fetchPriority:j,nonce:typeof b.nonce=="string"?b.nonce:void 0})}},$a.preinitModule=function(g,b){if(typeof g=="string")if(typeof b=="object"&&b!==null){if(b.as==null||b.as==="script"){var v=x(b.as,b.crossOrigin);l.d.M(g,{crossOrigin:v,integrity:typeof b.integrity=="string"?b.integrity:void 0,nonce:typeof b.nonce=="string"?b.nonce:void 0})}}else b==null&&l.d.M(g)},$a.preload=function(g,b){if(typeof g=="string"&&typeof b=="object"&&b!==null&&typeof b.as=="string"){var v=b.as,f=x(v,b.crossOrigin);l.d.L(g,v,{crossOrigin:f,integrity:typeof b.integrity=="string"?b.integrity:void 0,nonce:typeof b.nonce=="string"?b.nonce:void 0,type:typeof b.type=="string"?b.type:void 0,fetchPriority:typeof b.fetchPriority=="string"?b.fetchPriority:void 0,referrerPolicy:typeof b.referrerPolicy=="string"?b.referrerPolicy:void 0,imageSrcSet:typeof b.imageSrcSet=="string"?b.imageSrcSet:void 0,imageSizes:typeof b.imageSizes=="string"?b.imageSizes:void 0,media:typeof b.media=="string"?b.media:void 0})}},$a.preloadModule=function(g,b){if(typeof g=="string")if(b){var v=x(b.as,b.crossOrigin);l.d.m(g,{as:typeof b.as=="string"&&b.as!=="script"?b.as:void 0,crossOrigin:v,integrity:typeof b.integrity=="string"?b.integrity:void 0})}else l.d.m(g)},$a.requestFormReset=function(g){l.d.r(g)},$a.unstable_batchedUpdates=function(g,b){return g(b)},$a.useFormState=function(g,b,v){return h.H.useFormState(g,b,v)},$a.useFormStatus=function(){return h.H.useHostTransitionStatus()},$a.version="19.2.0",$a}var Ff;function Yg(){if(Ff)return xm.exports;Ff=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(o){console.error(o)}}return s(),xm.exports=J_(),xm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hf;function eS(){if(Hf)return hi;Hf=1;var s=Z_(),o=Ri(),n=Yg();function l(t){var a="https://react.dev/errors/"+t;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)a+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function m(t){var a=t,r=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,(a.flags&4098)!==0&&(r=a.return),t=a.return;while(t)}return a.tag===3?r:null}function h(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function x(t){if(t.tag===31){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function g(t){if(m(t)!==t)throw Error(l(188))}function b(t){var a=t.alternate;if(!a){if(a=m(t),a===null)throw Error(l(188));return a!==t?null:t}for(var r=t,i=a;;){var u=r.return;if(u===null)break;var p=u.alternate;if(p===null){if(i=u.return,i!==null){r=i;continue}break}if(u.child===p.child){for(p=u.child;p;){if(p===r)return g(u),t;if(p===i)return g(u),a;p=p.sibling}throw Error(l(188))}if(r.return!==i.return)r=u,i=p;else{for(var y=!1,S=u.child;S;){if(S===r){y=!0,r=u,i=p;break}if(S===i){y=!0,i=u,r=p;break}S=S.sibling}if(!y){for(S=p.child;S;){if(S===r){y=!0,r=p,i=u;break}if(S===i){y=!0,i=p,r=u;break}S=S.sibling}if(!y)throw Error(l(189))}}if(r.alternate!==i)throw Error(l(190))}if(r.tag!==3)throw Error(l(188));return r.stateNode.current===r?t:a}function v(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(a=v(t),a!==null)return a;t=t.sibling}return null}var f=Object.assign,N=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),z=Symbol.for("react.consumer"),P=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),ge=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function ne(t){return t===null||typeof t!="object"?null:(t=W&&t[W]||t["@@iterator"],typeof t=="function"?t:null)}var Ee=Symbol.for("react.client.reference");function Ce(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===Ee?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case w:return"Fragment";case E:return"Profiler";case C:return"StrictMode";case Z:return"Suspense";case oe:return"SuspenseList";case ge:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case _:return"Portal";case P:return t.displayName||"Context";case z:return(t._context.displayName||"Context")+".Consumer";case V:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case O:return a=t.displayName||null,a!==null?a:Ce(t.type)||"Memo";case T:a=t._payload,t=t._init;try{return Ce(t(a))}catch{}}return null}var Le=Array.isArray,I=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},de=[],ze=-1;function A(t){return{current:t}}function $(t){0>ze||(t.current=de[ze],de[ze]=null,ze--)}function se(t,a){ze++,de[ze]=t.current,t.current=a}var k=A(null),K=A(null),M=A(null),D=A(null);function q(t,a){switch(se(M,a),se(K,t),se(k,null),a.nodeType){case 9:case 11:t=(t=a.documentElement)&&(t=t.namespaceURI)?nf(t):0;break;default:if(t=a.tagName,a=a.namespaceURI)a=nf(a),t=of(a,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}$(k),se(k,t)}function G(){$(k),$(K),$(M)}function be(t){t.memoizedState!==null&&se(D,t);var a=k.current,r=of(a,t.type);a!==r&&(se(K,t),se(k,r))}function Ne(t){K.current===t&&($(k),$(K)),D.current===t&&($(D),ci._currentValue=F)}var R,ke;function je(t){if(R===void 0)try{throw Error()}catch(r){var a=r.stack.trim().match(/\n( *(at )?)/);R=a&&a[1]||"",ke=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+R+t+ke}var ee=!1;function ae(t,a){if(!t||ee)return"";ee=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(a){var Pe=function(){throw Error()};if(Object.defineProperty(Pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Pe,[])}catch(ye){var he=ye}Reflect.construct(t,[],Pe)}else{try{Pe.call()}catch(ye){he=ye}t.call(Pe.prototype)}}else{try{throw Error()}catch(ye){he=ye}(Pe=t())&&typeof Pe.catch=="function"&&Pe.catch(function(){})}}catch(ye){if(ye&&he&&typeof ye.stack=="string")return[ye.stack,he.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var u=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");u&&u.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=i.DetermineComponentFrameRoot(),y=p[0],S=p[1];if(y&&S){var H=y.split(`
`),pe=S.split(`
`);for(u=i=0;i<H.length&&!H[i].includes("DetermineComponentFrameRoot");)i++;for(;u<pe.length&&!pe[u].includes("DetermineComponentFrameRoot");)u++;if(i===H.length||u===pe.length)for(i=H.length-1,u=pe.length-1;1<=i&&0<=u&&H[i]!==pe[u];)u--;for(;1<=i&&0<=u;i--,u--)if(H[i]!==pe[u]){if(i!==1||u!==1)do if(i--,u--,0>u||H[i]!==pe[u]){var Ae=`
`+H[i].replace(" at new "," at ");return t.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",t.displayName)),Ae}while(1<=i&&0<=u);break}}}finally{ee=!1,Error.prepareStackTrace=r}return(r=t?t.displayName||t.name:"")?je(r):""}function rt(t,a){switch(t.tag){case 26:case 27:case 5:return je(t.type);case 16:return je("Lazy");case 13:return t.child!==a&&a!==null?je("Suspense Fallback"):je("Suspense");case 19:return je("SuspenseList");case 0:case 15:return ae(t.type,!1);case 11:return ae(t.type.render,!1);case 1:return ae(t.type,!0);case 31:return je("Activity");default:return""}}function jt(t){try{var a="",r=null;do a+=rt(t,r),r=t,t=t.return;while(t);return a}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var xe=Object.prototype.hasOwnProperty,Me=s.unstable_scheduleCallback,De=s.unstable_cancelCallback,Ge=s.unstable_shouldYield,qe=s.unstable_requestPaint,Se=s.unstable_now,Xe=s.unstable_getCurrentPriorityLevel,We=s.unstable_ImmediatePriority,xt=s.unstable_UserBlockingPriority,Ot=s.unstable_NormalPriority,It=s.unstable_LowPriority,Ue=s.unstable_IdlePriority,At=s.log,et=s.unstable_setDisableYieldValue,L=null,re=null;function Ve(t){if(typeof At=="function"&&et(t),re&&typeof re.setStrictMode=="function")try{re.setStrictMode(L,t)}catch{}}var ce=Math.clz32?Math.clz32:St,Te=Math.log,_t=Math.LN2;function St(t){return t>>>=0,t===0?32:31-(Te(t)/_t|0)|0}var tt=256,Ye=262144,ft=4194304;function Ct(t){var a=t&42;if(a!==0)return a;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function ve(t,a,r){var i=t.pendingLanes;if(i===0)return 0;var u=0,p=t.suspendedLanes,y=t.pingedLanes;t=t.warmLanes;var S=i&134217727;return S!==0?(i=S&~p,i!==0?u=Ct(i):(y&=S,y!==0?u=Ct(y):r||(r=S&~t,r!==0&&(u=Ct(r))))):(S=i&~p,S!==0?u=Ct(S):y!==0?u=Ct(y):r||(r=i&~t,r!==0&&(u=Ct(r)))),u===0?0:a!==0&&a!==u&&(a&p)===0&&(p=u&-u,r=a&-a,p>=r||p===32&&(r&4194048)!==0)?a:u}function gt(t,a){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&a)===0}function $e(t,a){switch(t){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function B(){var t=ft;return ft<<=1,(ft&62914560)===0&&(ft=4194304),t}function U(t){for(var a=[],r=0;31>r;r++)a.push(t);return a}function Dt(t,a){t.pendingLanes|=a,a!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Ke(t,a,r,i,u,p){var y=t.pendingLanes;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=r,t.entangledLanes&=r,t.errorRecoveryDisabledLanes&=r,t.shellSuspendCounter=0;var S=t.entanglements,H=t.expirationTimes,pe=t.hiddenUpdates;for(r=y&~r;0<r;){var Ae=31-ce(r),Pe=1<<Ae;S[Ae]=0,H[Ae]=-1;var he=pe[Ae];if(he!==null)for(pe[Ae]=null,Ae=0;Ae<he.length;Ae++){var ye=he[Ae];ye!==null&&(ye.lane&=-536870913)}r&=~Pe}i!==0&&fe(t,i,0),p!==0&&u===0&&t.tag!==0&&(t.suspendedLanes|=p&~(y&~a))}function fe(t,a,r){t.pendingLanes|=a,t.suspendedLanes&=~a;var i=31-ce(a);t.entangledLanes|=a,t.entanglements[i]=t.entanglements[i]|1073741824|r&261930}function $t(t,a){var r=t.entangledLanes|=a;for(t=t.entanglements;r;){var i=31-ce(r),u=1<<i;u&a|t[i]&a&&(t[i]|=a),r&=~u}}function Zt(t,a){var r=a&-a;return r=(r&42)!==0?1:pt(r),(r&(t.suspendedLanes|a))!==0?0:r}function pt(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function zt(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function lt(){var t=Q.p;return t!==0?t:(t=window.event,t===void 0?32:Ef(t.type))}function Be(t,a){var r=Q.p;try{return Q.p=t,a()}finally{Q.p=r}}var Ie=Math.random().toString(36).slice(2),Je="__reactFiber$"+Ie,ot="__reactProps$"+Ie,X="__reactContainer$"+Ie,Oe="__reactEvents$"+Ie,st="__reactListeners$"+Ie,Rt="__reactHandles$"+Ie,Qe="__reactResources$"+Ie,He="__reactMarker$"+Ie;function mt(t){delete t[Je],delete t[ot],delete t[Oe],delete t[st],delete t[Rt]}function Jt(t){var a=t[Je];if(a)return a;for(var r=t.parentNode;r;){if(a=r[X]||r[Je]){if(r=a.alternate,a.child!==null||r!==null&&r.child!==null)for(t=hf(t);t!==null;){if(r=t[Je])return r;t=hf(t)}return a}t=r,r=t.parentNode}return null}function pa(t){if(t=t[Je]||t[X]){var a=t.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return t}return null}function _e(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t.stateNode;throw Error(l(33))}function Fe(t){var a=t[Qe];return a||(a=t[Qe]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function ht(t){t[He]=!0}var Lt=new Set,ut={};function at(t,a){Y(t,a),Y(t+"Capture",a)}function Y(t,a){for(ut[t]=a,t=0;t<a.length;t++)Lt.add(a[t])}var we=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Mt={},Ze={};function vt(t){return xe.call(Ze,t)?!0:xe.call(Mt,t)?!1:we.test(t)?Ze[t]=!0:(Mt[t]=!0,!1)}function Tt(t,a,r){if(vt(a))if(r===null)t.removeAttribute(a);else{switch(typeof r){case"undefined":case"function":case"symbol":t.removeAttribute(a);return;case"boolean":var i=a.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){t.removeAttribute(a);return}}t.setAttribute(a,""+r)}}function Na(t,a,r){if(r===null)t.removeAttribute(a);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttribute(a,""+r)}}function Pa(t,a,r,i){if(i===null)t.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttributeNS(a,r,""+i)}}function ds(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Qp(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function UN(t,a,r){var i=Object.getOwnPropertyDescriptor(t.constructor.prototype,a);if(!t.hasOwnProperty(a)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var u=i.get,p=i.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return u.call(this)},set:function(y){r=""+y,p.call(this,y)}}),Object.defineProperty(t,a,{enumerable:i.enumerable}),{getValue:function(){return r},setValue:function(y){r=""+y},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function sd(t){if(!t._valueTracker){var a=Qp(t)?"checked":"value";t._valueTracker=UN(t,a,""+t[a])}}function Zp(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var r=a.getValue(),i="";return t&&(i=Qp(t)?t.checked?"true":"false":t.value),t=i,t!==r?(a.setValue(t),!0):!1}function zi(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var BN=/[\n"\\]/g;function us(t){return t.replace(BN,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function rd(t,a,r,i,u,p,y,S){t.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?t.type=y:t.removeAttribute("type"),a!=null?y==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+ds(a)):t.value!==""+ds(a)&&(t.value=""+ds(a)):y!=="submit"&&y!=="reset"||t.removeAttribute("value"),a!=null?nd(t,y,ds(a)):r!=null?nd(t,y,ds(r)):i!=null&&t.removeAttribute("value"),u==null&&p!=null&&(t.defaultChecked=!!p),u!=null&&(t.checked=u&&typeof u!="function"&&typeof u!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?t.name=""+ds(S):t.removeAttribute("name")}function Jp(t,a,r,i,u,p,y,S){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(t.type=p),a!=null||r!=null){if(!(p!=="submit"&&p!=="reset"||a!=null)){sd(t);return}r=r!=null?""+ds(r):"",a=a!=null?""+ds(a):r,S||a===t.value||(t.value=a),t.defaultValue=a}i=i??u,i=typeof i!="function"&&typeof i!="symbol"&&!!i,t.checked=S?t.checked:!!i,t.defaultChecked=!!i,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(t.name=y),sd(t)}function nd(t,a,r){a==="number"&&zi(t.ownerDocument)===t||t.defaultValue===""+r||(t.defaultValue=""+r)}function _n(t,a,r,i){if(t=t.options,a){a={};for(var u=0;u<r.length;u++)a["$"+r[u]]=!0;for(r=0;r<t.length;r++)u=a.hasOwnProperty("$"+t[r].value),t[r].selected!==u&&(t[r].selected=u),u&&i&&(t[r].defaultSelected=!0)}else{for(r=""+ds(r),a=null,u=0;u<t.length;u++){if(t[u].value===r){t[u].selected=!0,i&&(t[u].defaultSelected=!0);return}a!==null||t[u].disabled||(a=t[u])}a!==null&&(a.selected=!0)}}function eh(t,a,r){if(a!=null&&(a=""+ds(a),a!==t.value&&(t.value=a),r==null)){t.defaultValue!==a&&(t.defaultValue=a);return}t.defaultValue=r!=null?""+ds(r):""}function th(t,a,r,i){if(a==null){if(i!=null){if(r!=null)throw Error(l(92));if(Le(i)){if(1<i.length)throw Error(l(93));i=i[0]}r=i}r==null&&(r=""),a=r}r=ds(a),t.defaultValue=r,i=t.textContent,i===r&&i!==""&&i!==null&&(t.value=i),sd(t)}function Sn(t,a){if(a){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=a;return}}t.textContent=a}var VN=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ah(t,a,r){var i=a.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?i?t.setProperty(a,""):a==="float"?t.cssFloat="":t[a]="":i?t.setProperty(a,r):typeof r!="number"||r===0||VN.has(a)?a==="float"?t.cssFloat=r:t[a]=(""+r).trim():t[a]=r+"px"}function sh(t,a,r){if(a!=null&&typeof a!="object")throw Error(l(62));if(t=t.style,r!=null){for(var i in r)!r.hasOwnProperty(i)||a!=null&&a.hasOwnProperty(i)||(i.indexOf("--")===0?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="");for(var u in a)i=a[u],a.hasOwnProperty(u)&&r[u]!==i&&ah(t,u,i)}else for(var p in a)a.hasOwnProperty(p)&&ah(t,p,a[p])}function od(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $N=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),FN=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function qi(t){return FN.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Gs(){}var id=null;function ld(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var wn=null,Tn=null;function rh(t){var a=pa(t);if(a&&(t=a.stateNode)){var r=t[ot]||null;e:switch(t=a.stateNode,a.type){case"input":if(rd(t,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),a=r.name,r.type==="radio"&&a!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+us(""+a)+'"][type="radio"]'),a=0;a<r.length;a++){var i=r[a];if(i!==t&&i.form===t.form){var u=i[ot]||null;if(!u)throw Error(l(90));rd(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name)}}for(a=0;a<r.length;a++)i=r[a],i.form===t.form&&Zp(i)}break e;case"textarea":eh(t,r.value,r.defaultValue);break e;case"select":a=r.value,a!=null&&_n(t,!!r.multiple,a,!1)}}}var cd=!1;function nh(t,a,r){if(cd)return t(a,r);cd=!0;try{var i=t(a);return i}finally{if(cd=!1,(wn!==null||Tn!==null)&&(Tl(),wn&&(a=wn,t=Tn,Tn=wn=null,rh(a),t)))for(a=0;a<t.length;a++)rh(t[a])}}function To(t,a){var r=t.stateNode;if(r===null)return null;var i=r[ot]||null;if(i===null)return null;r=i[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(l(231,a,typeof r));return r}var Ws=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dd=!1;if(Ws)try{var Ao={};Object.defineProperty(Ao,"passive",{get:function(){dd=!0}}),window.addEventListener("test",Ao,Ao),window.removeEventListener("test",Ao,Ao)}catch{dd=!1}var br=null,ud=null,Ui=null;function oh(){if(Ui)return Ui;var t,a=ud,r=a.length,i,u="value"in br?br.value:br.textContent,p=u.length;for(t=0;t<r&&a[t]===u[t];t++);var y=r-t;for(i=1;i<=y&&a[r-i]===u[p-i];i++);return Ui=u.slice(t,1<i?1-i:void 0)}function Bi(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function Vi(){return!0}function ih(){return!1}function Wa(t){function a(r,i,u,p,y){this._reactName=r,this._targetInst=u,this.type=i,this.nativeEvent=p,this.target=y,this.currentTarget=null;for(var S in t)t.hasOwnProperty(S)&&(r=t[S],this[S]=r?r(p):p[S]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Vi:ih,this.isPropagationStopped=ih,this}return f(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Vi)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Vi)},persist:function(){},isPersistent:Vi}),a}var Yr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$i=Wa(Yr),Co=f({},Yr,{view:0,detail:0}),HN=Wa(Co),md,pd,ko,Fi=f({},Co,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ko&&(ko&&t.type==="mousemove"?(md=t.screenX-ko.screenX,pd=t.screenY-ko.screenY):pd=md=0,ko=t),md)},movementY:function(t){return"movementY"in t?t.movementY:pd}}),lh=Wa(Fi),GN=f({},Fi,{dataTransfer:0}),WN=Wa(GN),KN=f({},Co,{relatedTarget:0}),hd=Wa(KN),YN=f({},Yr,{animationName:0,elapsedTime:0,pseudoElement:0}),XN=Wa(YN),QN=f({},Yr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ZN=Wa(QN),JN=f({},Yr,{data:0}),ch=Wa(JN),ej={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sj(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=aj[t])?!!a[t]:!1}function xd(){return sj}var rj=f({},Co,{key:function(t){if(t.key){var a=ej[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=Bi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?tj[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xd,charCode:function(t){return t.type==="keypress"?Bi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Bi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),nj=Wa(rj),oj=f({},Fi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dh=Wa(oj),ij=f({},Co,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xd}),lj=Wa(ij),cj=f({},Yr,{propertyName:0,elapsedTime:0,pseudoElement:0}),dj=Wa(cj),uj=f({},Fi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),mj=Wa(uj),pj=f({},Yr,{newState:0,oldState:0}),hj=Wa(pj),xj=[9,13,27,32],fd=Ws&&"CompositionEvent"in window,Eo=null;Ws&&"documentMode"in document&&(Eo=document.documentMode);var fj=Ws&&"TextEvent"in window&&!Eo,uh=Ws&&(!fd||Eo&&8<Eo&&11>=Eo),mh=" ",ph=!1;function hh(t,a){switch(t){case"keyup":return xj.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var An=!1;function gj(t,a){switch(t){case"compositionend":return xh(a);case"keypress":return a.which!==32?null:(ph=!0,mh);case"textInput":return t=a.data,t===mh&&ph?null:t;default:return null}}function bj(t,a){if(An)return t==="compositionend"||!fd&&hh(t,a)?(t=oh(),Ui=ud=br=null,An=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return uh&&a.locale!=="ko"?null:a.data;default:return null}}var vj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fh(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!vj[t.type]:a==="textarea"}function gh(t,a,r,i){wn?Tn?Tn.push(i):Tn=[i]:wn=i,a=Pl(a,"onChange"),0<a.length&&(r=new $i("onChange","change",null,r,i),t.push({event:r,listeners:a}))}var Ro=null,Lo=null;function yj(t){J0(t,0)}function Hi(t){var a=_e(t);if(Zp(a))return t}function bh(t,a){if(t==="change")return a}var vh=!1;if(Ws){var gd;if(Ws){var bd="oninput"in document;if(!bd){var yh=document.createElement("div");yh.setAttribute("oninput","return;"),bd=typeof yh.oninput=="function"}gd=bd}else gd=!1;vh=gd&&(!document.documentMode||9<document.documentMode)}function Nh(){Ro&&(Ro.detachEvent("onpropertychange",jh),Lo=Ro=null)}function jh(t){if(t.propertyName==="value"&&Hi(Lo)){var a=[];gh(a,Lo,t,ld(t)),nh(yj,a)}}function Nj(t,a,r){t==="focusin"?(Nh(),Ro=a,Lo=r,Ro.attachEvent("onpropertychange",jh)):t==="focusout"&&Nh()}function jj(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Hi(Lo)}function _j(t,a){if(t==="click")return Hi(a)}function Sj(t,a){if(t==="input"||t==="change")return Hi(a)}function wj(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var es=typeof Object.is=="function"?Object.is:wj;function Po(t,a){if(es(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var r=Object.keys(t),i=Object.keys(a);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var u=r[i];if(!xe.call(a,u)||!es(t[u],a[u]))return!1}return!0}function _h(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Sh(t,a){var r=_h(t);t=0;for(var i;r;){if(r.nodeType===3){if(i=t+r.textContent.length,t<=a&&i>=a)return{node:r,offset:a-t};t=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_h(r)}}function wh(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?wh(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function Th(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var a=zi(t.document);a instanceof t.HTMLIFrameElement;){try{var r=typeof a.contentWindow.location.href=="string"}catch{r=!1}if(r)t=a.contentWindow;else break;a=zi(t.document)}return a}function vd(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}var Tj=Ws&&"documentMode"in document&&11>=document.documentMode,Cn=null,yd=null,Mo=null,Nd=!1;function Ah(t,a,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Nd||Cn==null||Cn!==zi(i)||(i=Cn,"selectionStart"in i&&vd(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Mo&&Po(Mo,i)||(Mo=i,i=Pl(yd,"onSelect"),0<i.length&&(a=new $i("onSelect","select",null,a,r),t.push({event:a,listeners:i}),a.target=Cn)))}function Xr(t,a){var r={};return r[t.toLowerCase()]=a.toLowerCase(),r["Webkit"+t]="webkit"+a,r["Moz"+t]="moz"+a,r}var kn={animationend:Xr("Animation","AnimationEnd"),animationiteration:Xr("Animation","AnimationIteration"),animationstart:Xr("Animation","AnimationStart"),transitionrun:Xr("Transition","TransitionRun"),transitionstart:Xr("Transition","TransitionStart"),transitioncancel:Xr("Transition","TransitionCancel"),transitionend:Xr("Transition","TransitionEnd")},jd={},Ch={};Ws&&(Ch=document.createElement("div").style,"AnimationEvent"in window||(delete kn.animationend.animation,delete kn.animationiteration.animation,delete kn.animationstart.animation),"TransitionEvent"in window||delete kn.transitionend.transition);function Qr(t){if(jd[t])return jd[t];if(!kn[t])return t;var a=kn[t],r;for(r in a)if(a.hasOwnProperty(r)&&r in Ch)return jd[t]=a[r];return t}var kh=Qr("animationend"),Eh=Qr("animationiteration"),Rh=Qr("animationstart"),Aj=Qr("transitionrun"),Cj=Qr("transitionstart"),kj=Qr("transitioncancel"),Lh=Qr("transitionend"),Ph=new Map,_d="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");_d.push("scrollEnd");function _s(t,a){Ph.set(t,a),at(a,[t])}var Gi=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},ms=[],En=0,Sd=0;function Wi(){for(var t=En,a=Sd=En=0;a<t;){var r=ms[a];ms[a++]=null;var i=ms[a];ms[a++]=null;var u=ms[a];ms[a++]=null;var p=ms[a];if(ms[a++]=null,i!==null&&u!==null){var y=i.pending;y===null?u.next=u:(u.next=y.next,y.next=u),i.pending=u}p!==0&&Mh(r,u,p)}}function Ki(t,a,r,i){ms[En++]=t,ms[En++]=a,ms[En++]=r,ms[En++]=i,Sd|=i,t.lanes|=i,t=t.alternate,t!==null&&(t.lanes|=i)}function wd(t,a,r,i){return Ki(t,a,r,i),Yi(t)}function Zr(t,a){return Ki(t,null,null,a),Yi(t)}function Mh(t,a,r){t.lanes|=r;var i=t.alternate;i!==null&&(i.lanes|=r);for(var u=!1,p=t.return;p!==null;)p.childLanes|=r,i=p.alternate,i!==null&&(i.childLanes|=r),p.tag===22&&(t=p.stateNode,t===null||t._visibility&1||(u=!0)),t=p,p=p.return;return t.tag===3?(p=t.stateNode,u&&a!==null&&(u=31-ce(r),t=p.hiddenUpdates,i=t[u],i===null?t[u]=[a]:i.push(a),a.lane=r|536870912),p):null}function Yi(t){if(50<ai)throw ai=0,Mu=null,Error(l(185));for(var a=t.return;a!==null;)t=a,a=t.return;return t.tag===3?t.stateNode:null}var Rn={};function Ej(t,a,r,i){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ts(t,a,r,i){return new Ej(t,a,r,i)}function Td(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ks(t,a){var r=t.alternate;return r===null?(r=ts(t.tag,a,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=a,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&65011712,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,a=t.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r.refCleanup=t.refCleanup,r}function Ih(t,a){t.flags&=65011714;var r=t.alternate;return r===null?(t.childLanes=0,t.lanes=a,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,t.type=r.type,a=r.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),t}function Xi(t,a,r,i,u,p){var y=0;if(i=t,typeof t=="function")Td(t)&&(y=1);else if(typeof t=="string")y=I_(t,r,k.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case ge:return t=ts(31,r,a,u),t.elementType=ge,t.lanes=p,t;case w:return Jr(r.children,u,p,a);case C:y=8,u|=24;break;case E:return t=ts(12,r,a,u|2),t.elementType=E,t.lanes=p,t;case Z:return t=ts(13,r,a,u),t.elementType=Z,t.lanes=p,t;case oe:return t=ts(19,r,a,u),t.elementType=oe,t.lanes=p,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case P:y=10;break e;case z:y=9;break e;case V:y=11;break e;case O:y=14;break e;case T:y=16,i=null;break e}y=29,r=Error(l(130,t===null?"null":typeof t,"")),i=null}return a=ts(y,r,a,u),a.elementType=t,a.type=i,a.lanes=p,a}function Jr(t,a,r,i){return t=ts(7,t,i,a),t.lanes=r,t}function Ad(t,a,r){return t=ts(6,t,null,a),t.lanes=r,t}function Oh(t){var a=ts(18,null,null,0);return a.stateNode=t,a}function Cd(t,a,r){return a=ts(4,t.children!==null?t.children:[],t.key,a),a.lanes=r,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}var Dh=new WeakMap;function ps(t,a){if(typeof t=="object"&&t!==null){var r=Dh.get(t);return r!==void 0?r:(a={value:t,source:a,stack:jt(a)},Dh.set(t,a),a)}return{value:t,source:a,stack:jt(a)}}var Ln=[],Pn=0,Qi=null,Io=0,hs=[],xs=0,vr=null,Ls=1,Ps="";function Ys(t,a){Ln[Pn++]=Io,Ln[Pn++]=Qi,Qi=t,Io=a}function zh(t,a,r){hs[xs++]=Ls,hs[xs++]=Ps,hs[xs++]=vr,vr=t;var i=Ls;t=Ps;var u=32-ce(i)-1;i&=~(1<<u),r+=1;var p=32-ce(a)+u;if(30<p){var y=u-u%5;p=(i&(1<<y)-1).toString(32),i>>=y,u-=y,Ls=1<<32-ce(a)+u|r<<u|i,Ps=p+t}else Ls=1<<p|r<<u|i,Ps=t}function kd(t){t.return!==null&&(Ys(t,1),zh(t,1,0))}function Ed(t){for(;t===Qi;)Qi=Ln[--Pn],Ln[Pn]=null,Io=Ln[--Pn],Ln[Pn]=null;for(;t===vr;)vr=hs[--xs],hs[xs]=null,Ps=hs[--xs],hs[xs]=null,Ls=hs[--xs],hs[xs]=null}function qh(t,a){hs[xs++]=Ls,hs[xs++]=Ps,hs[xs++]=vr,Ls=a.id,Ps=a.overflow,vr=t}var za=null,ba=null,Yt=!1,yr=null,fs=!1,Rd=Error(l(519));function Nr(t){var a=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Oo(ps(a,t)),Rd}function Uh(t){var a=t.stateNode,r=t.type,i=t.memoizedProps;switch(a[Je]=t,a[ot]=i,r){case"dialog":Ht("cancel",a),Ht("close",a);break;case"iframe":case"object":case"embed":Ht("load",a);break;case"video":case"audio":for(r=0;r<ri.length;r++)Ht(ri[r],a);break;case"source":Ht("error",a);break;case"img":case"image":case"link":Ht("error",a),Ht("load",a);break;case"details":Ht("toggle",a);break;case"input":Ht("invalid",a),Jp(a,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Ht("invalid",a);break;case"textarea":Ht("invalid",a),th(a,i.value,i.defaultValue,i.children)}r=i.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||a.textContent===""+r||i.suppressHydrationWarning===!0||sf(a.textContent,r)?(i.popover!=null&&(Ht("beforetoggle",a),Ht("toggle",a)),i.onScroll!=null&&Ht("scroll",a),i.onScrollEnd!=null&&Ht("scrollend",a),i.onClick!=null&&(a.onclick=Gs),a=!0):a=!1,a||Nr(t,!0)}function Bh(t){for(za=t.return;za;)switch(za.tag){case 5:case 31:case 13:fs=!1;return;case 27:case 3:fs=!0;return;default:za=za.return}}function Mn(t){if(t!==za)return!1;if(!Yt)return Bh(t),Yt=!0,!1;var a=t.tag,r;if((r=a!==3&&a!==27)&&((r=a===5)&&(r=t.type,r=!(r!=="form"&&r!=="button")||Yu(t.type,t.memoizedProps)),r=!r),r&&ba&&Nr(t),Bh(t),a===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(l(317));ba=pf(t)}else if(a===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(l(317));ba=pf(t)}else a===27?(a=ba,Ir(t.type)?(t=em,em=null,ba=t):ba=a):ba=za?bs(t.stateNode.nextSibling):null;return!0}function en(){ba=za=null,Yt=!1}function Ld(){var t=yr;return t!==null&&(Qa===null?Qa=t:Qa.push.apply(Qa,t),yr=null),t}function Oo(t){yr===null?yr=[t]:yr.push(t)}var Pd=A(null),tn=null,Xs=null;function jr(t,a,r){se(Pd,a._currentValue),a._currentValue=r}function Qs(t){t._currentValue=Pd.current,$(Pd)}function Md(t,a,r){for(;t!==null;){var i=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,i!==null&&(i.childLanes|=a)):i!==null&&(i.childLanes&a)!==a&&(i.childLanes|=a),t===r)break;t=t.return}}function Id(t,a,r,i){var u=t.child;for(u!==null&&(u.return=t);u!==null;){var p=u.dependencies;if(p!==null){var y=u.child;p=p.firstContext;e:for(;p!==null;){var S=p;p=u;for(var H=0;H<a.length;H++)if(S.context===a[H]){p.lanes|=r,S=p.alternate,S!==null&&(S.lanes|=r),Md(p.return,r,t),i||(y=null);break e}p=S.next}}else if(u.tag===18){if(y=u.return,y===null)throw Error(l(341));y.lanes|=r,p=y.alternate,p!==null&&(p.lanes|=r),Md(y,r,t),y=null}else y=u.child;if(y!==null)y.return=u;else for(y=u;y!==null;){if(y===t){y=null;break}if(u=y.sibling,u!==null){u.return=y.return,y=u;break}y=y.return}u=y}}function In(t,a,r,i){t=null;for(var u=a,p=!1;u!==null;){if(!p){if((u.flags&524288)!==0)p=!0;else if((u.flags&262144)!==0)break}if(u.tag===10){var y=u.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var S=u.type;es(u.pendingProps.value,y.value)||(t!==null?t.push(S):t=[S])}}else if(u===D.current){if(y=u.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==u.memoizedState.memoizedState&&(t!==null?t.push(ci):t=[ci])}u=u.return}t!==null&&Id(a,t,r,i),a.flags|=262144}function Zi(t){for(t=t.firstContext;t!==null;){if(!es(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function an(t){tn=t,Xs=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function qa(t){return Vh(tn,t)}function Ji(t,a){return tn===null&&an(t),Vh(t,a)}function Vh(t,a){var r=a._currentValue;if(a={context:a,memoizedValue:r,next:null},Xs===null){if(t===null)throw Error(l(308));Xs=a,t.dependencies={lanes:0,firstContext:a},t.flags|=524288}else Xs=Xs.next=a;return r}var Rj=typeof AbortController<"u"?AbortController:function(){var t=[],a=this.signal={aborted:!1,addEventListener:function(r,i){t.push(i)}};this.abort=function(){a.aborted=!0,t.forEach(function(r){return r()})}},Lj=s.unstable_scheduleCallback,Pj=s.unstable_NormalPriority,Ca={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Od(){return{controller:new Rj,data:new Map,refCount:0}}function Do(t){t.refCount--,t.refCount===0&&Lj(Pj,function(){t.controller.abort()})}var zo=null,Dd=0,On=0,Dn=null;function Mj(t,a){if(zo===null){var r=zo=[];Dd=0,On=Uu(),Dn={status:"pending",value:void 0,then:function(i){r.push(i)}}}return Dd++,a.then($h,$h),a}function $h(){if(--Dd===0&&zo!==null){Dn!==null&&(Dn.status="fulfilled");var t=zo;zo=null,On=0,Dn=null;for(var a=0;a<t.length;a++)(0,t[a])()}}function Ij(t,a){var r=[],i={status:"pending",value:null,reason:null,then:function(u){r.push(u)}};return t.then(function(){i.status="fulfilled",i.value=a;for(var u=0;u<r.length;u++)(0,r[u])(a)},function(u){for(i.status="rejected",i.reason=u,u=0;u<r.length;u++)(0,r[u])(void 0)}),i}var Fh=I.S;I.S=function(t,a){A0=Se(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Mj(t,a),Fh!==null&&Fh(t,a)};var sn=A(null);function zd(){var t=sn.current;return t!==null?t:ha.pooledCache}function el(t,a){a===null?se(sn,sn.current):se(sn,a.pool)}function Hh(){var t=zd();return t===null?null:{parent:Ca._currentValue,pool:t}}var zn=Error(l(460)),qd=Error(l(474)),tl=Error(l(542)),al={then:function(){}};function Gh(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Wh(t,a,r){switch(r=t[r],r===void 0?t.push(a):r!==a&&(a.then(Gs,Gs),a=r),a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,Yh(t),t;default:if(typeof a.status=="string")a.then(Gs,Gs);else{if(t=ha,t!==null&&100<t.shellSuspendCounter)throw Error(l(482));t=a,t.status="pending",t.then(function(i){if(a.status==="pending"){var u=a;u.status="fulfilled",u.value=i}},function(i){if(a.status==="pending"){var u=a;u.status="rejected",u.reason=i}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,Yh(t),t}throw nn=a,zn}}function rn(t){try{var a=t._init;return a(t._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(nn=r,zn):r}}var nn=null;function Kh(){if(nn===null)throw Error(l(459));var t=nn;return nn=null,t}function Yh(t){if(t===zn||t===tl)throw Error(l(483))}var qn=null,qo=0;function sl(t){var a=qo;return qo+=1,qn===null&&(qn=[]),Wh(qn,t,a)}function Uo(t,a){a=a.props.ref,t.ref=a!==void 0?a:null}function rl(t,a){throw a.$$typeof===N?Error(l(525)):(t=Object.prototype.toString.call(a),Error(l(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t)))}function Xh(t){function a(ie,te){if(t){var me=ie.deletions;me===null?(ie.deletions=[te],ie.flags|=16):me.push(te)}}function r(ie,te){if(!t)return null;for(;te!==null;)a(ie,te),te=te.sibling;return null}function i(ie){for(var te=new Map;ie!==null;)ie.key!==null?te.set(ie.key,ie):te.set(ie.index,ie),ie=ie.sibling;return te}function u(ie,te){return ie=Ks(ie,te),ie.index=0,ie.sibling=null,ie}function p(ie,te,me){return ie.index=me,t?(me=ie.alternate,me!==null?(me=me.index,me<te?(ie.flags|=67108866,te):me):(ie.flags|=67108866,te)):(ie.flags|=1048576,te)}function y(ie){return t&&ie.alternate===null&&(ie.flags|=67108866),ie}function S(ie,te,me,Re){return te===null||te.tag!==6?(te=Ad(me,ie.mode,Re),te.return=ie,te):(te=u(te,me),te.return=ie,te)}function H(ie,te,me,Re){var Et=me.type;return Et===w?Ae(ie,te,me.props.children,Re,me.key):te!==null&&(te.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===T&&rn(Et)===te.type)?(te=u(te,me.props),Uo(te,me),te.return=ie,te):(te=Xi(me.type,me.key,me.props,null,ie.mode,Re),Uo(te,me),te.return=ie,te)}function pe(ie,te,me,Re){return te===null||te.tag!==4||te.stateNode.containerInfo!==me.containerInfo||te.stateNode.implementation!==me.implementation?(te=Cd(me,ie.mode,Re),te.return=ie,te):(te=u(te,me.children||[]),te.return=ie,te)}function Ae(ie,te,me,Re,Et){return te===null||te.tag!==7?(te=Jr(me,ie.mode,Re,Et),te.return=ie,te):(te=u(te,me),te.return=ie,te)}function Pe(ie,te,me){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return te=Ad(""+te,ie.mode,me),te.return=ie,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case j:return me=Xi(te.type,te.key,te.props,null,ie.mode,me),Uo(me,te),me.return=ie,me;case _:return te=Cd(te,ie.mode,me),te.return=ie,te;case T:return te=rn(te),Pe(ie,te,me)}if(Le(te)||ne(te))return te=Jr(te,ie.mode,me,null),te.return=ie,te;if(typeof te.then=="function")return Pe(ie,sl(te),me);if(te.$$typeof===P)return Pe(ie,Ji(ie,te),me);rl(ie,te)}return null}function he(ie,te,me,Re){var Et=te!==null?te.key:null;if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return Et!==null?null:S(ie,te,""+me,Re);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case j:return me.key===Et?H(ie,te,me,Re):null;case _:return me.key===Et?pe(ie,te,me,Re):null;case T:return me=rn(me),he(ie,te,me,Re)}if(Le(me)||ne(me))return Et!==null?null:Ae(ie,te,me,Re,null);if(typeof me.then=="function")return he(ie,te,sl(me),Re);if(me.$$typeof===P)return he(ie,te,Ji(ie,me),Re);rl(ie,me)}return null}function ye(ie,te,me,Re,Et){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return ie=ie.get(me)||null,S(te,ie,""+Re,Et);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case j:return ie=ie.get(Re.key===null?me:Re.key)||null,H(te,ie,Re,Et);case _:return ie=ie.get(Re.key===null?me:Re.key)||null,pe(te,ie,Re,Et);case T:return Re=rn(Re),ye(ie,te,me,Re,Et)}if(Le(Re)||ne(Re))return ie=ie.get(me)||null,Ae(te,ie,Re,Et,null);if(typeof Re.then=="function")return ye(ie,te,me,sl(Re),Et);if(Re.$$typeof===P)return ye(ie,te,me,Ji(te,Re),Et);rl(te,Re)}return null}function bt(ie,te,me,Re){for(var Et=null,ea=null,wt=te,Bt=te=0,Wt=null;wt!==null&&Bt<me.length;Bt++){wt.index>Bt?(Wt=wt,wt=null):Wt=wt.sibling;var ta=he(ie,wt,me[Bt],Re);if(ta===null){wt===null&&(wt=Wt);break}t&&wt&&ta.alternate===null&&a(ie,wt),te=p(ta,te,Bt),ea===null?Et=ta:ea.sibling=ta,ea=ta,wt=Wt}if(Bt===me.length)return r(ie,wt),Yt&&Ys(ie,Bt),Et;if(wt===null){for(;Bt<me.length;Bt++)wt=Pe(ie,me[Bt],Re),wt!==null&&(te=p(wt,te,Bt),ea===null?Et=wt:ea.sibling=wt,ea=wt);return Yt&&Ys(ie,Bt),Et}for(wt=i(wt);Bt<me.length;Bt++)Wt=ye(wt,ie,Bt,me[Bt],Re),Wt!==null&&(t&&Wt.alternate!==null&&wt.delete(Wt.key===null?Bt:Wt.key),te=p(Wt,te,Bt),ea===null?Et=Wt:ea.sibling=Wt,ea=Wt);return t&&wt.forEach(function(Ur){return a(ie,Ur)}),Yt&&Ys(ie,Bt),Et}function Pt(ie,te,me,Re){if(me==null)throw Error(l(151));for(var Et=null,ea=null,wt=te,Bt=te=0,Wt=null,ta=me.next();wt!==null&&!ta.done;Bt++,ta=me.next()){wt.index>Bt?(Wt=wt,wt=null):Wt=wt.sibling;var Ur=he(ie,wt,ta.value,Re);if(Ur===null){wt===null&&(wt=Wt);break}t&&wt&&Ur.alternate===null&&a(ie,wt),te=p(Ur,te,Bt),ea===null?Et=Ur:ea.sibling=Ur,ea=Ur,wt=Wt}if(ta.done)return r(ie,wt),Yt&&Ys(ie,Bt),Et;if(wt===null){for(;!ta.done;Bt++,ta=me.next())ta=Pe(ie,ta.value,Re),ta!==null&&(te=p(ta,te,Bt),ea===null?Et=ta:ea.sibling=ta,ea=ta);return Yt&&Ys(ie,Bt),Et}for(wt=i(wt);!ta.done;Bt++,ta=me.next())ta=ye(wt,ie,Bt,ta.value,Re),ta!==null&&(t&&ta.alternate!==null&&wt.delete(ta.key===null?Bt:ta.key),te=p(ta,te,Bt),ea===null?Et=ta:ea.sibling=ta,ea=ta);return t&&wt.forEach(function(G_){return a(ie,G_)}),Yt&&Ys(ie,Bt),Et}function ma(ie,te,me,Re){if(typeof me=="object"&&me!==null&&me.type===w&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case j:e:{for(var Et=me.key;te!==null;){if(te.key===Et){if(Et=me.type,Et===w){if(te.tag===7){r(ie,te.sibling),Re=u(te,me.props.children),Re.return=ie,ie=Re;break e}}else if(te.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===T&&rn(Et)===te.type){r(ie,te.sibling),Re=u(te,me.props),Uo(Re,me),Re.return=ie,ie=Re;break e}r(ie,te);break}else a(ie,te);te=te.sibling}me.type===w?(Re=Jr(me.props.children,ie.mode,Re,me.key),Re.return=ie,ie=Re):(Re=Xi(me.type,me.key,me.props,null,ie.mode,Re),Uo(Re,me),Re.return=ie,ie=Re)}return y(ie);case _:e:{for(Et=me.key;te!==null;){if(te.key===Et)if(te.tag===4&&te.stateNode.containerInfo===me.containerInfo&&te.stateNode.implementation===me.implementation){r(ie,te.sibling),Re=u(te,me.children||[]),Re.return=ie,ie=Re;break e}else{r(ie,te);break}else a(ie,te);te=te.sibling}Re=Cd(me,ie.mode,Re),Re.return=ie,ie=Re}return y(ie);case T:return me=rn(me),ma(ie,te,me,Re)}if(Le(me))return bt(ie,te,me,Re);if(ne(me)){if(Et=ne(me),typeof Et!="function")throw Error(l(150));return me=Et.call(me),Pt(ie,te,me,Re)}if(typeof me.then=="function")return ma(ie,te,sl(me),Re);if(me.$$typeof===P)return ma(ie,te,Ji(ie,me),Re);rl(ie,me)}return typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint"?(me=""+me,te!==null&&te.tag===6?(r(ie,te.sibling),Re=u(te,me),Re.return=ie,ie=Re):(r(ie,te),Re=Ad(me,ie.mode,Re),Re.return=ie,ie=Re),y(ie)):r(ie,te)}return function(ie,te,me,Re){try{qo=0;var Et=ma(ie,te,me,Re);return qn=null,Et}catch(wt){if(wt===zn||wt===tl)throw wt;var ea=ts(29,wt,null,ie.mode);return ea.lanes=Re,ea.return=ie,ea}finally{}}}var on=Xh(!0),Qh=Xh(!1),_r=!1;function Ud(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Bd(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Sr(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function wr(t,a,r){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,(aa&2)!==0){var u=i.pending;return u===null?a.next=a:(a.next=u.next,u.next=a),i.pending=a,a=Yi(t),Mh(t,null,r),a}return Ki(t,i,a,r),Yi(t)}function Bo(t,a,r){if(a=a.updateQueue,a!==null&&(a=a.shared,(r&4194048)!==0)){var i=a.lanes;i&=t.pendingLanes,r|=i,a.lanes=r,$t(t,r)}}function Vd(t,a){var r=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var u=null,p=null;if(r=r.firstBaseUpdate,r!==null){do{var y={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};p===null?u=p=y:p=p.next=y,r=r.next}while(r!==null);p===null?u=p=a:p=p.next=a}else u=p=a;r={baseState:i.baseState,firstBaseUpdate:u,lastBaseUpdate:p,shared:i.shared,callbacks:i.callbacks},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=a:t.next=a,r.lastBaseUpdate=a}var $d=!1;function Vo(){if($d){var t=Dn;if(t!==null)throw t}}function $o(t,a,r,i){$d=!1;var u=t.updateQueue;_r=!1;var p=u.firstBaseUpdate,y=u.lastBaseUpdate,S=u.shared.pending;if(S!==null){u.shared.pending=null;var H=S,pe=H.next;H.next=null,y===null?p=pe:y.next=pe,y=H;var Ae=t.alternate;Ae!==null&&(Ae=Ae.updateQueue,S=Ae.lastBaseUpdate,S!==y&&(S===null?Ae.firstBaseUpdate=pe:S.next=pe,Ae.lastBaseUpdate=H))}if(p!==null){var Pe=u.baseState;y=0,Ae=pe=H=null,S=p;do{var he=S.lane&-536870913,ye=he!==S.lane;if(ye?(Gt&he)===he:(i&he)===he){he!==0&&he===On&&($d=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var bt=t,Pt=S;he=a;var ma=r;switch(Pt.tag){case 1:if(bt=Pt.payload,typeof bt=="function"){Pe=bt.call(ma,Pe,he);break e}Pe=bt;break e;case 3:bt.flags=bt.flags&-65537|128;case 0:if(bt=Pt.payload,he=typeof bt=="function"?bt.call(ma,Pe,he):bt,he==null)break e;Pe=f({},Pe,he);break e;case 2:_r=!0}}he=S.callback,he!==null&&(t.flags|=64,ye&&(t.flags|=8192),ye=u.callbacks,ye===null?u.callbacks=[he]:ye.push(he))}else ye={lane:he,tag:S.tag,payload:S.payload,callback:S.callback,next:null},Ae===null?(pe=Ae=ye,H=Pe):Ae=Ae.next=ye,y|=he;if(S=S.next,S===null){if(S=u.shared.pending,S===null)break;ye=S,S=ye.next,ye.next=null,u.lastBaseUpdate=ye,u.shared.pending=null}}while(!0);Ae===null&&(H=Pe),u.baseState=H,u.firstBaseUpdate=pe,u.lastBaseUpdate=Ae,p===null&&(u.shared.lanes=0),Er|=y,t.lanes=y,t.memoizedState=Pe}}function Zh(t,a){if(typeof t!="function")throw Error(l(191,t));t.call(a)}function Jh(t,a){var r=t.callbacks;if(r!==null)for(t.callbacks=null,t=0;t<r.length;t++)Zh(r[t],a)}var Un=A(null),nl=A(0);function ex(t,a){t=or,se(nl,t),se(Un,a),or=t|a.baseLanes}function Fd(){se(nl,or),se(Un,Un.current)}function Hd(){or=nl.current,$(Un),$(nl)}var as=A(null),gs=null;function Tr(t){var a=t.alternate;se(wa,wa.current&1),se(as,t),gs===null&&(a===null||Un.current!==null||a.memoizedState!==null)&&(gs=t)}function Gd(t){se(wa,wa.current),se(as,t),gs===null&&(gs=t)}function tx(t){t.tag===22?(se(wa,wa.current),se(as,t),gs===null&&(gs=t)):Ar()}function Ar(){se(wa,wa.current),se(as,as.current)}function ss(t){$(as),gs===t&&(gs=null),$(wa)}var wa=A(0);function ol(t){for(var a=t;a!==null;){if(a.tag===13){var r=a.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||Zu(r)||Ju(r)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Zs=0,Ut=null,da=null,ka=null,il=!1,Bn=!1,ln=!1,ll=0,Fo=0,Vn=null,Oj=0;function ja(){throw Error(l(321))}function Wd(t,a){if(a===null)return!1;for(var r=0;r<a.length&&r<t.length;r++)if(!es(t[r],a[r]))return!1;return!0}function Kd(t,a,r,i,u,p){return Zs=p,Ut=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,I.H=t===null||t.memoizedState===null?zx:cu,ln=!1,p=r(i,u),ln=!1,Bn&&(p=sx(a,r,i,u)),ax(t),p}function ax(t){I.H=Wo;var a=da!==null&&da.next!==null;if(Zs=0,ka=da=Ut=null,il=!1,Fo=0,Vn=null,a)throw Error(l(300));t===null||Ea||(t=t.dependencies,t!==null&&Zi(t)&&(Ea=!0))}function sx(t,a,r,i){Ut=t;var u=0;do{if(Bn&&(Vn=null),Fo=0,Bn=!1,25<=u)throw Error(l(301));if(u+=1,ka=da=null,t.updateQueue!=null){var p=t.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}I.H=qx,p=a(r,i)}while(Bn);return p}function Dj(){var t=I.H,a=t.useState()[0];return a=typeof a.then=="function"?Ho(a):a,t=t.useState()[0],(da!==null?da.memoizedState:null)!==t&&(Ut.flags|=1024),a}function Yd(){var t=ll!==0;return ll=0,t}function Xd(t,a,r){a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~r}function Qd(t){if(il){for(t=t.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}il=!1}Zs=0,ka=da=Ut=null,Bn=!1,Fo=ll=0,Vn=null}function Fa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ka===null?Ut.memoizedState=ka=t:ka=ka.next=t,ka}function Ta(){if(da===null){var t=Ut.alternate;t=t!==null?t.memoizedState:null}else t=da.next;var a=ka===null?Ut.memoizedState:ka.next;if(a!==null)ka=a,da=t;else{if(t===null)throw Ut.alternate===null?Error(l(467)):Error(l(310));da=t,t={memoizedState:da.memoizedState,baseState:da.baseState,baseQueue:da.baseQueue,queue:da.queue,next:null},ka===null?Ut.memoizedState=ka=t:ka=ka.next=t}return ka}function cl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ho(t){var a=Fo;return Fo+=1,Vn===null&&(Vn=[]),t=Wh(Vn,t,a),a=Ut,(ka===null?a.memoizedState:ka.next)===null&&(a=a.alternate,I.H=a===null||a.memoizedState===null?zx:cu),t}function dl(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Ho(t);if(t.$$typeof===P)return qa(t)}throw Error(l(438,String(t)))}function Zd(t){var a=null,r=Ut.updateQueue;if(r!==null&&(a=r.memoCache),a==null){var i=Ut.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(a={data:i.data.map(function(u){return u.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),r===null&&(r=cl(),Ut.updateQueue=r),r.memoCache=a,r=a.data[a.index],r===void 0)for(r=a.data[a.index]=Array(t),i=0;i<t;i++)r[i]=J;return a.index++,r}function Js(t,a){return typeof a=="function"?a(t):a}function ul(t){var a=Ta();return Jd(a,da,t)}function Jd(t,a,r){var i=t.queue;if(i===null)throw Error(l(311));i.lastRenderedReducer=r;var u=t.baseQueue,p=i.pending;if(p!==null){if(u!==null){var y=u.next;u.next=p.next,p.next=y}a.baseQueue=u=p,i.pending=null}if(p=t.baseState,u===null)t.memoizedState=p;else{a=u.next;var S=y=null,H=null,pe=a,Ae=!1;do{var Pe=pe.lane&-536870913;if(Pe!==pe.lane?(Gt&Pe)===Pe:(Zs&Pe)===Pe){var he=pe.revertLane;if(he===0)H!==null&&(H=H.next={lane:0,revertLane:0,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),Pe===On&&(Ae=!0);else if((Zs&he)===he){pe=pe.next,he===On&&(Ae=!0);continue}else Pe={lane:0,revertLane:pe.revertLane,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},H===null?(S=H=Pe,y=p):H=H.next=Pe,Ut.lanes|=he,Er|=he;Pe=pe.action,ln&&r(p,Pe),p=pe.hasEagerState?pe.eagerState:r(p,Pe)}else he={lane:Pe,revertLane:pe.revertLane,gesture:pe.gesture,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},H===null?(S=H=he,y=p):H=H.next=he,Ut.lanes|=Pe,Er|=Pe;pe=pe.next}while(pe!==null&&pe!==a);if(H===null?y=p:H.next=S,!es(p,t.memoizedState)&&(Ea=!0,Ae&&(r=Dn,r!==null)))throw r;t.memoizedState=p,t.baseState=y,t.baseQueue=H,i.lastRenderedState=p}return u===null&&(i.lanes=0),[t.memoizedState,i.dispatch]}function eu(t){var a=Ta(),r=a.queue;if(r===null)throw Error(l(311));r.lastRenderedReducer=t;var i=r.dispatch,u=r.pending,p=a.memoizedState;if(u!==null){r.pending=null;var y=u=u.next;do p=t(p,y.action),y=y.next;while(y!==u);es(p,a.memoizedState)||(Ea=!0),a.memoizedState=p,a.baseQueue===null&&(a.baseState=p),r.lastRenderedState=p}return[p,i]}function rx(t,a,r){var i=Ut,u=Ta(),p=Yt;if(p){if(r===void 0)throw Error(l(407));r=r()}else r=a();var y=!es((da||u).memoizedState,r);if(y&&(u.memoizedState=r,Ea=!0),u=u.queue,su(ix.bind(null,i,u,t),[t]),u.getSnapshot!==a||y||ka!==null&&ka.memoizedState.tag&1){if(i.flags|=2048,$n(9,{destroy:void 0},ox.bind(null,i,u,r,a),null),ha===null)throw Error(l(349));p||(Zs&127)!==0||nx(i,a,r)}return r}function nx(t,a,r){t.flags|=16384,t={getSnapshot:a,value:r},a=Ut.updateQueue,a===null?(a=cl(),Ut.updateQueue=a,a.stores=[t]):(r=a.stores,r===null?a.stores=[t]:r.push(t))}function ox(t,a,r,i){a.value=r,a.getSnapshot=i,lx(a)&&cx(t)}function ix(t,a,r){return r(function(){lx(a)&&cx(t)})}function lx(t){var a=t.getSnapshot;t=t.value;try{var r=a();return!es(t,r)}catch{return!0}}function cx(t){var a=Zr(t,2);a!==null&&Za(a,t,2)}function tu(t){var a=Fa();if(typeof t=="function"){var r=t;if(t=r(),ln){Ve(!0);try{r()}finally{Ve(!1)}}}return a.memoizedState=a.baseState=t,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Js,lastRenderedState:t},a}function dx(t,a,r,i){return t.baseState=r,Jd(t,da,typeof i=="function"?i:Js)}function zj(t,a,r,i,u){if(hl(t))throw Error(l(485));if(t=a.action,t!==null){var p={payload:u,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){p.listeners.push(y)}};I.T!==null?r(!0):p.isTransition=!1,i(p),r=a.pending,r===null?(p.next=a.pending=p,ux(a,p)):(p.next=r.next,a.pending=r.next=p)}}function ux(t,a){var r=a.action,i=a.payload,u=t.state;if(a.isTransition){var p=I.T,y={};I.T=y;try{var S=r(u,i),H=I.S;H!==null&&H(y,S),mx(t,a,S)}catch(pe){au(t,a,pe)}finally{p!==null&&y.types!==null&&(p.types=y.types),I.T=p}}else try{p=r(u,i),mx(t,a,p)}catch(pe){au(t,a,pe)}}function mx(t,a,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(i){px(t,a,i)},function(i){return au(t,a,i)}):px(t,a,r)}function px(t,a,r){a.status="fulfilled",a.value=r,hx(a),t.state=r,a=t.pending,a!==null&&(r=a.next,r===a?t.pending=null:(r=r.next,a.next=r,ux(t,r)))}function au(t,a,r){var i=t.pending;if(t.pending=null,i!==null){i=i.next;do a.status="rejected",a.reason=r,hx(a),a=a.next;while(a!==i)}t.action=null}function hx(t){t=t.listeners;for(var a=0;a<t.length;a++)(0,t[a])()}function xx(t,a){return a}function fx(t,a){if(Yt){var r=ha.formState;if(r!==null){e:{var i=Ut;if(Yt){if(ba){t:{for(var u=ba,p=fs;u.nodeType!==8;){if(!p){u=null;break t}if(u=bs(u.nextSibling),u===null){u=null;break t}}p=u.data,u=p==="F!"||p==="F"?u:null}if(u){ba=bs(u.nextSibling),i=u.data==="F!";break e}}Nr(i)}i=!1}i&&(a=r[0])}}return r=Fa(),r.memoizedState=r.baseState=a,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xx,lastRenderedState:a},r.queue=i,r=Ix.bind(null,Ut,i),i.dispatch=r,i=tu(!1),p=lu.bind(null,Ut,!1,i.queue),i=Fa(),u={state:a,dispatch:null,action:t,pending:null},i.queue=u,r=zj.bind(null,Ut,u,p,r),u.dispatch=r,i.memoizedState=t,[a,r,!1]}function gx(t){var a=Ta();return bx(a,da,t)}function bx(t,a,r){if(a=Jd(t,a,xx)[0],t=ul(Js)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var i=Ho(a)}catch(y){throw y===zn?tl:y}else i=a;a=Ta();var u=a.queue,p=u.dispatch;return r!==a.memoizedState&&(Ut.flags|=2048,$n(9,{destroy:void 0},qj.bind(null,u,r),null)),[i,p,t]}function qj(t,a){t.action=a}function vx(t){var a=Ta(),r=da;if(r!==null)return bx(a,r,t);Ta(),a=a.memoizedState,r=Ta();var i=r.queue.dispatch;return r.memoizedState=t,[a,i,!1]}function $n(t,a,r,i){return t={tag:t,create:r,deps:i,inst:a,next:null},a=Ut.updateQueue,a===null&&(a=cl(),Ut.updateQueue=a),r=a.lastEffect,r===null?a.lastEffect=t.next=t:(i=r.next,r.next=t,t.next=i,a.lastEffect=t),t}function yx(){return Ta().memoizedState}function ml(t,a,r,i){var u=Fa();Ut.flags|=t,u.memoizedState=$n(1|a,{destroy:void 0},r,i===void 0?null:i)}function pl(t,a,r,i){var u=Ta();i=i===void 0?null:i;var p=u.memoizedState.inst;da!==null&&i!==null&&Wd(i,da.memoizedState.deps)?u.memoizedState=$n(a,p,r,i):(Ut.flags|=t,u.memoizedState=$n(1|a,p,r,i))}function Nx(t,a){ml(8390656,8,t,a)}function su(t,a){pl(2048,8,t,a)}function Uj(t){Ut.flags|=4;var a=Ut.updateQueue;if(a===null)a=cl(),Ut.updateQueue=a,a.events=[t];else{var r=a.events;r===null?a.events=[t]:r.push(t)}}function jx(t){var a=Ta().memoizedState;return Uj({ref:a,nextImpl:t}),function(){if((aa&2)!==0)throw Error(l(440));return a.impl.apply(void 0,arguments)}}function _x(t,a){return pl(4,2,t,a)}function Sx(t,a){return pl(4,4,t,a)}function wx(t,a){if(typeof a=="function"){t=t();var r=a(t);return function(){typeof r=="function"?r():a(null)}}if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function Tx(t,a,r){r=r!=null?r.concat([t]):null,pl(4,4,wx.bind(null,a,t),r)}function ru(){}function Ax(t,a){var r=Ta();a=a===void 0?null:a;var i=r.memoizedState;return a!==null&&Wd(a,i[1])?i[0]:(r.memoizedState=[t,a],t)}function Cx(t,a){var r=Ta();a=a===void 0?null:a;var i=r.memoizedState;if(a!==null&&Wd(a,i[1]))return i[0];if(i=t(),ln){Ve(!0);try{t()}finally{Ve(!1)}}return r.memoizedState=[i,a],i}function nu(t,a,r){return r===void 0||(Zs&1073741824)!==0&&(Gt&261930)===0?t.memoizedState=a:(t.memoizedState=r,t=k0(),Ut.lanes|=t,Er|=t,r)}function kx(t,a,r,i){return es(r,a)?r:Un.current!==null?(t=nu(t,r,i),es(t,a)||(Ea=!0),t):(Zs&42)===0||(Zs&1073741824)!==0&&(Gt&261930)===0?(Ea=!0,t.memoizedState=r):(t=k0(),Ut.lanes|=t,Er|=t,a)}function Ex(t,a,r,i,u){var p=Q.p;Q.p=p!==0&&8>p?p:8;var y=I.T,S={};I.T=S,lu(t,!1,a,r);try{var H=u(),pe=I.S;if(pe!==null&&pe(S,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var Ae=Ij(H,i);Go(t,a,Ae,os(t))}else Go(t,a,i,os(t))}catch(Pe){Go(t,a,{then:function(){},status:"rejected",reason:Pe},os())}finally{Q.p=p,y!==null&&S.types!==null&&(y.types=S.types),I.T=y}}function Bj(){}function ou(t,a,r,i){if(t.tag!==5)throw Error(l(476));var u=Rx(t).queue;Ex(t,u,a,F,r===null?Bj:function(){return Lx(t),r(i)})}function Rx(t){var a=t.memoizedState;if(a!==null)return a;a={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Js,lastRenderedState:F},next:null};var r={};return a.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Js,lastRenderedState:r},next:null},t.memoizedState=a,t=t.alternate,t!==null&&(t.memoizedState=a),a}function Lx(t){var a=Rx(t);a.next===null&&(a=t.alternate.memoizedState),Go(t,a.next.queue,{},os())}function iu(){return qa(ci)}function Px(){return Ta().memoizedState}function Mx(){return Ta().memoizedState}function Vj(t){for(var a=t.return;a!==null;){switch(a.tag){case 24:case 3:var r=os();t=Sr(r);var i=wr(a,t,r);i!==null&&(Za(i,a,r),Bo(i,a,r)),a={cache:Od()},t.payload=a;return}a=a.return}}function $j(t,a,r){var i=os();r={lane:i,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},hl(t)?Ox(a,r):(r=wd(t,a,r,i),r!==null&&(Za(r,t,i),Dx(r,a,i)))}function Ix(t,a,r){var i=os();Go(t,a,r,i)}function Go(t,a,r,i){var u={lane:i,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(hl(t))Ox(a,u);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=a.lastRenderedReducer,p!==null))try{var y=a.lastRenderedState,S=p(y,r);if(u.hasEagerState=!0,u.eagerState=S,es(S,y))return Ki(t,a,u,0),ha===null&&Wi(),!1}catch{}finally{}if(r=wd(t,a,u,i),r!==null)return Za(r,t,i),Dx(r,a,i),!0}return!1}function lu(t,a,r,i){if(i={lane:2,revertLane:Uu(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},hl(t)){if(a)throw Error(l(479))}else a=wd(t,r,i,2),a!==null&&Za(a,t,2)}function hl(t){var a=t.alternate;return t===Ut||a!==null&&a===Ut}function Ox(t,a){Bn=il=!0;var r=t.pending;r===null?a.next=a:(a.next=r.next,r.next=a),t.pending=a}function Dx(t,a,r){if((r&4194048)!==0){var i=a.lanes;i&=t.pendingLanes,r|=i,a.lanes=r,$t(t,r)}}var Wo={readContext:qa,use:dl,useCallback:ja,useContext:ja,useEffect:ja,useImperativeHandle:ja,useLayoutEffect:ja,useInsertionEffect:ja,useMemo:ja,useReducer:ja,useRef:ja,useState:ja,useDebugValue:ja,useDeferredValue:ja,useTransition:ja,useSyncExternalStore:ja,useId:ja,useHostTransitionStatus:ja,useFormState:ja,useActionState:ja,useOptimistic:ja,useMemoCache:ja,useCacheRefresh:ja};Wo.useEffectEvent=ja;var zx={readContext:qa,use:dl,useCallback:function(t,a){return Fa().memoizedState=[t,a===void 0?null:a],t},useContext:qa,useEffect:Nx,useImperativeHandle:function(t,a,r){r=r!=null?r.concat([t]):null,ml(4194308,4,wx.bind(null,a,t),r)},useLayoutEffect:function(t,a){return ml(4194308,4,t,a)},useInsertionEffect:function(t,a){ml(4,2,t,a)},useMemo:function(t,a){var r=Fa();a=a===void 0?null:a;var i=t();if(ln){Ve(!0);try{t()}finally{Ve(!1)}}return r.memoizedState=[i,a],i},useReducer:function(t,a,r){var i=Fa();if(r!==void 0){var u=r(a);if(ln){Ve(!0);try{r(a)}finally{Ve(!1)}}}else u=a;return i.memoizedState=i.baseState=u,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:u},i.queue=t,t=t.dispatch=$j.bind(null,Ut,t),[i.memoizedState,t]},useRef:function(t){var a=Fa();return t={current:t},a.memoizedState=t},useState:function(t){t=tu(t);var a=t.queue,r=Ix.bind(null,Ut,a);return a.dispatch=r,[t.memoizedState,r]},useDebugValue:ru,useDeferredValue:function(t,a){var r=Fa();return nu(r,t,a)},useTransition:function(){var t=tu(!1);return t=Ex.bind(null,Ut,t.queue,!0,!1),Fa().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,a,r){var i=Ut,u=Fa();if(Yt){if(r===void 0)throw Error(l(407));r=r()}else{if(r=a(),ha===null)throw Error(l(349));(Gt&127)!==0||nx(i,a,r)}u.memoizedState=r;var p={value:r,getSnapshot:a};return u.queue=p,Nx(ix.bind(null,i,p,t),[t]),i.flags|=2048,$n(9,{destroy:void 0},ox.bind(null,i,p,r,a),null),r},useId:function(){var t=Fa(),a=ha.identifierPrefix;if(Yt){var r=Ps,i=Ls;r=(i&~(1<<32-ce(i)-1)).toString(32)+r,a="_"+a+"R_"+r,r=ll++,0<r&&(a+="H"+r.toString(32)),a+="_"}else r=Oj++,a="_"+a+"r_"+r.toString(32)+"_";return t.memoizedState=a},useHostTransitionStatus:iu,useFormState:fx,useActionState:fx,useOptimistic:function(t){var a=Fa();a.memoizedState=a.baseState=t;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=r,a=lu.bind(null,Ut,!0,r),r.dispatch=a,[t,a]},useMemoCache:Zd,useCacheRefresh:function(){return Fa().memoizedState=Vj.bind(null,Ut)},useEffectEvent:function(t){var a=Fa(),r={impl:t};return a.memoizedState=r,function(){if((aa&2)!==0)throw Error(l(440));return r.impl.apply(void 0,arguments)}}},cu={readContext:qa,use:dl,useCallback:Ax,useContext:qa,useEffect:su,useImperativeHandle:Tx,useInsertionEffect:_x,useLayoutEffect:Sx,useMemo:Cx,useReducer:ul,useRef:yx,useState:function(){return ul(Js)},useDebugValue:ru,useDeferredValue:function(t,a){var r=Ta();return kx(r,da.memoizedState,t,a)},useTransition:function(){var t=ul(Js)[0],a=Ta().memoizedState;return[typeof t=="boolean"?t:Ho(t),a]},useSyncExternalStore:rx,useId:Px,useHostTransitionStatus:iu,useFormState:gx,useActionState:gx,useOptimistic:function(t,a){var r=Ta();return dx(r,da,t,a)},useMemoCache:Zd,useCacheRefresh:Mx};cu.useEffectEvent=jx;var qx={readContext:qa,use:dl,useCallback:Ax,useContext:qa,useEffect:su,useImperativeHandle:Tx,useInsertionEffect:_x,useLayoutEffect:Sx,useMemo:Cx,useReducer:eu,useRef:yx,useState:function(){return eu(Js)},useDebugValue:ru,useDeferredValue:function(t,a){var r=Ta();return da===null?nu(r,t,a):kx(r,da.memoizedState,t,a)},useTransition:function(){var t=eu(Js)[0],a=Ta().memoizedState;return[typeof t=="boolean"?t:Ho(t),a]},useSyncExternalStore:rx,useId:Px,useHostTransitionStatus:iu,useFormState:vx,useActionState:vx,useOptimistic:function(t,a){var r=Ta();return da!==null?dx(r,da,t,a):(r.baseState=t,[t,r.queue.dispatch])},useMemoCache:Zd,useCacheRefresh:Mx};qx.useEffectEvent=jx;function du(t,a,r,i){a=t.memoizedState,r=r(i,a),r=r==null?a:f({},a,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var uu={enqueueSetState:function(t,a,r){t=t._reactInternals;var i=os(),u=Sr(i);u.payload=a,r!=null&&(u.callback=r),a=wr(t,u,i),a!==null&&(Za(a,t,i),Bo(a,t,i))},enqueueReplaceState:function(t,a,r){t=t._reactInternals;var i=os(),u=Sr(i);u.tag=1,u.payload=a,r!=null&&(u.callback=r),a=wr(t,u,i),a!==null&&(Za(a,t,i),Bo(a,t,i))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var r=os(),i=Sr(r);i.tag=2,a!=null&&(i.callback=a),a=wr(t,i,r),a!==null&&(Za(a,t,r),Bo(a,t,r))}};function Ux(t,a,r,i,u,p,y){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,p,y):a.prototype&&a.prototype.isPureReactComponent?!Po(r,i)||!Po(u,p):!0}function Bx(t,a,r,i){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(r,i),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(r,i),a.state!==t&&uu.enqueueReplaceState(a,a.state,null)}function cn(t,a){var r=a;if("ref"in a){r={};for(var i in a)i!=="ref"&&(r[i]=a[i])}if(t=t.defaultProps){r===a&&(r=f({},r));for(var u in t)r[u]===void 0&&(r[u]=t[u])}return r}function Vx(t){Gi(t)}function $x(t){console.error(t)}function Fx(t){Gi(t)}function xl(t,a){try{var r=t.onUncaughtError;r(a.value,{componentStack:a.stack})}catch(i){setTimeout(function(){throw i})}}function Hx(t,a,r){try{var i=t.onCaughtError;i(r.value,{componentStack:r.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(u){setTimeout(function(){throw u})}}function mu(t,a,r){return r=Sr(r),r.tag=3,r.payload={element:null},r.callback=function(){xl(t,a)},r}function Gx(t){return t=Sr(t),t.tag=3,t}function Wx(t,a,r,i){var u=r.type.getDerivedStateFromError;if(typeof u=="function"){var p=i.value;t.payload=function(){return u(p)},t.callback=function(){Hx(a,r,i)}}var y=r.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(t.callback=function(){Hx(a,r,i),typeof u!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var S=i.stack;this.componentDidCatch(i.value,{componentStack:S!==null?S:""})})}function Fj(t,a,r,i,u){if(r.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(a=r.alternate,a!==null&&In(a,r,u,!0),r=as.current,r!==null){switch(r.tag){case 31:case 13:return gs===null?Al():r.alternate===null&&_a===0&&(_a=3),r.flags&=-257,r.flags|=65536,r.lanes=u,i===al?r.flags|=16384:(a=r.updateQueue,a===null?r.updateQueue=new Set([i]):a.add(i),Du(t,i,u)),!1;case 22:return r.flags|=65536,i===al?r.flags|=16384:(a=r.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([i])},r.updateQueue=a):(r=a.retryQueue,r===null?a.retryQueue=new Set([i]):r.add(i)),Du(t,i,u)),!1}throw Error(l(435,r.tag))}return Du(t,i,u),Al(),!1}if(Yt)return a=as.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=u,i!==Rd&&(t=Error(l(422),{cause:i}),Oo(ps(t,r)))):(i!==Rd&&(a=Error(l(423),{cause:i}),Oo(ps(a,r))),t=t.current.alternate,t.flags|=65536,u&=-u,t.lanes|=u,i=ps(i,r),u=mu(t.stateNode,i,u),Vd(t,u),_a!==4&&(_a=2)),!1;var p=Error(l(520),{cause:i});if(p=ps(p,r),ti===null?ti=[p]:ti.push(p),_a!==4&&(_a=2),a===null)return!0;i=ps(i,r),r=a;do{switch(r.tag){case 3:return r.flags|=65536,t=u&-u,r.lanes|=t,t=mu(r.stateNode,i,t),Vd(r,t),!1;case 1:if(a=r.type,p=r.stateNode,(r.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Rr===null||!Rr.has(p))))return r.flags|=65536,u&=-u,r.lanes|=u,u=Gx(u),Wx(u,t,r,i),Vd(r,u),!1}r=r.return}while(r!==null);return!1}var pu=Error(l(461)),Ea=!1;function Ua(t,a,r,i){a.child=t===null?Qh(a,null,r,i):on(a,t.child,r,i)}function Kx(t,a,r,i,u){r=r.render;var p=a.ref;if("ref"in i){var y={};for(var S in i)S!=="ref"&&(y[S]=i[S])}else y=i;return an(a),i=Kd(t,a,r,y,p,u),S=Yd(),t!==null&&!Ea?(Xd(t,a,u),er(t,a,u)):(Yt&&S&&kd(a),a.flags|=1,Ua(t,a,i,u),a.child)}function Yx(t,a,r,i,u){if(t===null){var p=r.type;return typeof p=="function"&&!Td(p)&&p.defaultProps===void 0&&r.compare===null?(a.tag=15,a.type=p,Xx(t,a,p,i,u)):(t=Xi(r.type,null,i,a,a.mode,u),t.ref=a.ref,t.return=a,a.child=t)}if(p=t.child,!Nu(t,u)){var y=p.memoizedProps;if(r=r.compare,r=r!==null?r:Po,r(y,i)&&t.ref===a.ref)return er(t,a,u)}return a.flags|=1,t=Ks(p,i),t.ref=a.ref,t.return=a,a.child=t}function Xx(t,a,r,i,u){if(t!==null){var p=t.memoizedProps;if(Po(p,i)&&t.ref===a.ref)if(Ea=!1,a.pendingProps=i=p,Nu(t,u))(t.flags&131072)!==0&&(Ea=!0);else return a.lanes=t.lanes,er(t,a,u)}return hu(t,a,r,i,u)}function Qx(t,a,r,i){var u=i.children,p=t!==null?t.memoizedState:null;if(t===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((a.flags&128)!==0){if(p=p!==null?p.baseLanes|r:r,t!==null){for(i=a.child=t.child,u=0;i!==null;)u=u|i.lanes|i.childLanes,i=i.sibling;i=u&~p}else i=0,a.child=null;return Zx(t,a,p,r,i)}if((r&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},t!==null&&el(a,p!==null?p.cachePool:null),p!==null?ex(a,p):Fd(),tx(a);else return i=a.lanes=536870912,Zx(t,a,p!==null?p.baseLanes|r:r,r,i)}else p!==null?(el(a,p.cachePool),ex(a,p),Ar(),a.memoizedState=null):(t!==null&&el(a,null),Fd(),Ar());return Ua(t,a,u,r),a.child}function Ko(t,a){return t!==null&&t.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Zx(t,a,r,i,u){var p=zd();return p=p===null?null:{parent:Ca._currentValue,pool:p},a.memoizedState={baseLanes:r,cachePool:p},t!==null&&el(a,null),Fd(),tx(a),t!==null&&In(t,a,i,!0),a.childLanes=u,null}function fl(t,a){return a=bl({mode:a.mode,children:a.children},t.mode),a.ref=t.ref,t.child=a,a.return=t,a}function Jx(t,a,r){return on(a,t.child,null,r),t=fl(a,a.pendingProps),t.flags|=2,ss(a),a.memoizedState=null,t}function Hj(t,a,r){var i=a.pendingProps,u=(a.flags&128)!==0;if(a.flags&=-129,t===null){if(Yt){if(i.mode==="hidden")return t=fl(a,i),a.lanes=536870912,Ko(null,t);if(Gd(a),(t=ba)?(t=mf(t,fs),t=t!==null&&t.data==="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:vr!==null?{id:Ls,overflow:Ps}:null,retryLane:536870912,hydrationErrors:null},r=Oh(t),r.return=a,a.child=r,za=a,ba=null)):t=null,t===null)throw Nr(a);return a.lanes=536870912,null}return fl(a,i)}var p=t.memoizedState;if(p!==null){var y=p.dehydrated;if(Gd(a),u)if(a.flags&256)a.flags&=-257,a=Jx(t,a,r);else if(a.memoizedState!==null)a.child=t.child,a.flags|=128,a=null;else throw Error(l(558));else if(Ea||In(t,a,r,!1),u=(r&t.childLanes)!==0,Ea||u){if(i=ha,i!==null&&(y=Zt(i,r),y!==0&&y!==p.retryLane))throw p.retryLane=y,Zr(t,y),Za(i,t,y),pu;Al(),a=Jx(t,a,r)}else t=p.treeContext,ba=bs(y.nextSibling),za=a,Yt=!0,yr=null,fs=!1,t!==null&&qh(a,t),a=fl(a,i),a.flags|=4096;return a}return t=Ks(t.child,{mode:i.mode,children:i.children}),t.ref=a.ref,a.child=t,t.return=a,t}function gl(t,a){var r=a.ref;if(r===null)t!==null&&t.ref!==null&&(a.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(l(284));(t===null||t.ref!==r)&&(a.flags|=4194816)}}function hu(t,a,r,i,u){return an(a),r=Kd(t,a,r,i,void 0,u),i=Yd(),t!==null&&!Ea?(Xd(t,a,u),er(t,a,u)):(Yt&&i&&kd(a),a.flags|=1,Ua(t,a,r,u),a.child)}function e0(t,a,r,i,u,p){return an(a),a.updateQueue=null,r=sx(a,i,r,u),ax(t),i=Yd(),t!==null&&!Ea?(Xd(t,a,p),er(t,a,p)):(Yt&&i&&kd(a),a.flags|=1,Ua(t,a,r,p),a.child)}function t0(t,a,r,i,u){if(an(a),a.stateNode===null){var p=Rn,y=r.contextType;typeof y=="object"&&y!==null&&(p=qa(y)),p=new r(i,p),a.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=uu,a.stateNode=p,p._reactInternals=a,p=a.stateNode,p.props=i,p.state=a.memoizedState,p.refs={},Ud(a),y=r.contextType,p.context=typeof y=="object"&&y!==null?qa(y):Rn,p.state=a.memoizedState,y=r.getDerivedStateFromProps,typeof y=="function"&&(du(a,r,y,i),p.state=a.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(y=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),y!==p.state&&uu.enqueueReplaceState(p,p.state,null),$o(a,i,p,u),Vo(),p.state=a.memoizedState),typeof p.componentDidMount=="function"&&(a.flags|=4194308),i=!0}else if(t===null){p=a.stateNode;var S=a.memoizedProps,H=cn(r,S);p.props=H;var pe=p.context,Ae=r.contextType;y=Rn,typeof Ae=="object"&&Ae!==null&&(y=qa(Ae));var Pe=r.getDerivedStateFromProps;Ae=typeof Pe=="function"||typeof p.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,Ae||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S||pe!==y)&&Bx(a,p,i,y),_r=!1;var he=a.memoizedState;p.state=he,$o(a,i,p,u),Vo(),pe=a.memoizedState,S||he!==pe||_r?(typeof Pe=="function"&&(du(a,r,Pe,i),pe=a.memoizedState),(H=_r||Ux(a,r,H,i,he,pe,y))?(Ae||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(a.flags|=4194308)):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=i,a.memoizedState=pe),p.props=i,p.state=pe,p.context=y,i=H):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),i=!1)}else{p=a.stateNode,Bd(t,a),y=a.memoizedProps,Ae=cn(r,y),p.props=Ae,Pe=a.pendingProps,he=p.context,pe=r.contextType,H=Rn,typeof pe=="object"&&pe!==null&&(H=qa(pe)),S=r.getDerivedStateFromProps,(pe=typeof S=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(y!==Pe||he!==H)&&Bx(a,p,i,H),_r=!1,he=a.memoizedState,p.state=he,$o(a,i,p,u),Vo();var ye=a.memoizedState;y!==Pe||he!==ye||_r||t!==null&&t.dependencies!==null&&Zi(t.dependencies)?(typeof S=="function"&&(du(a,r,S,i),ye=a.memoizedState),(Ae=_r||Ux(a,r,Ae,i,he,ye,H)||t!==null&&t.dependencies!==null&&Zi(t.dependencies))?(pe||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(i,ye,H),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(i,ye,H)),typeof p.componentDidUpdate=="function"&&(a.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof p.componentDidUpdate!="function"||y===t.memoizedProps&&he===t.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&he===t.memoizedState||(a.flags|=1024),a.memoizedProps=i,a.memoizedState=ye),p.props=i,p.state=ye,p.context=H,i=Ae):(typeof p.componentDidUpdate!="function"||y===t.memoizedProps&&he===t.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&he===t.memoizedState||(a.flags|=1024),i=!1)}return p=i,gl(t,a),i=(a.flags&128)!==0,p||i?(p=a.stateNode,r=i&&typeof r.getDerivedStateFromError!="function"?null:p.render(),a.flags|=1,t!==null&&i?(a.child=on(a,t.child,null,u),a.child=on(a,null,r,u)):Ua(t,a,r,u),a.memoizedState=p.state,t=a.child):t=er(t,a,u),t}function a0(t,a,r,i){return en(),a.flags|=256,Ua(t,a,r,i),a.child}var xu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function fu(t){return{baseLanes:t,cachePool:Hh()}}function gu(t,a,r){return t=t!==null?t.childLanes&~r:0,a&&(t|=ns),t}function s0(t,a,r){var i=a.pendingProps,u=!1,p=(a.flags&128)!==0,y;if((y=p)||(y=t!==null&&t.memoizedState===null?!1:(wa.current&2)!==0),y&&(u=!0,a.flags&=-129),y=(a.flags&32)!==0,a.flags&=-33,t===null){if(Yt){if(u?Tr(a):Ar(),(t=ba)?(t=mf(t,fs),t=t!==null&&t.data!=="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:vr!==null?{id:Ls,overflow:Ps}:null,retryLane:536870912,hydrationErrors:null},r=Oh(t),r.return=a,a.child=r,za=a,ba=null)):t=null,t===null)throw Nr(a);return Ju(t)?a.lanes=32:a.lanes=536870912,null}var S=i.children;return i=i.fallback,u?(Ar(),u=a.mode,S=bl({mode:"hidden",children:S},u),i=Jr(i,u,r,null),S.return=a,i.return=a,S.sibling=i,a.child=S,i=a.child,i.memoizedState=fu(r),i.childLanes=gu(t,y,r),a.memoizedState=xu,Ko(null,i)):(Tr(a),bu(a,S))}var H=t.memoizedState;if(H!==null&&(S=H.dehydrated,S!==null)){if(p)a.flags&256?(Tr(a),a.flags&=-257,a=vu(t,a,r)):a.memoizedState!==null?(Ar(),a.child=t.child,a.flags|=128,a=null):(Ar(),S=i.fallback,u=a.mode,i=bl({mode:"visible",children:i.children},u),S=Jr(S,u,r,null),S.flags|=2,i.return=a,S.return=a,i.sibling=S,a.child=i,on(a,t.child,null,r),i=a.child,i.memoizedState=fu(r),i.childLanes=gu(t,y,r),a.memoizedState=xu,a=Ko(null,i));else if(Tr(a),Ju(S)){if(y=S.nextSibling&&S.nextSibling.dataset,y)var pe=y.dgst;y=pe,i=Error(l(419)),i.stack="",i.digest=y,Oo({value:i,source:null,stack:null}),a=vu(t,a,r)}else if(Ea||In(t,a,r,!1),y=(r&t.childLanes)!==0,Ea||y){if(y=ha,y!==null&&(i=Zt(y,r),i!==0&&i!==H.retryLane))throw H.retryLane=i,Zr(t,i),Za(y,t,i),pu;Zu(S)||Al(),a=vu(t,a,r)}else Zu(S)?(a.flags|=192,a.child=t.child,a=null):(t=H.treeContext,ba=bs(S.nextSibling),za=a,Yt=!0,yr=null,fs=!1,t!==null&&qh(a,t),a=bu(a,i.children),a.flags|=4096);return a}return u?(Ar(),S=i.fallback,u=a.mode,H=t.child,pe=H.sibling,i=Ks(H,{mode:"hidden",children:i.children}),i.subtreeFlags=H.subtreeFlags&65011712,pe!==null?S=Ks(pe,S):(S=Jr(S,u,r,null),S.flags|=2),S.return=a,i.return=a,i.sibling=S,a.child=i,Ko(null,i),i=a.child,S=t.child.memoizedState,S===null?S=fu(r):(u=S.cachePool,u!==null?(H=Ca._currentValue,u=u.parent!==H?{parent:H,pool:H}:u):u=Hh(),S={baseLanes:S.baseLanes|r,cachePool:u}),i.memoizedState=S,i.childLanes=gu(t,y,r),a.memoizedState=xu,Ko(t.child,i)):(Tr(a),r=t.child,t=r.sibling,r=Ks(r,{mode:"visible",children:i.children}),r.return=a,r.sibling=null,t!==null&&(y=a.deletions,y===null?(a.deletions=[t],a.flags|=16):y.push(t)),a.child=r,a.memoizedState=null,r)}function bu(t,a){return a=bl({mode:"visible",children:a},t.mode),a.return=t,t.child=a}function bl(t,a){return t=ts(22,t,null,a),t.lanes=0,t}function vu(t,a,r){return on(a,t.child,null,r),t=bu(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function r0(t,a,r){t.lanes|=a;var i=t.alternate;i!==null&&(i.lanes|=a),Md(t.return,a,r)}function yu(t,a,r,i,u,p){var y=t.memoizedState;y===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:u,treeForkCount:p}:(y.isBackwards=a,y.rendering=null,y.renderingStartTime=0,y.last=i,y.tail=r,y.tailMode=u,y.treeForkCount=p)}function n0(t,a,r){var i=a.pendingProps,u=i.revealOrder,p=i.tail;i=i.children;var y=wa.current,S=(y&2)!==0;if(S?(y=y&1|2,a.flags|=128):y&=1,se(wa,y),Ua(t,a,i,r),i=Yt?Io:0,!S&&t!==null&&(t.flags&128)!==0)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&r0(t,r,a);else if(t.tag===19)r0(t,r,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(u){case"forwards":for(r=a.child,u=null;r!==null;)t=r.alternate,t!==null&&ol(t)===null&&(u=r),r=r.sibling;r=u,r===null?(u=a.child,a.child=null):(u=r.sibling,r.sibling=null),yu(a,!1,u,r,p,i);break;case"backwards":case"unstable_legacy-backwards":for(r=null,u=a.child,a.child=null;u!==null;){if(t=u.alternate,t!==null&&ol(t)===null){a.child=u;break}t=u.sibling,u.sibling=r,r=u,u=t}yu(a,!0,r,null,p,i);break;case"together":yu(a,!1,null,null,void 0,i);break;default:a.memoizedState=null}return a.child}function er(t,a,r){if(t!==null&&(a.dependencies=t.dependencies),Er|=a.lanes,(r&a.childLanes)===0)if(t!==null){if(In(t,a,r,!1),(r&a.childLanes)===0)return null}else return null;if(t!==null&&a.child!==t.child)throw Error(l(153));if(a.child!==null){for(t=a.child,r=Ks(t,t.pendingProps),a.child=r,r.return=a;t.sibling!==null;)t=t.sibling,r=r.sibling=Ks(t,t.pendingProps),r.return=a;r.sibling=null}return a.child}function Nu(t,a){return(t.lanes&a)!==0?!0:(t=t.dependencies,!!(t!==null&&Zi(t)))}function Gj(t,a,r){switch(a.tag){case 3:q(a,a.stateNode.containerInfo),jr(a,Ca,t.memoizedState.cache),en();break;case 27:case 5:be(a);break;case 4:q(a,a.stateNode.containerInfo);break;case 10:jr(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Gd(a),null;break;case 13:var i=a.memoizedState;if(i!==null)return i.dehydrated!==null?(Tr(a),a.flags|=128,null):(r&a.child.childLanes)!==0?s0(t,a,r):(Tr(a),t=er(t,a,r),t!==null?t.sibling:null);Tr(a);break;case 19:var u=(t.flags&128)!==0;if(i=(r&a.childLanes)!==0,i||(In(t,a,r,!1),i=(r&a.childLanes)!==0),u){if(i)return n0(t,a,r);a.flags|=128}if(u=a.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),se(wa,wa.current),i)break;return null;case 22:return a.lanes=0,Qx(t,a,r,a.pendingProps);case 24:jr(a,Ca,t.memoizedState.cache)}return er(t,a,r)}function o0(t,a,r){if(t!==null)if(t.memoizedProps!==a.pendingProps)Ea=!0;else{if(!Nu(t,r)&&(a.flags&128)===0)return Ea=!1,Gj(t,a,r);Ea=(t.flags&131072)!==0}else Ea=!1,Yt&&(a.flags&1048576)!==0&&zh(a,Io,a.index);switch(a.lanes=0,a.tag){case 16:e:{var i=a.pendingProps;if(t=rn(a.elementType),a.type=t,typeof t=="function")Td(t)?(i=cn(t,i),a.tag=1,a=t0(null,a,t,i,r)):(a.tag=0,a=hu(null,a,t,i,r));else{if(t!=null){var u=t.$$typeof;if(u===V){a.tag=11,a=Kx(null,a,t,i,r);break e}else if(u===O){a.tag=14,a=Yx(null,a,t,i,r);break e}}throw a=Ce(t)||t,Error(l(306,a,""))}}return a;case 0:return hu(t,a,a.type,a.pendingProps,r);case 1:return i=a.type,u=cn(i,a.pendingProps),t0(t,a,i,u,r);case 3:e:{if(q(a,a.stateNode.containerInfo),t===null)throw Error(l(387));i=a.pendingProps;var p=a.memoizedState;u=p.element,Bd(t,a),$o(a,i,null,r);var y=a.memoizedState;if(i=y.cache,jr(a,Ca,i),i!==p.cache&&Id(a,[Ca],r,!0),Vo(),i=y.element,p.isDehydrated)if(p={element:i,isDehydrated:!1,cache:y.cache},a.updateQueue.baseState=p,a.memoizedState=p,a.flags&256){a=a0(t,a,i,r);break e}else if(i!==u){u=ps(Error(l(424)),a),Oo(u),a=a0(t,a,i,r);break e}else{switch(t=a.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(ba=bs(t.firstChild),za=a,Yt=!0,yr=null,fs=!0,r=Qh(a,null,i,r),a.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(en(),i===u){a=er(t,a,r);break e}Ua(t,a,i,r)}a=a.child}return a;case 26:return gl(t,a),t===null?(r=bf(a.type,null,a.pendingProps,null))?a.memoizedState=r:Yt||(r=a.type,t=a.pendingProps,i=Ml(M.current).createElement(r),i[Je]=a,i[ot]=t,Ba(i,r,t),ht(i),a.stateNode=i):a.memoizedState=bf(a.type,t.memoizedProps,a.pendingProps,t.memoizedState),null;case 27:return be(a),t===null&&Yt&&(i=a.stateNode=xf(a.type,a.pendingProps,M.current),za=a,fs=!0,u=ba,Ir(a.type)?(em=u,ba=bs(i.firstChild)):ba=u),Ua(t,a,a.pendingProps.children,r),gl(t,a),t===null&&(a.flags|=4194304),a.child;case 5:return t===null&&Yt&&((u=i=ba)&&(i=j_(i,a.type,a.pendingProps,fs),i!==null?(a.stateNode=i,za=a,ba=bs(i.firstChild),fs=!1,u=!0):u=!1),u||Nr(a)),be(a),u=a.type,p=a.pendingProps,y=t!==null?t.memoizedProps:null,i=p.children,Yu(u,p)?i=null:y!==null&&Yu(u,y)&&(a.flags|=32),a.memoizedState!==null&&(u=Kd(t,a,Dj,null,null,r),ci._currentValue=u),gl(t,a),Ua(t,a,i,r),a.child;case 6:return t===null&&Yt&&((t=r=ba)&&(r=__(r,a.pendingProps,fs),r!==null?(a.stateNode=r,za=a,ba=null,t=!0):t=!1),t||Nr(a)),null;case 13:return s0(t,a,r);case 4:return q(a,a.stateNode.containerInfo),i=a.pendingProps,t===null?a.child=on(a,null,i,r):Ua(t,a,i,r),a.child;case 11:return Kx(t,a,a.type,a.pendingProps,r);case 7:return Ua(t,a,a.pendingProps,r),a.child;case 8:return Ua(t,a,a.pendingProps.children,r),a.child;case 12:return Ua(t,a,a.pendingProps.children,r),a.child;case 10:return i=a.pendingProps,jr(a,a.type,i.value),Ua(t,a,i.children,r),a.child;case 9:return u=a.type._context,i=a.pendingProps.children,an(a),u=qa(u),i=i(u),a.flags|=1,Ua(t,a,i,r),a.child;case 14:return Yx(t,a,a.type,a.pendingProps,r);case 15:return Xx(t,a,a.type,a.pendingProps,r);case 19:return n0(t,a,r);case 31:return Hj(t,a,r);case 22:return Qx(t,a,r,a.pendingProps);case 24:return an(a),i=qa(Ca),t===null?(u=zd(),u===null&&(u=ha,p=Od(),u.pooledCache=p,p.refCount++,p!==null&&(u.pooledCacheLanes|=r),u=p),a.memoizedState={parent:i,cache:u},Ud(a),jr(a,Ca,u)):((t.lanes&r)!==0&&(Bd(t,a),$o(a,null,null,r),Vo()),u=t.memoizedState,p=a.memoizedState,u.parent!==i?(u={parent:i,cache:i},a.memoizedState=u,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=u),jr(a,Ca,i)):(i=p.cache,jr(a,Ca,i),i!==u.cache&&Id(a,[Ca],r,!0))),Ua(t,a,a.pendingProps.children,r),a.child;case 29:throw a.pendingProps}throw Error(l(156,a.tag))}function tr(t){t.flags|=4}function ju(t,a,r,i,u){if((a=(t.mode&32)!==0)&&(a=!1),a){if(t.flags|=16777216,(u&335544128)===u)if(t.stateNode.complete)t.flags|=8192;else if(P0())t.flags|=8192;else throw nn=al,qd}else t.flags&=-16777217}function i0(t,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!_f(a))if(P0())t.flags|=8192;else throw nn=al,qd}function vl(t,a){a!==null&&(t.flags|=4),t.flags&16384&&(a=t.tag!==22?B():536870912,t.lanes|=a,Wn|=a)}function Yo(t,a){if(!Yt)switch(t.tailMode){case"hidden":a=t.tail;for(var r=null;a!==null;)a.alternate!==null&&(r=a),a=a.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function va(t){var a=t.alternate!==null&&t.alternate.child===t.child,r=0,i=0;if(a)for(var u=t.child;u!==null;)r|=u.lanes|u.childLanes,i|=u.subtreeFlags&65011712,i|=u.flags&65011712,u.return=t,u=u.sibling;else for(u=t.child;u!==null;)r|=u.lanes|u.childLanes,i|=u.subtreeFlags,i|=u.flags,u.return=t,u=u.sibling;return t.subtreeFlags|=i,t.childLanes=r,a}function Wj(t,a,r){var i=a.pendingProps;switch(Ed(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return va(a),null;case 1:return va(a),null;case 3:return r=a.stateNode,i=null,t!==null&&(i=t.memoizedState.cache),a.memoizedState.cache!==i&&(a.flags|=2048),Qs(Ca),G(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Mn(a)?tr(a):t===null||t.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Ld())),va(a),null;case 26:var u=a.type,p=a.memoizedState;return t===null?(tr(a),p!==null?(va(a),i0(a,p)):(va(a),ju(a,u,null,i,r))):p?p!==t.memoizedState?(tr(a),va(a),i0(a,p)):(va(a),a.flags&=-16777217):(t=t.memoizedProps,t!==i&&tr(a),va(a),ju(a,u,t,i,r)),null;case 27:if(Ne(a),r=M.current,u=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==i&&tr(a);else{if(!i){if(a.stateNode===null)throw Error(l(166));return va(a),null}t=k.current,Mn(a)?Uh(a):(t=xf(u,i,r),a.stateNode=t,tr(a))}return va(a),null;case 5:if(Ne(a),u=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==i&&tr(a);else{if(!i){if(a.stateNode===null)throw Error(l(166));return va(a),null}if(p=k.current,Mn(a))Uh(a);else{var y=Ml(M.current);switch(p){case 1:p=y.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:p=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":p=y.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":p=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":p=y.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof i.is=="string"?y.createElement("select",{is:i.is}):y.createElement("select"),i.multiple?p.multiple=!0:i.size&&(p.size=i.size);break;default:p=typeof i.is=="string"?y.createElement(u,{is:i.is}):y.createElement(u)}}p[Je]=a,p[ot]=i;e:for(y=a.child;y!==null;){if(y.tag===5||y.tag===6)p.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===a)break e;for(;y.sibling===null;){if(y.return===null||y.return===a)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}a.stateNode=p;e:switch(Ba(p,u,i),u){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&tr(a)}}return va(a),ju(a,a.type,t===null?null:t.memoizedProps,a.pendingProps,r),null;case 6:if(t&&a.stateNode!=null)t.memoizedProps!==i&&tr(a);else{if(typeof i!="string"&&a.stateNode===null)throw Error(l(166));if(t=M.current,Mn(a)){if(t=a.stateNode,r=a.memoizedProps,i=null,u=za,u!==null)switch(u.tag){case 27:case 5:i=u.memoizedProps}t[Je]=a,t=!!(t.nodeValue===r||i!==null&&i.suppressHydrationWarning===!0||sf(t.nodeValue,r)),t||Nr(a,!0)}else t=Ml(t).createTextNode(i),t[Je]=a,a.stateNode=t}return va(a),null;case 31:if(r=a.memoizedState,t===null||t.memoizedState!==null){if(i=Mn(a),r!==null){if(t===null){if(!i)throw Error(l(318));if(t=a.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(l(557));t[Je]=a}else en(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;va(a),t=!1}else r=Ld(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=r),t=!0;if(!t)return a.flags&256?(ss(a),a):(ss(a),null);if((a.flags&128)!==0)throw Error(l(558))}return va(a),null;case 13:if(i=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(u=Mn(a),i!==null&&i.dehydrated!==null){if(t===null){if(!u)throw Error(l(318));if(u=a.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(l(317));u[Je]=a}else en(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;va(a),u=!1}else u=Ld(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=u),u=!0;if(!u)return a.flags&256?(ss(a),a):(ss(a),null)}return ss(a),(a.flags&128)!==0?(a.lanes=r,a):(r=i!==null,t=t!==null&&t.memoizedState!==null,r&&(i=a.child,u=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(u=i.alternate.memoizedState.cachePool.pool),p=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(p=i.memoizedState.cachePool.pool),p!==u&&(i.flags|=2048)),r!==t&&r&&(a.child.flags|=8192),vl(a,a.updateQueue),va(a),null);case 4:return G(),t===null&&Fu(a.stateNode.containerInfo),va(a),null;case 10:return Qs(a.type),va(a),null;case 19:if($(wa),i=a.memoizedState,i===null)return va(a),null;if(u=(a.flags&128)!==0,p=i.rendering,p===null)if(u)Yo(i,!1);else{if(_a!==0||t!==null&&(t.flags&128)!==0)for(t=a.child;t!==null;){if(p=ol(t),p!==null){for(a.flags|=128,Yo(i,!1),t=p.updateQueue,a.updateQueue=t,vl(a,t),a.subtreeFlags=0,t=r,r=a.child;r!==null;)Ih(r,t),r=r.sibling;return se(wa,wa.current&1|2),Yt&&Ys(a,i.treeForkCount),a.child}t=t.sibling}i.tail!==null&&Se()>Sl&&(a.flags|=128,u=!0,Yo(i,!1),a.lanes=4194304)}else{if(!u)if(t=ol(p),t!==null){if(a.flags|=128,u=!0,t=t.updateQueue,a.updateQueue=t,vl(a,t),Yo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!p.alternate&&!Yt)return va(a),null}else 2*Se()-i.renderingStartTime>Sl&&r!==536870912&&(a.flags|=128,u=!0,Yo(i,!1),a.lanes=4194304);i.isBackwards?(p.sibling=a.child,a.child=p):(t=i.last,t!==null?t.sibling=p:a.child=p,i.last=p)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Se(),t.sibling=null,r=wa.current,se(wa,u?r&1|2:r&1),Yt&&Ys(a,i.treeForkCount),t):(va(a),null);case 22:case 23:return ss(a),Hd(),i=a.memoizedState!==null,t!==null?t.memoizedState!==null!==i&&(a.flags|=8192):i&&(a.flags|=8192),i?(r&536870912)!==0&&(a.flags&128)===0&&(va(a),a.subtreeFlags&6&&(a.flags|=8192)):va(a),r=a.updateQueue,r!==null&&vl(a,r.retryQueue),r=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==r&&(a.flags|=2048),t!==null&&$(sn),null;case 24:return r=null,t!==null&&(r=t.memoizedState.cache),a.memoizedState.cache!==r&&(a.flags|=2048),Qs(Ca),va(a),null;case 25:return null;case 30:return null}throw Error(l(156,a.tag))}function Kj(t,a){switch(Ed(a),a.tag){case 1:return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return Qs(Ca),G(),t=a.flags,(t&65536)!==0&&(t&128)===0?(a.flags=t&-65537|128,a):null;case 26:case 27:case 5:return Ne(a),null;case 31:if(a.memoizedState!==null){if(ss(a),a.alternate===null)throw Error(l(340));en()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 13:if(ss(a),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(l(340));en()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return $(wa),null;case 4:return G(),null;case 10:return Qs(a.type),null;case 22:case 23:return ss(a),Hd(),t!==null&&$(sn),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 24:return Qs(Ca),null;case 25:return null;default:return null}}function l0(t,a){switch(Ed(a),a.tag){case 3:Qs(Ca),G();break;case 26:case 27:case 5:Ne(a);break;case 4:G();break;case 31:a.memoizedState!==null&&ss(a);break;case 13:ss(a);break;case 19:$(wa);break;case 10:Qs(a.type);break;case 22:case 23:ss(a),Hd(),t!==null&&$(sn);break;case 24:Qs(Ca)}}function Xo(t,a){try{var r=a.updateQueue,i=r!==null?r.lastEffect:null;if(i!==null){var u=i.next;r=u;do{if((r.tag&t)===t){i=void 0;var p=r.create,y=r.inst;i=p(),y.destroy=i}r=r.next}while(r!==u)}}catch(S){ca(a,a.return,S)}}function Cr(t,a,r){try{var i=a.updateQueue,u=i!==null?i.lastEffect:null;if(u!==null){var p=u.next;i=p;do{if((i.tag&t)===t){var y=i.inst,S=y.destroy;if(S!==void 0){y.destroy=void 0,u=a;var H=r,pe=S;try{pe()}catch(Ae){ca(u,H,Ae)}}}i=i.next}while(i!==p)}}catch(Ae){ca(a,a.return,Ae)}}function c0(t){var a=t.updateQueue;if(a!==null){var r=t.stateNode;try{Jh(a,r)}catch(i){ca(t,t.return,i)}}}function d0(t,a,r){r.props=cn(t.type,t.memoizedProps),r.state=t.memoizedState;try{r.componentWillUnmount()}catch(i){ca(t,a,i)}}function Qo(t,a){try{var r=t.ref;if(r!==null){switch(t.tag){case 26:case 27:case 5:var i=t.stateNode;break;case 30:i=t.stateNode;break;default:i=t.stateNode}typeof r=="function"?t.refCleanup=r(i):r.current=i}}catch(u){ca(t,a,u)}}function Ms(t,a){var r=t.ref,i=t.refCleanup;if(r!==null)if(typeof i=="function")try{i()}catch(u){ca(t,a,u)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(u){ca(t,a,u)}else r.current=null}function u0(t){var a=t.type,r=t.memoizedProps,i=t.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":r.autoFocus&&i.focus();break e;case"img":r.src?i.src=r.src:r.srcSet&&(i.srcset=r.srcSet)}}catch(u){ca(t,t.return,u)}}function _u(t,a,r){try{var i=t.stateNode;f_(i,t.type,r,a),i[ot]=a}catch(u){ca(t,t.return,u)}}function m0(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Ir(t.type)||t.tag===4}function Su(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||m0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Ir(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function wu(t,a,r){var i=t.tag;if(i===5||i===6)t=t.stateNode,a?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(t,a):(a=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,a.appendChild(t),r=r._reactRootContainer,r!=null||a.onclick!==null||(a.onclick=Gs));else if(i!==4&&(i===27&&Ir(t.type)&&(r=t.stateNode,a=null),t=t.child,t!==null))for(wu(t,a,r),t=t.sibling;t!==null;)wu(t,a,r),t=t.sibling}function yl(t,a,r){var i=t.tag;if(i===5||i===6)t=t.stateNode,a?r.insertBefore(t,a):r.appendChild(t);else if(i!==4&&(i===27&&Ir(t.type)&&(r=t.stateNode),t=t.child,t!==null))for(yl(t,a,r),t=t.sibling;t!==null;)yl(t,a,r),t=t.sibling}function p0(t){var a=t.stateNode,r=t.memoizedProps;try{for(var i=t.type,u=a.attributes;u.length;)a.removeAttributeNode(u[0]);Ba(a,i,r),a[Je]=t,a[ot]=r}catch(p){ca(t,t.return,p)}}var ar=!1,Ra=!1,Tu=!1,h0=typeof WeakSet=="function"?WeakSet:Set,Oa=null;function Yj(t,a){if(t=t.containerInfo,Wu=Bl,t=Th(t),vd(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var u=i.anchorOffset,p=i.focusNode;i=i.focusOffset;try{r.nodeType,p.nodeType}catch{r=null;break e}var y=0,S=-1,H=-1,pe=0,Ae=0,Pe=t,he=null;t:for(;;){for(var ye;Pe!==r||u!==0&&Pe.nodeType!==3||(S=y+u),Pe!==p||i!==0&&Pe.nodeType!==3||(H=y+i),Pe.nodeType===3&&(y+=Pe.nodeValue.length),(ye=Pe.firstChild)!==null;)he=Pe,Pe=ye;for(;;){if(Pe===t)break t;if(he===r&&++pe===u&&(S=y),he===p&&++Ae===i&&(H=y),(ye=Pe.nextSibling)!==null)break;Pe=he,he=Pe.parentNode}Pe=ye}r=S===-1||H===-1?null:{start:S,end:H}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ku={focusedElem:t,selectionRange:r},Bl=!1,Oa=a;Oa!==null;)if(a=Oa,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,Oa=t;else for(;Oa!==null;){switch(a=Oa,p=a.alternate,t=a.flags,a.tag){case 0:if((t&4)!==0&&(t=a.updateQueue,t=t!==null?t.events:null,t!==null))for(r=0;r<t.length;r++)u=t[r],u.ref.impl=u.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&p!==null){t=void 0,r=a,u=p.memoizedProps,p=p.memoizedState,i=r.stateNode;try{var bt=cn(r.type,u);t=i.getSnapshotBeforeUpdate(bt,p),i.__reactInternalSnapshotBeforeUpdate=t}catch(Pt){ca(r,r.return,Pt)}}break;case 3:if((t&1024)!==0){if(t=a.stateNode.containerInfo,r=t.nodeType,r===9)Qu(t);else if(r===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Qu(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(l(163))}if(t=a.sibling,t!==null){t.return=a.return,Oa=t;break}Oa=a.return}}function x0(t,a,r){var i=r.flags;switch(r.tag){case 0:case 11:case 15:rr(t,r),i&4&&Xo(5,r);break;case 1:if(rr(t,r),i&4)if(t=r.stateNode,a===null)try{t.componentDidMount()}catch(y){ca(r,r.return,y)}else{var u=cn(r.type,a.memoizedProps);a=a.memoizedState;try{t.componentDidUpdate(u,a,t.__reactInternalSnapshotBeforeUpdate)}catch(y){ca(r,r.return,y)}}i&64&&c0(r),i&512&&Qo(r,r.return);break;case 3:if(rr(t,r),i&64&&(t=r.updateQueue,t!==null)){if(a=null,r.child!==null)switch(r.child.tag){case 27:case 5:a=r.child.stateNode;break;case 1:a=r.child.stateNode}try{Jh(t,a)}catch(y){ca(r,r.return,y)}}break;case 27:a===null&&i&4&&p0(r);case 26:case 5:rr(t,r),a===null&&i&4&&u0(r),i&512&&Qo(r,r.return);break;case 12:rr(t,r);break;case 31:rr(t,r),i&4&&b0(t,r);break;case 13:rr(t,r),i&4&&v0(t,r),i&64&&(t=r.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(r=r_.bind(null,r),S_(t,r))));break;case 22:if(i=r.memoizedState!==null||ar,!i){a=a!==null&&a.memoizedState!==null||Ra,u=ar;var p=Ra;ar=i,(Ra=a)&&!p?nr(t,r,(r.subtreeFlags&8772)!==0):rr(t,r),ar=u,Ra=p}break;case 30:break;default:rr(t,r)}}function f0(t){var a=t.alternate;a!==null&&(t.alternate=null,f0(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&mt(a)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var ya=null,Ka=!1;function sr(t,a,r){for(r=r.child;r!==null;)g0(t,a,r),r=r.sibling}function g0(t,a,r){if(re&&typeof re.onCommitFiberUnmount=="function")try{re.onCommitFiberUnmount(L,r)}catch{}switch(r.tag){case 26:Ra||Ms(r,a),sr(t,a,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:Ra||Ms(r,a);var i=ya,u=Ka;Ir(r.type)&&(ya=r.stateNode,Ka=!1),sr(t,a,r),oi(r.stateNode),ya=i,Ka=u;break;case 5:Ra||Ms(r,a);case 6:if(i=ya,u=Ka,ya=null,sr(t,a,r),ya=i,Ka=u,ya!==null)if(Ka)try{(ya.nodeType===9?ya.body:ya.nodeName==="HTML"?ya.ownerDocument.body:ya).removeChild(r.stateNode)}catch(p){ca(r,a,p)}else try{ya.removeChild(r.stateNode)}catch(p){ca(r,a,p)}break;case 18:ya!==null&&(Ka?(t=ya,df(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,r.stateNode),to(t)):df(ya,r.stateNode));break;case 4:i=ya,u=Ka,ya=r.stateNode.containerInfo,Ka=!0,sr(t,a,r),ya=i,Ka=u;break;case 0:case 11:case 14:case 15:Cr(2,r,a),Ra||Cr(4,r,a),sr(t,a,r);break;case 1:Ra||(Ms(r,a),i=r.stateNode,typeof i.componentWillUnmount=="function"&&d0(r,a,i)),sr(t,a,r);break;case 21:sr(t,a,r);break;case 22:Ra=(i=Ra)||r.memoizedState!==null,sr(t,a,r),Ra=i;break;default:sr(t,a,r)}}function b0(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{to(t)}catch(r){ca(a,a.return,r)}}}function v0(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{to(t)}catch(r){ca(a,a.return,r)}}function Xj(t){switch(t.tag){case 31:case 13:case 19:var a=t.stateNode;return a===null&&(a=t.stateNode=new h0),a;case 22:return t=t.stateNode,a=t._retryCache,a===null&&(a=t._retryCache=new h0),a;default:throw Error(l(435,t.tag))}}function Nl(t,a){var r=Xj(t);a.forEach(function(i){if(!r.has(i)){r.add(i);var u=n_.bind(null,t,i);i.then(u,u)}})}function Ya(t,a){var r=a.deletions;if(r!==null)for(var i=0;i<r.length;i++){var u=r[i],p=t,y=a,S=y;e:for(;S!==null;){switch(S.tag){case 27:if(Ir(S.type)){ya=S.stateNode,Ka=!1;break e}break;case 5:ya=S.stateNode,Ka=!1;break e;case 3:case 4:ya=S.stateNode.containerInfo,Ka=!0;break e}S=S.return}if(ya===null)throw Error(l(160));g0(p,y,u),ya=null,Ka=!1,p=u.alternate,p!==null&&(p.return=null),u.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)y0(a,t),a=a.sibling}var Ss=null;function y0(t,a){var r=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Ya(a,t),Xa(t),i&4&&(Cr(3,t,t.return),Xo(3,t),Cr(5,t,t.return));break;case 1:Ya(a,t),Xa(t),i&512&&(Ra||r===null||Ms(r,r.return)),i&64&&ar&&(t=t.updateQueue,t!==null&&(i=t.callbacks,i!==null&&(r=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=r===null?i:r.concat(i))));break;case 26:var u=Ss;if(Ya(a,t),Xa(t),i&512&&(Ra||r===null||Ms(r,r.return)),i&4){var p=r!==null?r.memoizedState:null;if(i=t.memoizedState,r===null)if(i===null)if(t.stateNode===null){e:{i=t.type,r=t.memoizedProps,u=u.ownerDocument||u;t:switch(i){case"title":p=u.getElementsByTagName("title")[0],(!p||p[He]||p[Je]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=u.createElement(i),u.head.insertBefore(p,u.querySelector("head > title"))),Ba(p,i,r),p[Je]=t,ht(p),i=p;break e;case"link":var y=Nf("link","href",u).get(i+(r.href||""));if(y){for(var S=0;S<y.length;S++)if(p=y[S],p.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&p.getAttribute("rel")===(r.rel==null?null:r.rel)&&p.getAttribute("title")===(r.title==null?null:r.title)&&p.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){y.splice(S,1);break t}}p=u.createElement(i),Ba(p,i,r),u.head.appendChild(p);break;case"meta":if(y=Nf("meta","content",u).get(i+(r.content||""))){for(S=0;S<y.length;S++)if(p=y[S],p.getAttribute("content")===(r.content==null?null:""+r.content)&&p.getAttribute("name")===(r.name==null?null:r.name)&&p.getAttribute("property")===(r.property==null?null:r.property)&&p.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&p.getAttribute("charset")===(r.charSet==null?null:r.charSet)){y.splice(S,1);break t}}p=u.createElement(i),Ba(p,i,r),u.head.appendChild(p);break;default:throw Error(l(468,i))}p[Je]=t,ht(p),i=p}t.stateNode=i}else jf(u,t.type,t.stateNode);else t.stateNode=yf(u,i,t.memoizedProps);else p!==i?(p===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):p.count--,i===null?jf(u,t.type,t.stateNode):yf(u,i,t.memoizedProps)):i===null&&t.stateNode!==null&&_u(t,t.memoizedProps,r.memoizedProps)}break;case 27:Ya(a,t),Xa(t),i&512&&(Ra||r===null||Ms(r,r.return)),r!==null&&i&4&&_u(t,t.memoizedProps,r.memoizedProps);break;case 5:if(Ya(a,t),Xa(t),i&512&&(Ra||r===null||Ms(r,r.return)),t.flags&32){u=t.stateNode;try{Sn(u,"")}catch(bt){ca(t,t.return,bt)}}i&4&&t.stateNode!=null&&(u=t.memoizedProps,_u(t,u,r!==null?r.memoizedProps:u)),i&1024&&(Tu=!0);break;case 6:if(Ya(a,t),Xa(t),i&4){if(t.stateNode===null)throw Error(l(162));i=t.memoizedProps,r=t.stateNode;try{r.nodeValue=i}catch(bt){ca(t,t.return,bt)}}break;case 3:if(Dl=null,u=Ss,Ss=Il(a.containerInfo),Ya(a,t),Ss=u,Xa(t),i&4&&r!==null&&r.memoizedState.isDehydrated)try{to(a.containerInfo)}catch(bt){ca(t,t.return,bt)}Tu&&(Tu=!1,N0(t));break;case 4:i=Ss,Ss=Il(t.stateNode.containerInfo),Ya(a,t),Xa(t),Ss=i;break;case 12:Ya(a,t),Xa(t);break;case 31:Ya(a,t),Xa(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,Nl(t,i)));break;case 13:Ya(a,t),Xa(t),t.child.flags&8192&&t.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(_l=Se()),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,Nl(t,i)));break;case 22:u=t.memoizedState!==null;var H=r!==null&&r.memoizedState!==null,pe=ar,Ae=Ra;if(ar=pe||u,Ra=Ae||H,Ya(a,t),Ra=Ae,ar=pe,Xa(t),i&8192)e:for(a=t.stateNode,a._visibility=u?a._visibility&-2:a._visibility|1,u&&(r===null||H||ar||Ra||dn(t)),r=null,a=t;;){if(a.tag===5||a.tag===26){if(r===null){H=r=a;try{if(p=H.stateNode,u)y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{S=H.stateNode;var Pe=H.memoizedProps.style,he=Pe!=null&&Pe.hasOwnProperty("display")?Pe.display:null;S.style.display=he==null||typeof he=="boolean"?"":(""+he).trim()}}catch(bt){ca(H,H.return,bt)}}}else if(a.tag===6){if(r===null){H=a;try{H.stateNode.nodeValue=u?"":H.memoizedProps}catch(bt){ca(H,H.return,bt)}}}else if(a.tag===18){if(r===null){H=a;try{var ye=H.stateNode;u?uf(ye,!0):uf(H.stateNode,!1)}catch(bt){ca(H,H.return,bt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;a.sibling===null;){if(a.return===null||a.return===t)break e;r===a&&(r=null),a=a.return}r===a&&(r=null),a.sibling.return=a.return,a=a.sibling}i&4&&(i=t.updateQueue,i!==null&&(r=i.retryQueue,r!==null&&(i.retryQueue=null,Nl(t,r))));break;case 19:Ya(a,t),Xa(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,Nl(t,i)));break;case 30:break;case 21:break;default:Ya(a,t),Xa(t)}}function Xa(t){var a=t.flags;if(a&2){try{for(var r,i=t.return;i!==null;){if(m0(i)){r=i;break}i=i.return}if(r==null)throw Error(l(160));switch(r.tag){case 27:var u=r.stateNode,p=Su(t);yl(t,p,u);break;case 5:var y=r.stateNode;r.flags&32&&(Sn(y,""),r.flags&=-33);var S=Su(t);yl(t,S,y);break;case 3:case 4:var H=r.stateNode.containerInfo,pe=Su(t);wu(t,pe,H);break;default:throw Error(l(161))}}catch(Ae){ca(t,t.return,Ae)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function N0(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var a=t;N0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),t=t.sibling}}function rr(t,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)x0(t,a.alternate,a),a=a.sibling}function dn(t){for(t=t.child;t!==null;){var a=t;switch(a.tag){case 0:case 11:case 14:case 15:Cr(4,a,a.return),dn(a);break;case 1:Ms(a,a.return);var r=a.stateNode;typeof r.componentWillUnmount=="function"&&d0(a,a.return,r),dn(a);break;case 27:oi(a.stateNode);case 26:case 5:Ms(a,a.return),dn(a);break;case 22:a.memoizedState===null&&dn(a);break;case 30:dn(a);break;default:dn(a)}t=t.sibling}}function nr(t,a,r){for(r=r&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var i=a.alternate,u=t,p=a,y=p.flags;switch(p.tag){case 0:case 11:case 15:nr(u,p,r),Xo(4,p);break;case 1:if(nr(u,p,r),i=p,u=i.stateNode,typeof u.componentDidMount=="function")try{u.componentDidMount()}catch(pe){ca(i,i.return,pe)}if(i=p,u=i.updateQueue,u!==null){var S=i.stateNode;try{var H=u.shared.hiddenCallbacks;if(H!==null)for(u.shared.hiddenCallbacks=null,u=0;u<H.length;u++)Zh(H[u],S)}catch(pe){ca(i,i.return,pe)}}r&&y&64&&c0(p),Qo(p,p.return);break;case 27:p0(p);case 26:case 5:nr(u,p,r),r&&i===null&&y&4&&u0(p),Qo(p,p.return);break;case 12:nr(u,p,r);break;case 31:nr(u,p,r),r&&y&4&&b0(u,p);break;case 13:nr(u,p,r),r&&y&4&&v0(u,p);break;case 22:p.memoizedState===null&&nr(u,p,r),Qo(p,p.return);break;case 30:break;default:nr(u,p,r)}a=a.sibling}}function Au(t,a){var r=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),t=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(t=a.memoizedState.cachePool.pool),t!==r&&(t!=null&&t.refCount++,r!=null&&Do(r))}function Cu(t,a){t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&Do(t))}function ws(t,a,r,i){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)j0(t,a,r,i),a=a.sibling}function j0(t,a,r,i){var u=a.flags;switch(a.tag){case 0:case 11:case 15:ws(t,a,r,i),u&2048&&Xo(9,a);break;case 1:ws(t,a,r,i);break;case 3:ws(t,a,r,i),u&2048&&(t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&Do(t)));break;case 12:if(u&2048){ws(t,a,r,i),t=a.stateNode;try{var p=a.memoizedProps,y=p.id,S=p.onPostCommit;typeof S=="function"&&S(y,a.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(H){ca(a,a.return,H)}}else ws(t,a,r,i);break;case 31:ws(t,a,r,i);break;case 13:ws(t,a,r,i);break;case 23:break;case 22:p=a.stateNode,y=a.alternate,a.memoizedState!==null?p._visibility&2?ws(t,a,r,i):Zo(t,a):p._visibility&2?ws(t,a,r,i):(p._visibility|=2,Fn(t,a,r,i,(a.subtreeFlags&10256)!==0||!1)),u&2048&&Au(y,a);break;case 24:ws(t,a,r,i),u&2048&&Cu(a.alternate,a);break;default:ws(t,a,r,i)}}function Fn(t,a,r,i,u){for(u=u&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var p=t,y=a,S=r,H=i,pe=y.flags;switch(y.tag){case 0:case 11:case 15:Fn(p,y,S,H,u),Xo(8,y);break;case 23:break;case 22:var Ae=y.stateNode;y.memoizedState!==null?Ae._visibility&2?Fn(p,y,S,H,u):Zo(p,y):(Ae._visibility|=2,Fn(p,y,S,H,u)),u&&pe&2048&&Au(y.alternate,y);break;case 24:Fn(p,y,S,H,u),u&&pe&2048&&Cu(y.alternate,y);break;default:Fn(p,y,S,H,u)}a=a.sibling}}function Zo(t,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var r=t,i=a,u=i.flags;switch(i.tag){case 22:Zo(r,i),u&2048&&Au(i.alternate,i);break;case 24:Zo(r,i),u&2048&&Cu(i.alternate,i);break;default:Zo(r,i)}a=a.sibling}}var Jo=8192;function Hn(t,a,r){if(t.subtreeFlags&Jo)for(t=t.child;t!==null;)_0(t,a,r),t=t.sibling}function _0(t,a,r){switch(t.tag){case 26:Hn(t,a,r),t.flags&Jo&&t.memoizedState!==null&&O_(r,Ss,t.memoizedState,t.memoizedProps);break;case 5:Hn(t,a,r);break;case 3:case 4:var i=Ss;Ss=Il(t.stateNode.containerInfo),Hn(t,a,r),Ss=i;break;case 22:t.memoizedState===null&&(i=t.alternate,i!==null&&i.memoizedState!==null?(i=Jo,Jo=16777216,Hn(t,a,r),Jo=i):Hn(t,a,r));break;default:Hn(t,a,r)}}function S0(t){var a=t.alternate;if(a!==null&&(t=a.child,t!==null)){a.child=null;do a=t.sibling,t.sibling=null,t=a;while(t!==null)}}function ei(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var r=0;r<a.length;r++){var i=a[r];Oa=i,T0(i,t)}S0(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)w0(t),t=t.sibling}function w0(t){switch(t.tag){case 0:case 11:case 15:ei(t),t.flags&2048&&Cr(9,t,t.return);break;case 3:ei(t);break;case 12:ei(t);break;case 22:var a=t.stateNode;t.memoizedState!==null&&a._visibility&2&&(t.return===null||t.return.tag!==13)?(a._visibility&=-3,jl(t)):ei(t);break;default:ei(t)}}function jl(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var r=0;r<a.length;r++){var i=a[r];Oa=i,T0(i,t)}S0(t)}for(t=t.child;t!==null;){switch(a=t,a.tag){case 0:case 11:case 15:Cr(8,a,a.return),jl(a);break;case 22:r=a.stateNode,r._visibility&2&&(r._visibility&=-3,jl(a));break;default:jl(a)}t=t.sibling}}function T0(t,a){for(;Oa!==null;){var r=Oa;switch(r.tag){case 0:case 11:case 15:Cr(8,r,a);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var i=r.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:Do(r.memoizedState.cache)}if(i=r.child,i!==null)i.return=r,Oa=i;else e:for(r=t;Oa!==null;){i=Oa;var u=i.sibling,p=i.return;if(f0(i),i===r){Oa=null;break e}if(u!==null){u.return=p,Oa=u;break e}Oa=p}}}var Qj={getCacheForType:function(t){var a=qa(Ca),r=a.data.get(t);return r===void 0&&(r=t(),a.data.set(t,r)),r},cacheSignal:function(){return qa(Ca).controller.signal}},Zj=typeof WeakMap=="function"?WeakMap:Map,aa=0,ha=null,Ft=null,Gt=0,la=0,rs=null,kr=!1,Gn=!1,ku=!1,or=0,_a=0,Er=0,un=0,Eu=0,ns=0,Wn=0,ti=null,Qa=null,Ru=!1,_l=0,A0=0,Sl=1/0,wl=null,Rr=null,Ma=0,Lr=null,Kn=null,ir=0,Lu=0,Pu=null,C0=null,ai=0,Mu=null;function os(){return(aa&2)!==0&&Gt!==0?Gt&-Gt:I.T!==null?Uu():lt()}function k0(){if(ns===0)if((Gt&536870912)===0||Yt){var t=Ye;Ye<<=1,(Ye&3932160)===0&&(Ye=262144),ns=t}else ns=536870912;return t=as.current,t!==null&&(t.flags|=32),ns}function Za(t,a,r){(t===ha&&(la===2||la===9)||t.cancelPendingCommit!==null)&&(Yn(t,0),Pr(t,Gt,ns,!1)),Dt(t,r),((aa&2)===0||t!==ha)&&(t===ha&&((aa&2)===0&&(un|=r),_a===4&&Pr(t,Gt,ns,!1)),Is(t))}function E0(t,a,r){if((aa&6)!==0)throw Error(l(327));var i=!r&&(a&127)===0&&(a&t.expiredLanes)===0||gt(t,a),u=i?t_(t,a):Ou(t,a,!0),p=i;do{if(u===0){Gn&&!i&&Pr(t,a,0,!1);break}else{if(r=t.current.alternate,p&&!Jj(r)){u=Ou(t,a,!1),p=!1;continue}if(u===2){if(p=a,t.errorRecoveryDisabledLanes&p)var y=0;else y=t.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){a=y;e:{var S=t;u=ti;var H=S.current.memoizedState.isDehydrated;if(H&&(Yn(S,y).flags|=256),y=Ou(S,y,!1),y!==2){if(ku&&!H){S.errorRecoveryDisabledLanes|=p,un|=p,u=4;break e}p=Qa,Qa=u,p!==null&&(Qa===null?Qa=p:Qa.push.apply(Qa,p))}u=y}if(p=!1,u!==2)continue}}if(u===1){Yn(t,0),Pr(t,a,0,!0);break}e:{switch(i=t,p=u,p){case 0:case 1:throw Error(l(345));case 4:if((a&4194048)!==a)break;case 6:Pr(i,a,ns,!kr);break e;case 2:Qa=null;break;case 3:case 5:break;default:throw Error(l(329))}if((a&62914560)===a&&(u=_l+300-Se(),10<u)){if(Pr(i,a,ns,!kr),ve(i,0,!0)!==0)break e;ir=a,i.timeoutHandle=lf(R0.bind(null,i,r,Qa,wl,Ru,a,ns,un,Wn,kr,p,"Throttled",-0,0),u);break e}R0(i,r,Qa,wl,Ru,a,ns,un,Wn,kr,p,null,-0,0)}}break}while(!0);Is(t)}function R0(t,a,r,i,u,p,y,S,H,pe,Ae,Pe,he,ye){if(t.timeoutHandle=-1,Pe=a.subtreeFlags,Pe&8192||(Pe&16785408)===16785408){Pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gs},_0(a,p,Pe);var bt=(p&62914560)===p?_l-Se():(p&4194048)===p?A0-Se():0;if(bt=D_(Pe,bt),bt!==null){ir=p,t.cancelPendingCommit=bt(q0.bind(null,t,a,p,r,i,u,y,S,H,Ae,Pe,null,he,ye)),Pr(t,p,y,!pe);return}}q0(t,a,p,r,i,u,y,S,H)}function Jj(t){for(var a=t;;){var r=a.tag;if((r===0||r===11||r===15)&&a.flags&16384&&(r=a.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var i=0;i<r.length;i++){var u=r[i],p=u.getSnapshot;u=u.value;try{if(!es(p(),u))return!1}catch{return!1}}if(r=a.child,a.subtreeFlags&16384&&r!==null)r.return=a,a=r;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Pr(t,a,r,i){a&=~Eu,a&=~un,t.suspendedLanes|=a,t.pingedLanes&=~a,i&&(t.warmLanes|=a),i=t.expirationTimes;for(var u=a;0<u;){var p=31-ce(u),y=1<<p;i[p]=-1,u&=~y}r!==0&&fe(t,r,a)}function Tl(){return(aa&6)===0?(si(0),!1):!0}function Iu(){if(Ft!==null){if(la===0)var t=Ft.return;else t=Ft,Xs=tn=null,Qd(t),qn=null,qo=0,t=Ft;for(;t!==null;)l0(t.alternate,t),t=t.return;Ft=null}}function Yn(t,a){var r=t.timeoutHandle;r!==-1&&(t.timeoutHandle=-1,v_(r)),r=t.cancelPendingCommit,r!==null&&(t.cancelPendingCommit=null,r()),ir=0,Iu(),ha=t,Ft=r=Ks(t.current,null),Gt=a,la=0,rs=null,kr=!1,Gn=gt(t,a),ku=!1,Wn=ns=Eu=un=Er=_a=0,Qa=ti=null,Ru=!1,(a&8)!==0&&(a|=a&32);var i=t.entangledLanes;if(i!==0)for(t=t.entanglements,i&=a;0<i;){var u=31-ce(i),p=1<<u;a|=t[u],i&=~p}return or=a,Wi(),r}function L0(t,a){Ut=null,I.H=Wo,a===zn||a===tl?(a=Kh(),la=3):a===qd?(a=Kh(),la=4):la=a===pu?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,rs=a,Ft===null&&(_a=1,xl(t,ps(a,t.current)))}function P0(){var t=as.current;return t===null?!0:(Gt&4194048)===Gt?gs===null:(Gt&62914560)===Gt||(Gt&536870912)!==0?t===gs:!1}function M0(){var t=I.H;return I.H=Wo,t===null?Wo:t}function I0(){var t=I.A;return I.A=Qj,t}function Al(){_a=4,kr||(Gt&4194048)!==Gt&&as.current!==null||(Gn=!0),(Er&134217727)===0&&(un&134217727)===0||ha===null||Pr(ha,Gt,ns,!1)}function Ou(t,a,r){var i=aa;aa|=2;var u=M0(),p=I0();(ha!==t||Gt!==a)&&(wl=null,Yn(t,a)),a=!1;var y=_a;e:do try{if(la!==0&&Ft!==null){var S=Ft,H=rs;switch(la){case 8:Iu(),y=6;break e;case 3:case 2:case 9:case 6:as.current===null&&(a=!0);var pe=la;if(la=0,rs=null,Xn(t,S,H,pe),r&&Gn){y=0;break e}break;default:pe=la,la=0,rs=null,Xn(t,S,H,pe)}}e_(),y=_a;break}catch(Ae){L0(t,Ae)}while(!0);return a&&t.shellSuspendCounter++,Xs=tn=null,aa=i,I.H=u,I.A=p,Ft===null&&(ha=null,Gt=0,Wi()),y}function e_(){for(;Ft!==null;)O0(Ft)}function t_(t,a){var r=aa;aa|=2;var i=M0(),u=I0();ha!==t||Gt!==a?(wl=null,Sl=Se()+500,Yn(t,a)):Gn=gt(t,a);e:do try{if(la!==0&&Ft!==null){a=Ft;var p=rs;t:switch(la){case 1:la=0,rs=null,Xn(t,a,p,1);break;case 2:case 9:if(Gh(p)){la=0,rs=null,D0(a);break}a=function(){la!==2&&la!==9||ha!==t||(la=7),Is(t)},p.then(a,a);break e;case 3:la=7;break e;case 4:la=5;break e;case 7:Gh(p)?(la=0,rs=null,D0(a)):(la=0,rs=null,Xn(t,a,p,7));break;case 5:var y=null;switch(Ft.tag){case 26:y=Ft.memoizedState;case 5:case 27:var S=Ft;if(y?_f(y):S.stateNode.complete){la=0,rs=null;var H=S.sibling;if(H!==null)Ft=H;else{var pe=S.return;pe!==null?(Ft=pe,Cl(pe)):Ft=null}break t}}la=0,rs=null,Xn(t,a,p,5);break;case 6:la=0,rs=null,Xn(t,a,p,6);break;case 8:Iu(),_a=6;break e;default:throw Error(l(462))}}a_();break}catch(Ae){L0(t,Ae)}while(!0);return Xs=tn=null,I.H=i,I.A=u,aa=r,Ft!==null?0:(ha=null,Gt=0,Wi(),_a)}function a_(){for(;Ft!==null&&!Ge();)O0(Ft)}function O0(t){var a=o0(t.alternate,t,or);t.memoizedProps=t.pendingProps,a===null?Cl(t):Ft=a}function D0(t){var a=t,r=a.alternate;switch(a.tag){case 15:case 0:a=e0(r,a,a.pendingProps,a.type,void 0,Gt);break;case 11:a=e0(r,a,a.pendingProps,a.type.render,a.ref,Gt);break;case 5:Qd(a);default:l0(r,a),a=Ft=Ih(a,or),a=o0(r,a,or)}t.memoizedProps=t.pendingProps,a===null?Cl(t):Ft=a}function Xn(t,a,r,i){Xs=tn=null,Qd(a),qn=null,qo=0;var u=a.return;try{if(Fj(t,u,a,r,Gt)){_a=1,xl(t,ps(r,t.current)),Ft=null;return}}catch(p){if(u!==null)throw Ft=u,p;_a=1,xl(t,ps(r,t.current)),Ft=null;return}a.flags&32768?(Yt||i===1?t=!0:Gn||(Gt&536870912)!==0?t=!1:(kr=t=!0,(i===2||i===9||i===3||i===6)&&(i=as.current,i!==null&&i.tag===13&&(i.flags|=16384))),z0(a,t)):Cl(a)}function Cl(t){var a=t;do{if((a.flags&32768)!==0){z0(a,kr);return}t=a.return;var r=Wj(a.alternate,a,or);if(r!==null){Ft=r;return}if(a=a.sibling,a!==null){Ft=a;return}Ft=a=t}while(a!==null);_a===0&&(_a=5)}function z0(t,a){do{var r=Kj(t.alternate,t);if(r!==null){r.flags&=32767,Ft=r;return}if(r=t.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!a&&(t=t.sibling,t!==null)){Ft=t;return}Ft=t=r}while(t!==null);_a=6,Ft=null}function q0(t,a,r,i,u,p,y,S,H){t.cancelPendingCommit=null;do kl();while(Ma!==0);if((aa&6)!==0)throw Error(l(327));if(a!==null){if(a===t.current)throw Error(l(177));if(p=a.lanes|a.childLanes,p|=Sd,Ke(t,r,p,y,S,H),t===ha&&(Ft=ha=null,Gt=0),Kn=a,Lr=t,ir=r,Lu=p,Pu=u,C0=i,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,o_(Ot,function(){return F0(),null})):(t.callbackNode=null,t.callbackPriority=0),i=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||i){i=I.T,I.T=null,u=Q.p,Q.p=2,y=aa,aa|=4;try{Yj(t,a,r)}finally{aa=y,Q.p=u,I.T=i}}Ma=1,U0(),B0(),V0()}}function U0(){if(Ma===1){Ma=0;var t=Lr,a=Kn,r=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||r){r=I.T,I.T=null;var i=Q.p;Q.p=2;var u=aa;aa|=4;try{y0(a,t);var p=Ku,y=Th(t.containerInfo),S=p.focusedElem,H=p.selectionRange;if(y!==S&&S&&S.ownerDocument&&wh(S.ownerDocument.documentElement,S)){if(H!==null&&vd(S)){var pe=H.start,Ae=H.end;if(Ae===void 0&&(Ae=pe),"selectionStart"in S)S.selectionStart=pe,S.selectionEnd=Math.min(Ae,S.value.length);else{var Pe=S.ownerDocument||document,he=Pe&&Pe.defaultView||window;if(he.getSelection){var ye=he.getSelection(),bt=S.textContent.length,Pt=Math.min(H.start,bt),ma=H.end===void 0?Pt:Math.min(H.end,bt);!ye.extend&&Pt>ma&&(y=ma,ma=Pt,Pt=y);var ie=Sh(S,Pt),te=Sh(S,ma);if(ie&&te&&(ye.rangeCount!==1||ye.anchorNode!==ie.node||ye.anchorOffset!==ie.offset||ye.focusNode!==te.node||ye.focusOffset!==te.offset)){var me=Pe.createRange();me.setStart(ie.node,ie.offset),ye.removeAllRanges(),Pt>ma?(ye.addRange(me),ye.extend(te.node,te.offset)):(me.setEnd(te.node,te.offset),ye.addRange(me))}}}}for(Pe=[],ye=S;ye=ye.parentNode;)ye.nodeType===1&&Pe.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<Pe.length;S++){var Re=Pe[S];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}Bl=!!Wu,Ku=Wu=null}finally{aa=u,Q.p=i,I.T=r}}t.current=a,Ma=2}}function B0(){if(Ma===2){Ma=0;var t=Lr,a=Kn,r=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||r){r=I.T,I.T=null;var i=Q.p;Q.p=2;var u=aa;aa|=4;try{x0(t,a.alternate,a)}finally{aa=u,Q.p=i,I.T=r}}Ma=3}}function V0(){if(Ma===4||Ma===3){Ma=0,qe();var t=Lr,a=Kn,r=ir,i=C0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Ma=5:(Ma=0,Kn=Lr=null,$0(t,t.pendingLanes));var u=t.pendingLanes;if(u===0&&(Rr=null),zt(r),a=a.stateNode,re&&typeof re.onCommitFiberRoot=="function")try{re.onCommitFiberRoot(L,a,void 0,(a.current.flags&128)===128)}catch{}if(i!==null){a=I.T,u=Q.p,Q.p=2,I.T=null;try{for(var p=t.onRecoverableError,y=0;y<i.length;y++){var S=i[y];p(S.value,{componentStack:S.stack})}}finally{I.T=a,Q.p=u}}(ir&3)!==0&&kl(),Is(t),u=t.pendingLanes,(r&261930)!==0&&(u&42)!==0?t===Mu?ai++:(ai=0,Mu=t):ai=0,si(0)}}function $0(t,a){(t.pooledCacheLanes&=a)===0&&(a=t.pooledCache,a!=null&&(t.pooledCache=null,Do(a)))}function kl(){return U0(),B0(),V0(),F0()}function F0(){if(Ma!==5)return!1;var t=Lr,a=Lu;Lu=0;var r=zt(ir),i=I.T,u=Q.p;try{Q.p=32>r?32:r,I.T=null,r=Pu,Pu=null;var p=Lr,y=ir;if(Ma=0,Kn=Lr=null,ir=0,(aa&6)!==0)throw Error(l(331));var S=aa;if(aa|=4,w0(p.current),j0(p,p.current,y,r),aa=S,si(0,!1),re&&typeof re.onPostCommitFiberRoot=="function")try{re.onPostCommitFiberRoot(L,p)}catch{}return!0}finally{Q.p=u,I.T=i,$0(t,a)}}function H0(t,a,r){a=ps(r,a),a=mu(t.stateNode,a,2),t=wr(t,a,2),t!==null&&(Dt(t,2),Is(t))}function ca(t,a,r){if(t.tag===3)H0(t,t,r);else for(;a!==null;){if(a.tag===3){H0(a,t,r);break}else if(a.tag===1){var i=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Rr===null||!Rr.has(i))){t=ps(r,t),r=Gx(2),i=wr(a,r,2),i!==null&&(Wx(r,i,a,t),Dt(i,2),Is(i));break}}a=a.return}}function Du(t,a,r){var i=t.pingCache;if(i===null){i=t.pingCache=new Zj;var u=new Set;i.set(a,u)}else u=i.get(a),u===void 0&&(u=new Set,i.set(a,u));u.has(r)||(ku=!0,u.add(r),t=s_.bind(null,t,a,r),a.then(t,t))}function s_(t,a,r){var i=t.pingCache;i!==null&&i.delete(a),t.pingedLanes|=t.suspendedLanes&r,t.warmLanes&=~r,ha===t&&(Gt&r)===r&&(_a===4||_a===3&&(Gt&62914560)===Gt&&300>Se()-_l?(aa&2)===0&&Yn(t,0):Eu|=r,Wn===Gt&&(Wn=0)),Is(t)}function G0(t,a){a===0&&(a=B()),t=Zr(t,a),t!==null&&(Dt(t,a),Is(t))}function r_(t){var a=t.memoizedState,r=0;a!==null&&(r=a.retryLane),G0(t,r)}function n_(t,a){var r=0;switch(t.tag){case 31:case 13:var i=t.stateNode,u=t.memoizedState;u!==null&&(r=u.retryLane);break;case 19:i=t.stateNode;break;case 22:i=t.stateNode._retryCache;break;default:throw Error(l(314))}i!==null&&i.delete(a),G0(t,r)}function o_(t,a){return Me(t,a)}var El=null,Qn=null,zu=!1,Rl=!1,qu=!1,Mr=0;function Is(t){t!==Qn&&t.next===null&&(Qn===null?El=Qn=t:Qn=Qn.next=t),Rl=!0,zu||(zu=!0,l_())}function si(t,a){if(!qu&&Rl){qu=!0;do for(var r=!1,i=El;i!==null;){if(t!==0){var u=i.pendingLanes;if(u===0)var p=0;else{var y=i.suspendedLanes,S=i.pingedLanes;p=(1<<31-ce(42|t)+1)-1,p&=u&~(y&~S),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(r=!0,X0(i,p))}else p=Gt,p=ve(i,i===ha?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(p&3)===0||gt(i,p)||(r=!0,X0(i,p));i=i.next}while(r);qu=!1}}function i_(){W0()}function W0(){Rl=zu=!1;var t=0;Mr!==0&&b_()&&(t=Mr);for(var a=Se(),r=null,i=El;i!==null;){var u=i.next,p=K0(i,a);p===0?(i.next=null,r===null?El=u:r.next=u,u===null&&(Qn=r)):(r=i,(t!==0||(p&3)!==0)&&(Rl=!0)),i=u}Ma!==0&&Ma!==5||si(t),Mr!==0&&(Mr=0)}function K0(t,a){for(var r=t.suspendedLanes,i=t.pingedLanes,u=t.expirationTimes,p=t.pendingLanes&-62914561;0<p;){var y=31-ce(p),S=1<<y,H=u[y];H===-1?((S&r)===0||(S&i)!==0)&&(u[y]=$e(S,a)):H<=a&&(t.expiredLanes|=S),p&=~S}if(a=ha,r=Gt,r=ve(t,t===a?r:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i=t.callbackNode,r===0||t===a&&(la===2||la===9)||t.cancelPendingCommit!==null)return i!==null&&i!==null&&De(i),t.callbackNode=null,t.callbackPriority=0;if((r&3)===0||gt(t,r)){if(a=r&-r,a===t.callbackPriority)return a;switch(i!==null&&De(i),zt(r)){case 2:case 8:r=xt;break;case 32:r=Ot;break;case 268435456:r=Ue;break;default:r=Ot}return i=Y0.bind(null,t),r=Me(r,i),t.callbackPriority=a,t.callbackNode=r,a}return i!==null&&i!==null&&De(i),t.callbackPriority=2,t.callbackNode=null,2}function Y0(t,a){if(Ma!==0&&Ma!==5)return t.callbackNode=null,t.callbackPriority=0,null;var r=t.callbackNode;if(kl()&&t.callbackNode!==r)return null;var i=Gt;return i=ve(t,t===ha?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i===0?null:(E0(t,i,a),K0(t,Se()),t.callbackNode!=null&&t.callbackNode===r?Y0.bind(null,t):null)}function X0(t,a){if(kl())return null;E0(t,a,!0)}function l_(){y_(function(){(aa&6)!==0?Me(We,i_):W0()})}function Uu(){if(Mr===0){var t=On;t===0&&(t=tt,tt<<=1,(tt&261888)===0&&(tt=256)),Mr=t}return Mr}function Q0(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:qi(""+t)}function Z0(t,a){var r=a.ownerDocument.createElement("input");return r.name=a.name,r.value=a.value,t.id&&r.setAttribute("form",t.id),a.parentNode.insertBefore(r,a),t=new FormData(t),r.parentNode.removeChild(r),t}function c_(t,a,r,i,u){if(a==="submit"&&r&&r.stateNode===u){var p=Q0((u[ot]||null).action),y=i.submitter;y&&(a=(a=y[ot]||null)?Q0(a.formAction):y.getAttribute("formAction"),a!==null&&(p=a,y=null));var S=new $i("action","action",null,i,u);t.push({event:S,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Mr!==0){var H=y?Z0(u,y):new FormData(u);ou(r,{pending:!0,data:H,method:u.method,action:p},null,H)}}else typeof p=="function"&&(S.preventDefault(),H=y?Z0(u,y):new FormData(u),ou(r,{pending:!0,data:H,method:u.method,action:p},p,H))},currentTarget:u}]})}}for(var Bu=0;Bu<_d.length;Bu++){var Vu=_d[Bu],d_=Vu.toLowerCase(),u_=Vu[0].toUpperCase()+Vu.slice(1);_s(d_,"on"+u_)}_s(kh,"onAnimationEnd"),_s(Eh,"onAnimationIteration"),_s(Rh,"onAnimationStart"),_s("dblclick","onDoubleClick"),_s("focusin","onFocus"),_s("focusout","onBlur"),_s(Aj,"onTransitionRun"),_s(Cj,"onTransitionStart"),_s(kj,"onTransitionCancel"),_s(Lh,"onTransitionEnd"),Y("onMouseEnter",["mouseout","mouseover"]),Y("onMouseLeave",["mouseout","mouseover"]),Y("onPointerEnter",["pointerout","pointerover"]),Y("onPointerLeave",["pointerout","pointerover"]),at("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),at("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),at("onBeforeInput",["compositionend","keypress","textInput","paste"]),at("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ri));function J0(t,a){a=(a&4)!==0;for(var r=0;r<t.length;r++){var i=t[r],u=i.event;i=i.listeners;e:{var p=void 0;if(a)for(var y=i.length-1;0<=y;y--){var S=i[y],H=S.instance,pe=S.currentTarget;if(S=S.listener,H!==p&&u.isPropagationStopped())break e;p=S,u.currentTarget=pe;try{p(u)}catch(Ae){Gi(Ae)}u.currentTarget=null,p=H}else for(y=0;y<i.length;y++){if(S=i[y],H=S.instance,pe=S.currentTarget,S=S.listener,H!==p&&u.isPropagationStopped())break e;p=S,u.currentTarget=pe;try{p(u)}catch(Ae){Gi(Ae)}u.currentTarget=null,p=H}}}}function Ht(t,a){var r=a[Oe];r===void 0&&(r=a[Oe]=new Set);var i=t+"__bubble";r.has(i)||(ef(a,t,2,!1),r.add(i))}function $u(t,a,r){var i=0;a&&(i|=4),ef(r,t,i,a)}var Ll="_reactListening"+Math.random().toString(36).slice(2);function Fu(t){if(!t[Ll]){t[Ll]=!0,Lt.forEach(function(r){r!=="selectionchange"&&(m_.has(r)||$u(r,!1,t),$u(r,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[Ll]||(a[Ll]=!0,$u("selectionchange",!1,a))}}function ef(t,a,r,i){switch(Ef(a)){case 2:var u=U_;break;case 8:u=B_;break;default:u=nm}r=u.bind(null,a,r,t),u=void 0,!dd||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(u=!0),i?u!==void 0?t.addEventListener(a,r,{capture:!0,passive:u}):t.addEventListener(a,r,!0):u!==void 0?t.addEventListener(a,r,{passive:u}):t.addEventListener(a,r,!1)}function Hu(t,a,r,i,u){var p=i;if((a&1)===0&&(a&2)===0&&i!==null)e:for(;;){if(i===null)return;var y=i.tag;if(y===3||y===4){var S=i.stateNode.containerInfo;if(S===u)break;if(y===4)for(y=i.return;y!==null;){var H=y.tag;if((H===3||H===4)&&y.stateNode.containerInfo===u)return;y=y.return}for(;S!==null;){if(y=Jt(S),y===null)return;if(H=y.tag,H===5||H===6||H===26||H===27){i=p=y;continue e}S=S.parentNode}}i=i.return}nh(function(){var pe=p,Ae=ld(r),Pe=[];e:{var he=Ph.get(t);if(he!==void 0){var ye=$i,bt=t;switch(t){case"keypress":if(Bi(r)===0)break e;case"keydown":case"keyup":ye=nj;break;case"focusin":bt="focus",ye=hd;break;case"focusout":bt="blur",ye=hd;break;case"beforeblur":case"afterblur":ye=hd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=lh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=WN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=lj;break;case kh:case Eh:case Rh:ye=XN;break;case Lh:ye=dj;break;case"scroll":case"scrollend":ye=HN;break;case"wheel":ye=mj;break;case"copy":case"cut":case"paste":ye=ZN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=dh;break;case"toggle":case"beforetoggle":ye=hj}var Pt=(a&4)!==0,ma=!Pt&&(t==="scroll"||t==="scrollend"),ie=Pt?he!==null?he+"Capture":null:he;Pt=[];for(var te=pe,me;te!==null;){var Re=te;if(me=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||me===null||ie===null||(Re=To(te,ie),Re!=null&&Pt.push(ni(te,Re,me))),ma)break;te=te.return}0<Pt.length&&(he=new ye(he,bt,null,r,Ae),Pe.push({event:he,listeners:Pt}))}}if((a&7)===0){e:{if(he=t==="mouseover"||t==="pointerover",ye=t==="mouseout"||t==="pointerout",he&&r!==id&&(bt=r.relatedTarget||r.fromElement)&&(Jt(bt)||bt[X]))break e;if((ye||he)&&(he=Ae.window===Ae?Ae:(he=Ae.ownerDocument)?he.defaultView||he.parentWindow:window,ye?(bt=r.relatedTarget||r.toElement,ye=pe,bt=bt?Jt(bt):null,bt!==null&&(ma=m(bt),Pt=bt.tag,bt!==ma||Pt!==5&&Pt!==27&&Pt!==6)&&(bt=null)):(ye=null,bt=pe),ye!==bt)){if(Pt=lh,Re="onMouseLeave",ie="onMouseEnter",te="mouse",(t==="pointerout"||t==="pointerover")&&(Pt=dh,Re="onPointerLeave",ie="onPointerEnter",te="pointer"),ma=ye==null?he:_e(ye),me=bt==null?he:_e(bt),he=new Pt(Re,te+"leave",ye,r,Ae),he.target=ma,he.relatedTarget=me,Re=null,Jt(Ae)===pe&&(Pt=new Pt(ie,te+"enter",bt,r,Ae),Pt.target=me,Pt.relatedTarget=ma,Re=Pt),ma=Re,ye&&bt)t:{for(Pt=p_,ie=ye,te=bt,me=0,Re=ie;Re;Re=Pt(Re))me++;Re=0;for(var Et=te;Et;Et=Pt(Et))Re++;for(;0<me-Re;)ie=Pt(ie),me--;for(;0<Re-me;)te=Pt(te),Re--;for(;me--;){if(ie===te||te!==null&&ie===te.alternate){Pt=ie;break t}ie=Pt(ie),te=Pt(te)}Pt=null}else Pt=null;ye!==null&&tf(Pe,he,ye,Pt,!1),bt!==null&&ma!==null&&tf(Pe,ma,bt,Pt,!0)}}e:{if(he=pe?_e(pe):window,ye=he.nodeName&&he.nodeName.toLowerCase(),ye==="select"||ye==="input"&&he.type==="file")var ea=bh;else if(fh(he))if(vh)ea=Sj;else{ea=jj;var wt=Nj}else ye=he.nodeName,!ye||ye.toLowerCase()!=="input"||he.type!=="checkbox"&&he.type!=="radio"?pe&&od(pe.elementType)&&(ea=bh):ea=_j;if(ea&&(ea=ea(t,pe))){gh(Pe,ea,r,Ae);break e}wt&&wt(t,he,pe),t==="focusout"&&pe&&he.type==="number"&&pe.memoizedProps.value!=null&&nd(he,"number",he.value)}switch(wt=pe?_e(pe):window,t){case"focusin":(fh(wt)||wt.contentEditable==="true")&&(Cn=wt,yd=pe,Mo=null);break;case"focusout":Mo=yd=Cn=null;break;case"mousedown":Nd=!0;break;case"contextmenu":case"mouseup":case"dragend":Nd=!1,Ah(Pe,r,Ae);break;case"selectionchange":if(Tj)break;case"keydown":case"keyup":Ah(Pe,r,Ae)}var Bt;if(fd)e:{switch(t){case"compositionstart":var Wt="onCompositionStart";break e;case"compositionend":Wt="onCompositionEnd";break e;case"compositionupdate":Wt="onCompositionUpdate";break e}Wt=void 0}else An?hh(t,r)&&(Wt="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(Wt="onCompositionStart");Wt&&(uh&&r.locale!=="ko"&&(An||Wt!=="onCompositionStart"?Wt==="onCompositionEnd"&&An&&(Bt=oh()):(br=Ae,ud="value"in br?br.value:br.textContent,An=!0)),wt=Pl(pe,Wt),0<wt.length&&(Wt=new ch(Wt,t,null,r,Ae),Pe.push({event:Wt,listeners:wt}),Bt?Wt.data=Bt:(Bt=xh(r),Bt!==null&&(Wt.data=Bt)))),(Bt=fj?gj(t,r):bj(t,r))&&(Wt=Pl(pe,"onBeforeInput"),0<Wt.length&&(wt=new ch("onBeforeInput","beforeinput",null,r,Ae),Pe.push({event:wt,listeners:Wt}),wt.data=Bt)),c_(Pe,t,pe,r,Ae)}J0(Pe,a)})}function ni(t,a,r){return{instance:t,listener:a,currentTarget:r}}function Pl(t,a){for(var r=a+"Capture",i=[];t!==null;){var u=t,p=u.stateNode;if(u=u.tag,u!==5&&u!==26&&u!==27||p===null||(u=To(t,r),u!=null&&i.unshift(ni(t,u,p)),u=To(t,a),u!=null&&i.push(ni(t,u,p))),t.tag===3)return i;t=t.return}return[]}function p_(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function tf(t,a,r,i,u){for(var p=a._reactName,y=[];r!==null&&r!==i;){var S=r,H=S.alternate,pe=S.stateNode;if(S=S.tag,H!==null&&H===i)break;S!==5&&S!==26&&S!==27||pe===null||(H=pe,u?(pe=To(r,p),pe!=null&&y.unshift(ni(r,pe,H))):u||(pe=To(r,p),pe!=null&&y.push(ni(r,pe,H)))),r=r.return}y.length!==0&&t.push({event:a,listeners:y})}var h_=/\r\n?/g,x_=/\u0000|\uFFFD/g;function af(t){return(typeof t=="string"?t:""+t).replace(h_,`
`).replace(x_,"")}function sf(t,a){return a=af(a),af(t)===a}function ua(t,a,r,i,u,p){switch(r){case"children":typeof i=="string"?a==="body"||a==="textarea"&&i===""||Sn(t,i):(typeof i=="number"||typeof i=="bigint")&&a!=="body"&&Sn(t,""+i);break;case"className":Na(t,"class",i);break;case"tabIndex":Na(t,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":Na(t,r,i);break;case"style":sh(t,i,p);break;case"data":if(a!=="object"){Na(t,"data",i);break}case"src":case"href":if(i===""&&(a!=="a"||r!=="href")){t.removeAttribute(r);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(r);break}i=qi(""+i),t.setAttribute(r,i);break;case"action":case"formAction":if(typeof i=="function"){t.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(r==="formAction"?(a!=="input"&&ua(t,a,"name",u.name,u,null),ua(t,a,"formEncType",u.formEncType,u,null),ua(t,a,"formMethod",u.formMethod,u,null),ua(t,a,"formTarget",u.formTarget,u,null)):(ua(t,a,"encType",u.encType,u,null),ua(t,a,"method",u.method,u,null),ua(t,a,"target",u.target,u,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(r);break}i=qi(""+i),t.setAttribute(r,i);break;case"onClick":i!=null&&(t.onclick=Gs);break;case"onScroll":i!=null&&Ht("scroll",t);break;case"onScrollEnd":i!=null&&Ht("scrollend",t);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(r=i.__html,r!=null){if(u.children!=null)throw Error(l(60));t.innerHTML=r}}break;case"multiple":t.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":t.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){t.removeAttribute("xlink:href");break}r=qi(""+i),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(r,""+i):t.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(r,""):t.removeAttribute(r);break;case"capture":case"download":i===!0?t.setAttribute(r,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(r,i):t.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?t.setAttribute(r,i):t.removeAttribute(r);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?t.removeAttribute(r):t.setAttribute(r,i);break;case"popover":Ht("beforetoggle",t),Ht("toggle",t),Tt(t,"popover",i);break;case"xlinkActuate":Pa(t,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":Pa(t,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":Pa(t,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":Pa(t,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":Pa(t,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":Pa(t,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":Pa(t,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":Pa(t,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":Pa(t,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Tt(t,"is",i);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=$N.get(r)||r,Tt(t,r,i))}}function Gu(t,a,r,i,u,p){switch(r){case"style":sh(t,i,p);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(r=i.__html,r!=null){if(u.children!=null)throw Error(l(60));t.innerHTML=r}}break;case"children":typeof i=="string"?Sn(t,i):(typeof i=="number"||typeof i=="bigint")&&Sn(t,""+i);break;case"onScroll":i!=null&&Ht("scroll",t);break;case"onScrollEnd":i!=null&&Ht("scrollend",t);break;case"onClick":i!=null&&(t.onclick=Gs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ut.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(u=r.endsWith("Capture"),a=r.slice(2,u?r.length-7:void 0),p=t[ot]||null,p=p!=null?p[r]:null,typeof p=="function"&&t.removeEventListener(a,p,u),typeof i=="function")){typeof p!="function"&&p!==null&&(r in t?t[r]=null:t.hasAttribute(r)&&t.removeAttribute(r)),t.addEventListener(a,i,u);break e}r in t?t[r]=i:i===!0?t.setAttribute(r,""):Tt(t,r,i)}}}function Ba(t,a,r){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ht("error",t),Ht("load",t);var i=!1,u=!1,p;for(p in r)if(r.hasOwnProperty(p)){var y=r[p];if(y!=null)switch(p){case"src":i=!0;break;case"srcSet":u=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,a));default:ua(t,a,p,y,r,null)}}u&&ua(t,a,"srcSet",r.srcSet,r,null),i&&ua(t,a,"src",r.src,r,null);return;case"input":Ht("invalid",t);var S=p=y=u=null,H=null,pe=null;for(i in r)if(r.hasOwnProperty(i)){var Ae=r[i];if(Ae!=null)switch(i){case"name":u=Ae;break;case"type":y=Ae;break;case"checked":H=Ae;break;case"defaultChecked":pe=Ae;break;case"value":p=Ae;break;case"defaultValue":S=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(l(137,a));break;default:ua(t,a,i,Ae,r,null)}}Jp(t,p,S,H,pe,y,u,!1);return;case"select":Ht("invalid",t),i=y=p=null;for(u in r)if(r.hasOwnProperty(u)&&(S=r[u],S!=null))switch(u){case"value":p=S;break;case"defaultValue":y=S;break;case"multiple":i=S;default:ua(t,a,u,S,r,null)}a=p,r=y,t.multiple=!!i,a!=null?_n(t,!!i,a,!1):r!=null&&_n(t,!!i,r,!0);return;case"textarea":Ht("invalid",t),p=u=i=null;for(y in r)if(r.hasOwnProperty(y)&&(S=r[y],S!=null))switch(y){case"value":i=S;break;case"defaultValue":u=S;break;case"children":p=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(l(91));break;default:ua(t,a,y,S,r,null)}th(t,i,u,p);return;case"option":for(H in r)if(r.hasOwnProperty(H)&&(i=r[H],i!=null))switch(H){case"selected":t.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:ua(t,a,H,i,r,null)}return;case"dialog":Ht("beforetoggle",t),Ht("toggle",t),Ht("cancel",t),Ht("close",t);break;case"iframe":case"object":Ht("load",t);break;case"video":case"audio":for(i=0;i<ri.length;i++)Ht(ri[i],t);break;case"image":Ht("error",t),Ht("load",t);break;case"details":Ht("toggle",t);break;case"embed":case"source":case"link":Ht("error",t),Ht("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in r)if(r.hasOwnProperty(pe)&&(i=r[pe],i!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,a));default:ua(t,a,pe,i,r,null)}return;default:if(od(a)){for(Ae in r)r.hasOwnProperty(Ae)&&(i=r[Ae],i!==void 0&&Gu(t,a,Ae,i,r,void 0));return}}for(S in r)r.hasOwnProperty(S)&&(i=r[S],i!=null&&ua(t,a,S,i,r,null))}function f_(t,a,r,i){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var u=null,p=null,y=null,S=null,H=null,pe=null,Ae=null;for(ye in r){var Pe=r[ye];if(r.hasOwnProperty(ye)&&Pe!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":H=Pe;default:i.hasOwnProperty(ye)||ua(t,a,ye,null,i,Pe)}}for(var he in i){var ye=i[he];if(Pe=r[he],i.hasOwnProperty(he)&&(ye!=null||Pe!=null))switch(he){case"type":p=ye;break;case"name":u=ye;break;case"checked":pe=ye;break;case"defaultChecked":Ae=ye;break;case"value":y=ye;break;case"defaultValue":S=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(l(137,a));break;default:ye!==Pe&&ua(t,a,he,ye,i,Pe)}}rd(t,y,S,H,pe,Ae,p,u);return;case"select":ye=y=S=he=null;for(p in r)if(H=r[p],r.hasOwnProperty(p)&&H!=null)switch(p){case"value":break;case"multiple":ye=H;default:i.hasOwnProperty(p)||ua(t,a,p,null,i,H)}for(u in i)if(p=i[u],H=r[u],i.hasOwnProperty(u)&&(p!=null||H!=null))switch(u){case"value":he=p;break;case"defaultValue":S=p;break;case"multiple":y=p;default:p!==H&&ua(t,a,u,p,i,H)}a=S,r=y,i=ye,he!=null?_n(t,!!r,he,!1):!!i!=!!r&&(a!=null?_n(t,!!r,a,!0):_n(t,!!r,r?[]:"",!1));return;case"textarea":ye=he=null;for(S in r)if(u=r[S],r.hasOwnProperty(S)&&u!=null&&!i.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:ua(t,a,S,null,i,u)}for(y in i)if(u=i[y],p=r[y],i.hasOwnProperty(y)&&(u!=null||p!=null))switch(y){case"value":he=u;break;case"defaultValue":ye=u;break;case"children":break;case"dangerouslySetInnerHTML":if(u!=null)throw Error(l(91));break;default:u!==p&&ua(t,a,y,u,i,p)}eh(t,he,ye);return;case"option":for(var bt in r)if(he=r[bt],r.hasOwnProperty(bt)&&he!=null&&!i.hasOwnProperty(bt))switch(bt){case"selected":t.selected=!1;break;default:ua(t,a,bt,null,i,he)}for(H in i)if(he=i[H],ye=r[H],i.hasOwnProperty(H)&&he!==ye&&(he!=null||ye!=null))switch(H){case"selected":t.selected=he&&typeof he!="function"&&typeof he!="symbol";break;default:ua(t,a,H,he,i,ye)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pt in r)he=r[Pt],r.hasOwnProperty(Pt)&&he!=null&&!i.hasOwnProperty(Pt)&&ua(t,a,Pt,null,i,he);for(pe in i)if(he=i[pe],ye=r[pe],i.hasOwnProperty(pe)&&he!==ye&&(he!=null||ye!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(l(137,a));break;default:ua(t,a,pe,he,i,ye)}return;default:if(od(a)){for(var ma in r)he=r[ma],r.hasOwnProperty(ma)&&he!==void 0&&!i.hasOwnProperty(ma)&&Gu(t,a,ma,void 0,i,he);for(Ae in i)he=i[Ae],ye=r[Ae],!i.hasOwnProperty(Ae)||he===ye||he===void 0&&ye===void 0||Gu(t,a,Ae,he,i,ye);return}}for(var ie in r)he=r[ie],r.hasOwnProperty(ie)&&he!=null&&!i.hasOwnProperty(ie)&&ua(t,a,ie,null,i,he);for(Pe in i)he=i[Pe],ye=r[Pe],!i.hasOwnProperty(Pe)||he===ye||he==null&&ye==null||ua(t,a,Pe,he,i,ye)}function rf(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function g_(){if(typeof performance.getEntriesByType=="function"){for(var t=0,a=0,r=performance.getEntriesByType("resource"),i=0;i<r.length;i++){var u=r[i],p=u.transferSize,y=u.initiatorType,S=u.duration;if(p&&S&&rf(y)){for(y=0,S=u.responseEnd,i+=1;i<r.length;i++){var H=r[i],pe=H.startTime;if(pe>S)break;var Ae=H.transferSize,Pe=H.initiatorType;Ae&&rf(Pe)&&(H=H.responseEnd,y+=Ae*(H<S?1:(S-pe)/(H-pe)))}if(--i,a+=8*(p+y)/(u.duration/1e3),t++,10<t)break}}if(0<t)return a/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Wu=null,Ku=null;function Ml(t){return t.nodeType===9?t:t.ownerDocument}function nf(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function of(t,a){if(t===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&a==="foreignObject"?0:t}function Yu(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Xu=null;function b_(){var t=window.event;return t&&t.type==="popstate"?t===Xu?!1:(Xu=t,!0):(Xu=null,!1)}var lf=typeof setTimeout=="function"?setTimeout:void 0,v_=typeof clearTimeout=="function"?clearTimeout:void 0,cf=typeof Promise=="function"?Promise:void 0,y_=typeof queueMicrotask=="function"?queueMicrotask:typeof cf<"u"?function(t){return cf.resolve(null).then(t).catch(N_)}:lf;function N_(t){setTimeout(function(){throw t})}function Ir(t){return t==="head"}function df(t,a){var r=a,i=0;do{var u=r.nextSibling;if(t.removeChild(r),u&&u.nodeType===8)if(r=u.data,r==="/$"||r==="/&"){if(i===0){t.removeChild(u),to(a);return}i--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")i++;else if(r==="html")oi(t.ownerDocument.documentElement);else if(r==="head"){r=t.ownerDocument.head,oi(r);for(var p=r.firstChild;p;){var y=p.nextSibling,S=p.nodeName;p[He]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&p.rel.toLowerCase()==="stylesheet"||r.removeChild(p),p=y}}else r==="body"&&oi(t.ownerDocument.body);r=u}while(r);to(a)}function uf(t,a){var r=t;t=0;do{var i=r.nextSibling;if(r.nodeType===1?a?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(a?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(t===0)break;t--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||t++;r=i}while(r)}function Qu(t){var a=t.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var r=a;switch(a=a.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Qu(r),mt(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}t.removeChild(r)}}function j_(t,a,r,i){for(;t.nodeType===1;){var u=r;if(t.nodeName.toLowerCase()!==a.toLowerCase()){if(!i&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(i){if(!t[He])switch(a){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(p=t.getAttribute("rel"),p==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(p!==u.rel||t.getAttribute("href")!==(u.href==null||u.href===""?null:u.href)||t.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin)||t.getAttribute("title")!==(u.title==null?null:u.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(p=t.getAttribute("src"),(p!==(u.src==null?null:u.src)||t.getAttribute("type")!==(u.type==null?null:u.type)||t.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin))&&p&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(a==="input"&&t.type==="hidden"){var p=u.name==null?null:""+u.name;if(u.type==="hidden"&&t.getAttribute("name")===p)return t}else return t;if(t=bs(t.nextSibling),t===null)break}return null}function __(t,a,r){if(a==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=bs(t.nextSibling),t===null))return null;return t}function mf(t,a){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=bs(t.nextSibling),t===null))return null;return t}function Zu(t){return t.data==="$?"||t.data==="$~"}function Ju(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function S_(t,a){var r=t.ownerDocument;if(t.data==="$~")t._reactRetry=a;else if(t.data!=="$?"||r.readyState!=="loading")a();else{var i=function(){a(),r.removeEventListener("DOMContentLoaded",i)};r.addEventListener("DOMContentLoaded",i),t._reactRetry=i}}function bs(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return t}var em=null;function pf(t){t=t.nextSibling;for(var a=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"||r==="/&"){if(a===0)return bs(t.nextSibling);a--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||a++}t=t.nextSibling}return null}function hf(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(a===0)return t;a--}else r!=="/$"&&r!=="/&"||a++}t=t.previousSibling}return null}function xf(t,a,r){switch(a=Ml(r),t){case"html":if(t=a.documentElement,!t)throw Error(l(452));return t;case"head":if(t=a.head,!t)throw Error(l(453));return t;case"body":if(t=a.body,!t)throw Error(l(454));return t;default:throw Error(l(451))}}function oi(t){for(var a=t.attributes;a.length;)t.removeAttributeNode(a[0]);mt(t)}var vs=new Map,ff=new Set;function Il(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var lr=Q.d;Q.d={f:w_,r:T_,D:A_,C:C_,L:k_,m:E_,X:L_,S:R_,M:P_};function w_(){var t=lr.f(),a=Tl();return t||a}function T_(t){var a=pa(t);a!==null&&a.tag===5&&a.type==="form"?Lx(a):lr.r(t)}var Zn=typeof document>"u"?null:document;function gf(t,a,r){var i=Zn;if(i&&typeof a=="string"&&a){var u=us(a);u='link[rel="'+t+'"][href="'+u+'"]',typeof r=="string"&&(u+='[crossorigin="'+r+'"]'),ff.has(u)||(ff.add(u),t={rel:t,crossOrigin:r,href:a},i.querySelector(u)===null&&(a=i.createElement("link"),Ba(a,"link",t),ht(a),i.head.appendChild(a)))}}function A_(t){lr.D(t),gf("dns-prefetch",t,null)}function C_(t,a){lr.C(t,a),gf("preconnect",t,a)}function k_(t,a,r){lr.L(t,a,r);var i=Zn;if(i&&t&&a){var u='link[rel="preload"][as="'+us(a)+'"]';a==="image"&&r&&r.imageSrcSet?(u+='[imagesrcset="'+us(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(u+='[imagesizes="'+us(r.imageSizes)+'"]')):u+='[href="'+us(t)+'"]';var p=u;switch(a){case"style":p=Jn(t);break;case"script":p=eo(t)}vs.has(p)||(t=f({rel:"preload",href:a==="image"&&r&&r.imageSrcSet?void 0:t,as:a},r),vs.set(p,t),i.querySelector(u)!==null||a==="style"&&i.querySelector(ii(p))||a==="script"&&i.querySelector(li(p))||(a=i.createElement("link"),Ba(a,"link",t),ht(a),i.head.appendChild(a)))}}function E_(t,a){lr.m(t,a);var r=Zn;if(r&&t){var i=a&&typeof a.as=="string"?a.as:"script",u='link[rel="modulepreload"][as="'+us(i)+'"][href="'+us(t)+'"]',p=u;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=eo(t)}if(!vs.has(p)&&(t=f({rel:"modulepreload",href:t},a),vs.set(p,t),r.querySelector(u)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(li(p)))return}i=r.createElement("link"),Ba(i,"link",t),ht(i),r.head.appendChild(i)}}}function R_(t,a,r){lr.S(t,a,r);var i=Zn;if(i&&t){var u=Fe(i).hoistableStyles,p=Jn(t);a=a||"default";var y=u.get(p);if(!y){var S={loading:0,preload:null};if(y=i.querySelector(ii(p)))S.loading=5;else{t=f({rel:"stylesheet",href:t,"data-precedence":a},r),(r=vs.get(p))&&tm(t,r);var H=y=i.createElement("link");ht(H),Ba(H,"link",t),H._p=new Promise(function(pe,Ae){H.onload=pe,H.onerror=Ae}),H.addEventListener("load",function(){S.loading|=1}),H.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Ol(y,a,i)}y={type:"stylesheet",instance:y,count:1,state:S},u.set(p,y)}}}function L_(t,a){lr.X(t,a);var r=Zn;if(r&&t){var i=Fe(r).hoistableScripts,u=eo(t),p=i.get(u);p||(p=r.querySelector(li(u)),p||(t=f({src:t,async:!0},a),(a=vs.get(u))&&am(t,a),p=r.createElement("script"),ht(p),Ba(p,"link",t),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},i.set(u,p))}}function P_(t,a){lr.M(t,a);var r=Zn;if(r&&t){var i=Fe(r).hoistableScripts,u=eo(t),p=i.get(u);p||(p=r.querySelector(li(u)),p||(t=f({src:t,async:!0,type:"module"},a),(a=vs.get(u))&&am(t,a),p=r.createElement("script"),ht(p),Ba(p,"link",t),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},i.set(u,p))}}function bf(t,a,r,i){var u=(u=M.current)?Il(u):null;if(!u)throw Error(l(446));switch(t){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(a=Jn(r.href),r=Fe(u).hoistableStyles,i=r.get(a),i||(i={type:"style",instance:null,count:0,state:null},r.set(a,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){t=Jn(r.href);var p=Fe(u).hoistableStyles,y=p.get(t);if(y||(u=u.ownerDocument||u,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(t,y),(p=u.querySelector(ii(t)))&&!p._p&&(y.instance=p,y.state.loading=5),vs.has(t)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},vs.set(t,r),p||M_(u,t,r,y.state))),a&&i===null)throw Error(l(528,""));return y}if(a&&i!==null)throw Error(l(529,""));return null;case"script":return a=r.async,r=r.src,typeof r=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=eo(r),r=Fe(u).hoistableScripts,i=r.get(a),i||(i={type:"script",instance:null,count:0,state:null},r.set(a,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,t))}}function Jn(t){return'href="'+us(t)+'"'}function ii(t){return'link[rel="stylesheet"]['+t+"]"}function vf(t){return f({},t,{"data-precedence":t.precedence,precedence:null})}function M_(t,a,r,i){t.querySelector('link[rel="preload"][as="style"]['+a+"]")?i.loading=1:(a=t.createElement("link"),i.preload=a,a.addEventListener("load",function(){return i.loading|=1}),a.addEventListener("error",function(){return i.loading|=2}),Ba(a,"link",r),ht(a),t.head.appendChild(a))}function eo(t){return'[src="'+us(t)+'"]'}function li(t){return"script[async]"+t}function yf(t,a,r){if(a.count++,a.instance===null)switch(a.type){case"style":var i=t.querySelector('style[data-href~="'+us(r.href)+'"]');if(i)return a.instance=i,ht(i),i;var u=f({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return i=(t.ownerDocument||t).createElement("style"),ht(i),Ba(i,"style",u),Ol(i,r.precedence,t),a.instance=i;case"stylesheet":u=Jn(r.href);var p=t.querySelector(ii(u));if(p)return a.state.loading|=4,a.instance=p,ht(p),p;i=vf(r),(u=vs.get(u))&&tm(i,u),p=(t.ownerDocument||t).createElement("link"),ht(p);var y=p;return y._p=new Promise(function(S,H){y.onload=S,y.onerror=H}),Ba(p,"link",i),a.state.loading|=4,Ol(p,r.precedence,t),a.instance=p;case"script":return p=eo(r.src),(u=t.querySelector(li(p)))?(a.instance=u,ht(u),u):(i=r,(u=vs.get(p))&&(i=f({},r),am(i,u)),t=t.ownerDocument||t,u=t.createElement("script"),ht(u),Ba(u,"link",i),t.head.appendChild(u),a.instance=u);case"void":return null;default:throw Error(l(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(i=a.instance,a.state.loading|=4,Ol(i,r.precedence,t));return a.instance}function Ol(t,a,r){for(var i=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),u=i.length?i[i.length-1]:null,p=u,y=0;y<i.length;y++){var S=i[y];if(S.dataset.precedence===a)p=S;else if(p!==u)break}p?p.parentNode.insertBefore(t,p.nextSibling):(a=r.nodeType===9?r.head:r,a.insertBefore(t,a.firstChild))}function tm(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.title==null&&(t.title=a.title)}function am(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.integrity==null&&(t.integrity=a.integrity)}var Dl=null;function Nf(t,a,r){if(Dl===null){var i=new Map,u=Dl=new Map;u.set(r,i)}else u=Dl,i=u.get(r),i||(i=new Map,u.set(r,i));if(i.has(t))return i;for(i.set(t,null),r=r.getElementsByTagName(t),u=0;u<r.length;u++){var p=r[u];if(!(p[He]||p[Je]||t==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var y=p.getAttribute(a)||"";y=t+y;var S=i.get(y);S?S.push(p):i.set(y,[p])}}return i}function jf(t,a,r){t=t.ownerDocument||t,t.head.insertBefore(r,a==="title"?t.querySelector("head > title"):null)}function I_(t,a,r){if(r===1||a.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return t=a.disabled,typeof a.precedence=="string"&&t==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function _f(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function O_(t,a,r,i){if(r.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var u=Jn(i.href),p=a.querySelector(ii(u));if(p){a=p._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(t.count++,t=zl.bind(t),a.then(t,t)),r.state.loading|=4,r.instance=p,ht(p);return}p=a.ownerDocument||a,i=vf(i),(u=vs.get(u))&&tm(i,u),p=p.createElement("link"),ht(p);var y=p;y._p=new Promise(function(S,H){y.onload=S,y.onerror=H}),Ba(p,"link",i),r.instance=p}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(r,a),(a=r.state.preload)&&(r.state.loading&3)===0&&(t.count++,r=zl.bind(t),a.addEventListener("load",r),a.addEventListener("error",r))}}var sm=0;function D_(t,a){return t.stylesheets&&t.count===0&&Ul(t,t.stylesheets),0<t.count||0<t.imgCount?function(r){var i=setTimeout(function(){if(t.stylesheets&&Ul(t,t.stylesheets),t.unsuspend){var p=t.unsuspend;t.unsuspend=null,p()}},6e4+a);0<t.imgBytes&&sm===0&&(sm=62500*g_());var u=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Ul(t,t.stylesheets),t.unsuspend)){var p=t.unsuspend;t.unsuspend=null,p()}},(t.imgBytes>sm?50:800)+a);return t.unsuspend=r,function(){t.unsuspend=null,clearTimeout(i),clearTimeout(u)}}:null}function zl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ul(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var ql=null;function Ul(t,a){t.stylesheets=null,t.unsuspend!==null&&(t.count++,ql=new Map,a.forEach(z_,t),ql=null,zl.call(t))}function z_(t,a){if(!(a.state.loading&4)){var r=ql.get(t);if(r)var i=r.get(null);else{r=new Map,ql.set(t,r);for(var u=t.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<u.length;p++){var y=u[p];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(r.set(y.dataset.precedence,y),i=y)}i&&r.set(null,i)}u=a.instance,y=u.getAttribute("data-precedence"),p=r.get(y)||i,p===i&&r.set(null,u),r.set(y,u),this.count++,i=zl.bind(this),u.addEventListener("load",i),u.addEventListener("error",i),p?p.parentNode.insertBefore(u,p.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(u,t.firstChild)),a.state.loading|=4}}var ci={$$typeof:P,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function q_(t,a,r,i,u,p,y,S,H){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=U(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=U(0),this.hiddenUpdates=U(null),this.identifierPrefix=i,this.onUncaughtError=u,this.onCaughtError=p,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function Sf(t,a,r,i,u,p,y,S,H,pe,Ae,Pe){return t=new q_(t,a,r,y,H,pe,Ae,Pe,S),a=1,p===!0&&(a|=24),p=ts(3,null,null,a),t.current=p,p.stateNode=t,a=Od(),a.refCount++,t.pooledCache=a,a.refCount++,p.memoizedState={element:i,isDehydrated:r,cache:a},Ud(p),t}function wf(t){return t?(t=Rn,t):Rn}function Tf(t,a,r,i,u,p){u=wf(u),i.context===null?i.context=u:i.pendingContext=u,i=Sr(a),i.payload={element:r},p=p===void 0?null:p,p!==null&&(i.callback=p),r=wr(t,i,a),r!==null&&(Za(r,t,a),Bo(r,t,a))}function Af(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<a?r:a}}function rm(t,a){Af(t,a),(t=t.alternate)&&Af(t,a)}function Cf(t){if(t.tag===13||t.tag===31){var a=Zr(t,67108864);a!==null&&Za(a,t,67108864),rm(t,67108864)}}function kf(t){if(t.tag===13||t.tag===31){var a=os();a=pt(a);var r=Zr(t,a);r!==null&&Za(r,t,a),rm(t,a)}}var Bl=!0;function U_(t,a,r,i){var u=I.T;I.T=null;var p=Q.p;try{Q.p=2,nm(t,a,r,i)}finally{Q.p=p,I.T=u}}function B_(t,a,r,i){var u=I.T;I.T=null;var p=Q.p;try{Q.p=8,nm(t,a,r,i)}finally{Q.p=p,I.T=u}}function nm(t,a,r,i){if(Bl){var u=om(i);if(u===null)Hu(t,a,i,Vl,r),Rf(t,i);else if($_(u,t,a,r,i))i.stopPropagation();else if(Rf(t,i),a&4&&-1<V_.indexOf(t)){for(;u!==null;){var p=pa(u);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var y=Ct(p.pendingLanes);if(y!==0){var S=p;for(S.pendingLanes|=2,S.entangledLanes|=2;y;){var H=1<<31-ce(y);S.entanglements[1]|=H,y&=~H}Is(p),(aa&6)===0&&(Sl=Se()+500,si(0))}}break;case 31:case 13:S=Zr(p,2),S!==null&&Za(S,p,2),Tl(),rm(p,2)}if(p=om(i),p===null&&Hu(t,a,i,Vl,r),p===u)break;u=p}u!==null&&i.stopPropagation()}else Hu(t,a,i,null,r)}}function om(t){return t=ld(t),im(t)}var Vl=null;function im(t){if(Vl=null,t=Jt(t),t!==null){var a=m(t);if(a===null)t=null;else{var r=a.tag;if(r===13){if(t=h(a),t!==null)return t;t=null}else if(r===31){if(t=x(a),t!==null)return t;t=null}else if(r===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null)}}return Vl=t,null}function Ef(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xe()){case We:return 2;case xt:return 8;case Ot:case It:return 32;case Ue:return 268435456;default:return 32}default:return 32}}var lm=!1,Or=null,Dr=null,zr=null,di=new Map,ui=new Map,qr=[],V_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Rf(t,a){switch(t){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Dr=null;break;case"mouseover":case"mouseout":zr=null;break;case"pointerover":case"pointerout":di.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":ui.delete(a.pointerId)}}function mi(t,a,r,i,u,p){return t===null||t.nativeEvent!==p?(t={blockedOn:a,domEventName:r,eventSystemFlags:i,nativeEvent:p,targetContainers:[u]},a!==null&&(a=pa(a),a!==null&&Cf(a)),t):(t.eventSystemFlags|=i,a=t.targetContainers,u!==null&&a.indexOf(u)===-1&&a.push(u),t)}function $_(t,a,r,i,u){switch(a){case"focusin":return Or=mi(Or,t,a,r,i,u),!0;case"dragenter":return Dr=mi(Dr,t,a,r,i,u),!0;case"mouseover":return zr=mi(zr,t,a,r,i,u),!0;case"pointerover":var p=u.pointerId;return di.set(p,mi(di.get(p)||null,t,a,r,i,u)),!0;case"gotpointercapture":return p=u.pointerId,ui.set(p,mi(ui.get(p)||null,t,a,r,i,u)),!0}return!1}function Lf(t){var a=Jt(t.target);if(a!==null){var r=m(a);if(r!==null){if(a=r.tag,a===13){if(a=h(r),a!==null){t.blockedOn=a,Be(t.priority,function(){kf(r)});return}}else if(a===31){if(a=x(r),a!==null){t.blockedOn=a,Be(t.priority,function(){kf(r)});return}}else if(a===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $l(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var r=om(t.nativeEvent);if(r===null){r=t.nativeEvent;var i=new r.constructor(r.type,r);id=i,r.target.dispatchEvent(i),id=null}else return a=pa(r),a!==null&&Cf(a),t.blockedOn=r,!1;a.shift()}return!0}function Pf(t,a,r){$l(t)&&r.delete(a)}function F_(){lm=!1,Or!==null&&$l(Or)&&(Or=null),Dr!==null&&$l(Dr)&&(Dr=null),zr!==null&&$l(zr)&&(zr=null),di.forEach(Pf),ui.forEach(Pf)}function Fl(t,a){t.blockedOn===a&&(t.blockedOn=null,lm||(lm=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,F_)))}var Hl=null;function Mf(t){Hl!==t&&(Hl=t,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Hl===t&&(Hl=null);for(var a=0;a<t.length;a+=3){var r=t[a],i=t[a+1],u=t[a+2];if(typeof i!="function"){if(im(i||r)===null)continue;break}var p=pa(r);p!==null&&(t.splice(a,3),a-=3,ou(p,{pending:!0,data:u,method:r.method,action:i},i,u))}}))}function to(t){function a(H){return Fl(H,t)}Or!==null&&Fl(Or,t),Dr!==null&&Fl(Dr,t),zr!==null&&Fl(zr,t),di.forEach(a),ui.forEach(a);for(var r=0;r<qr.length;r++){var i=qr[r];i.blockedOn===t&&(i.blockedOn=null)}for(;0<qr.length&&(r=qr[0],r.blockedOn===null);)Lf(r),r.blockedOn===null&&qr.shift();if(r=(t.ownerDocument||t).$$reactFormReplay,r!=null)for(i=0;i<r.length;i+=3){var u=r[i],p=r[i+1],y=u[ot]||null;if(typeof p=="function")y||Mf(r);else if(y){var S=null;if(p&&p.hasAttribute("formAction")){if(u=p,y=p[ot]||null)S=y.formAction;else if(im(u)!==null)continue}else S=y.action;typeof S=="function"?r[i+1]=S:(r.splice(i,3),i-=3),Mf(r)}}}function If(){function t(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(y){return u=y})},focusReset:"manual",scroll:"manual"})}function a(){u!==null&&(u(),u=null),i||setTimeout(r,20)}function r(){if(!i&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,u=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(r,100),function(){i=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),u!==null&&(u(),u=null)}}}function cm(t){this._internalRoot=t}Gl.prototype.render=cm.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(l(409));var r=a.current,i=os();Tf(r,i,t,a,null,null)},Gl.prototype.unmount=cm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;Tf(t.current,2,null,t,null,null),Tl(),a[X]=null}};function Gl(t){this._internalRoot=t}Gl.prototype.unstable_scheduleHydration=function(t){if(t){var a=lt();t={blockedOn:null,target:t,priority:a};for(var r=0;r<qr.length&&a!==0&&a<qr[r].priority;r++);qr.splice(r,0,t),r===0&&Lf(t)}};var Of=o.version;if(Of!=="19.2.0")throw Error(l(527,Of,"19.2.0"));Q.findDOMNode=function(t){var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(l(188)):(t=Object.keys(t).join(","),Error(l(268,t)));return t=b(a),t=t!==null?v(t):null,t=t===null?null:t.stateNode,t};var H_={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wl.isDisabled&&Wl.supportsFiber)try{L=Wl.inject(H_),re=Wl}catch{}}return hi.createRoot=function(t,a){if(!d(t))throw Error(l(299));var r=!1,i="",u=Vx,p=$x,y=Fx;return a!=null&&(a.unstable_strictMode===!0&&(r=!0),a.identifierPrefix!==void 0&&(i=a.identifierPrefix),a.onUncaughtError!==void 0&&(u=a.onUncaughtError),a.onCaughtError!==void 0&&(p=a.onCaughtError),a.onRecoverableError!==void 0&&(y=a.onRecoverableError)),a=Sf(t,1,!1,null,null,r,i,null,u,p,y,If),t[X]=a.current,Fu(t),new cm(a)},hi.hydrateRoot=function(t,a,r){if(!d(t))throw Error(l(299));var i=!1,u="",p=Vx,y=$x,S=Fx,H=null;return r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(S=r.onRecoverableError),r.formState!==void 0&&(H=r.formState)),a=Sf(t,1,!0,a,r??null,i,u,H,p,y,S,If),a.context=wf(null),r=a.current,i=os(),i=pt(i),u=Sr(i),u.callback=null,wr(r,u,i),r=i,a.current.lanes=r,Dt(a,r),Is(a),t[X]=a.current,Fu(t),new Gl(a)},hi.version="19.2.0",hi}var Gf;function tS(){if(Gf)return mm.exports;Gf=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(o){console.error(o)}}return s(),mm.exports=eS(),mm.exports}var aS=tS();const io=new WeakMap,ic=new WeakMap,pc={current:[]};let fm=!1,ji=0;const vi=new Set,Kl=new Map;function Xg(s){const o=Array.from(s).sort((n,l)=>n instanceof lo&&n.options.deps.includes(l)?1:l instanceof lo&&l.options.deps.includes(n)?-1:0);for(const n of o){if(pc.current.includes(n))continue;pc.current.push(n),n.recompute();const l=ic.get(n);if(l)for(const d of l){const m=io.get(d);m&&Xg(m)}}}function sS(s){const o={prevVal:s.prevState,currentVal:s.state};for(const n of s.listeners)n(o)}function rS(s){const o={prevVal:s.prevState,currentVal:s.state};for(const n of s.listeners)n(o)}function Qg(s){if(ji>0&&!Kl.has(s)&&Kl.set(s,s.prevState),vi.add(s),!(ji>0)&&!fm)try{for(fm=!0;vi.size>0;){const o=Array.from(vi);vi.clear();for(const n of o){const l=Kl.get(n)??n.prevState;n.prevState=l,sS(n)}for(const n of o){const l=io.get(n);l&&(pc.current.push(n),Xg(l))}for(const n of o){const l=io.get(n);if(l)for(const d of l)rS(d)}}}finally{fm=!1,pc.current=[],Kl.clear()}}function _i(s){ji++;try{s()}finally{if(ji--,ji===0){const o=vi.values().next().value;o&&Qg(o)}}}function nS(s){return typeof s=="function"}class zm{constructor(o,n){this.listeners=new Set,this.subscribe=l=>{var d,m;this.listeners.add(l);const h=(m=(d=this.options)==null?void 0:d.onSubscribe)==null?void 0:m.call(d,l,this);return()=>{this.listeners.delete(l),h?.()}},this.prevState=o,this.state=o,this.options=n}setState(o){var n,l,d;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(o):nS(o)?this.state=o(this.prevState):this.state=o,(d=(l=this.options)==null?void 0:l.onUpdate)==null||d.call(l),Qg(this)}}class lo{constructor(o){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=this.options.deps.length,l=new Array(n),d=new Array(n);for(let m=0;m<n;m++){const h=this.options.deps[m];l[m]=h.prevState,d[m]=h.state}return this.lastSeenDepValues=d,{prevDepVals:l,currDepVals:d,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,l;this.prevState=this.state;const d=this.getDepVals();this.state=this.options.fn(d),(l=(n=this.options).onUpdate)==null||l.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const m of this.options.deps)m instanceof lo&&m.checkIfRecalculationNeededDeeply();let n=!1;const l=this.lastSeenDepValues,{currDepVals:d}=this.getDepVals();for(let m=0;m<d.length;m++)if(d[m]!==l[m]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var l,d;this.listeners.add(n);const m=(d=(l=this.options).onSubscribe)==null?void 0:d.call(l,n,this);return()=>{this.listeners.delete(n),m?.()}},this.options=o,this.state=o.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(o=this.options.deps){for(const n of o)if(n instanceof lo)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof zm){let l=io.get(n);l||(l=new Set,io.set(n,l)),l.add(this);let d=ic.get(this);d||(d=new Set,ic.set(this,d)),d.add(n)}}unregisterFromGraph(o=this.options.deps){for(const n of o)if(n instanceof lo)this.unregisterFromGraph(n.options.deps);else if(n instanceof zm){const l=io.get(n);l&&l.delete(this);const d=ic.get(this);d&&d.delete(n)}}}const Fr="__TSR_index",Wf="popstate",Kf="beforeunload";function oS(s){let o=s.getLocation();const n=new Set,l=h=>{o=s.getLocation(),n.forEach(x=>x({location:o,action:h}))},d=h=>{s.notifyOnIndexChange??!0?l(h):o=s.getLocation()},m=async({task:h,navigateOpts:x,...g})=>{if(x?.ignoreBlocker??!1){h();return}const v=s.getBlockers?.()??[],f=g.type==="PUSH"||g.type==="REPLACE";if(typeof document<"u"&&v.length&&f)for(const N of v){const j=hc(g.path,g.state);if(await N.blockerFn({currentLocation:o,nextLocation:j,action:g.type})){s.onBlocked?.();return}}h()};return{get location(){return o},get length(){return s.getLength()},subscribers:n,subscribe:h=>(n.add(h),()=>{n.delete(h)}),push:(h,x,g)=>{const b=o.state[Fr];x=Yf(b+1,x),m({task:()=>{s.pushState(h,x),l({type:"PUSH"})},navigateOpts:g,type:"PUSH",path:h,state:x})},replace:(h,x,g)=>{const b=o.state[Fr];x=Yf(b,x),m({task:()=>{s.replaceState(h,x),l({type:"REPLACE"})},navigateOpts:g,type:"REPLACE",path:h,state:x})},go:(h,x)=>{m({task:()=>{s.go(h),d({type:"GO",index:h})},navigateOpts:x,type:"GO"})},back:h=>{m({task:()=>{s.back(h?.ignoreBlocker??!1),d({type:"BACK"})},navigateOpts:h,type:"BACK"})},forward:h=>{m({task:()=>{s.forward(h?.ignoreBlocker??!1),d({type:"FORWARD"})},navigateOpts:h,type:"FORWARD"})},canGoBack:()=>o.state[Fr]!==0,createHref:h=>s.createHref(h),block:h=>{if(!s.setBlockers)return()=>{};const x=s.getBlockers?.()??[];return s.setBlockers([...x,h]),()=>{const g=s.getBlockers?.()??[];s.setBlockers?.(g.filter(b=>b!==h))}},flush:()=>s.flush?.(),destroy:()=>s.destroy?.(),notify:l}}function Yf(s,o){o||(o={});const n=np();return{...o,key:n,__TSR_key:n,[Fr]:s}}function iS(s){const o=typeof document<"u"?window:void 0,n=o.history.pushState,l=o.history.replaceState;let d=[];const m=()=>d,h=T=>d=T,x=(T=>T),g=(()=>hc(`${o.location.pathname}${o.location.search}${o.location.hash}`,o.history.state));if(!o.history.state?.__TSR_key&&!o.history.state?.key){const T=np();o.history.replaceState({[Fr]:0,key:T,__TSR_key:T},"")}let b=g(),v,f=!1,N=!1,j=!1,_=!1;const w=()=>b;let C,E;const z=()=>{C&&(O._ignoreSubscribers=!0,(C.isPush?o.history.pushState:o.history.replaceState)(C.state,"",C.href),O._ignoreSubscribers=!1,C=void 0,E=void 0,v=void 0)},P=(T,ge,J)=>{const W=x(ge);E||(v=b),b=hc(ge,J),C={href:W,state:J,isPush:C?.isPush||T==="push"},E||(E=Promise.resolve().then(()=>z()))},V=T=>{b=g(),O.notify({type:T})},Z=async()=>{if(N){N=!1;return}const T=g(),ge=T.state[Fr]-b.state[Fr],J=ge===1,W=ge===-1,ne=!J&&!W||f;f=!1;const Ee=ne?"GO":W?"BACK":"FORWARD",Ce=ne?{type:"GO",index:ge}:{type:W?"BACK":"FORWARD"};if(j)j=!1;else{const Le=m();if(typeof document<"u"&&Le.length){for(const I of Le)if(await I.blockerFn({currentLocation:b,nextLocation:T,action:Ee})){N=!0,o.history.go(1),O.notify(Ce);return}}}b=g(),O.notify(Ce)},oe=T=>{if(_){_=!1;return}let ge=!1;const J=m();if(typeof document<"u"&&J.length)for(const W of J){const ne=W.enableBeforeUnload??!0;if(ne===!0){ge=!0;break}if(typeof ne=="function"&&ne()===!0){ge=!0;break}}if(ge)return T.preventDefault(),T.returnValue=""},O=oS({getLocation:w,getLength:()=>o.history.length,pushState:(T,ge)=>P("push",T,ge),replaceState:(T,ge)=>P("replace",T,ge),back:T=>(T&&(j=!0),_=!0,o.history.back()),forward:T=>{T&&(j=!0),_=!0,o.history.forward()},go:T=>{f=!0,o.history.go(T)},createHref:T=>x(T),flush:z,destroy:()=>{o.history.pushState=n,o.history.replaceState=l,o.removeEventListener(Kf,oe,{capture:!0}),o.removeEventListener(Wf,Z)},onBlocked:()=>{v&&b!==v&&(b=v)},getBlockers:m,setBlockers:h,notifyOnIndexChange:!1});return o.addEventListener(Kf,oe,{capture:!0}),o.addEventListener(Wf,Z),o.history.pushState=function(...T){const ge=n.apply(o.history,T);return O._ignoreSubscribers||V("PUSH"),ge},o.history.replaceState=function(...T){const ge=l.apply(o.history,T);return O._ignoreSubscribers||V("REPLACE"),ge},O}function hc(s,o){const n=s.indexOf("#"),l=s.indexOf("?"),d=np();return{href:s,pathname:s.substring(0,n>0?l>0?Math.min(n,l):n:l>0?l:s.length),hash:n>-1?s.substring(n):"",search:l>-1?s.slice(l,n===-1?void 0:n):"",state:o||{[Fr]:0,key:d,__TSR_key:d}}}function np(){return(Math.random()+1).toString(36).substring(7)}function qm(s){return s[s.length-1]}function lS(s){return typeof s=="function"}function pn(s,o){return lS(s)?s(o):s}const cS=Object.prototype.hasOwnProperty;function ys(s,o){if(s===o)return s;const n=o,l=Zf(s)&&Zf(n);if(!l&&!(xc(s)&&xc(n)))return n;const d=l?s:Xf(s);if(!d)return n;const m=l?n:Xf(n);if(!m)return n;const h=d.length,x=m.length,g=l?new Array(x):{};let b=0;for(let v=0;v<x;v++){const f=l?v:m[v],N=s[f],j=n[f];if(N===j){g[f]=N,(l?v<h:cS.call(s,f))&&b++;continue}if(N===null||j===null||typeof N!="object"||typeof j!="object"){g[f]=j;continue}const _=ys(N,j);g[f]=_,_===N&&b++}return h===x&&b===h?s:g}function Xf(s){const o=[],n=Object.getOwnPropertyNames(s);for(const d of n){if(!Object.prototype.propertyIsEnumerable.call(s,d))return!1;o.push(d)}const l=Object.getOwnPropertySymbols(s);for(const d of l){if(!Object.prototype.propertyIsEnumerable.call(s,d))return!1;o.push(d)}return o}function xc(s){if(!Qf(s))return!1;const o=s.constructor;if(typeof o>"u")return!0;const n=o.prototype;return!(!Qf(n)||!n.hasOwnProperty("isPrototypeOf"))}function Qf(s){return Object.prototype.toString.call(s)==="[object Object]"}function Zf(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function hn(s,o,n){if(s===o)return!0;if(typeof s!=typeof o)return!1;if(Array.isArray(s)&&Array.isArray(o)){if(s.length!==o.length)return!1;for(let l=0,d=s.length;l<d;l++)if(!hn(s[l],o[l],n))return!1;return!0}if(xc(s)&&xc(o)){const l=n?.ignoreUndefined??!0;if(n?.partial){for(const h in o)if((!l||o[h]!==void 0)&&!hn(s[h],o[h],n))return!1;return!0}let d=0;if(!l)d=Object.keys(s).length;else for(const h in s)s[h]!==void 0&&d++;let m=0;for(const h in o)if((!l||o[h]!==void 0)&&(m++,m>d||!hn(s[h],o[h],n)))return!1;return d===m}return!1}function po(s){let o,n;const l=new Promise((d,m)=>{o=d,n=m});return l.status="pending",l.resolve=d=>{l.status="resolved",l.value=d,o(d),s?.(d)},l.reject=d=>{l.status="rejected",n(d)},l}function Hr(s){return!!(s&&typeof s=="object"&&typeof s.then=="function")}var dS="Invariant failed";function mr(s,o){if(!s)throw new Error(dS)}const Ja="__root__",qs=0,fn=1,ho=2,xo=3;function ur(s){return op(s.filter(o=>o!==void 0).join("/"))}function op(s){return s.replace(/\/{2,}/g,"/")}function ip(s){return s==="/"?s:s.replace(/^\/{1,}/,"")}function Gr(s){return s==="/"?s:s.replace(/\/{1,}$/,"")}function lc(s){return Gr(ip(s))}function fc(s,o){return s?.endsWith("/")&&s!=="/"&&s!==`${o}/`?s.slice(0,-1):s}function uS(s,o,n){return fc(s,n)===fc(o,n)}function mS(s){const{type:o,value:n}=s;if(o===qs)return n;const{prefixSegment:l,suffixSegment:d}=s;if(o===fn){const m=n.substring(1);if(l&&d)return`${l}{$${m}}${d}`;if(l)return`${l}{$${m}}`;if(d)return`{$${m}}${d}`}if(o===xo){const m=n.substring(1);return l&&d?`${l}{-$${m}}${d}`:l?`${l}{-$${m}}`:d?`{-$${m}}${d}`:`{-$${m}}`}if(o===ho){if(l&&d)return`${l}{$}${d}`;if(l)return`${l}{$}`;if(d)return`{$}${d}`}return n}function pS({base:s,to:o,trailingSlash:n="never",parseCache:l}){let d=Zg(s,l).slice();const m=kc(o,l);d.length>1&&qm(d)?.value==="/"&&d.pop();for(let g=0,b=m.length;g<b;g++){const v=m[g],f=v.value;f==="/"?g?g===b-1&&d.push(v):d=[v]:f===".."?d.pop():f==="."||d.push(v)}d.length>1&&(qm(d).value==="/"?n==="never"&&d.pop():n==="always"&&d.push({type:qs,value:"/"}));const h=d.map(mS);return ur(h)}const Zg=(s,o)=>Jg(s,o,!0),kc=(s,o)=>Jg(s,o,!1),Jg=(s,o,n)=>{if(!s)return[];const l=o?.get(s);if(l)return l;const d=vS(s,n);return o?.set(s,d),d},hS=/^\$.{1,}$/,xS=/^(.*?)\{(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,fS=/^(.*?)\{-(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,gS=/^\$$/,bS=/^(.*?)\{\$\}(.*)$/;function vS(s,o){s=op(s);const n=[];if(s.slice(0,1)==="/"&&(s=s.substring(1),n.push({type:qs,value:"/"})),!s)return n;const l=s.split("/").filter(Boolean);return n.push(...l.map(d=>{const m=!o&&d!==Ja&&d.slice(-1)==="_"?d.slice(0,-1):d,h=m.match(bS);if(h){const b=h[1],v=h[2];return{type:ho,value:"$",prefixSegment:b||void 0,suffixSegment:v||void 0}}const x=m.match(fS);if(x){const b=x[1],v=x[2],f=x[3];return{type:xo,value:v,prefixSegment:b||void 0,suffixSegment:f||void 0}}const g=m.match(xS);if(g){const b=g[1],v=g[2],f=g[3];return{type:fn,value:""+v,prefixSegment:b||void 0,suffixSegment:f||void 0}}if(hS.test(m)){const b=m.substring(1);return{type:fn,value:"$"+b,prefixSegment:void 0,suffixSegment:void 0}}return gS.test(m)?{type:ho,value:"$",prefixSegment:void 0,suffixSegment:void 0}:{type:qs,value:m.includes("%25")?m.split("%25").map(b=>decodeURI(b)).join("%25"):decodeURI(m)}})),s.slice(-1)==="/"&&(s=s.substring(1),n.push({type:qs,value:"/"})),n}function Yl({path:s,params:o,leaveWildcards:n,leaveParams:l,decodeCharMap:d,parseCache:m}){const h=kc(s,m);function x(f){const N=o[f],j=typeof N=="string";return f==="*"||f==="_splat"?j?encodeURI(N):N:j?yS(N,d):N}let g=!1;const b={},v=ur(h.map(f=>{if(f.type===qs)return f.value;if(f.type===ho){b._splat=o._splat,b["*"]=o._splat;const N=f.prefixSegment||"",j=f.suffixSegment||"";if(!("_splat"in o))return g=!0,n?`${N}${f.value}${j}`:N||j?`${N}${j}`:void 0;const _=x("_splat");return n?`${N}${f.value}${_??""}${j}`:`${N}${_}${j}`}if(f.type===fn){const N=f.value.substring(1);!g&&!(N in o)&&(g=!0),b[N]=o[N];const j=f.prefixSegment||"",_=f.suffixSegment||"";if(l){const w=x(f.value);return`${j}${f.value}${w??""}${_}`}return`${j}${x(N)??"undefined"}${_}`}if(f.type===xo){const N=f.value.substring(1),j=f.prefixSegment||"",_=f.suffixSegment||"";if(!(N in o)||o[N]==null)return n?`${j}${N}${_}`:j||_?`${j}${_}`:void 0;if(b[N]=o[N],l){const w=x(f.value);return`${j}${f.value}${w??""}${_}`}return n?`${j}${N}${x(N)??""}${_}`:`${j}${x(N)??""}${_}`}return f.value}));return{usedParams:b,interpolatedPath:v,isMissingParams:g}}function yS(s,o){let n=encodeURIComponent(s);if(o)for(const[l,d]of o)n=n.replaceAll(l,d);return n}function Um(s,o,n){const l=NS(s,o,n);if(!(o.to&&!l))return l??{}}function NS(s,{to:o,fuzzy:n,caseSensitive:l},d){const m=o,h=Zg(s.startsWith("/")?s:`/${s}`,d),x=kc(m.startsWith("/")?m:`/${m}`,d),g={};return jS(h,x,g,n,l)?g:void 0}function jS(s,o,n,l,d){let m=0,h=0;for(;m<s.length||h<o.length;){const x=s[m],g=o[h];if(g){if(g.type===ho){const b=s.slice(m);let v;if(g.prefixSegment||g.suffixSegment){if(!x)return!1;const f=g.prefixSegment||"",N=g.suffixSegment||"",j=x.value;if("prefixSegment"in g&&!j.startsWith(f)||"suffixSegment"in g&&!s[s.length-1]?.value.endsWith(N))return!1;let _=decodeURI(ur(b.map(w=>w.value)));f&&_.startsWith(f)&&(_=_.slice(f.length)),N&&_.endsWith(N)&&(_=_.slice(0,_.length-N.length)),v=_}else v=decodeURI(ur(b.map(f=>f.value)));return n["*"]=v,n._splat=v,!0}if(g.type===qs){if(g.value==="/"&&!x?.value){h++;continue}if(x){if(d){if(g.value!==x.value)return!1}else if(g.value.toLowerCase()!==x.value.toLowerCase())return!1;m++,h++;continue}else return!1}if(g.type===fn){if(!x||x.value==="/")return!1;let b="",v=!1;if(g.prefixSegment||g.suffixSegment){const f=g.prefixSegment||"",N=g.suffixSegment||"",j=x.value;if(f&&!j.startsWith(f)||N&&!j.endsWith(N))return!1;let _=j;f&&_.startsWith(f)&&(_=_.slice(f.length)),N&&_.endsWith(N)&&(_=_.slice(0,_.length-N.length)),b=decodeURIComponent(_),v=!0}else b=decodeURIComponent(x.value),v=!0;v&&(n[g.value.substring(1)]=b,m++),h++;continue}if(g.type===xo){if(!x){h++;continue}if(x.value==="/"){h++;continue}let b="",v=!1;if(g.prefixSegment||g.suffixSegment){const f=g.prefixSegment||"",N=g.suffixSegment||"",j=x.value;if((!f||j.startsWith(f))&&(!N||j.endsWith(N))){let _=j;f&&_.startsWith(f)&&(_=_.slice(f.length)),N&&_.endsWith(N)&&(_=_.slice(0,_.length-N.length)),b=decodeURIComponent(_),v=!0}}else{let f=!0;for(let N=h+1;N<o.length;N++){const j=o[N];if(j?.type===qs&&j.value===x.value){f=!1;break}if(j?.type===fn||j?.type===ho){s.length<o.length&&(f=!1);break}}f&&(b=decodeURIComponent(x.value),v=!0)}v&&(n[g.value.substring(1)]=b,m++),h++;continue}}if(m<s.length&&h>=o.length)return n["**"]=ur(s.slice(m).map(b=>b.value)),!!l&&o[o.length-1]?.value!=="/";if(h<o.length&&m>=s.length){for(let b=h;b<o.length;b++)if(o[b]?.type!==xo)return!1;break}break}return!0}const _S=.75,SS=1,wS=.5,TS=.4,AS=.25,CS=.2,kS=.05,ES=.02,RS=.01,Jf=2e-4,eg=1e-4;function tg(s,o){return s.prefixSegment&&s.suffixSegment?o+kS+Jf*s.prefixSegment.length+eg*s.suffixSegment.length:s.prefixSegment?o+ES+Jf*s.prefixSegment.length:s.suffixSegment?o+RS+eg*s.suffixSegment.length:o}function LS(s){const o=[];return s.forEach((l,d)=>{if(l.isRoot||!l.path)return;const m=ip(l.fullPath);let h=kc(m),x=0;for(;h.length>x+1&&h[x]?.value==="/";)x++;x>0&&(h=h.slice(x));let g=0,b=!1;const v=h.map((f,N)=>{if(f.value==="/")return _S;if(f.type===qs)return SS;let j;f.type===fn?j=wS:f.type===xo?(j=TS,g++):j=AS;for(let _=N+1;_<h.length;_++){const w=h[_];if(w.type===qs&&w.value!=="/")return b=!0,tg(f,j+CS)}return tg(f,j)});o.push({child:l,trimmed:m,parsed:h,index:d,scores:v,optionalParamCount:g,hasStaticAfter:b})}),o.sort((l,d)=>{const m=Math.min(l.scores.length,d.scores.length);for(let h=0;h<m;h++)if(l.scores[h]!==d.scores[h])return d.scores[h]-l.scores[h];if(l.scores.length!==d.scores.length){if(l.optionalParamCount!==d.optionalParamCount){if(l.hasStaticAfter===d.hasStaticAfter)return l.optionalParamCount-d.optionalParamCount;if(l.hasStaticAfter&&!d.hasStaticAfter)return-1;if(!l.hasStaticAfter&&d.hasStaticAfter)return 1}return d.scores.length-l.scores.length}for(let h=0;h<m;h++)if(l.parsed[h].value!==d.parsed[h].value)return l.parsed[h].value>d.parsed[h].value?1:-1;return l.index-d.index}).map((l,d)=>(l.child.rank=d,l.child))}function PS({routeTree:s,initRoute:o}){const n={},l={},d=h=>{h.forEach((x,g)=>{o?.(x,g);const b=n[x.id];if(mr(!b,`Duplicate routes found with id: ${String(x.id)}`),n[x.id]=x,!x.isRoot&&x.path){const f=Gr(x.fullPath);(!l[f]||x.fullPath.endsWith("/"))&&(l[f]=x)}const v=x.children;v?.length&&d(v)})};d([s]);const m=LS(Object.values(n));return{routesById:n,routesByPath:l,flatRoutes:m}}function Vs(s){return!!s?.isNotFound}function MS(){try{if(typeof window<"u"&&typeof window.sessionStorage=="object")return window.sessionStorage}catch{}}const gc="tsr-scroll-restoration-v1_3",IS=(s,o)=>{let n;return(...l)=>{n||(n=setTimeout(()=>{s(...l),n=null},o))}};function OS(){const s=MS();if(!s)return null;const o=s.getItem(gc);let n=o?JSON.parse(o):{};return{state:n,set:l=>(n=pn(l,n)||n,s.setItem(gc,JSON.stringify(n)))}}const Xl=OS(),Bm=s=>s.state.__TSR_key||s.href;function DS(s){const o=[];let n;for(;n=s.parentNode;)o.push(`${s.tagName}:nth-child(${Array.prototype.indexOf.call(n.children,s)+1})`),s=n;return`${o.reverse().join(" > ")}`.toLowerCase()}let bc=!1;function eb({storageKey:s,key:o,behavior:n,shouldScrollRestoration:l,scrollToTopSelectors:d,location:m}){let h;try{h=JSON.parse(sessionStorage.getItem(s)||"{}")}catch(b){console.error(b);return}const x=o||window.history.state?.__TSR_key,g=h[x];bc=!0;e:{if(l&&g&&Object.keys(g).length>0){for(const f in g){const N=g[f];if(f==="window")window.scrollTo({top:N.scrollY,left:N.scrollX,behavior:n});else if(f){const j=document.querySelector(f);j&&(j.scrollLeft=N.scrollX,j.scrollTop=N.scrollY)}}break e}const b=(m??window.location).hash.split("#",2)[1];if(b){const f=window.history.state?.__hashScrollIntoViewOptions??!0;if(f){const N=document.getElementById(b);N&&N.scrollIntoView(f)}break e}const v={top:0,left:0,behavior:n};if(window.scrollTo(v),d)for(const f of d){if(f==="window")continue;const N=typeof f=="function"?f():document.querySelector(f);N&&N.scrollTo(v)}}bc=!1}function zS(s,o){if(!Xl&&!s.isServer||((s.options.scrollRestoration??!1)&&(s.isScrollRestoring=!0),s.isServer||s.isScrollRestorationSetup||!Xl))return;s.isScrollRestorationSetup=!0,bc=!1;const l=s.options.getScrollRestorationKey||Bm;window.history.scrollRestoration="manual";const d=m=>{if(bc||!s.isScrollRestoring)return;let h="";if(m.target===document||m.target===window)h="window";else{const g=m.target.getAttribute("data-scroll-restoration-id");g?h=`[data-scroll-restoration-id="${g}"]`:h=DS(m.target)}const x=l(s.state.location);Xl.set(g=>{const b=g[x]||={},v=b[h]||={};if(h==="window")v.scrollX=window.scrollX||0,v.scrollY=window.scrollY||0;else if(h){const f=document.querySelector(h);f&&(v.scrollX=f.scrollLeft||0,v.scrollY=f.scrollTop||0)}return g})};typeof document<"u"&&document.addEventListener("scroll",IS(d,100),!0),s.subscribe("onRendered",m=>{const h=l(m.toLocation);if(!s.resetNextScroll){s.resetNextScroll=!0;return}typeof s.options.scrollRestoration=="function"&&!s.options.scrollRestoration({location:s.latestLocation})||(eb({storageKey:gc,key:h,behavior:s.options.scrollRestorationBehavior,shouldScrollRestoration:s.isScrollRestoring,scrollToTopSelectors:s.options.scrollToTopSelectors,location:s.history.location}),s.isScrollRestoring&&Xl.set(x=>(x[h]||={},x)))})}function qS(s){if(typeof document<"u"&&document.querySelector){const o=s.state.location.state.__hashScrollIntoViewOptions??!0;if(o&&s.state.location.hash!==""){const n=document.getElementById(s.state.location.hash);n&&n.scrollIntoView(o)}}}function US(s,o=String){const n=new URLSearchParams;for(const l in s){const d=s[l];d!==void 0&&n.set(l,o(d))}return n.toString()}function gm(s){return s?s==="false"?!1:s==="true"?!0:+s*0===0&&+s+""===s?+s:s:""}function BS(s){const o=new URLSearchParams(s),n={};for(const[l,d]of o.entries()){const m=n[l];m==null?n[l]=gm(d):Array.isArray(m)?m.push(gm(d)):n[l]=[m,gm(d)]}return n}const VS=FS(JSON.parse),$S=HS(JSON.stringify,JSON.parse);function FS(s){return o=>{o[0]==="?"&&(o=o.substring(1));const n=BS(o);for(const l in n){const d=n[l];if(typeof d=="string")try{n[l]=s(d)}catch{}}return n}}function HS(s,o){const n=typeof o=="function";function l(d){if(typeof d=="object"&&d!==null)try{return s(d)}catch{}else if(n&&typeof d=="string")try{return o(d),s(d)}catch{}return d}return d=>{const m=US(d,l);return m?`?${m}`:""}}function GS(s){if(s.statusCode=s.statusCode||s.code||307,!s.reloadDocument&&typeof s.href=="string")try{new URL(s.href),s.reloadDocument=!0}catch{}const o=new Headers(s.headers);s.href&&o.get("Location")===null&&o.set("Location",s.href);const n=new Response(null,{status:s.statusCode,headers:o});if(n.options=s,s.throw)throw n;return n}function Ds(s){return s instanceof Response&&!!s.options}function WS(s){const o=new Map;let n,l;const d=m=>{m.next&&(m.prev?(m.prev.next=m.next,m.next.prev=m.prev,m.next=void 0,l&&(l.next=m,m.prev=l)):(m.next.prev=void 0,n=m.next,m.next=void 0,l&&(m.prev=l,l.next=m)),l=m)};return{get(m){const h=o.get(m);if(h)return d(h),h.value},set(m,h){if(o.size>=s&&n){const g=n;o.delete(g.key),g.next&&(n=g.next,g.next.prev=void 0),g===l&&(l=void 0)}const x=o.get(m);if(x)x.value=h,d(x);else{const g={key:m,value:h,prev:l};l&&(l.next=g),l=g,n||(n=g),o.set(m,g)}}}}const cc=s=>{if(!s.rendered)return s.rendered=!0,s.onReady?.()},Ec=(s,o)=>!!(s.preload&&!s.router.state.matches.some(n=>n.id===o)),tb=(s,o)=>{const n=s.router.routesById[o.routeId??""]??s.router.routeTree;!n.options.notFoundComponent&&s.router.options?.defaultNotFoundComponent&&(n.options.notFoundComponent=s.router.options.defaultNotFoundComponent),mr(n.options.notFoundComponent);const l=s.matches.find(d=>d.routeId===n.id);mr(l,"Could not find match for route: "+n.id),s.updateMatch(l.id,d=>({...d,status:"notFound",error:o,isFetching:!1})),o.routerCode==="BEFORE_LOAD"&&n.parentRoute&&(o.routeId=n.parentRoute.id,tb(s,o))},$r=(s,o,n)=>{if(!(!Ds(n)&&!Vs(n))){if(Ds(n)&&n.redirectHandled&&!n.options.reloadDocument)throw n;if(o){o._nonReactive.beforeLoadPromise?.resolve(),o._nonReactive.loaderPromise?.resolve(),o._nonReactive.beforeLoadPromise=void 0,o._nonReactive.loaderPromise=void 0;const l=Ds(n)?"redirected":"notFound";s.updateMatch(o.id,d=>({...d,status:l,isFetching:!1,error:n})),Vs(n)&&!n.routeId&&(n.routeId=o.routeId),o._nonReactive.loadPromise?.resolve()}throw Ds(n)?(s.rendered=!0,n.options._fromLocation=s.location,n.redirectHandled=!0,n=s.router.resolveRedirect(n),n):(tb(s,n),n)}},ab=(s,o)=>{const n=s.router.getMatch(o);return!!(!s.router.isServer&&n._nonReactive.dehydrated||s.router.isServer&&n.ssr===!1)},xi=(s,o,n,l)=>{const{id:d,routeId:m}=s.matches[o],h=s.router.looseRoutesById[m];if(n instanceof Promise)throw n;n.routerCode=l,s.firstBadMatchIndex??=o,$r(s,s.router.getMatch(d),n);try{h.options.onError?.(n)}catch(x){n=x,$r(s,s.router.getMatch(d),n)}s.updateMatch(d,x=>(x._nonReactive.beforeLoadPromise?.resolve(),x._nonReactive.beforeLoadPromise=void 0,x._nonReactive.loadPromise?.resolve(),{...x,error:n,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController}))},KS=(s,o,n,l)=>{const d=s.router.getMatch(o),m=s.matches[n-1]?.id,h=m?s.router.getMatch(m):void 0;if(s.router.isShell()){d.ssr=o===Ja;return}if(h?.ssr===!1){d.ssr=!1;return}const x=j=>j===!0&&h?.ssr==="data-only"?"data-only":j,g=s.router.options.defaultSsr??!0;if(l.options.ssr===void 0){d.ssr=x(g);return}if(typeof l.options.ssr!="function"){d.ssr=x(l.options.ssr);return}const{search:b,params:v}=d,f={search:Ql(b,d.searchError),params:Ql(v,d.paramsError),location:s.location,matches:s.matches.map(j=>({index:j.index,pathname:j.pathname,fullPath:j.fullPath,staticData:j.staticData,id:j.id,routeId:j.routeId,search:Ql(j.search,j.searchError),params:Ql(j.params,j.paramsError),ssr:j.ssr}))},N=l.options.ssr(f);if(Hr(N))return N.then(j=>{d.ssr=x(j??g)});d.ssr=x(N??g)},sb=(s,o,n,l)=>{if(l._nonReactive.pendingTimeout!==void 0)return;const d=n.options.pendingMs??s.router.options.defaultPendingMs;if(!!(s.onReady&&!s.router.isServer&&!Ec(s,o)&&(n.options.loader||n.options.beforeLoad||ob(n))&&typeof d=="number"&&d!==1/0&&(n.options.pendingComponent??s.router.options?.defaultPendingComponent))){const h=setTimeout(()=>{cc(s)},d);l._nonReactive.pendingTimeout=h}},YS=(s,o,n)=>{const l=s.router.getMatch(o);if(!l._nonReactive.beforeLoadPromise&&!l._nonReactive.loaderPromise)return;sb(s,o,n,l);const d=()=>{const m=s.router.getMatch(o);m.preload&&(m.status==="redirected"||m.status==="notFound")&&$r(s,m,m.error)};return l._nonReactive.beforeLoadPromise?l._nonReactive.beforeLoadPromise.then(d):d()},XS=(s,o,n,l)=>{const d=s.router.getMatch(o),m=d._nonReactive.loadPromise;d._nonReactive.loadPromise=po(()=>{m?.resolve()});const{paramsError:h,searchError:x}=d;h&&xi(s,n,h,"PARSE_PARAMS"),x&&xi(s,n,x,"VALIDATE_SEARCH"),sb(s,o,l,d);const g=new AbortController,b=s.matches[n-1]?.id,N={...(b?s.router.getMatch(b):void 0)?.context??s.router.options.context??void 0,...d.__routeContext};let j=!1;const _=()=>{j||(j=!0,s.updateMatch(o,O=>({...O,isFetching:"beforeLoad",fetchCount:O.fetchCount+1,abortController:g,context:N})))},w=()=>{d._nonReactive.beforeLoadPromise?.resolve(),d._nonReactive.beforeLoadPromise=void 0,s.updateMatch(o,O=>({...O,isFetching:!1}))};if(!l.options.beforeLoad){_i(()=>{_(),w()});return}d._nonReactive.beforeLoadPromise=po();const{search:C,params:E,cause:z}=d,P=Ec(s,o),V={search:C,abortController:g,params:E,preload:P,context:N,location:s.location,navigate:O=>s.router.navigate({...O,_fromLocation:s.location}),buildLocation:s.router.buildLocation,cause:P?"preload":z,matches:s.matches,...s.router.options.additionalContext},Z=O=>{if(O===void 0){_i(()=>{_(),w()});return}(Ds(O)||Vs(O))&&(_(),xi(s,n,O,"BEFORE_LOAD")),_i(()=>{_(),s.updateMatch(o,T=>({...T,__beforeLoadContext:O,context:{...T.context,...O}})),w()})};let oe;try{if(oe=l.options.beforeLoad(V),Hr(oe))return _(),oe.catch(O=>{xi(s,n,O,"BEFORE_LOAD")}).then(Z)}catch(O){_(),xi(s,n,O,"BEFORE_LOAD")}Z(oe)},QS=(s,o)=>{const{id:n,routeId:l}=s.matches[o],d=s.router.looseRoutesById[l],m=()=>{if(s.router.isServer){const g=KS(s,n,o,d);if(Hr(g))return g.then(x)}return x()},h=()=>XS(s,n,o,d),x=()=>{if(ab(s,n))return;const g=YS(s,n,d);return Hr(g)?g.then(h):h()};return m()},Si=(s,o,n)=>{const l=s.router.getMatch(o);if(!l||!n.options.head&&!n.options.scripts&&!n.options.headers)return;const d={matches:s.matches,match:l,params:l.params,loaderData:l.loaderData};return Promise.all([n.options.head?.(d),n.options.scripts?.(d),n.options.headers?.(d)]).then(([m,h,x])=>{const g=m?.meta,b=m?.links,v=m?.scripts,f=m?.styles;return{meta:g,links:b,headScripts:v,headers:x,scripts:h,styles:f}})},rb=(s,o,n,l)=>{const d=s.matchPromises[n-1],{params:m,loaderDeps:h,abortController:x,context:g,cause:b}=s.router.getMatch(o),v=Ec(s,o);return{params:m,deps:h,preload:!!v,parentMatchPromise:d,abortController:x,context:g,location:s.location,navigate:f=>s.router.navigate({...f,_fromLocation:s.location}),cause:v?"preload":b,route:l,...s.router.options.additionalContext}},ag=async(s,o,n,l)=>{try{const d=s.router.getMatch(o);try{(!s.router.isServer||d.ssr===!0)&&nb(l);const m=l.options.loader?.(rb(s,o,n,l)),h=l.options.loader&&Hr(m);if(!!(h||l._lazyPromise||l._componentsPromise||l.options.head||l.options.scripts||l.options.headers||d._nonReactive.minPendingPromise)&&s.updateMatch(o,f=>({...f,isFetching:"loader"})),l.options.loader){const f=h?await m:m;$r(s,s.router.getMatch(o),f),f!==void 0&&s.updateMatch(o,N=>({...N,loaderData:f}))}l._lazyPromise&&await l._lazyPromise;const g=Si(s,o,l),b=g?await g:void 0,v=d._nonReactive.minPendingPromise;v&&await v,l._componentsPromise&&await l._componentsPromise,s.updateMatch(o,f=>({...f,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),...b}))}catch(m){let h=m;const x=d._nonReactive.minPendingPromise;x&&await x,$r(s,s.router.getMatch(o),m);try{l.options.onError?.(m)}catch(v){h=v,$r(s,s.router.getMatch(o),v)}const g=Si(s,o,l),b=g?await g:void 0;s.updateMatch(o,v=>({...v,error:h,status:"error",isFetching:!1,...b}))}}catch(d){const m=s.router.getMatch(o);if(m){const h=Si(s,o,l);if(h){const x=await h;s.updateMatch(o,g=>({...g,...x}))}m._nonReactive.loaderPromise=void 0}$r(s,m,d)}},ZS=async(s,o)=>{const{id:n,routeId:l}=s.matches[o];let d=!1,m=!1;const h=s.router.looseRoutesById[l];if(ab(s,n)){if(s.router.isServer){const b=Si(s,n,h);if(b){const v=await b;s.updateMatch(n,f=>({...f,...v}))}return s.router.getMatch(n)}}else{const b=s.router.getMatch(n);if(b._nonReactive.loaderPromise){if(b.status==="success"&&!s.sync&&!b.preload)return b;await b._nonReactive.loaderPromise;const v=s.router.getMatch(n);v.error&&$r(s,v,v.error)}else{const v=Date.now()-b.updatedAt,f=Ec(s,n),N=f?h.options.preloadStaleTime??s.router.options.defaultPreloadStaleTime??3e4:h.options.staleTime??s.router.options.defaultStaleTime??0,j=h.options.shouldReload,_=typeof j=="function"?j(rb(s,n,o,h)):j,w=!!f&&!s.router.state.matches.some(P=>P.id===n),C=s.router.getMatch(n);C._nonReactive.loaderPromise=po(),w!==C.preload&&s.updateMatch(n,P=>({...P,preload:w}));const{status:E,invalid:z}=C;if(d=E==="success"&&(z||(_??v>N)),!(f&&h.options.preload===!1))if(d&&!s.sync)m=!0,(async()=>{try{await ag(s,n,o,h);const P=s.router.getMatch(n);P._nonReactive.loaderPromise?.resolve(),P._nonReactive.loadPromise?.resolve(),P._nonReactive.loaderPromise=void 0}catch(P){Ds(P)&&await s.router.navigate(P.options)}})();else if(E!=="success"||d&&s.sync)await ag(s,n,o,h);else{const P=Si(s,n,h);if(P){const V=await P;s.updateMatch(n,Z=>({...Z,...V}))}}}}const x=s.router.getMatch(n);m||(x._nonReactive.loaderPromise?.resolve(),x._nonReactive.loadPromise?.resolve()),clearTimeout(x._nonReactive.pendingTimeout),x._nonReactive.pendingTimeout=void 0,m||(x._nonReactive.loaderPromise=void 0),x._nonReactive.dehydrated=void 0;const g=m?x.isFetching:!1;return g!==x.isFetching||x.invalid!==!1?(s.updateMatch(n,b=>({...b,isFetching:g,invalid:!1})),s.router.getMatch(n)):x};async function sg(s){const o=Object.assign(s,{matchPromises:[]});!o.router.isServer&&o.router.state.matches.some(n=>n._forcePending)&&cc(o);try{for(let d=0;d<o.matches.length;d++){const m=QS(o,d);Hr(m)&&await m}const n=o.firstBadMatchIndex??o.matches.length;for(let d=0;d<n;d++)o.matchPromises.push(ZS(o,d));await Promise.all(o.matchPromises);const l=cc(o);Hr(l)&&await l}catch(n){if(Vs(n)&&!o.preload){const l=cc(o);throw Hr(l)&&await l,n}if(Ds(n))throw n}return o.matches}async function nb(s){if(!s._lazyLoaded&&s._lazyPromise===void 0&&(s.lazyFn?s._lazyPromise=s.lazyFn().then(o=>{const{id:n,...l}=o.options;Object.assign(s.options,l),s._lazyLoaded=!0,s._lazyPromise=void 0}):s._lazyLoaded=!0),!s._componentsLoaded&&s._componentsPromise===void 0){const o=()=>{const n=[];for(const l of ib){const d=s.options[l]?.preload;d&&n.push(d())}if(n.length)return Promise.all(n).then(()=>{s._componentsLoaded=!0,s._componentsPromise=void 0});s._componentsLoaded=!0,s._componentsPromise=void 0};s._componentsPromise=s._lazyPromise?s._lazyPromise.then(o):o()}return s._componentsPromise}function Ql(s,o){return o?{status:"error",error:o}:{status:"success",value:s}}function ob(s){for(const o of ib)if(s.options[o]?.preload)return!0;return!1}const ib=["component","errorComponent","pendingComponent","notFoundComponent"];function JS(s){return{input:({url:o})=>{for(const n of s)o=lb(n,o);return o},output:({url:o})=>{for(let n=s.length-1;n>=0;n--)o=cb(s[n],o);return o}}}function ew(s){const o=lc(s.basepath),n=`/${o}`,l=`${n}/`,d=s.caseSensitive?n:n.toLowerCase(),m=s.caseSensitive?l:l.toLowerCase();return{input:({url:h})=>{const x=s.caseSensitive?h.pathname:h.pathname.toLowerCase();return x===d?h.pathname="/":x.startsWith(m)&&(h.pathname=h.pathname.slice(n.length)),h},output:({url:h})=>(h.pathname=ur(["/",o,h.pathname]),h)}}function lb(s,o){const n=s?.input?.({url:o});if(n){if(typeof n=="string")return new URL(n);if(n instanceof URL)return n}return o}function cb(s,o){const n=s?.output?.({url:o});if(n){if(typeof n=="string")return new URL(n);if(n instanceof URL)return n}return o}function xn(s){const o=s.resolvedLocation,n=s.location,l=o?.pathname!==n.pathname,d=o?.href!==n.href,m=o?.hash!==n.hash;return{fromLocation:o,toLocation:n,pathChanged:l,hrefChanged:d,hashChanged:m}}class tw{constructor(o){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startTransition=n=>n(),this.update=n=>{n.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/framework/react/guide/not-found-errors#migrating-from-notfoundroute for more info.");const l=this.options,d=this.basepath??l?.basepath??"/",m=this.basepath===void 0,h=l?.rewrite;this.options={...l,...n},this.isServer=this.options.isServer??typeof document>"u",this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(N=>[encodeURIComponent(N),N])):void 0,(!this.history||this.options.history&&this.options.history!==this.history)&&(this.options.history?this.history=this.options.history:this.isServer||(this.history=iS())),this.origin=this.options.origin,this.origin||(!this.isServer&&window?.origin&&window.origin!=="null"?this.origin=window.origin:this.origin="http://localhost"),this.history&&this.updateLatestLocation(),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),!this.__store&&this.latestLocation&&(this.__store=new zm(sw(this.latestLocation),{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(N=>!["redirected"].includes(N.status))}}}),zS(this));let x=!1;const g=this.options.basepath??"/",b=this.options.rewrite;if(m||d!==g||h!==b){this.basepath=g;const N=[];lc(g)!==""&&N.push(ew({basepath:g})),b&&N.push(b),this.rewrite=N.length===0?void 0:N.length===1?N[0]:JS(N),this.history&&this.updateLatestLocation(),x=!0}x&&this.__store&&(this.__store.state={...this.state,location:this.latestLocation}),typeof window<"u"&&"CSS"in window&&typeof window.CSS?.supports=="function"&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)"))},this.updateLatestLocation=()=>{this.latestLocation=this.parseLocation(this.history.location,this.latestLocation)},this.buildRouteTree=()=>{const{routesById:n,routesByPath:l,flatRoutes:d}=PS({routeTree:this.routeTree,initRoute:(h,x)=>{h.init({originalIndex:x})}});this.routesById=n,this.routesByPath=l,this.flatRoutes=d;const m=this.options.notFoundRoute;m&&(m.init({originalIndex:99999999999}),this.routesById[m.id]=m)},this.subscribe=(n,l)=>{const d={eventType:n,fn:l};return this.subscribers.add(d),()=>{this.subscribers.delete(d)}},this.emit=n=>{this.subscribers.forEach(l=>{l.eventType===n.type&&l.fn(n)})},this.parseLocation=(n,l)=>{const d=({href:g,state:b})=>{const v=new URL(g,this.origin),f=lb(this.rewrite,v),N=this.options.parseSearch(f.search),j=this.options.stringifySearch(N);f.search=j;const _=f.href.replace(f.origin,""),{pathname:w,hash:C}=f;return{href:_,publicHref:g,url:f.href,pathname:w,searchStr:j,search:ys(l?.search,N),hash:C.split("#").reverse()[0]??"",state:ys(l?.state,b)}},m=d(n),{__tempLocation:h,__tempKey:x}=m.state;if(h&&(!x||x===this.tempLocationKey)){const g=d(h);return g.state.key=m.state.key,g.state.__TSR_key=m.state.__TSR_key,delete g.state.__tempLocation,{...g,maskedLocation:m}}return m},this.resolvePathWithBase=(n,l)=>pS({base:n,to:op(l),trailingSlash:this.options.trailingSlash,parseCache:this.parsePathnameCache}),this.matchRoutes=(n,l,d)=>typeof n=="string"?this.matchRoutesInternal({pathname:n,search:l},d):this.matchRoutesInternal(n,l),this.parsePathnameCache=WS(1e3),this.getMatchedRoutes=(n,l)=>rw({pathname:n,routePathname:l,caseSensitive:this.options.caseSensitive,routesByPath:this.routesByPath,routesById:this.routesById,flatRoutes:this.flatRoutes,parseCache:this.parsePathnameCache}),this.cancelMatch=n=>{const l=this.getMatch(n);l&&(l.abortController.abort(),clearTimeout(l._nonReactive.pendingTimeout),l._nonReactive.pendingTimeout=void 0)},this.cancelMatches=()=>{this.state.pendingMatches?.forEach(n=>{this.cancelMatch(n.id)})},this.buildLocation=n=>{const l=(m={})=>{const h=m._fromLocation||this.latestLocation,x=this.matchRoutes(h,{_buildLocation:!0}),g=qm(x);m.from;const b=m.unsafeRelative==="path"?h.pathname:m.from??g.fullPath,v=this.resolvePathWithBase(b,"."),f=g.search,N={...g.params},j=m.to?this.resolvePathWithBase(v,`${m.to}`):this.resolvePathWithBase(v,"."),_=m.params===!1||m.params===null?{}:(m.params??!0)===!0?N:Object.assign(N,pn(m.params,N)),w=Yl({path:j,params:_,parseCache:this.parsePathnameCache}).interpolatedPath,C=this.matchRoutes(w,void 0,{_buildLocation:!0}).map(J=>this.looseRoutesById[J.routeId]);if(Object.keys(_).length>0)for(const J of C){const W=J.options.params?.stringify??J.options.stringifyParams;W&&Object.assign(_,W(_))}const E=Yl({path:j,params:_,leaveWildcards:!1,leaveParams:n.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath;let z=f;if(n._includeValidateSearch&&this.options.search?.strict){const J={};C.forEach(W=>{if(W.options.validateSearch)try{Object.assign(J,Vm(W.options.validateSearch,{...J,...z}))}catch{}}),z=J}z=nw({search:z,dest:m,destRoutes:C,_includeValidateSearch:n._includeValidateSearch}),z=ys(f,z);const P=this.options.stringifySearch(z),V=m.hash===!0?h.hash:m.hash?pn(m.hash,h.hash):void 0,Z=V?`#${V}`:"";let oe=m.state===!0?h.state:m.state?pn(m.state,h.state):{};oe=ys(h.state,oe);const O=`${E}${P}${Z}`,T=new URL(O,this.origin),ge=cb(this.rewrite,T);return{publicHref:ge.pathname+ge.search+ge.hash,href:O,url:ge.href,pathname:E,search:z,searchStr:P,state:oe,hash:V??"",unmaskOnReload:m.unmaskOnReload}},d=(m={},h)=>{const x=l(m);let g=h?l(h):void 0;if(!g){let b={};const v=this.options.routeMasks?.find(f=>{const N=Um(x.pathname,{to:f.from,caseSensitive:!1,fuzzy:!1},this.parsePathnameCache);return N?(b=N,!0):!1});if(v){const{from:f,...N}=v;h={from:n.from,...N,params:b},g=l(h)}}return g&&(x.maskedLocation=g),x};return n.mask?d(n,{from:n.from,...n.mask}):d(n)},this.commitLocation=({viewTransition:n,ignoreBlocker:l,...d})=>{const m=()=>{const g=["key","__TSR_key","__TSR_index","__hashScrollIntoViewOptions"];g.forEach(v=>{d.state[v]=this.latestLocation.state[v]});const b=hn(d.state,this.latestLocation.state);return g.forEach(v=>{delete d.state[v]}),b},h=Gr(this.latestLocation.href)===Gr(d.href),x=this.commitLocationPromise;if(this.commitLocationPromise=po(()=>{x?.resolve()}),h&&m())this.load();else{let{maskedLocation:g,hashScrollIntoView:b,...v}=d;g&&(v={...g,state:{...g.state,__tempKey:void 0,__tempLocation:{...v,search:v.searchStr,state:{...v.state,__tempKey:void 0,__tempLocation:void 0,__TSR_key:void 0,key:void 0}}}},(v.unmaskOnReload??this.options.unmaskOnReload??!1)&&(v.state.__tempKey=this.tempLocationKey)),v.state.__hashScrollIntoViewOptions=b??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=n,this.history[d.replace?"replace":"push"](v.publicHref,v.state,{ignoreBlocker:l})}return this.resetNextScroll=d.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:n,resetScroll:l,hashScrollIntoView:d,viewTransition:m,ignoreBlocker:h,href:x,...g}={})=>{if(x){const v=this.history.location.state.__TSR_index,f=hc(x,{__TSR_index:n?v:v+1});g.to=f.pathname,g.search=this.options.parseSearch(f.search),g.hash=f.hash.slice(1)}const b=this.buildLocation({...g,_includeValidateSearch:!0});return this.commitLocation({...b,viewTransition:m,replace:n,resetScroll:l,hashScrollIntoView:d,ignoreBlocker:h})},this.navigate=({to:n,reloadDocument:l,href:d,...m})=>{if(!l&&d)try{new URL(`${d}`),l=!0}catch{}return l?(d||(d=this.buildLocation({to:n,...m}).url),m.replace?window.location.replace(d):window.location.href=d,Promise.resolve()):this.buildAndCommitLocation({...m,href:d,to:n,_isNavigate:!0})},this.beforeLoad=()=>{if(this.cancelMatches(),this.updateLatestLocation(),this.isServer){const l=this.buildLocation({to:this.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0}),d=m=>{try{return encodeURI(decodeURI(m))}catch{return m}};if(lc(d(this.latestLocation.href))!==lc(d(l.href))){let m=l.url;throw this.origin&&m.startsWith(this.origin)&&(m=m.replace(this.origin,"")||"/"),GS({href:m})}}const n=this.matchRoutes(this.latestLocation);this.__store.setState(l=>({...l,status:"pending",statusCode:200,isLoading:!0,location:this.latestLocation,pendingMatches:n,cachedMatches:l.cachedMatches.filter(d=>!n.some(m=>m.id===d.id))}))},this.load=async n=>{let l,d,m;for(m=new Promise(h=>{this.startTransition(async()=>{try{this.beforeLoad();const x=this.latestLocation,g=this.state.resolvedLocation;this.state.redirect||this.emit({type:"onBeforeNavigate",...xn({resolvedLocation:g,location:x})}),this.emit({type:"onBeforeLoad",...xn({resolvedLocation:g,location:x})}),await sg({router:this,sync:n?.sync,matches:this.state.pendingMatches,location:x,updateMatch:this.updateMatch,onReady:async()=>{this.startViewTransition(async()=>{let b,v,f;_i(()=>{this.__store.setState(N=>{const j=N.matches,_=N.pendingMatches||N.matches;return b=j.filter(w=>!_.some(C=>C.id===w.id)),v=_.filter(w=>!j.some(C=>C.id===w.id)),f=j.filter(w=>_.some(C=>C.id===w.id)),{...N,isLoading:!1,loadedAt:Date.now(),matches:_,pendingMatches:void 0,cachedMatches:[...N.cachedMatches,...b.filter(w=>w.status!=="error")]}}),this.clearExpiredCache()}),[[b,"onLeave"],[v,"onEnter"],[f,"onStay"]].forEach(([N,j])=>{N.forEach(_=>{this.looseRoutesById[_.routeId].options[j]?.(_)})})})}})}catch(x){Ds(x)?(l=x,this.isServer||this.navigate({...l.options,replace:!0,ignoreBlocker:!0})):Vs(x)&&(d=x),this.__store.setState(g=>({...g,statusCode:l?l.status:d?404:g.matches.some(b=>b.status==="error")?500:200,redirect:l}))}this.latestLoadPromise===m&&(this.commitLocationPromise?.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),h()})}),this.latestLoadPromise=m,await m;this.latestLoadPromise&&m!==this.latestLoadPromise;)await this.latestLoadPromise;this.hasNotFoundMatch()&&this.__store.setState(h=>({...h,statusCode:404}))},this.startViewTransition=n=>{const l=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,l&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"){let d;if(typeof l=="object"&&this.isViewTransitionTypesSupported){const m=this.latestLocation,h=this.state.resolvedLocation,x=typeof l.types=="function"?l.types(xn({resolvedLocation:h,location:m})):l.types;if(x===!1){n();return}d={update:n,types:x}}else d=n;document.startViewTransition(d)}else n()},this.updateMatch=(n,l)=>{const d=this.state.pendingMatches?.some(m=>m.id===n)?"pendingMatches":this.state.matches.some(m=>m.id===n)?"matches":this.state.cachedMatches.some(m=>m.id===n)?"cachedMatches":"";d&&this.__store.setState(m=>({...m,[d]:m[d]?.map(h=>h.id===n?l(h):h)}))},this.getMatch=n=>{const l=d=>d.id===n;return this.state.cachedMatches.find(l)??this.state.pendingMatches?.find(l)??this.state.matches.find(l)},this.invalidate=n=>{const l=d=>n?.filter?.(d)??!0?{...d,invalid:!0,...n?.forcePending||d.status==="error"?{status:"pending",error:void 0}:void 0}:d;return this.__store.setState(d=>({...d,matches:d.matches.map(l),cachedMatches:d.cachedMatches.map(l),pendingMatches:d.pendingMatches?.map(l)})),this.shouldViewTransition=!1,this.load({sync:n?.sync})},this.resolveRedirect=n=>{if(!n.options.href){const l=this.buildLocation(n.options);let d=l.url;this.origin&&d.startsWith(this.origin)&&(d=d.replace(this.origin,"")||"/"),n.options.href=l.href,n.headers.set("Location",d)}return n.headers.get("Location")||n.headers.set("Location",n.options.href),n},this.clearCache=n=>{const l=n?.filter;l!==void 0?this.__store.setState(d=>({...d,cachedMatches:d.cachedMatches.filter(m=>!l(m))})):this.__store.setState(d=>({...d,cachedMatches:[]}))},this.clearExpiredCache=()=>{const n=l=>{const d=this.looseRoutesById[l.routeId];if(!d.options.loader)return!0;const m=(l.preload?d.options.preloadGcTime??this.options.defaultPreloadGcTime:d.options.gcTime??this.options.defaultGcTime)??300*1e3;return l.status==="error"?!0:Date.now()-l.updatedAt>=m};this.clearCache({filter:n})},this.loadRouteChunk=nb,this.preloadRoute=async n=>{const l=this.buildLocation(n);let d=this.matchRoutes(l,{throwOnError:!0,preload:!0,dest:n});const m=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(x=>x.id)),h=new Set([...m,...this.state.cachedMatches.map(x=>x.id)]);_i(()=>{d.forEach(x=>{h.has(x.id)||this.__store.setState(g=>({...g,cachedMatches:[...g.cachedMatches,x]}))})});try{return d=await sg({router:this,matches:d,location:l,preload:!0,updateMatch:(x,g)=>{m.has(x)?d=d.map(b=>b.id===x?g(b):b):this.updateMatch(x,g)}}),d}catch(x){if(Ds(x))return x.options.reloadDocument?void 0:await this.preloadRoute({...x.options,_fromLocation:l});Vs(x)||console.error(x);return}},this.matchRoute=(n,l)=>{const d={...n,to:n.to?this.resolvePathWithBase(n.from||"",n.to):void 0,params:n.params||{},leaveParams:!0},m=this.buildLocation(d);if(l?.pending&&this.state.status!=="pending")return!1;const x=(l?.pending===void 0?!this.state.isLoading:l.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,g=Um(x.pathname,{...l,to:m.pathname},this.parsePathnameCache);return!g||n.params&&!hn(g,n.params,{partial:!0})?!1:g&&(l?.includeSearch??!0)?hn(x.search,m.search,{partial:!0})?g:!1:g},this.hasNotFoundMatch=()=>this.__store.state.matches.some(n=>n.status==="notFound"||n.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...o,caseSensitive:o.caseSensitive??!1,notFoundMode:o.notFoundMode??"fuzzy",stringifySearch:o.stringifySearch??$S,parseSearch:o.parseSearch??VS}),typeof document<"u"&&(self.__TSR_ROUTER__=this)}isShell(){return!!this.options.isShell}isPrerendering(){return!!this.options.isPrerendering}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutesInternal(o,n){const{foundRoute:l,matchedRoutes:d,routeParams:m}=this.getMatchedRoutes(o.pathname,n?.dest?.to);let h=!1;(l?l.path!=="/"&&m["**"]:Gr(o.pathname))&&(this.options.notFoundRoute?d.push(this.options.notFoundRoute):h=!0);const x=(()=>{if(h){if(this.options.notFoundMode!=="root")for(let v=d.length-1;v>=0;v--){const f=d[v];if(f.children)return f.id}return Ja}})(),g=[],b=v=>v?.id?v.context??this.options.context??void 0:this.options.context??void 0;return d.forEach((v,f)=>{const N=g[f-1],[j,_,w]=(()=>{const ne=N?.search??o.search,Ee=N?._strictSearch??void 0;try{const Ce=Vm(v.options.validateSearch,{...ne})??void 0;return[{...ne,...Ce},{...Ee,...Ce},void 0]}catch(Ce){let Le=Ce;if(Ce instanceof vc||(Le=new vc(Ce.message,{cause:Ce})),n?.throwOnError)throw Le;return[ne,{},Le]}})(),C=v.options.loaderDeps?.({search:j})??"",E=C?JSON.stringify(C):"",{interpolatedPath:z,usedParams:P}=Yl({path:v.fullPath,params:m,decodeCharMap:this.pathParamsDecodeCharMap}),V=Yl({path:v.id,params:m,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath+E,Z=this.getMatch(V),oe=this.state.matches.find(ne=>ne.routeId===v.id),O=Z?._strictParams??P;let T;if(!Z){const ne=v.options.params?.parse??v.options.parseParams;if(ne)try{Object.assign(O,ne(O))}catch(Ee){if(T=new aw(Ee.message,{cause:Ee}),n?.throwOnError)throw T}}Object.assign(m,O);const ge=oe?"stay":"enter";let J;if(Z)J={...Z,cause:ge,params:oe?ys(oe.params,m):m,_strictParams:O,search:ys(oe?oe.search:Z.search,j),_strictSearch:_};else{const ne=v.options.loader||v.options.beforeLoad||v.lazyFn||ob(v)?"pending":"success";J={id:V,index:f,routeId:v.id,params:oe?ys(oe.params,m):m,_strictParams:O,pathname:z,updatedAt:Date.now(),search:oe?ys(oe.search,j):j,_strictSearch:_,searchError:void 0,status:ne,isFetching:!1,error:void 0,paramsError:T,__routeContext:void 0,_nonReactive:{loadPromise:po()},__beforeLoadContext:void 0,context:{},abortController:new AbortController,fetchCount:0,cause:ge,loaderDeps:oe?ys(oe.loaderDeps,C):C,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:v.options.staticData||{},fullPath:v.fullPath}}n?.preload||(J.globalNotFound=x===v.id),J.searchError=w;const W=b(N);J.context={...W,...J.__routeContext,...J.__beforeLoadContext},g.push(J)}),g.forEach((v,f)=>{const N=this.looseRoutesById[v.routeId];if(!this.getMatch(v.id)&&n?._buildLocation!==!0){const _=g[f-1],w=b(_);if(N.options.context){const C={deps:v.loaderDeps,params:v.params,context:w??{},location:o,navigate:E=>this.navigate({...E,_fromLocation:o}),buildLocation:this.buildLocation,cause:v.cause,abortController:v.abortController,preload:!!v.preload,matches:g};v.__routeContext=N.options.context(C)??void 0}v.context={...w,...v.__routeContext,...v.__beforeLoadContext}}}),g}}class vc extends Error{}class aw extends Error{}function sw(s){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location:s,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}function Vm(s,o){if(s==null)return{};if("~standard"in s){const n=s["~standard"].validate(o);if(n instanceof Promise)throw new vc("Async validation not supported");if(n.issues)throw new vc(JSON.stringify(n.issues,void 0,2),{cause:n});return n.value}return"parse"in s?s.parse(o):typeof s=="function"?s(o):{}}function rw({pathname:s,routePathname:o,caseSensitive:n,routesByPath:l,routesById:d,flatRoutes:m,parseCache:h}){let x={};const g=Gr(s),b=j=>Um(g,{to:j.fullPath,caseSensitive:j.options?.caseSensitive??n,fuzzy:!0},h);let v=o!==void 0?l[o]:void 0;if(v)x=b(v);else{let j;for(const _ of m){const w=b(_);if(w)if(_.path!=="/"&&w["**"])j||(j={foundRoute:_,routeParams:w});else{v=_,x=w;break}}!v&&j&&(v=j.foundRoute,x=j.routeParams)}let f=v||d[Ja];const N=[f];for(;f.parentRoute;)f=f.parentRoute,N.push(f);return N.reverse(),{matchedRoutes:N,routeParams:x,foundRoute:v}}function nw({search:s,dest:o,destRoutes:n,_includeValidateSearch:l}){const d=n.reduce((x,g)=>{const b=[];if("search"in g.options)g.options.search?.middlewares&&b.push(...g.options.search.middlewares);else if(g.options.preSearchFilters||g.options.postSearchFilters){const v=({search:f,next:N})=>{let j=f;"preSearchFilters"in g.options&&g.options.preSearchFilters&&(j=g.options.preSearchFilters.reduce((w,C)=>C(w),f));const _=N(j);return"postSearchFilters"in g.options&&g.options.postSearchFilters?g.options.postSearchFilters.reduce((w,C)=>C(w),_):_};b.push(v)}if(l&&g.options.validateSearch){const v=({search:f,next:N})=>{const j=N(f);try{return{...j,...Vm(g.options.validateSearch,j)??void 0}}catch{return j}};b.push(v)}return x.concat(b)},[])??[],m=({search:x})=>o.search?o.search===!0?x:pn(o.search,x):{};d.push(m);const h=(x,g)=>{if(x>=d.length)return g;const b=d[x];return b({search:g,next:f=>h(x+1,f)})};return h(0,s)}const ow="Error preloading route! ☝️";class db{constructor(o){if(this.init=n=>{this.originalIndex=n.originalIndex;const l=this.options,d=!l?.path&&!l?.id;this.parentRoute=this.options.getParentRoute?.(),d?this._path=Ja:this.parentRoute||mr(!1);let m=d?Ja:l?.path;m&&m!=="/"&&(m=ip(m));const h=l?.id||m;let x=d?Ja:ur([this.parentRoute.id===Ja?"":this.parentRoute.id,h]);m===Ja&&(m="/"),x!==Ja&&(x=ur(["/",x]));const g=x===Ja?"/":ur([this.parentRoute.fullPath,m]);this._path=m,this._id=x,this._fullPath=g,this._to=g},this.clone=n=>{this._path=n._path,this._id=n._id,this._fullPath=n._fullPath,this._to=n._to,this.options.getParentRoute=n.options.getParentRoute,this.children=n.children},this.addChildren=n=>this._addFileChildren(n),this._addFileChildren=n=>(Array.isArray(n)&&(this.children=n),typeof n=="object"&&n!==null&&(this.children=Object.values(n)),this),this._addFileTypes=()=>this,this.updateLoader=n=>(Object.assign(this.options,n),this),this.update=n=>(Object.assign(this.options,n),this),this.lazy=n=>(this.lazyFn=n,this),this.options=o||{},this.isRoot=!o?.getParentRoute,o?.id&&o?.path)throw new Error("Route cannot have both an 'id' and a 'path' option.")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}}class iw extends db{constructor(o){super(o)}}function lp(s){const o=s.errorComponent??Rc;return e.jsx(lw,{getResetKey:s.getResetKey,onCatch:s.onCatch,children:({error:n,reset:l})=>n?c.createElement(o,{error:n,reset:l}):s.children})}class lw extends c.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromProps(o){return{resetKey:o.getResetKey()}}static getDerivedStateFromError(o){return{error:o}}reset(){this.setState({error:null})}componentDidUpdate(o,n){n.error&&n.resetKey!==this.state.resetKey&&this.reset()}componentDidCatch(o,n){this.props.onCatch&&this.props.onCatch(o,n)}render(){return this.props.children({error:this.state.resetKey!==this.props.getResetKey()?null:this.state.error,reset:()=>{this.reset()}})}}function Rc({error:s}){const[o,n]=c.useState(!1);return e.jsxs("div",{style:{padding:".5rem",maxWidth:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5rem"},children:[e.jsx("strong",{style:{fontSize:"1rem"},children:"Something went wrong!"}),e.jsx("button",{style:{appearance:"none",fontSize:".6em",border:"1px solid currentColor",padding:".1rem .2rem",fontWeight:"bold",borderRadius:".25rem"},onClick:()=>n(l=>!l),children:o?"Hide Error":"Show Error"})]}),e.jsx("div",{style:{height:".25rem"}}),o?e.jsx("div",{children:e.jsx("pre",{style:{fontSize:".7em",border:"1px solid red",borderRadius:".25rem",padding:".3rem",color:"red",overflow:"auto"},children:s.message?e.jsx("code",{children:s.message}):null})}):null]})}function cw({children:s,fallback:o=null}){return dw()?e.jsx(ga.Fragment,{children:s}):e.jsx(ga.Fragment,{children:o})}function dw(){return ga.useSyncExternalStore(uw,()=>!0,()=>!1)}function uw(){return()=>{}}var bm={exports:{}},vm={},ym={exports:{}},Nm={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rg;function mw(){if(rg)return Nm;rg=1;var s=Ri();function o(f,N){return f===N&&(f!==0||1/f===1/N)||f!==f&&N!==N}var n=typeof Object.is=="function"?Object.is:o,l=s.useState,d=s.useEffect,m=s.useLayoutEffect,h=s.useDebugValue;function x(f,N){var j=N(),_=l({inst:{value:j,getSnapshot:N}}),w=_[0].inst,C=_[1];return m(function(){w.value=j,w.getSnapshot=N,g(w)&&C({inst:w})},[f,j,N]),d(function(){return g(w)&&C({inst:w}),f(function(){g(w)&&C({inst:w})})},[f]),h(j),j}function g(f){var N=f.getSnapshot;f=f.value;try{var j=N();return!n(f,j)}catch{return!0}}function b(f,N){return N()}var v=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?b:x;return Nm.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:v,Nm}var ng;function pw(){return ng||(ng=1,ym.exports=mw()),ym.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var og;function hw(){if(og)return vm;og=1;var s=Ri(),o=pw();function n(b,v){return b===v&&(b!==0||1/b===1/v)||b!==b&&v!==v}var l=typeof Object.is=="function"?Object.is:n,d=o.useSyncExternalStore,m=s.useRef,h=s.useEffect,x=s.useMemo,g=s.useDebugValue;return vm.useSyncExternalStoreWithSelector=function(b,v,f,N,j){var _=m(null);if(_.current===null){var w={hasValue:!1,value:null};_.current=w}else w=_.current;_=x(function(){function E(oe){if(!z){if(z=!0,P=oe,oe=N(oe),j!==void 0&&w.hasValue){var O=w.value;if(j(O,oe))return V=O}return V=oe}if(O=V,l(P,oe))return O;var T=N(oe);return j!==void 0&&j(O,T)?(P=oe,O):(P=oe,V=T)}var z=!1,P,V,Z=f===void 0?null:f;return[function(){return E(v())},Z===null?void 0:function(){return E(Z())}]},[v,f,N,j]);var C=d(b,_[0],_[1]);return h(function(){w.hasValue=!0,w.value=C},[C]),g(C),C},vm}var ig;function xw(){return ig||(ig=1,bm.exports=hw()),bm.exports}var fw=xw();function gw(s,o=n=>n){return fw.useSyncExternalStoreWithSelector(s.subscribe,()=>s.state,()=>s.state,o,bw)}function bw(s,o){if(Object.is(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;if(s instanceof Map&&o instanceof Map){if(s.size!==o.size)return!1;for(const[l,d]of s)if(!o.has(l)||!Object.is(d,o.get(l)))return!1;return!0}if(s instanceof Set&&o instanceof Set){if(s.size!==o.size)return!1;for(const l of s)if(!o.has(l))return!1;return!0}if(s instanceof Date&&o instanceof Date)return s.getTime()===o.getTime();const n=lg(s);if(n.length!==lg(o).length)return!1;for(let l=0;l<n.length;l++)if(!Object.prototype.hasOwnProperty.call(o,n[l])||!Object.is(s[n[l]],o[n[l]]))return!1;return!0}function lg(s){return Object.keys(s).concat(Object.getOwnPropertySymbols(s))}const jm=c.createContext(null);function ub(){return typeof document>"u"?jm:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=jm,jm)}function cs(s){const o=c.useContext(ub());return s?.warn,o}function Ha(s){const o=cs({warn:s?.router===void 0}),n=s?.router||o,l=c.useRef(void 0);return gw(n.__store,d=>{if(s?.select){if(s.structuralSharing??n.options.defaultStructuralSharing){const m=ys(l.current,s.select(d));return l.current=m,m}return s.select(d)}return d})}const Lc=c.createContext(void 0),vw=c.createContext(void 0);function $s(s){const o=c.useContext(s.from?vw:Lc);return Ha({select:l=>{const d=l.matches.find(m=>s.from?s.from===m.routeId:m.id===o);if(mr(!((s.shouldThrow??!0)&&!d),`Could not find ${s.from?`an active match from "${s.from}"`:"a nearest match!"}`),d!==void 0)return s.select?s.select(d):d},structuralSharing:s.structuralSharing})}function cp(s){return $s({from:s.from,strict:s.strict,structuralSharing:s.structuralSharing,select:o=>s.select?s.select(o.loaderData):o.loaderData})}function dp(s){const{select:o,...n}=s;return $s({...n,select:l=>o?o(l.loaderDeps):l.loaderDeps})}function up(s){return $s({from:s.from,shouldThrow:s.shouldThrow,structuralSharing:s.structuralSharing,strict:s.strict,select:o=>{const n=s.strict===!1?o.params:o._strictParams;return s.select?s.select(n):n}})}function mp(s){return $s({from:s.from,strict:s.strict,shouldThrow:s.shouldThrow,structuralSharing:s.structuralSharing,select:o=>s.select?s.select(o.search):o.search})}function pp(s){const o=cs();return c.useCallback(n=>o.navigate({...n,from:n.from??s?.from}),[s?.from,o])}var Pc=Yg();const yw=Wg(Pc),Zl=typeof window<"u"?c.useLayoutEffect:c.useEffect;function _m(s){const o=c.useRef({value:s,prev:null}),n=o.current.value;return s!==n&&(o.current={value:s,prev:n}),o.current.prev}function Nw(s,o,n={},l={}){c.useEffect(()=>{if(!s.current||l.disabled||typeof IntersectionObserver!="function")return;const d=new IntersectionObserver(([m])=>{o(m)},n);return d.observe(s.current),()=>{d.disconnect()}},[o,n,l.disabled,s])}function jw(s){const o=c.useRef(null);return c.useImperativeHandle(s,()=>o.current,[]),o}function _w(s,o){const n=cs(),[l,d]=c.useState(!1),m=c.useRef(!1),h=jw(o),{activeProps:x,inactiveProps:g,activeOptions:b,to:v,preload:f,preloadDelay:N,hashScrollIntoView:j,replace:_,startTransition:w,resetScroll:C,viewTransition:E,children:z,target:P,disabled:V,style:Z,className:oe,onClick:O,onFocus:T,onMouseEnter:ge,onMouseLeave:J,onTouchStart:W,ignoreBlocker:ne,params:Ee,search:Ce,hash:Le,state:I,mask:Q,reloadDocument:F,unsafeRelative:de,from:ze,_fromLocation:A,...$}=s,se=Ha({select:qe=>qe.location.search,structuralSharing:!0}),k=s.from,K=c.useMemo(()=>({...s,from:k}),[n,se,k,s._fromLocation,s.hash,s.to,s.search,s.params,s.state,s.mask,s.unsafeRelative]),M=c.useMemo(()=>n.buildLocation({...K}),[n,K]),D=c.useMemo(()=>{if(V)return;let qe=M.maskedLocation?M.maskedLocation.url:M.url,Se=!1;return n.origin&&(qe.startsWith(n.origin)?qe=n.history.createHref(qe.replace(n.origin,""))||"/":Se=!0),{href:qe,external:Se}},[V,M.maskedLocation,M.url,n.origin,n.history]),q=c.useMemo(()=>{if(D?.external)return D.href;try{return new URL(v),v}catch{}},[v,D]),G=s.reloadDocument||q?!1:f??n.options.defaultPreload,be=N??n.options.defaultPreloadDelay??0,Ne=Ha({select:qe=>{if(q)return!1;if(b?.exact){if(!uS(qe.location.pathname,M.pathname,n.basepath))return!1}else{const Se=fc(qe.location.pathname,n.basepath),Xe=fc(M.pathname,n.basepath);if(!(Se.startsWith(Xe)&&(Se.length===Xe.length||Se[Xe.length]==="/")))return!1}return(b?.includeSearch??!0)&&!hn(qe.location.search,M.search,{partial:!b?.exact,ignoreUndefined:!b?.explicitUndefined})?!1:b?.includeHash?qe.location.hash===M.hash:!0}}),R=c.useCallback(()=>{n.preloadRoute({...K}).catch(qe=>{console.warn(qe),console.warn(ow)})},[n,K]),ke=c.useCallback(qe=>{qe?.isIntersecting&&R()},[R]);Nw(h,ke,Cw,{disabled:!!V||G!=="viewport"}),c.useEffect(()=>{m.current||!V&&G==="render"&&(R(),m.current=!0)},[V,R,G]);const je=qe=>{const Se=qe.currentTarget.target,Xe=P!==void 0?P:Se;if(!V&&!kw(qe)&&!qe.defaultPrevented&&(!Xe||Xe==="_self")&&qe.button===0){qe.preventDefault(),Pc.flushSync(()=>{d(!0)});const We=n.subscribe("onResolved",()=>{We(),d(!1)});n.navigate({...K,replace:_,resetScroll:C,hashScrollIntoView:j,startTransition:w,viewTransition:E,ignoreBlocker:ne})}};if(q)return{...$,ref:h,href:q,...z&&{children:z},...P&&{target:P},...V&&{disabled:V},...Z&&{style:Z},...oe&&{className:oe},...O&&{onClick:O},...T&&{onFocus:T},...ge&&{onMouseEnter:ge},...J&&{onMouseLeave:J},...W&&{onTouchStart:W}};const ee=qe=>{V||G&&R()},ae=ee,rt=qe=>{if(!(V||!G))if(!be)R();else{const Se=qe.target;if(fi.has(Se))return;const Xe=setTimeout(()=>{fi.delete(Se),R()},be);fi.set(Se,Xe)}},jt=qe=>{if(V||!G||!be)return;const Se=qe.target,Xe=fi.get(Se);Xe&&(clearTimeout(Xe),fi.delete(Se))},xe=Ne?pn(x,{})??Sw:Sm,Me=Ne?Sm:pn(g,{})??Sm,De=[oe,xe.className,Me.className].filter(Boolean).join(" "),Ge=(Z||xe.style||Me.style)&&{...Z,...xe.style,...Me.style};return{...$,...xe,...Me,href:D?.href,ref:h,onClick:gi([O,je]),onFocus:gi([T,ee]),onMouseEnter:gi([ge,rt]),onMouseLeave:gi([J,jt]),onTouchStart:gi([W,ae]),disabled:!!V,target:P,...Ge&&{style:Ge},...De&&{className:De},...V&&ww,...Ne&&Tw,...l&&Aw}}const Sm={},Sw={className:"active"},ww={role:"link","aria-disabled":!0},Tw={"data-status":"active","aria-current":"page"},Aw={"data-transitioning":"transitioning"},fi=new WeakMap,Cw={rootMargin:"100px"},gi=s=>o=>{for(const n of s)if(n){if(o.defaultPrevented)return;n(o)}},Ts=c.forwardRef((s,o)=>{const{_asChild:n,...l}=s,{type:d,ref:m,...h}=_w(l,o),x=typeof l.children=="function"?l.children({isActive:h["data-status"]==="active"}):l.children;return n===void 0&&delete h.disabled,c.createElement(n||"a",{...h,ref:m},x)});function kw(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}let Ew=class extends db{constructor(o){super(o),this.useMatch=n=>$s({select:n?.select,from:this.id,structuralSharing:n?.structuralSharing}),this.useRouteContext=n=>$s({...n,from:this.id,select:l=>n?.select?n.select(l.context):l.context}),this.useSearch=n=>mp({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useParams=n=>up({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useLoaderDeps=n=>dp({...n,from:this.id}),this.useLoaderData=n=>cp({...n,from:this.id}),this.useNavigate=()=>pp({from:this.fullPath}),this.Link=ga.forwardRef((n,l)=>e.jsx(Ts,{ref:l,from:this.fullPath,...n})),this.$$typeof=Symbol.for("react.memo")}};function Rw(s){return new Ew(s)}class Lw extends iw{constructor(o){super(o),this.useMatch=n=>$s({select:n?.select,from:this.id,structuralSharing:n?.structuralSharing}),this.useRouteContext=n=>$s({...n,from:this.id,select:l=>n?.select?n.select(l.context):l.context}),this.useSearch=n=>mp({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useParams=n=>up({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useLoaderDeps=n=>dp({...n,from:this.id}),this.useLoaderData=n=>cp({...n,from:this.id}),this.useNavigate=()=>pp({from:this.fullPath}),this.Link=ga.forwardRef((n,l)=>e.jsx(Ts,{ref:l,from:this.fullPath,...n})),this.$$typeof=Symbol.for("react.memo")}}function Pw(s){return new Lw(s)}function Sa(s){return typeof s=="object"?new cg(s,{silent:!0}).createRoute(s):new cg(s,{silent:!0}).createRoute}class cg{constructor(o,n){this.path=o,this.createRoute=l=>{this.silent;const d=Rw(l);return d.isRoot=!1,d},this.silent=n?.silent}}class dg{constructor(o){this.useMatch=n=>$s({select:n?.select,from:this.options.id,structuralSharing:n?.structuralSharing}),this.useRouteContext=n=>$s({from:this.options.id,select:l=>n?.select?n.select(l.context):l.context}),this.useSearch=n=>mp({select:n?.select,structuralSharing:n?.structuralSharing,from:this.options.id}),this.useParams=n=>up({select:n?.select,structuralSharing:n?.structuralSharing,from:this.options.id}),this.useLoaderDeps=n=>dp({...n,from:this.options.id}),this.useLoaderData=n=>cp({...n,from:this.options.id}),this.useNavigate=()=>{const n=cs();return pp({from:n.routesById[this.options.id].fullPath})},this.options=o,this.$$typeof=Symbol.for("react.memo")}}function ug(s){return typeof s=="object"?new dg(s):o=>new dg({id:s,...o})}function Mw(){const s=cs(),o=c.useRef({router:s,mounted:!1}),[n,l]=c.useState(!1),{hasPendingMatches:d,isLoading:m}=Ha({select:f=>({isLoading:f.isLoading,hasPendingMatches:f.matches.some(N=>N.status==="pending")}),structuralSharing:!0}),h=_m(m),x=m||n||d,g=_m(x),b=m||d,v=_m(b);return s.startTransition=f=>{l(!0),c.startTransition(()=>{f(),l(!1)})},c.useEffect(()=>{const f=s.history.subscribe(s.load),N=s.buildLocation({to:s.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});return Gr(s.latestLocation.href)!==Gr(N.href)&&s.commitLocation({...N,replace:!0}),()=>{f()}},[s,s.history]),Zl(()=>{if(typeof window<"u"&&s.ssr||o.current.router===s&&o.current.mounted)return;o.current={router:s,mounted:!0},(async()=>{try{await s.load()}catch(N){console.error(N)}})()},[s]),Zl(()=>{h&&!m&&s.emit({type:"onLoad",...xn(s.state)})},[h,s,m]),Zl(()=>{v&&!b&&s.emit({type:"onBeforeRouteMount",...xn(s.state)})},[b,v,s]),Zl(()=>{g&&!x&&(s.emit({type:"onResolved",...xn(s.state)}),s.__store.setState(f=>({...f,status:"idle",resolvedLocation:f.location})),qS(s))},[x,g,s]),null}function Iw(s){const o=Ha({select:n=>`not-found-${n.location.pathname}-${n.status}`});return e.jsx(lp,{getResetKey:()=>o,onCatch:(n,l)=>{if(Vs(n))s.onCatch?.(n,l);else throw n},errorComponent:({error:n})=>{if(Vs(n))return s.fallback?.(n);throw n},children:s.children})}function Ow(){return e.jsx("p",{children:"Not Found"})}function oo(s){return e.jsx(e.Fragment,{children:s.children})}function mb(s,o,n){return o.options.notFoundComponent?e.jsx(o.options.notFoundComponent,{data:n}):s.options.defaultNotFoundComponent?e.jsx(s.options.defaultNotFoundComponent,{data:n}):e.jsx(Ow,{})}function Dw({children:s}){const o=cs();return o.isServer?e.jsx("script",{nonce:o.options.ssr?.nonce,className:"$tsr",dangerouslySetInnerHTML:{__html:[s].filter(Boolean).join(`
`)+";$_TSR.c()"}}):null}function zw(){const s=cs();if(!s.isScrollRestoring||!s.isServer||typeof s.options.scrollRestoration=="function"&&!s.options.scrollRestoration({location:s.latestLocation}))return null;const n=(s.options.getScrollRestorationKey||Bm)(s.latestLocation),l=n!==Bm(s.latestLocation)?n:void 0,d={storageKey:gc,shouldScrollRestoration:!0};return l&&(d.key=l),e.jsx(Dw,{children:`(${eb.toString()})(${JSON.stringify(d)})`})}const pb=c.memo(function({matchId:o}){const n=cs(),l=Ha({select:E=>{const z=E.matches.find(P=>P.id===o);return mr(z),{routeId:z.routeId,ssr:z.ssr,_displayPending:z._displayPending}},structuralSharing:!0}),d=n.routesById[l.routeId],m=d.options.pendingComponent??n.options.defaultPendingComponent,h=m?e.jsx(m,{}):null,x=d.options.errorComponent??n.options.defaultErrorComponent,g=d.options.onCatch??n.options.defaultOnCatch,b=d.isRoot?d.options.notFoundComponent??n.options.notFoundRoute?.options.component:d.options.notFoundComponent,v=l.ssr===!1||l.ssr==="data-only",f=(!d.isRoot||d.options.wrapInSuspense||v)&&(d.options.wrapInSuspense??m??(d.options.errorComponent?.preload||v))?c.Suspense:oo,N=x?lp:oo,j=b?Iw:oo,_=Ha({select:E=>E.loadedAt}),w=Ha({select:E=>{const z=E.matches.findIndex(P=>P.id===o);return E.matches[z-1]?.routeId}}),C=d.isRoot?d.options.shellComponent??oo:oo;return e.jsxs(C,{children:[e.jsx(Lc.Provider,{value:o,children:e.jsx(f,{fallback:h,children:e.jsx(N,{getResetKey:()=>_,errorComponent:x||Rc,onCatch:(E,z)=>{if(Vs(E))throw E;g?.(E,z)},children:e.jsx(j,{fallback:E=>{if(!b||E.routeId&&E.routeId!==l.routeId||!E.routeId&&!d.isRoot)throw E;return c.createElement(b,E)},children:v||l._displayPending?e.jsx(cw,{fallback:h,children:e.jsx(mg,{matchId:o})}):e.jsx(mg,{matchId:o})})})})}),w===Ja&&n.options.scrollRestoration?e.jsxs(e.Fragment,{children:[e.jsx(qw,{}),e.jsx(zw,{})]}):null]})});function qw(){const s=cs(),o=c.useRef(void 0);return e.jsx("script",{suppressHydrationWarning:!0,ref:n=>{n&&(o.current===void 0||o.current.href!==s.latestLocation.href)&&(s.emit({type:"onRendered",...xn(s.state)}),o.current=s.latestLocation)}},s.latestLocation.state.__TSR_key)}const mg=c.memo(function({matchId:o}){const n=cs(),{match:l,key:d,routeId:m}=Ha({select:g=>{const b=g.matches.find(_=>_.id===o),v=b.routeId,N=(n.routesById[v].options.remountDeps??n.options.defaultRemountDeps)?.({routeId:v,loaderDeps:b.loaderDeps,params:b._strictParams,search:b._strictSearch});return{key:N?JSON.stringify(N):void 0,routeId:v,match:{id:b.id,status:b.status,error:b.error,_forcePending:b._forcePending,_displayPending:b._displayPending}}},structuralSharing:!0}),h=n.routesById[m],x=c.useMemo(()=>{const g=h.options.component??n.options.defaultComponent;return g?e.jsx(g,{},d):e.jsx(hb,{})},[d,h.options.component,n.options.defaultComponent]);if(l._displayPending)throw n.getMatch(l.id)?._nonReactive.displayPendingPromise;if(l._forcePending)throw n.getMatch(l.id)?._nonReactive.minPendingPromise;if(l.status==="pending"){const g=h.options.pendingMinMs??n.options.defaultPendingMinMs;if(g){const b=n.getMatch(l.id);if(b&&!b._nonReactive.minPendingPromise&&!n.isServer){const v=po();b._nonReactive.minPendingPromise=v,setTimeout(()=>{v.resolve(),b._nonReactive.minPendingPromise=void 0},g)}}throw n.getMatch(l.id)?._nonReactive.loadPromise}if(l.status==="notFound")return mr(Vs(l.error)),mb(n,h,l.error);if(l.status==="redirected")throw mr(Ds(l.error)),n.getMatch(l.id)?._nonReactive.loadPromise;if(l.status==="error"){if(n.isServer){const g=(h.options.errorComponent??n.options.defaultErrorComponent)||Rc;return e.jsx(g,{error:l.error,reset:void 0,info:{componentStack:""}})}throw l.error}return x}),hb=c.memo(function(){const o=cs(),n=c.useContext(Lc),l=Ha({select:b=>b.matches.find(v=>v.id===n)?.routeId}),d=o.routesById[l],m=Ha({select:b=>{const f=b.matches.find(N=>N.id===n);return mr(f),f.globalNotFound}}),h=Ha({select:b=>{const v=b.matches,f=v.findIndex(N=>N.id===n);return v[f+1]?.id}}),x=o.options.defaultPendingComponent?e.jsx(o.options.defaultPendingComponent,{}):null;if(m)return mb(o,d,void 0);if(!h)return null;const g=e.jsx(pb,{matchId:h});return n===Ja?e.jsx(c.Suspense,{fallback:x,children:g}):g});function Uw(){const s=cs(),n=s.routesById[Ja].options.pendingComponent??s.options.defaultPendingComponent,l=n?e.jsx(n,{}):null,d=s.isServer||typeof document<"u"&&s.ssr?oo:c.Suspense,m=e.jsxs(d,{fallback:l,children:[!s.isServer&&e.jsx(Mw,{}),e.jsx(Bw,{})]});return s.options.InnerWrap?e.jsx(s.options.InnerWrap,{children:m}):m}function Bw(){const s=cs(),o=Ha({select:d=>d.matches[0]?.id}),n=Ha({select:d=>d.loadedAt}),l=o?e.jsx(pb,{matchId:o}):null;return e.jsx(Lc.Provider,{value:o,children:s.options.disableGlobalCatchBoundary?l:e.jsx(lp,{getResetKey:()=>n,errorComponent:Rc,onCatch:d=>{d.message||d.toString()},children:l})})}const Vw=s=>new $w(s);class $w extends tw{constructor(o){super(o)}}typeof globalThis<"u"?(globalThis.createFileRoute=Sa,globalThis.createLazyFileRoute=ug):typeof window<"u"&&(window.createFileRoute=Sa,window.createLazyFileRoute=ug);function Fw({router:s,children:o,...n}){Object.keys(n).length>0&&s.update({...s.options,...n,context:{...s.options.context,...n.context}});const l=ub(),d=e.jsx(l.Provider,{value:s,children:o});return s.options.Wrap?e.jsx(s.options.Wrap,{children:d}):d}function Hw({router:s,...o}){return e.jsx(Fw,{router:s,...o,children:e.jsx(Uw,{})})}function Gw(s){return Ha({select:o=>s?.select?s.select(o.location):o.location})}function pg(s,o){if(typeof s=="function")return s(o);s!=null&&(s.current=o)}function Mc(...s){return o=>{let n=!1;const l=s.map(d=>{const m=pg(d,o);return!n&&typeof m=="function"&&(n=!0),m});if(n)return()=>{for(let d=0;d<l.length;d++){const m=l[d];typeof m=="function"?m():pg(s[d],null)}}}}function xa(...s){return c.useCallback(Mc(...s),s)}function fo(s){const o=Ww(s),n=c.forwardRef((l,d)=>{const{children:m,...h}=l,x=c.Children.toArray(m),g=x.find(Yw);if(g){const b=g.props.children,v=x.map(f=>f===g?c.Children.count(b)>1?c.Children.only(null):c.isValidElement(b)?b.props.children:null:f);return e.jsx(o,{...h,ref:d,children:c.isValidElement(b)?c.cloneElement(b,void 0,v):null})}return e.jsx(o,{...h,ref:d,children:m})});return n.displayName=`${s}.Slot`,n}var hp=fo("Slot");function Ww(s){const o=c.forwardRef((n,l)=>{const{children:d,...m}=n;if(c.isValidElement(d)){const h=Qw(d),x=Xw(m,d.props);return d.type!==c.Fragment&&(x.ref=l?Mc(l,h):h),c.cloneElement(d,x)}return c.Children.count(d)>1?c.Children.only(null):null});return o.displayName=`${s}.SlotClone`,o}var xb=Symbol("radix.slottable");function Kw(s){const o=({children:n})=>e.jsx(e.Fragment,{children:n});return o.displayName=`${s}.Slottable`,o.__radixId=xb,o}function Yw(s){return c.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===xb}function Xw(s,o){const n={...o};for(const l in o){const d=s[l],m=o[l];/^on[A-Z]/.test(l)?d&&m?n[l]=(...x)=>{const g=m(...x);return d(...x),g}:d&&(n[l]=d):l==="style"?n[l]={...d,...m}:l==="className"&&(n[l]=[d,m].filter(Boolean).join(" "))}return{...s,...n}}function Qw(s){let o=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,n=o&&"isReactWarning"in o&&o.isReactWarning;return n?s.ref:(o=Object.getOwnPropertyDescriptor(s,"ref")?.get,n=o&&"isReactWarning"in o&&o.isReactWarning,n?s.props.ref:s.props.ref||s.ref)}function fb(s){var o,n,l="";if(typeof s=="string"||typeof s=="number")l+=s;else if(typeof s=="object")if(Array.isArray(s)){var d=s.length;for(o=0;o<d;o++)s[o]&&(n=fb(s[o]))&&(l&&(l+=" "),l+=n)}else for(n in s)s[n]&&(l&&(l+=" "),l+=n);return l}function gb(){for(var s,o,n=0,l="",d=arguments.length;n<d;n++)(s=arguments[n])&&(o=fb(s))&&(l&&(l+=" "),l+=o);return l}const hg=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,xg=gb,Zw=(s,o)=>n=>{var l;if(o?.variants==null)return xg(s,n?.class,n?.className);const{variants:d,defaultVariants:m}=o,h=Object.keys(d).map(b=>{const v=n?.[b],f=m?.[b];if(v===null)return null;const N=hg(v)||hg(f);return d[b][N]}),x=n&&Object.entries(n).reduce((b,v)=>{let[f,N]=v;return N===void 0||(b[f]=N),b},{}),g=o==null||(l=o.compoundVariants)===null||l===void 0?void 0:l.reduce((b,v)=>{let{class:f,className:N,...j}=v;return Object.entries(j).every(_=>{let[w,C]=_;return Array.isArray(C)?C.includes({...m,...x}[w]):{...m,...x}[w]===C})?[...b,f,N]:b},[]);return xg(s,h,g,n?.class,n?.className)};/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),e1=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(o,n,l)=>l?l.toUpperCase():n.toLowerCase()),fg=s=>{const o=e1(s);return o.charAt(0).toUpperCase()+o.slice(1)},bb=(...s)=>s.filter((o,n,l)=>!!o&&o.trim()!==""&&l.indexOf(o)===n).join(" ").trim(),t1=s=>{for(const o in s)if(o.startsWith("aria-")||o==="role"||o==="title")return!0};/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var a1={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s1=c.forwardRef(({color:s="currentColor",size:o=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:d="",children:m,iconNode:h,...x},g)=>c.createElement("svg",{ref:g,...a1,width:o,height:o,stroke:s,strokeWidth:l?Number(n)*24/Number(o):n,className:bb("lucide",d),...!m&&!t1(x)&&{"aria-hidden":"true"},...x},[...h.map(([b,v])=>c.createElement(b,v)),...Array.isArray(m)?m:[m]]));/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=(s,o)=>{const n=c.forwardRef(({className:l,...d},m)=>c.createElement(s1,{ref:m,iconNode:o,className:bb(`lucide-${Jw(fg(s))}`,`lucide-${s}`,l),...d}));return n.displayName=fg(s),n};/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r1=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],La=fa("book-open",r1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n1=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],xp=fa("chevron-down",n1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o1=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],vb=fa("chevron-right",o1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i1=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],yb=fa("circle-alert",i1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l1=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],gg=fa("circle-check-big",l1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c1=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],bg=fa("circle-play",c1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d1=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],u1=fa("circle-x",d1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m1=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],oa=fa("code",m1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p1=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],h1=fa("database",p1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x1=[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]],yi=fa("file-code",x1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f1=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Va=fa("file-text",f1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g1=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],b1=fa("house",g1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v1=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],y1=fa("info",v1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N1=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],j1=fa("lightbulb",N1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _1=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Nb=fa("lock",_1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S1=[["path",{d:"M5 12h14",key:"1ays0h"}]],go=fa("minus",S1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w1=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],ct=fa("pause",w1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T1=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],nt=fa("play",T1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],dr=fa("plus",A1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C1=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],it=fa("rotate-ccw",C1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k1=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ic=fa("settings",k1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E1=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],R1=fa("shield",E1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L1=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],vn=fa("trending-down",L1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P1=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],yn=fa("triangle-alert",P1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M1=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],jb=fa("users",M1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I1=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],O1=fa("x",I1);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D1=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],fp=fa("zap",D1),gp="-",z1=s=>{const o=U1(s),{conflictingClassGroups:n,conflictingClassGroupModifiers:l}=s;return{getClassGroupId:h=>{const x=h.split(gp);return x[0]===""&&x.length!==1&&x.shift(),_b(x,o)||q1(h)},getConflictingClassGroupIds:(h,x)=>{const g=n[h]||[];return x&&l[h]?[...g,...l[h]]:g}}},_b=(s,o)=>{if(s.length===0)return o.classGroupId;const n=s[0],l=o.nextPart.get(n),d=l?_b(s.slice(1),l):void 0;if(d)return d;if(o.validators.length===0)return;const m=s.join(gp);return o.validators.find(({validator:h})=>h(m))?.classGroupId},vg=/^\[(.+)\]$/,q1=s=>{if(vg.test(s)){const o=vg.exec(s)[1],n=o?.substring(0,o.indexOf(":"));if(n)return"arbitrary.."+n}},U1=s=>{const{theme:o,classGroups:n}=s,l={nextPart:new Map,validators:[]};for(const d in n)$m(n[d],l,d,o);return l},$m=(s,o,n,l)=>{s.forEach(d=>{if(typeof d=="string"){const m=d===""?o:yg(o,d);m.classGroupId=n;return}if(typeof d=="function"){if(B1(d)){$m(d(l),o,n,l);return}o.validators.push({validator:d,classGroupId:n});return}Object.entries(d).forEach(([m,h])=>{$m(h,yg(o,m),n,l)})})},yg=(s,o)=>{let n=s;return o.split(gp).forEach(l=>{n.nextPart.has(l)||n.nextPart.set(l,{nextPart:new Map,validators:[]}),n=n.nextPart.get(l)}),n},B1=s=>s.isThemeGetter,V1=s=>{if(s<1)return{get:()=>{},set:()=>{}};let o=0,n=new Map,l=new Map;const d=(m,h)=>{n.set(m,h),o++,o>s&&(o=0,l=n,n=new Map)};return{get(m){let h=n.get(m);if(h!==void 0)return h;if((h=l.get(m))!==void 0)return d(m,h),h},set(m,h){n.has(m)?n.set(m,h):d(m,h)}}},Fm="!",Hm=":",$1=Hm.length,F1=s=>{const{prefix:o,experimentalParseClassName:n}=s;let l=d=>{const m=[];let h=0,x=0,g=0,b;for(let _=0;_<d.length;_++){let w=d[_];if(h===0&&x===0){if(w===Hm){m.push(d.slice(g,_)),g=_+$1;continue}if(w==="/"){b=_;continue}}w==="["?h++:w==="]"?h--:w==="("?x++:w===")"&&x--}const v=m.length===0?d:d.substring(g),f=H1(v),N=f!==v,j=b&&b>g?b-g:void 0;return{modifiers:m,hasImportantModifier:N,baseClassName:f,maybePostfixModifierPosition:j}};if(o){const d=o+Hm,m=l;l=h=>h.startsWith(d)?m(h.substring(d.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:h,maybePostfixModifierPosition:void 0}}if(n){const d=l;l=m=>n({className:m,parseClassName:d})}return l},H1=s=>s.endsWith(Fm)?s.substring(0,s.length-1):s.startsWith(Fm)?s.substring(1):s,G1=s=>{const o=Object.fromEntries(s.orderSensitiveModifiers.map(l=>[l,!0]));return l=>{if(l.length<=1)return l;const d=[];let m=[];return l.forEach(h=>{h[0]==="["||o[h]?(d.push(...m.sort(),h),m=[]):m.push(h)}),d.push(...m.sort()),d}},W1=s=>({cache:V1(s.cacheSize),parseClassName:F1(s),sortModifiers:G1(s),...z1(s)}),K1=/\s+/,Y1=(s,o)=>{const{parseClassName:n,getClassGroupId:l,getConflictingClassGroupIds:d,sortModifiers:m}=o,h=[],x=s.trim().split(K1);let g="";for(let b=x.length-1;b>=0;b-=1){const v=x[b],{isExternal:f,modifiers:N,hasImportantModifier:j,baseClassName:_,maybePostfixModifierPosition:w}=n(v);if(f){g=v+(g.length>0?" "+g:g);continue}let C=!!w,E=l(C?_.substring(0,w):_);if(!E){if(!C){g=v+(g.length>0?" "+g:g);continue}if(E=l(_),!E){g=v+(g.length>0?" "+g:g);continue}C=!1}const z=m(N).join(":"),P=j?z+Fm:z,V=P+E;if(h.includes(V))continue;h.push(V);const Z=d(E,C);for(let oe=0;oe<Z.length;++oe){const O=Z[oe];h.push(P+O)}g=v+(g.length>0?" "+g:g)}return g};function X1(){let s=0,o,n,l="";for(;s<arguments.length;)(o=arguments[s++])&&(n=Sb(o))&&(l&&(l+=" "),l+=n);return l}const Sb=s=>{if(typeof s=="string")return s;let o,n="";for(let l=0;l<s.length;l++)s[l]&&(o=Sb(s[l]))&&(n&&(n+=" "),n+=o);return n};function Q1(s,...o){let n,l,d,m=h;function h(g){const b=o.reduce((v,f)=>f(v),s());return n=W1(b),l=n.cache.get,d=n.cache.set,m=x,x(g)}function x(g){const b=l(g);if(b)return b;const v=Y1(g,n);return d(g,v),v}return function(){return m(X1.apply(null,arguments))}}const Ia=s=>{const o=n=>n[s]||[];return o.isThemeGetter=!0,o},wb=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Tb=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Z1=/^\d+\/\d+$/,J1=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,e4=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,t4=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,a4=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,s4=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ao=s=>Z1.test(s),Vt=s=>!!s&&!Number.isNaN(Number(s)),Br=s=>!!s&&Number.isInteger(Number(s)),wm=s=>s.endsWith("%")&&Vt(s.slice(0,-1)),cr=s=>J1.test(s),r4=()=>!0,n4=s=>e4.test(s)&&!t4.test(s),Ab=()=>!1,o4=s=>a4.test(s),i4=s=>s4.test(s),l4=s=>!yt(s)&&!Nt(s),c4=s=>yo(s,Eb,Ab),yt=s=>wb.test(s),mn=s=>yo(s,Rb,n4),Tm=s=>yo(s,h4,Vt),Ng=s=>yo(s,Cb,Ab),d4=s=>yo(s,kb,i4),Jl=s=>yo(s,Lb,o4),Nt=s=>Tb.test(s),bi=s=>No(s,Rb),u4=s=>No(s,x4),jg=s=>No(s,Cb),m4=s=>No(s,Eb),p4=s=>No(s,kb),ec=s=>No(s,Lb,!0),yo=(s,o,n)=>{const l=wb.exec(s);return l?l[1]?o(l[1]):n(l[2]):!1},No=(s,o,n=!1)=>{const l=Tb.exec(s);return l?l[1]?o(l[1]):n:!1},Cb=s=>s==="position"||s==="percentage",kb=s=>s==="image"||s==="url",Eb=s=>s==="length"||s==="size"||s==="bg-size",Rb=s=>s==="length",h4=s=>s==="number",x4=s=>s==="family-name",Lb=s=>s==="shadow",f4=()=>{const s=Ia("color"),o=Ia("font"),n=Ia("text"),l=Ia("font-weight"),d=Ia("tracking"),m=Ia("leading"),h=Ia("breakpoint"),x=Ia("container"),g=Ia("spacing"),b=Ia("radius"),v=Ia("shadow"),f=Ia("inset-shadow"),N=Ia("text-shadow"),j=Ia("drop-shadow"),_=Ia("blur"),w=Ia("perspective"),C=Ia("aspect"),E=Ia("ease"),z=Ia("animate"),P=()=>["auto","avoid","all","avoid-page","page","left","right","column"],V=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],Z=()=>[...V(),Nt,yt],oe=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto","contain","none"],T=()=>[Nt,yt,g],ge=()=>[ao,"full","auto",...T()],J=()=>[Br,"none","subgrid",Nt,yt],W=()=>["auto",{span:["full",Br,Nt,yt]},Br,Nt,yt],ne=()=>[Br,"auto",Nt,yt],Ee=()=>["auto","min","max","fr",Nt,yt],Ce=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Le=()=>["start","end","center","stretch","center-safe","end-safe"],I=()=>["auto",...T()],Q=()=>[ao,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...T()],F=()=>[s,Nt,yt],de=()=>[...V(),jg,Ng,{position:[Nt,yt]}],ze=()=>["no-repeat",{repeat:["","x","y","space","round"]}],A=()=>["auto","cover","contain",m4,c4,{size:[Nt,yt]}],$=()=>[wm,bi,mn],se=()=>["","none","full",b,Nt,yt],k=()=>["",Vt,bi,mn],K=()=>["solid","dashed","dotted","double"],M=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],D=()=>[Vt,wm,jg,Ng],q=()=>["","none",_,Nt,yt],G=()=>["none",Vt,Nt,yt],be=()=>["none",Vt,Nt,yt],Ne=()=>[Vt,Nt,yt],R=()=>[ao,"full",...T()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[cr],breakpoint:[cr],color:[r4],container:[cr],"drop-shadow":[cr],ease:["in","out","in-out"],font:[l4],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[cr],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[cr],shadow:[cr],spacing:["px",Vt],text:[cr],"text-shadow":[cr],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ao,yt,Nt,C]}],container:["container"],columns:[{columns:[Vt,yt,Nt,x]}],"break-after":[{"break-after":P()}],"break-before":[{"break-before":P()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:Z()}],overflow:[{overflow:oe()}],"overflow-x":[{"overflow-x":oe()}],"overflow-y":[{"overflow-y":oe()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:ge()}],"inset-x":[{"inset-x":ge()}],"inset-y":[{"inset-y":ge()}],start:[{start:ge()}],end:[{end:ge()}],top:[{top:ge()}],right:[{right:ge()}],bottom:[{bottom:ge()}],left:[{left:ge()}],visibility:["visible","invisible","collapse"],z:[{z:[Br,"auto",Nt,yt]}],basis:[{basis:[ao,"full","auto",x,...T()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Vt,ao,"auto","initial","none",yt]}],grow:[{grow:["",Vt,Nt,yt]}],shrink:[{shrink:["",Vt,Nt,yt]}],order:[{order:[Br,"first","last","none",Nt,yt]}],"grid-cols":[{"grid-cols":J()}],"col-start-end":[{col:W()}],"col-start":[{"col-start":ne()}],"col-end":[{"col-end":ne()}],"grid-rows":[{"grid-rows":J()}],"row-start-end":[{row:W()}],"row-start":[{"row-start":ne()}],"row-end":[{"row-end":ne()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":Ee()}],"auto-rows":[{"auto-rows":Ee()}],gap:[{gap:T()}],"gap-x":[{"gap-x":T()}],"gap-y":[{"gap-y":T()}],"justify-content":[{justify:[...Ce(),"normal"]}],"justify-items":[{"justify-items":[...Le(),"normal"]}],"justify-self":[{"justify-self":["auto",...Le()]}],"align-content":[{content:["normal",...Ce()]}],"align-items":[{items:[...Le(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Le(),{baseline:["","last"]}]}],"place-content":[{"place-content":Ce()}],"place-items":[{"place-items":[...Le(),"baseline"]}],"place-self":[{"place-self":["auto",...Le()]}],p:[{p:T()}],px:[{px:T()}],py:[{py:T()}],ps:[{ps:T()}],pe:[{pe:T()}],pt:[{pt:T()}],pr:[{pr:T()}],pb:[{pb:T()}],pl:[{pl:T()}],m:[{m:I()}],mx:[{mx:I()}],my:[{my:I()}],ms:[{ms:I()}],me:[{me:I()}],mt:[{mt:I()}],mr:[{mr:I()}],mb:[{mb:I()}],ml:[{ml:I()}],"space-x":[{"space-x":T()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":T()}],"space-y-reverse":["space-y-reverse"],size:[{size:Q()}],w:[{w:[x,"screen",...Q()]}],"min-w":[{"min-w":[x,"screen","none",...Q()]}],"max-w":[{"max-w":[x,"screen","none","prose",{screen:[h]},...Q()]}],h:[{h:["screen","lh",...Q()]}],"min-h":[{"min-h":["screen","lh","none",...Q()]}],"max-h":[{"max-h":["screen","lh",...Q()]}],"font-size":[{text:["base",n,bi,mn]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[l,Nt,Tm]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",wm,yt]}],"font-family":[{font:[u4,yt,o]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[d,Nt,yt]}],"line-clamp":[{"line-clamp":[Vt,"none",Nt,Tm]}],leading:[{leading:[m,...T()]}],"list-image":[{"list-image":["none",Nt,yt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Nt,yt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:F()}],"text-color":[{text:F()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...K(),"wavy"]}],"text-decoration-thickness":[{decoration:[Vt,"from-font","auto",Nt,mn]}],"text-decoration-color":[{decoration:F()}],"underline-offset":[{"underline-offset":[Vt,"auto",Nt,yt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Nt,yt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Nt,yt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:de()}],"bg-repeat":[{bg:ze()}],"bg-size":[{bg:A()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Br,Nt,yt],radial:["",Nt,yt],conic:[Br,Nt,yt]},p4,d4]}],"bg-color":[{bg:F()}],"gradient-from-pos":[{from:$()}],"gradient-via-pos":[{via:$()}],"gradient-to-pos":[{to:$()}],"gradient-from":[{from:F()}],"gradient-via":[{via:F()}],"gradient-to":[{to:F()}],rounded:[{rounded:se()}],"rounded-s":[{"rounded-s":se()}],"rounded-e":[{"rounded-e":se()}],"rounded-t":[{"rounded-t":se()}],"rounded-r":[{"rounded-r":se()}],"rounded-b":[{"rounded-b":se()}],"rounded-l":[{"rounded-l":se()}],"rounded-ss":[{"rounded-ss":se()}],"rounded-se":[{"rounded-se":se()}],"rounded-ee":[{"rounded-ee":se()}],"rounded-es":[{"rounded-es":se()}],"rounded-tl":[{"rounded-tl":se()}],"rounded-tr":[{"rounded-tr":se()}],"rounded-br":[{"rounded-br":se()}],"rounded-bl":[{"rounded-bl":se()}],"border-w":[{border:k()}],"border-w-x":[{"border-x":k()}],"border-w-y":[{"border-y":k()}],"border-w-s":[{"border-s":k()}],"border-w-e":[{"border-e":k()}],"border-w-t":[{"border-t":k()}],"border-w-r":[{"border-r":k()}],"border-w-b":[{"border-b":k()}],"border-w-l":[{"border-l":k()}],"divide-x":[{"divide-x":k()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":k()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...K(),"hidden","none"]}],"divide-style":[{divide:[...K(),"hidden","none"]}],"border-color":[{border:F()}],"border-color-x":[{"border-x":F()}],"border-color-y":[{"border-y":F()}],"border-color-s":[{"border-s":F()}],"border-color-e":[{"border-e":F()}],"border-color-t":[{"border-t":F()}],"border-color-r":[{"border-r":F()}],"border-color-b":[{"border-b":F()}],"border-color-l":[{"border-l":F()}],"divide-color":[{divide:F()}],"outline-style":[{outline:[...K(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Vt,Nt,yt]}],"outline-w":[{outline:["",Vt,bi,mn]}],"outline-color":[{outline:F()}],shadow:[{shadow:["","none",v,ec,Jl]}],"shadow-color":[{shadow:F()}],"inset-shadow":[{"inset-shadow":["none",f,ec,Jl]}],"inset-shadow-color":[{"inset-shadow":F()}],"ring-w":[{ring:k()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:F()}],"ring-offset-w":[{"ring-offset":[Vt,mn]}],"ring-offset-color":[{"ring-offset":F()}],"inset-ring-w":[{"inset-ring":k()}],"inset-ring-color":[{"inset-ring":F()}],"text-shadow":[{"text-shadow":["none",N,ec,Jl]}],"text-shadow-color":[{"text-shadow":F()}],opacity:[{opacity:[Vt,Nt,yt]}],"mix-blend":[{"mix-blend":[...M(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":M()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Vt]}],"mask-image-linear-from-pos":[{"mask-linear-from":D()}],"mask-image-linear-to-pos":[{"mask-linear-to":D()}],"mask-image-linear-from-color":[{"mask-linear-from":F()}],"mask-image-linear-to-color":[{"mask-linear-to":F()}],"mask-image-t-from-pos":[{"mask-t-from":D()}],"mask-image-t-to-pos":[{"mask-t-to":D()}],"mask-image-t-from-color":[{"mask-t-from":F()}],"mask-image-t-to-color":[{"mask-t-to":F()}],"mask-image-r-from-pos":[{"mask-r-from":D()}],"mask-image-r-to-pos":[{"mask-r-to":D()}],"mask-image-r-from-color":[{"mask-r-from":F()}],"mask-image-r-to-color":[{"mask-r-to":F()}],"mask-image-b-from-pos":[{"mask-b-from":D()}],"mask-image-b-to-pos":[{"mask-b-to":D()}],"mask-image-b-from-color":[{"mask-b-from":F()}],"mask-image-b-to-color":[{"mask-b-to":F()}],"mask-image-l-from-pos":[{"mask-l-from":D()}],"mask-image-l-to-pos":[{"mask-l-to":D()}],"mask-image-l-from-color":[{"mask-l-from":F()}],"mask-image-l-to-color":[{"mask-l-to":F()}],"mask-image-x-from-pos":[{"mask-x-from":D()}],"mask-image-x-to-pos":[{"mask-x-to":D()}],"mask-image-x-from-color":[{"mask-x-from":F()}],"mask-image-x-to-color":[{"mask-x-to":F()}],"mask-image-y-from-pos":[{"mask-y-from":D()}],"mask-image-y-to-pos":[{"mask-y-to":D()}],"mask-image-y-from-color":[{"mask-y-from":F()}],"mask-image-y-to-color":[{"mask-y-to":F()}],"mask-image-radial":[{"mask-radial":[Nt,yt]}],"mask-image-radial-from-pos":[{"mask-radial-from":D()}],"mask-image-radial-to-pos":[{"mask-radial-to":D()}],"mask-image-radial-from-color":[{"mask-radial-from":F()}],"mask-image-radial-to-color":[{"mask-radial-to":F()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":V()}],"mask-image-conic-pos":[{"mask-conic":[Vt]}],"mask-image-conic-from-pos":[{"mask-conic-from":D()}],"mask-image-conic-to-pos":[{"mask-conic-to":D()}],"mask-image-conic-from-color":[{"mask-conic-from":F()}],"mask-image-conic-to-color":[{"mask-conic-to":F()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:de()}],"mask-repeat":[{mask:ze()}],"mask-size":[{mask:A()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Nt,yt]}],filter:[{filter:["","none",Nt,yt]}],blur:[{blur:q()}],brightness:[{brightness:[Vt,Nt,yt]}],contrast:[{contrast:[Vt,Nt,yt]}],"drop-shadow":[{"drop-shadow":["","none",j,ec,Jl]}],"drop-shadow-color":[{"drop-shadow":F()}],grayscale:[{grayscale:["",Vt,Nt,yt]}],"hue-rotate":[{"hue-rotate":[Vt,Nt,yt]}],invert:[{invert:["",Vt,Nt,yt]}],saturate:[{saturate:[Vt,Nt,yt]}],sepia:[{sepia:["",Vt,Nt,yt]}],"backdrop-filter":[{"backdrop-filter":["","none",Nt,yt]}],"backdrop-blur":[{"backdrop-blur":q()}],"backdrop-brightness":[{"backdrop-brightness":[Vt,Nt,yt]}],"backdrop-contrast":[{"backdrop-contrast":[Vt,Nt,yt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Vt,Nt,yt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Vt,Nt,yt]}],"backdrop-invert":[{"backdrop-invert":["",Vt,Nt,yt]}],"backdrop-opacity":[{"backdrop-opacity":[Vt,Nt,yt]}],"backdrop-saturate":[{"backdrop-saturate":[Vt,Nt,yt]}],"backdrop-sepia":[{"backdrop-sepia":["",Vt,Nt,yt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":T()}],"border-spacing-x":[{"border-spacing-x":T()}],"border-spacing-y":[{"border-spacing-y":T()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Nt,yt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Vt,"initial",Nt,yt]}],ease:[{ease:["linear","initial",E,Nt,yt]}],delay:[{delay:[Vt,Nt,yt]}],animate:[{animate:["none",z,Nt,yt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[w,Nt,yt]}],"perspective-origin":[{"perspective-origin":Z()}],rotate:[{rotate:G()}],"rotate-x":[{"rotate-x":G()}],"rotate-y":[{"rotate-y":G()}],"rotate-z":[{"rotate-z":G()}],scale:[{scale:be()}],"scale-x":[{"scale-x":be()}],"scale-y":[{"scale-y":be()}],"scale-z":[{"scale-z":be()}],"scale-3d":["scale-3d"],skew:[{skew:Ne()}],"skew-x":[{"skew-x":Ne()}],"skew-y":[{"skew-y":Ne()}],transform:[{transform:[Nt,yt,"","none","gpu","cpu"]}],"transform-origin":[{origin:Z()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:R()}],"translate-x":[{"translate-x":R()}],"translate-y":[{"translate-y":R()}],"translate-z":[{"translate-z":R()}],"translate-none":["translate-none"],accent:[{accent:F()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:F()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Nt,yt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Nt,yt]}],fill:[{fill:["none",...F()]}],"stroke-w":[{stroke:[Vt,bi,mn,Tm]}],stroke:[{stroke:["none",...F()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},g4=Q1(f4);function Xt(...s){return g4(gb(s))}const Am=768;function b4(){const[s,o]=c.useState(void 0);return c.useEffect(()=>{const n=window.matchMedia(`(max-width: ${Am-1}px)`),l=()=>{o(window.innerWidth<Am)};return n.addEventListener("change",l),o(window.innerWidth<Am),()=>n.removeEventListener("change",l)},[]),!!s}var v4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Kt=v4.reduce((s,o)=>{const n=fo(`Primitive.${o}`),l=c.forwardRef((d,m)=>{const{asChild:h,...x}=d,g=h?n:o;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(g,{...x,ref:m})});return l.displayName=`Primitive.${o}`,{...s,[o]:l}},{});function Pb(s,o){s&&Pc.flushSync(()=>s.dispatchEvent(o))}function kt(s,o,{checkForDefaultPrevented:n=!0}={}){return function(d){if(s?.(d),n===!1||!d.defaultPrevented)return o?.(d)}}function y4(s,o){const n=c.createContext(o),l=m=>{const{children:h,...x}=m,g=c.useMemo(()=>x,Object.values(x));return e.jsx(n.Provider,{value:g,children:h})};l.displayName=s+"Provider";function d(m){const h=c.useContext(n);if(h)return h;if(o!==void 0)return o;throw new Error(`\`${m}\` must be used within \`${s}\``)}return[l,d]}function ks(s,o=[]){let n=[];function l(m,h){const x=c.createContext(h),g=n.length;n=[...n,h];const b=f=>{const{scope:N,children:j,..._}=f,w=N?.[s]?.[g]||x,C=c.useMemo(()=>_,Object.values(_));return e.jsx(w.Provider,{value:C,children:j})};b.displayName=m+"Provider";function v(f,N){const j=N?.[s]?.[g]||x,_=c.useContext(j);if(_)return _;if(h!==void 0)return h;throw new Error(`\`${f}\` must be used within \`${m}\``)}return[b,v]}const d=()=>{const m=n.map(h=>c.createContext(h));return function(x){const g=x?.[s]||m;return c.useMemo(()=>({[`__scope${s}`]:{...x,[s]:g}}),[x,g])}};return d.scopeName=s,[l,N4(d,...o)]}function N4(...s){const o=s[0];if(s.length===1)return o;const n=()=>{const l=s.map(d=>({useScope:d(),scopeName:d.scopeName}));return function(m){const h=l.reduce((x,{useScope:g,scopeName:b})=>{const f=g(m)[`__scope${b}`];return{...x,...f}},{});return c.useMemo(()=>({[`__scope${o.scopeName}`]:h}),[h])}};return n.scopeName=o.scopeName,n}var pr=globalThis?.document?c.useLayoutEffect:()=>{},j4=Kg[" useId ".trim().toString()]||(()=>{}),_4=0;function Us(s){const[o,n]=c.useState(j4());return pr(()=>{n(l=>l??String(_4++))},[s]),o?`radix-${o}`:""}var S4=Kg[" useInsertionEffect ".trim().toString()]||pr;function gr({prop:s,defaultProp:o,onChange:n=()=>{},caller:l}){const[d,m,h]=w4({defaultProp:o,onChange:n}),x=s!==void 0,g=x?s:d;{const v=c.useRef(s!==void 0);c.useEffect(()=>{const f=v.current;f!==x&&console.warn(`${l} is changing from ${f?"controlled":"uncontrolled"} to ${x?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),v.current=x},[x,l])}const b=c.useCallback(v=>{if(x){const f=T4(v)?v(s):v;f!==s&&h.current?.(f)}else m(v)},[x,s,m,h]);return[g,b]}function w4({defaultProp:s,onChange:o}){const[n,l]=c.useState(s),d=c.useRef(n),m=c.useRef(o);return S4(()=>{m.current=o},[o]),c.useEffect(()=>{d.current!==n&&(m.current?.(n),d.current=n)},[n,d]),[n,l,m]}function T4(s){return typeof s=="function"}function hr(s){const o=c.useRef(s);return c.useEffect(()=>{o.current=s}),c.useMemo(()=>(...n)=>o.current?.(...n),[])}function A4(s,o=globalThis?.document){const n=hr(s);c.useEffect(()=>{const l=d=>{d.key==="Escape"&&n(d)};return o.addEventListener("keydown",l,{capture:!0}),()=>o.removeEventListener("keydown",l,{capture:!0})},[n,o])}var C4="DismissableLayer",Gm="dismissableLayer.update",k4="dismissableLayer.pointerDownOutside",E4="dismissableLayer.focusOutside",_g,Mb=c.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Oc=c.forwardRef((s,o)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:m,onInteractOutside:h,onDismiss:x,...g}=s,b=c.useContext(Mb),[v,f]=c.useState(null),N=v?.ownerDocument??globalThis?.document,[,j]=c.useState({}),_=xa(o,O=>f(O)),w=Array.from(b.layers),[C]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),E=w.indexOf(C),z=v?w.indexOf(v):-1,P=b.layersWithOutsidePointerEventsDisabled.size>0,V=z>=E,Z=P4(O=>{const T=O.target,ge=[...b.branches].some(J=>J.contains(T));!V||ge||(d?.(O),h?.(O),O.defaultPrevented||x?.())},N),oe=M4(O=>{const T=O.target;[...b.branches].some(J=>J.contains(T))||(m?.(O),h?.(O),O.defaultPrevented||x?.())},N);return A4(O=>{z===b.layers.size-1&&(l?.(O),!O.defaultPrevented&&x&&(O.preventDefault(),x()))},N),c.useEffect(()=>{if(v)return n&&(b.layersWithOutsidePointerEventsDisabled.size===0&&(_g=N.body.style.pointerEvents,N.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(v)),b.layers.add(v),Sg(),()=>{n&&b.layersWithOutsidePointerEventsDisabled.size===1&&(N.body.style.pointerEvents=_g)}},[v,N,n,b]),c.useEffect(()=>()=>{v&&(b.layers.delete(v),b.layersWithOutsidePointerEventsDisabled.delete(v),Sg())},[v,b]),c.useEffect(()=>{const O=()=>j({});return document.addEventListener(Gm,O),()=>document.removeEventListener(Gm,O)},[]),e.jsx(Kt.div,{...g,ref:_,style:{pointerEvents:P?V?"auto":"none":void 0,...s.style},onFocusCapture:kt(s.onFocusCapture,oe.onFocusCapture),onBlurCapture:kt(s.onBlurCapture,oe.onBlurCapture),onPointerDownCapture:kt(s.onPointerDownCapture,Z.onPointerDownCapture)})});Oc.displayName=C4;var R4="DismissableLayerBranch",L4=c.forwardRef((s,o)=>{const n=c.useContext(Mb),l=c.useRef(null),d=xa(o,l);return c.useEffect(()=>{const m=l.current;if(m)return n.branches.add(m),()=>{n.branches.delete(m)}},[n.branches]),e.jsx(Kt.div,{...s,ref:d})});L4.displayName=R4;function P4(s,o=globalThis?.document){const n=hr(s),l=c.useRef(!1),d=c.useRef(()=>{});return c.useEffect(()=>{const m=x=>{if(x.target&&!l.current){let g=function(){Ib(k4,n,b,{discrete:!0})};const b={originalEvent:x};x.pointerType==="touch"?(o.removeEventListener("click",d.current),d.current=g,o.addEventListener("click",d.current,{once:!0})):g()}else o.removeEventListener("click",d.current);l.current=!1},h=window.setTimeout(()=>{o.addEventListener("pointerdown",m)},0);return()=>{window.clearTimeout(h),o.removeEventListener("pointerdown",m),o.removeEventListener("click",d.current)}},[o,n]),{onPointerDownCapture:()=>l.current=!0}}function M4(s,o=globalThis?.document){const n=hr(s),l=c.useRef(!1);return c.useEffect(()=>{const d=m=>{m.target&&!l.current&&Ib(E4,n,{originalEvent:m},{discrete:!1})};return o.addEventListener("focusin",d),()=>o.removeEventListener("focusin",d)},[o,n]),{onFocusCapture:()=>l.current=!0,onBlurCapture:()=>l.current=!1}}function Sg(){const s=new CustomEvent(Gm);document.dispatchEvent(s)}function Ib(s,o,n,{discrete:l}){const d=n.originalEvent.target,m=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:n});o&&d.addEventListener(s,o,{once:!0}),l?Pb(d,m):d.dispatchEvent(m)}var Cm="focusScope.autoFocusOnMount",km="focusScope.autoFocusOnUnmount",wg={bubbles:!1,cancelable:!0},I4="FocusScope",bp=c.forwardRef((s,o)=>{const{loop:n=!1,trapped:l=!1,onMountAutoFocus:d,onUnmountAutoFocus:m,...h}=s,[x,g]=c.useState(null),b=hr(d),v=hr(m),f=c.useRef(null),N=xa(o,w=>g(w)),j=c.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;c.useEffect(()=>{if(l){let w=function(P){if(j.paused||!x)return;const V=P.target;x.contains(V)?f.current=V:Vr(f.current,{select:!0})},C=function(P){if(j.paused||!x)return;const V=P.relatedTarget;V!==null&&(x.contains(V)||Vr(f.current,{select:!0}))},E=function(P){if(document.activeElement===document.body)for(const Z of P)Z.removedNodes.length>0&&Vr(x)};document.addEventListener("focusin",w),document.addEventListener("focusout",C);const z=new MutationObserver(E);return x&&z.observe(x,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",w),document.removeEventListener("focusout",C),z.disconnect()}}},[l,x,j.paused]),c.useEffect(()=>{if(x){Ag.add(j);const w=document.activeElement;if(!x.contains(w)){const E=new CustomEvent(Cm,wg);x.addEventListener(Cm,b),x.dispatchEvent(E),E.defaultPrevented||(O4(B4(Ob(x)),{select:!0}),document.activeElement===w&&Vr(x))}return()=>{x.removeEventListener(Cm,b),setTimeout(()=>{const E=new CustomEvent(km,wg);x.addEventListener(km,v),x.dispatchEvent(E),E.defaultPrevented||Vr(w??document.body,{select:!0}),x.removeEventListener(km,v),Ag.remove(j)},0)}}},[x,b,v,j]);const _=c.useCallback(w=>{if(!n&&!l||j.paused)return;const C=w.key==="Tab"&&!w.altKey&&!w.ctrlKey&&!w.metaKey,E=document.activeElement;if(C&&E){const z=w.currentTarget,[P,V]=D4(z);P&&V?!w.shiftKey&&E===V?(w.preventDefault(),n&&Vr(P,{select:!0})):w.shiftKey&&E===P&&(w.preventDefault(),n&&Vr(V,{select:!0})):E===z&&w.preventDefault()}},[n,l,j.paused]);return e.jsx(Kt.div,{tabIndex:-1,...h,ref:N,onKeyDown:_})});bp.displayName=I4;function O4(s,{select:o=!1}={}){const n=document.activeElement;for(const l of s)if(Vr(l,{select:o}),document.activeElement!==n)return}function D4(s){const o=Ob(s),n=Tg(o,s),l=Tg(o.reverse(),s);return[n,l]}function Ob(s){const o=[],n=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:l=>{const d=l.tagName==="INPUT"&&l.type==="hidden";return l.disabled||l.hidden||d?NodeFilter.FILTER_SKIP:l.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)o.push(n.currentNode);return o}function Tg(s,o){for(const n of s)if(!z4(n,{upTo:o}))return n}function z4(s,{upTo:o}){if(getComputedStyle(s).visibility==="hidden")return!0;for(;s;){if(o!==void 0&&s===o)return!1;if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}function q4(s){return s instanceof HTMLInputElement&&"select"in s}function Vr(s,{select:o=!1}={}){if(s&&s.focus){const n=document.activeElement;s.focus({preventScroll:!0}),s!==n&&q4(s)&&o&&s.select()}}var Ag=U4();function U4(){let s=[];return{add(o){const n=s[0];o!==n&&n?.pause(),s=Cg(s,o),s.unshift(o)},remove(o){s=Cg(s,o),s[0]?.resume()}}}function Cg(s,o){const n=[...s],l=n.indexOf(o);return l!==-1&&n.splice(l,1),n}function B4(s){return s.filter(o=>o.tagName!=="A")}var V4="Portal",Dc=c.forwardRef((s,o)=>{const{container:n,...l}=s,[d,m]=c.useState(!1);pr(()=>m(!0),[]);const h=n||d&&globalThis?.document?.body;return h?yw.createPortal(e.jsx(Kt.div,{...l,ref:o}),h):null});Dc.displayName=V4;function $4(s,o){return c.useReducer((n,l)=>o[n][l]??n,s)}var js=s=>{const{present:o,children:n}=s,l=F4(o),d=typeof n=="function"?n({present:l.isPresent}):c.Children.only(n),m=xa(l.ref,H4(d));return typeof n=="function"||l.isPresent?c.cloneElement(d,{ref:m}):null};js.displayName="Presence";function F4(s){const[o,n]=c.useState(),l=c.useRef(null),d=c.useRef(s),m=c.useRef("none"),h=s?"mounted":"unmounted",[x,g]=$4(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return c.useEffect(()=>{const b=tc(l.current);m.current=x==="mounted"?b:"none"},[x]),pr(()=>{const b=l.current,v=d.current;if(v!==s){const N=m.current,j=tc(b);s?g("MOUNT"):j==="none"||b?.display==="none"?g("UNMOUNT"):g(v&&N!==j?"ANIMATION_OUT":"UNMOUNT"),d.current=s}},[s,g]),pr(()=>{if(o){let b;const v=o.ownerDocument.defaultView??window,f=j=>{const w=tc(l.current).includes(CSS.escape(j.animationName));if(j.target===o&&w&&(g("ANIMATION_END"),!d.current)){const C=o.style.animationFillMode;o.style.animationFillMode="forwards",b=v.setTimeout(()=>{o.style.animationFillMode==="forwards"&&(o.style.animationFillMode=C)})}},N=j=>{j.target===o&&(m.current=tc(l.current))};return o.addEventListener("animationstart",N),o.addEventListener("animationcancel",f),o.addEventListener("animationend",f),()=>{v.clearTimeout(b),o.removeEventListener("animationstart",N),o.removeEventListener("animationcancel",f),o.removeEventListener("animationend",f)}}else g("ANIMATION_END")},[o,g]),{isPresent:["mounted","unmountSuspended"].includes(x),ref:c.useCallback(b=>{l.current=b?getComputedStyle(b):null,n(b)},[])}}function tc(s){return s?.animationName||"none"}function H4(s){let o=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,n=o&&"isReactWarning"in o&&o.isReactWarning;return n?s.ref:(o=Object.getOwnPropertyDescriptor(s,"ref")?.get,n=o&&"isReactWarning"in o&&o.isReactWarning,n?s.props.ref:s.props.ref||s.ref)}var Em=0;function Db(){c.useEffect(()=>{const s=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",s[0]??kg()),document.body.insertAdjacentElement("beforeend",s[1]??kg()),Em++,()=>{Em===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(o=>o.remove()),Em--}},[])}function kg(){const s=document.createElement("span");return s.setAttribute("data-radix-focus-guard",""),s.tabIndex=0,s.style.outline="none",s.style.opacity="0",s.style.position="fixed",s.style.pointerEvents="none",s}var Os=function(){return Os=Object.assign||function(o){for(var n,l=1,d=arguments.length;l<d;l++){n=arguments[l];for(var m in n)Object.prototype.hasOwnProperty.call(n,m)&&(o[m]=n[m])}return o},Os.apply(this,arguments)};function zb(s,o){var n={};for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&o.indexOf(l)<0&&(n[l]=s[l]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,l=Object.getOwnPropertySymbols(s);d<l.length;d++)o.indexOf(l[d])<0&&Object.prototype.propertyIsEnumerable.call(s,l[d])&&(n[l[d]]=s[l[d]]);return n}function G4(s,o,n){if(n||arguments.length===2)for(var l=0,d=o.length,m;l<d;l++)(m||!(l in o))&&(m||(m=Array.prototype.slice.call(o,0,l)),m[l]=o[l]);return s.concat(m||Array.prototype.slice.call(o))}var dc="right-scroll-bar-position",uc="width-before-scroll-bar",W4="with-scroll-bars-hidden",K4="--removed-body-scroll-bar-size";function Rm(s,o){return typeof s=="function"?s(o):s&&(s.current=o),s}function Y4(s,o){var n=c.useState(function(){return{value:s,callback:o,facade:{get current(){return n.value},set current(l){var d=n.value;d!==l&&(n.value=l,n.callback(l,d))}}}})[0];return n.callback=o,n.facade}var X4=typeof window<"u"?c.useLayoutEffect:c.useEffect,Eg=new WeakMap;function Q4(s,o){var n=Y4(null,function(l){return s.forEach(function(d){return Rm(d,l)})});return X4(function(){var l=Eg.get(n);if(l){var d=new Set(l),m=new Set(s),h=n.current;d.forEach(function(x){m.has(x)||Rm(x,null)}),m.forEach(function(x){d.has(x)||Rm(x,h)})}Eg.set(n,s)},[s]),n}function Z4(s){return s}function J4(s,o){o===void 0&&(o=Z4);var n=[],l=!1,d={read:function(){if(l)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:s},useMedium:function(m){var h=o(m,l);return n.push(h),function(){n=n.filter(function(x){return x!==h})}},assignSyncMedium:function(m){for(l=!0;n.length;){var h=n;n=[],h.forEach(m)}n={push:function(x){return m(x)},filter:function(){return n}}},assignMedium:function(m){l=!0;var h=[];if(n.length){var x=n;n=[],x.forEach(m),h=n}var g=function(){var v=h;h=[],v.forEach(m)},b=function(){return Promise.resolve().then(g)};b(),n={push:function(v){h.push(v),b()},filter:function(v){return h=h.filter(v),n}}}};return d}function eT(s){s===void 0&&(s={});var o=J4(null);return o.options=Os({async:!0,ssr:!1},s),o}var qb=function(s){var o=s.sideCar,n=zb(s,["sideCar"]);if(!o)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var l=o.read();if(!l)throw new Error("Sidecar medium not found");return c.createElement(l,Os({},n))};qb.isSideCarExport=!0;function tT(s,o){return s.useMedium(o),qb}var Ub=eT(),Lm=function(){},zc=c.forwardRef(function(s,o){var n=c.useRef(null),l=c.useState({onScrollCapture:Lm,onWheelCapture:Lm,onTouchMoveCapture:Lm}),d=l[0],m=l[1],h=s.forwardProps,x=s.children,g=s.className,b=s.removeScrollBar,v=s.enabled,f=s.shards,N=s.sideCar,j=s.noRelative,_=s.noIsolation,w=s.inert,C=s.allowPinchZoom,E=s.as,z=E===void 0?"div":E,P=s.gapMode,V=zb(s,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),Z=N,oe=Q4([n,o]),O=Os(Os({},V),d);return c.createElement(c.Fragment,null,v&&c.createElement(Z,{sideCar:Ub,removeScrollBar:b,shards:f,noRelative:j,noIsolation:_,inert:w,setCallbacks:m,allowPinchZoom:!!C,lockRef:n,gapMode:P}),h?c.cloneElement(c.Children.only(x),Os(Os({},O),{ref:oe})):c.createElement(z,Os({},O,{className:g,ref:oe}),x))});zc.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};zc.classNames={fullWidth:uc,zeroRight:dc};var aT=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function sT(){if(!document)return null;var s=document.createElement("style");s.type="text/css";var o=aT();return o&&s.setAttribute("nonce",o),s}function rT(s,o){s.styleSheet?s.styleSheet.cssText=o:s.appendChild(document.createTextNode(o))}function nT(s){var o=document.head||document.getElementsByTagName("head")[0];o.appendChild(s)}var oT=function(){var s=0,o=null;return{add:function(n){s==0&&(o=sT())&&(rT(o,n),nT(o)),s++},remove:function(){s--,!s&&o&&(o.parentNode&&o.parentNode.removeChild(o),o=null)}}},iT=function(){var s=oT();return function(o,n){c.useEffect(function(){return s.add(o),function(){s.remove()}},[o&&n])}},Bb=function(){var s=iT(),o=function(n){var l=n.styles,d=n.dynamic;return s(l,d),null};return o},lT={left:0,top:0,right:0,gap:0},Pm=function(s){return parseInt(s||"",10)||0},cT=function(s){var o=window.getComputedStyle(document.body),n=o[s==="padding"?"paddingLeft":"marginLeft"],l=o[s==="padding"?"paddingTop":"marginTop"],d=o[s==="padding"?"paddingRight":"marginRight"];return[Pm(n),Pm(l),Pm(d)]},dT=function(s){if(s===void 0&&(s="margin"),typeof window>"u")return lT;var o=cT(s),n=document.documentElement.clientWidth,l=window.innerWidth;return{left:o[0],top:o[1],right:o[2],gap:Math.max(0,l-n+o[2]-o[0])}},uT=Bb(),co="data-scroll-locked",mT=function(s,o,n,l){var d=s.left,m=s.top,h=s.right,x=s.gap;return n===void 0&&(n="margin"),`
  .`.concat(W4,` {
   overflow: hidden `).concat(l,`;
   padding-right: `).concat(x,"px ").concat(l,`;
  }
  body[`).concat(co,`] {
    overflow: hidden `).concat(l,`;
    overscroll-behavior: contain;
    `).concat([o&&"position: relative ".concat(l,";"),n==="margin"&&`
    padding-left: `.concat(d,`px;
    padding-top: `).concat(m,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(x,"px ").concat(l,`;
    `),n==="padding"&&"padding-right: ".concat(x,"px ").concat(l,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(dc,` {
    right: `).concat(x,"px ").concat(l,`;
  }
  
  .`).concat(uc,` {
    margin-right: `).concat(x,"px ").concat(l,`;
  }
  
  .`).concat(dc," .").concat(dc,` {
    right: 0 `).concat(l,`;
  }
  
  .`).concat(uc," .").concat(uc,` {
    margin-right: 0 `).concat(l,`;
  }
  
  body[`).concat(co,`] {
    `).concat(K4,": ").concat(x,`px;
  }
`)},Rg=function(){var s=parseInt(document.body.getAttribute(co)||"0",10);return isFinite(s)?s:0},pT=function(){c.useEffect(function(){return document.body.setAttribute(co,(Rg()+1).toString()),function(){var s=Rg()-1;s<=0?document.body.removeAttribute(co):document.body.setAttribute(co,s.toString())}},[])},hT=function(s){var o=s.noRelative,n=s.noImportant,l=s.gapMode,d=l===void 0?"margin":l;pT();var m=c.useMemo(function(){return dT(d)},[d]);return c.createElement(uT,{styles:mT(m,!o,d,n?"":"!important")})},Wm=!1;if(typeof window<"u")try{var ac=Object.defineProperty({},"passive",{get:function(){return Wm=!0,!0}});window.addEventListener("test",ac,ac),window.removeEventListener("test",ac,ac)}catch{Wm=!1}var so=Wm?{passive:!1}:!1,xT=function(s){return s.tagName==="TEXTAREA"},Vb=function(s,o){if(!(s instanceof Element))return!1;var n=window.getComputedStyle(s);return n[o]!=="hidden"&&!(n.overflowY===n.overflowX&&!xT(s)&&n[o]==="visible")},fT=function(s){return Vb(s,"overflowY")},gT=function(s){return Vb(s,"overflowX")},Lg=function(s,o){var n=o.ownerDocument,l=o;do{typeof ShadowRoot<"u"&&l instanceof ShadowRoot&&(l=l.host);var d=$b(s,l);if(d){var m=Fb(s,l),h=m[1],x=m[2];if(h>x)return!0}l=l.parentNode}while(l&&l!==n.body);return!1},bT=function(s){var o=s.scrollTop,n=s.scrollHeight,l=s.clientHeight;return[o,n,l]},vT=function(s){var o=s.scrollLeft,n=s.scrollWidth,l=s.clientWidth;return[o,n,l]},$b=function(s,o){return s==="v"?fT(o):gT(o)},Fb=function(s,o){return s==="v"?bT(o):vT(o)},yT=function(s,o){return s==="h"&&o==="rtl"?-1:1},NT=function(s,o,n,l,d){var m=yT(s,window.getComputedStyle(o).direction),h=m*l,x=n.target,g=o.contains(x),b=!1,v=h>0,f=0,N=0;do{if(!x)break;var j=Fb(s,x),_=j[0],w=j[1],C=j[2],E=w-C-m*_;(_||E)&&$b(s,x)&&(f+=E,N+=_);var z=x.parentNode;x=z&&z.nodeType===Node.DOCUMENT_FRAGMENT_NODE?z.host:z}while(!g&&x!==document.body||g&&(o.contains(x)||o===x));return(v&&Math.abs(f)<1||!v&&Math.abs(N)<1)&&(b=!0),b},sc=function(s){return"changedTouches"in s?[s.changedTouches[0].clientX,s.changedTouches[0].clientY]:[0,0]},Pg=function(s){return[s.deltaX,s.deltaY]},Mg=function(s){return s&&"current"in s?s.current:s},jT=function(s,o){return s[0]===o[0]&&s[1]===o[1]},_T=function(s){return`
  .block-interactivity-`.concat(s,` {pointer-events: none;}
  .allow-interactivity-`).concat(s,` {pointer-events: all;}
`)},ST=0,ro=[];function wT(s){var o=c.useRef([]),n=c.useRef([0,0]),l=c.useRef(),d=c.useState(ST++)[0],m=c.useState(Bb)[0],h=c.useRef(s);c.useEffect(function(){h.current=s},[s]),c.useEffect(function(){if(s.inert){document.body.classList.add("block-interactivity-".concat(d));var w=G4([s.lockRef.current],(s.shards||[]).map(Mg),!0).filter(Boolean);return w.forEach(function(C){return C.classList.add("allow-interactivity-".concat(d))}),function(){document.body.classList.remove("block-interactivity-".concat(d)),w.forEach(function(C){return C.classList.remove("allow-interactivity-".concat(d))})}}},[s.inert,s.lockRef.current,s.shards]);var x=c.useCallback(function(w,C){if("touches"in w&&w.touches.length===2||w.type==="wheel"&&w.ctrlKey)return!h.current.allowPinchZoom;var E=sc(w),z=n.current,P="deltaX"in w?w.deltaX:z[0]-E[0],V="deltaY"in w?w.deltaY:z[1]-E[1],Z,oe=w.target,O=Math.abs(P)>Math.abs(V)?"h":"v";if("touches"in w&&O==="h"&&oe.type==="range")return!1;var T=Lg(O,oe);if(!T)return!0;if(T?Z=O:(Z=O==="v"?"h":"v",T=Lg(O,oe)),!T)return!1;if(!l.current&&"changedTouches"in w&&(P||V)&&(l.current=Z),!Z)return!0;var ge=l.current||Z;return NT(ge,C,w,ge==="h"?P:V)},[]),g=c.useCallback(function(w){var C=w;if(!(!ro.length||ro[ro.length-1]!==m)){var E="deltaY"in C?Pg(C):sc(C),z=o.current.filter(function(Z){return Z.name===C.type&&(Z.target===C.target||C.target===Z.shadowParent)&&jT(Z.delta,E)})[0];if(z&&z.should){C.cancelable&&C.preventDefault();return}if(!z){var P=(h.current.shards||[]).map(Mg).filter(Boolean).filter(function(Z){return Z.contains(C.target)}),V=P.length>0?x(C,P[0]):!h.current.noIsolation;V&&C.cancelable&&C.preventDefault()}}},[]),b=c.useCallback(function(w,C,E,z){var P={name:w,delta:C,target:E,should:z,shadowParent:TT(E)};o.current.push(P),setTimeout(function(){o.current=o.current.filter(function(V){return V!==P})},1)},[]),v=c.useCallback(function(w){n.current=sc(w),l.current=void 0},[]),f=c.useCallback(function(w){b(w.type,Pg(w),w.target,x(w,s.lockRef.current))},[]),N=c.useCallback(function(w){b(w.type,sc(w),w.target,x(w,s.lockRef.current))},[]);c.useEffect(function(){return ro.push(m),s.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:N}),document.addEventListener("wheel",g,so),document.addEventListener("touchmove",g,so),document.addEventListener("touchstart",v,so),function(){ro=ro.filter(function(w){return w!==m}),document.removeEventListener("wheel",g,so),document.removeEventListener("touchmove",g,so),document.removeEventListener("touchstart",v,so)}},[]);var j=s.removeScrollBar,_=s.inert;return c.createElement(c.Fragment,null,_?c.createElement(m,{styles:_T(d)}):null,j?c.createElement(hT,{noRelative:s.noRelative,gapMode:s.gapMode}):null)}function TT(s){for(var o=null;s!==null;)s instanceof ShadowRoot&&(o=s.host,s=s.host),s=s.parentNode;return o}const AT=tT(Ub,wT);var vp=c.forwardRef(function(s,o){return c.createElement(zc,Os({},s,{ref:o,sideCar:AT}))});vp.classNames=zc.classNames;var CT=function(s){if(typeof document>"u")return null;var o=Array.isArray(s)?s[0]:s;return o.ownerDocument.body},no=new WeakMap,rc=new WeakMap,nc={},Mm=0,Hb=function(s){return s&&(s.host||Hb(s.parentNode))},kT=function(s,o){return o.map(function(n){if(s.contains(n))return n;var l=Hb(n);return l&&s.contains(l)?l:(console.error("aria-hidden",n,"in not contained inside",s,". Doing nothing"),null)}).filter(function(n){return!!n})},ET=function(s,o,n,l){var d=kT(o,Array.isArray(s)?s:[s]);nc[n]||(nc[n]=new WeakMap);var m=nc[n],h=[],x=new Set,g=new Set(d),b=function(f){!f||x.has(f)||(x.add(f),b(f.parentNode))};d.forEach(b);var v=function(f){!f||g.has(f)||Array.prototype.forEach.call(f.children,function(N){if(x.has(N))v(N);else try{var j=N.getAttribute(l),_=j!==null&&j!=="false",w=(no.get(N)||0)+1,C=(m.get(N)||0)+1;no.set(N,w),m.set(N,C),h.push(N),w===1&&_&&rc.set(N,!0),C===1&&N.setAttribute(n,"true"),_||N.setAttribute(l,"true")}catch(E){console.error("aria-hidden: cannot operate on ",N,E)}})};return v(o),x.clear(),Mm++,function(){h.forEach(function(f){var N=no.get(f)-1,j=m.get(f)-1;no.set(f,N),m.set(f,j),N||(rc.has(f)||f.removeAttribute(l),rc.delete(f)),j||f.removeAttribute(n)}),Mm--,Mm||(no=new WeakMap,no=new WeakMap,rc=new WeakMap,nc={})}},Gb=function(s,o,n){n===void 0&&(n="data-aria-hidden");var l=Array.from(Array.isArray(s)?s:[s]),d=CT(s);return d?(l.push.apply(l,Array.from(d.querySelectorAll("[aria-live], script"))),ET(l,d,n,"aria-hidden")):function(){return null}},qc="Dialog",[Wb]=ks(qc),[RT,Es]=Wb(qc),Kb=s=>{const{__scopeDialog:o,children:n,open:l,defaultOpen:d,onOpenChange:m,modal:h=!0}=s,x=c.useRef(null),g=c.useRef(null),[b,v]=gr({prop:l,defaultProp:d??!1,onChange:m,caller:qc});return e.jsx(RT,{scope:o,triggerRef:x,contentRef:g,contentId:Us(),titleId:Us(),descriptionId:Us(),open:b,onOpenChange:v,onOpenToggle:c.useCallback(()=>v(f=>!f),[v]),modal:h,children:n})};Kb.displayName=qc;var Yb="DialogTrigger",LT=c.forwardRef((s,o)=>{const{__scopeDialog:n,...l}=s,d=Es(Yb,n),m=xa(o,d.triggerRef);return e.jsx(Kt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":d.open,"aria-controls":d.contentId,"data-state":jp(d.open),...l,ref:m,onClick:kt(s.onClick,d.onOpenToggle)})});LT.displayName=Yb;var yp="DialogPortal",[PT,Xb]=Wb(yp,{forceMount:void 0}),Qb=s=>{const{__scopeDialog:o,forceMount:n,children:l,container:d}=s,m=Es(yp,o);return e.jsx(PT,{scope:o,forceMount:n,children:c.Children.map(l,h=>e.jsx(js,{present:n||m.open,children:e.jsx(Dc,{asChild:!0,container:d,children:h})}))})};Qb.displayName=yp;var yc="DialogOverlay",Zb=c.forwardRef((s,o)=>{const n=Xb(yc,s.__scopeDialog),{forceMount:l=n.forceMount,...d}=s,m=Es(yc,s.__scopeDialog);return m.modal?e.jsx(js,{present:l||m.open,children:e.jsx(IT,{...d,ref:o})}):null});Zb.displayName=yc;var MT=fo("DialogOverlay.RemoveScroll"),IT=c.forwardRef((s,o)=>{const{__scopeDialog:n,...l}=s,d=Es(yc,n);return e.jsx(vp,{as:MT,allowPinchZoom:!0,shards:[d.contentRef],children:e.jsx(Kt.div,{"data-state":jp(d.open),...l,ref:o,style:{pointerEvents:"auto",...l.style}})})}),gn="DialogContent",Jb=c.forwardRef((s,o)=>{const n=Xb(gn,s.__scopeDialog),{forceMount:l=n.forceMount,...d}=s,m=Es(gn,s.__scopeDialog);return e.jsx(js,{present:l||m.open,children:m.modal?e.jsx(OT,{...d,ref:o}):e.jsx(DT,{...d,ref:o})})});Jb.displayName=gn;var OT=c.forwardRef((s,o)=>{const n=Es(gn,s.__scopeDialog),l=c.useRef(null),d=xa(o,n.contentRef,l);return c.useEffect(()=>{const m=l.current;if(m)return Gb(m)},[]),e.jsx(ev,{...s,ref:d,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:kt(s.onCloseAutoFocus,m=>{m.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:kt(s.onPointerDownOutside,m=>{const h=m.detail.originalEvent,x=h.button===0&&h.ctrlKey===!0;(h.button===2||x)&&m.preventDefault()}),onFocusOutside:kt(s.onFocusOutside,m=>m.preventDefault())})}),DT=c.forwardRef((s,o)=>{const n=Es(gn,s.__scopeDialog),l=c.useRef(!1),d=c.useRef(!1);return e.jsx(ev,{...s,ref:o,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:m=>{s.onCloseAutoFocus?.(m),m.defaultPrevented||(l.current||n.triggerRef.current?.focus(),m.preventDefault()),l.current=!1,d.current=!1},onInteractOutside:m=>{s.onInteractOutside?.(m),m.defaultPrevented||(l.current=!0,m.detail.originalEvent.type==="pointerdown"&&(d.current=!0));const h=m.target;n.triggerRef.current?.contains(h)&&m.preventDefault(),m.detail.originalEvent.type==="focusin"&&d.current&&m.preventDefault()}})}),ev=c.forwardRef((s,o)=>{const{__scopeDialog:n,trapFocus:l,onOpenAutoFocus:d,onCloseAutoFocus:m,...h}=s,x=Es(gn,n),g=c.useRef(null),b=xa(o,g);return Db(),e.jsxs(e.Fragment,{children:[e.jsx(bp,{asChild:!0,loop:!0,trapped:l,onMountAutoFocus:d,onUnmountAutoFocus:m,children:e.jsx(Oc,{role:"dialog",id:x.contentId,"aria-describedby":x.descriptionId,"aria-labelledby":x.titleId,"data-state":jp(x.open),...h,ref:b,onDismiss:()=>x.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(zT,{titleId:x.titleId}),e.jsx(UT,{contentRef:g,descriptionId:x.descriptionId})]})]})}),Np="DialogTitle",tv=c.forwardRef((s,o)=>{const{__scopeDialog:n,...l}=s,d=Es(Np,n);return e.jsx(Kt.h2,{id:d.titleId,...l,ref:o})});tv.displayName=Np;var av="DialogDescription",sv=c.forwardRef((s,o)=>{const{__scopeDialog:n,...l}=s,d=Es(av,n);return e.jsx(Kt.p,{id:d.descriptionId,...l,ref:o})});sv.displayName=av;var rv="DialogClose",nv=c.forwardRef((s,o)=>{const{__scopeDialog:n,...l}=s,d=Es(rv,n);return e.jsx(Kt.button,{type:"button",...l,ref:o,onClick:kt(s.onClick,()=>d.onOpenChange(!1))})});nv.displayName=rv;function jp(s){return s?"open":"closed"}var ov="DialogTitleWarning",[H2,iv]=y4(ov,{contentName:gn,titleName:Np,docsSlug:"dialog"}),zT=({titleId:s})=>{const o=iv(ov),n=`\`${o.contentName}\` requires a \`${o.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${o.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${o.docsSlug}`;return c.useEffect(()=>{s&&(document.getElementById(s)||console.error(n))},[n,s]),null},qT="DialogDescriptionWarning",UT=({contentRef:s,descriptionId:o})=>{const l=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${iv(qT).contentName}}.`;return c.useEffect(()=>{const d=s.current?.getAttribute("aria-describedby");o&&d&&(document.getElementById(o)||console.warn(l))},[l,s,o]),null},BT=Kb,VT=Qb,lv=Zb,cv=Jb,dv=tv,uv=sv,$T=nv;const FT=BT,HT=VT,mv=c.forwardRef(({className:s,...o},n)=>e.jsx(lv,{className:Xt("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...o,ref:n}));mv.displayName=lv.displayName;const GT={side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},pv=c.forwardRef(({side:s="right",className:o,children:n,...l},d)=>e.jsxs(HT,{children:[e.jsx(mv,{}),e.jsxs(cv,{ref:d,className:Xt("fixed z-50 gap-4 bg-white p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",GT.side[s],o),...l,children:[n,e.jsxs($T,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-gray-100",children:[e.jsx(O1,{className:"size-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));pv.displayName=cv.displayName;const hv=({className:s,...o})=>e.jsx("div",{className:Xt("flex flex-col space-y-2 text-center sm:text-left",s),...o});hv.displayName="SheetHeader";const xv=c.forwardRef(({className:s,...o},n)=>e.jsx(dv,{ref:n,className:Xt("text-lg font-semibold text-gray-950",s),...o}));xv.displayName=dv.displayName;const fv=c.forwardRef(({className:s,...o},n)=>e.jsx(uv,{ref:n,className:Xt("text-sm text-gray-500",s),...o}));fv.displayName=uv.displayName;const WT=["top","right","bottom","left"],Wr=Math.min,is=Math.max,Nc=Math.round,oc=Math.floor,Bs=s=>({x:s,y:s}),KT={left:"right",right:"left",bottom:"top",top:"bottom"},YT={start:"end",end:"start"};function Km(s,o,n){return is(s,Wr(o,n))}function xr(s,o){return typeof s=="function"?s(o):s}function fr(s){return s.split("-")[0]}function jo(s){return s.split("-")[1]}function _p(s){return s==="x"?"y":"x"}function Sp(s){return s==="y"?"height":"width"}const XT=new Set(["top","bottom"]);function zs(s){return XT.has(fr(s))?"y":"x"}function wp(s){return _p(zs(s))}function QT(s,o,n){n===void 0&&(n=!1);const l=jo(s),d=wp(s),m=Sp(d);let h=d==="x"?l===(n?"end":"start")?"right":"left":l==="start"?"bottom":"top";return o.reference[m]>o.floating[m]&&(h=jc(h)),[h,jc(h)]}function ZT(s){const o=jc(s);return[Ym(s),o,Ym(o)]}function Ym(s){return s.replace(/start|end/g,o=>YT[o])}const Ig=["left","right"],Og=["right","left"],JT=["top","bottom"],eA=["bottom","top"];function tA(s,o,n){switch(s){case"top":case"bottom":return n?o?Og:Ig:o?Ig:Og;case"left":case"right":return o?JT:eA;default:return[]}}function aA(s,o,n,l){const d=jo(s);let m=tA(fr(s),n==="start",l);return d&&(m=m.map(h=>h+"-"+d),o&&(m=m.concat(m.map(Ym)))),m}function jc(s){return s.replace(/left|right|bottom|top/g,o=>KT[o])}function sA(s){return{top:0,right:0,bottom:0,left:0,...s}}function gv(s){return typeof s!="number"?sA(s):{top:s,right:s,bottom:s,left:s}}function _c(s){const{x:o,y:n,width:l,height:d}=s;return{width:l,height:d,top:n,left:o,right:o+l,bottom:n+d,x:o,y:n}}function Dg(s,o,n){let{reference:l,floating:d}=s;const m=zs(o),h=wp(o),x=Sp(h),g=fr(o),b=m==="y",v=l.x+l.width/2-d.width/2,f=l.y+l.height/2-d.height/2,N=l[x]/2-d[x]/2;let j;switch(g){case"top":j={x:v,y:l.y-d.height};break;case"bottom":j={x:v,y:l.y+l.height};break;case"right":j={x:l.x+l.width,y:f};break;case"left":j={x:l.x-d.width,y:f};break;default:j={x:l.x,y:l.y}}switch(jo(o)){case"start":j[h]-=N*(n&&b?-1:1);break;case"end":j[h]+=N*(n&&b?-1:1);break}return j}const rA=async(s,o,n)=>{const{placement:l="bottom",strategy:d="absolute",middleware:m=[],platform:h}=n,x=m.filter(Boolean),g=await(h.isRTL==null?void 0:h.isRTL(o));let b=await h.getElementRects({reference:s,floating:o,strategy:d}),{x:v,y:f}=Dg(b,l,g),N=l,j={},_=0;for(let w=0;w<x.length;w++){const{name:C,fn:E}=x[w],{x:z,y:P,data:V,reset:Z}=await E({x:v,y:f,initialPlacement:l,placement:N,strategy:d,middlewareData:j,rects:b,platform:h,elements:{reference:s,floating:o}});v=z??v,f=P??f,j={...j,[C]:{...j[C],...V}},Z&&_<=50&&(_++,typeof Z=="object"&&(Z.placement&&(N=Z.placement),Z.rects&&(b=Z.rects===!0?await h.getElementRects({reference:s,floating:o,strategy:d}):Z.rects),{x:v,y:f}=Dg(b,N,g)),w=-1)}return{x:v,y:f,placement:N,strategy:d,middlewareData:j}};async function Ti(s,o){var n;o===void 0&&(o={});const{x:l,y:d,platform:m,rects:h,elements:x,strategy:g}=s,{boundary:b="clippingAncestors",rootBoundary:v="viewport",elementContext:f="floating",altBoundary:N=!1,padding:j=0}=xr(o,s),_=gv(j),C=x[N?f==="floating"?"reference":"floating":f],E=_c(await m.getClippingRect({element:(n=await(m.isElement==null?void 0:m.isElement(C)))==null||n?C:C.contextElement||await(m.getDocumentElement==null?void 0:m.getDocumentElement(x.floating)),boundary:b,rootBoundary:v,strategy:g})),z=f==="floating"?{x:l,y:d,width:h.floating.width,height:h.floating.height}:h.reference,P=await(m.getOffsetParent==null?void 0:m.getOffsetParent(x.floating)),V=await(m.isElement==null?void 0:m.isElement(P))?await(m.getScale==null?void 0:m.getScale(P))||{x:1,y:1}:{x:1,y:1},Z=_c(m.convertOffsetParentRelativeRectToViewportRelativeRect?await m.convertOffsetParentRelativeRectToViewportRelativeRect({elements:x,rect:z,offsetParent:P,strategy:g}):z);return{top:(E.top-Z.top+_.top)/V.y,bottom:(Z.bottom-E.bottom+_.bottom)/V.y,left:(E.left-Z.left+_.left)/V.x,right:(Z.right-E.right+_.right)/V.x}}const nA=s=>({name:"arrow",options:s,async fn(o){const{x:n,y:l,placement:d,rects:m,platform:h,elements:x,middlewareData:g}=o,{element:b,padding:v=0}=xr(s,o)||{};if(b==null)return{};const f=gv(v),N={x:n,y:l},j=wp(d),_=Sp(j),w=await h.getDimensions(b),C=j==="y",E=C?"top":"left",z=C?"bottom":"right",P=C?"clientHeight":"clientWidth",V=m.reference[_]+m.reference[j]-N[j]-m.floating[_],Z=N[j]-m.reference[j],oe=await(h.getOffsetParent==null?void 0:h.getOffsetParent(b));let O=oe?oe[P]:0;(!O||!await(h.isElement==null?void 0:h.isElement(oe)))&&(O=x.floating[P]||m.floating[_]);const T=V/2-Z/2,ge=O/2-w[_]/2-1,J=Wr(f[E],ge),W=Wr(f[z],ge),ne=J,Ee=O-w[_]-W,Ce=O/2-w[_]/2+T,Le=Km(ne,Ce,Ee),I=!g.arrow&&jo(d)!=null&&Ce!==Le&&m.reference[_]/2-(Ce<ne?J:W)-w[_]/2<0,Q=I?Ce<ne?Ce-ne:Ce-Ee:0;return{[j]:N[j]+Q,data:{[j]:Le,centerOffset:Ce-Le-Q,...I&&{alignmentOffset:Q}},reset:I}}}),oA=function(s){return s===void 0&&(s={}),{name:"flip",options:s,async fn(o){var n,l;const{placement:d,middlewareData:m,rects:h,initialPlacement:x,platform:g,elements:b}=o,{mainAxis:v=!0,crossAxis:f=!0,fallbackPlacements:N,fallbackStrategy:j="bestFit",fallbackAxisSideDirection:_="none",flipAlignment:w=!0,...C}=xr(s,o);if((n=m.arrow)!=null&&n.alignmentOffset)return{};const E=fr(d),z=zs(x),P=fr(x)===x,V=await(g.isRTL==null?void 0:g.isRTL(b.floating)),Z=N||(P||!w?[jc(x)]:ZT(x)),oe=_!=="none";!N&&oe&&Z.push(...aA(x,w,_,V));const O=[x,...Z],T=await Ti(o,C),ge=[];let J=((l=m.flip)==null?void 0:l.overflows)||[];if(v&&ge.push(T[E]),f){const Ce=QT(d,h,V);ge.push(T[Ce[0]],T[Ce[1]])}if(J=[...J,{placement:d,overflows:ge}],!ge.every(Ce=>Ce<=0)){var W,ne;const Ce=(((W=m.flip)==null?void 0:W.index)||0)+1,Le=O[Ce];if(Le&&(!(f==="alignment"?z!==zs(Le):!1)||J.every(F=>zs(F.placement)===z?F.overflows[0]>0:!0)))return{data:{index:Ce,overflows:J},reset:{placement:Le}};let I=(ne=J.filter(Q=>Q.overflows[0]<=0).sort((Q,F)=>Q.overflows[1]-F.overflows[1])[0])==null?void 0:ne.placement;if(!I)switch(j){case"bestFit":{var Ee;const Q=(Ee=J.filter(F=>{if(oe){const de=zs(F.placement);return de===z||de==="y"}return!0}).map(F=>[F.placement,F.overflows.filter(de=>de>0).reduce((de,ze)=>de+ze,0)]).sort((F,de)=>F[1]-de[1])[0])==null?void 0:Ee[0];Q&&(I=Q);break}case"initialPlacement":I=x;break}if(d!==I)return{reset:{placement:I}}}return{}}}};function zg(s,o){return{top:s.top-o.height,right:s.right-o.width,bottom:s.bottom-o.height,left:s.left-o.width}}function qg(s){return WT.some(o=>s[o]>=0)}const iA=function(s){return s===void 0&&(s={}),{name:"hide",options:s,async fn(o){const{rects:n}=o,{strategy:l="referenceHidden",...d}=xr(s,o);switch(l){case"referenceHidden":{const m=await Ti(o,{...d,elementContext:"reference"}),h=zg(m,n.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:qg(h)}}}case"escaped":{const m=await Ti(o,{...d,altBoundary:!0}),h=zg(m,n.floating);return{data:{escapedOffsets:h,escaped:qg(h)}}}default:return{}}}}},bv=new Set(["left","top"]);async function lA(s,o){const{placement:n,platform:l,elements:d}=s,m=await(l.isRTL==null?void 0:l.isRTL(d.floating)),h=fr(n),x=jo(n),g=zs(n)==="y",b=bv.has(h)?-1:1,v=m&&g?-1:1,f=xr(o,s);let{mainAxis:N,crossAxis:j,alignmentAxis:_}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return x&&typeof _=="number"&&(j=x==="end"?_*-1:_),g?{x:j*v,y:N*b}:{x:N*b,y:j*v}}const cA=function(s){return s===void 0&&(s=0),{name:"offset",options:s,async fn(o){var n,l;const{x:d,y:m,placement:h,middlewareData:x}=o,g=await lA(o,s);return h===((n=x.offset)==null?void 0:n.placement)&&(l=x.arrow)!=null&&l.alignmentOffset?{}:{x:d+g.x,y:m+g.y,data:{...g,placement:h}}}}},dA=function(s){return s===void 0&&(s={}),{name:"shift",options:s,async fn(o){const{x:n,y:l,placement:d}=o,{mainAxis:m=!0,crossAxis:h=!1,limiter:x={fn:C=>{let{x:E,y:z}=C;return{x:E,y:z}}},...g}=xr(s,o),b={x:n,y:l},v=await Ti(o,g),f=zs(fr(d)),N=_p(f);let j=b[N],_=b[f];if(m){const C=N==="y"?"top":"left",E=N==="y"?"bottom":"right",z=j+v[C],P=j-v[E];j=Km(z,j,P)}if(h){const C=f==="y"?"top":"left",E=f==="y"?"bottom":"right",z=_+v[C],P=_-v[E];_=Km(z,_,P)}const w=x.fn({...o,[N]:j,[f]:_});return{...w,data:{x:w.x-n,y:w.y-l,enabled:{[N]:m,[f]:h}}}}}},uA=function(s){return s===void 0&&(s={}),{options:s,fn(o){const{x:n,y:l,placement:d,rects:m,middlewareData:h}=o,{offset:x=0,mainAxis:g=!0,crossAxis:b=!0}=xr(s,o),v={x:n,y:l},f=zs(d),N=_p(f);let j=v[N],_=v[f];const w=xr(x,o),C=typeof w=="number"?{mainAxis:w,crossAxis:0}:{mainAxis:0,crossAxis:0,...w};if(g){const P=N==="y"?"height":"width",V=m.reference[N]-m.floating[P]+C.mainAxis,Z=m.reference[N]+m.reference[P]-C.mainAxis;j<V?j=V:j>Z&&(j=Z)}if(b){var E,z;const P=N==="y"?"width":"height",V=bv.has(fr(d)),Z=m.reference[f]-m.floating[P]+(V&&((E=h.offset)==null?void 0:E[f])||0)+(V?0:C.crossAxis),oe=m.reference[f]+m.reference[P]+(V?0:((z=h.offset)==null?void 0:z[f])||0)-(V?C.crossAxis:0);_<Z?_=Z:_>oe&&(_=oe)}return{[N]:j,[f]:_}}}},mA=function(s){return s===void 0&&(s={}),{name:"size",options:s,async fn(o){var n,l;const{placement:d,rects:m,platform:h,elements:x}=o,{apply:g=()=>{},...b}=xr(s,o),v=await Ti(o,b),f=fr(d),N=jo(d),j=zs(d)==="y",{width:_,height:w}=m.floating;let C,E;f==="top"||f==="bottom"?(C=f,E=N===(await(h.isRTL==null?void 0:h.isRTL(x.floating))?"start":"end")?"left":"right"):(E=f,C=N==="end"?"top":"bottom");const z=w-v.top-v.bottom,P=_-v.left-v.right,V=Wr(w-v[C],z),Z=Wr(_-v[E],P),oe=!o.middlewareData.shift;let O=V,T=Z;if((n=o.middlewareData.shift)!=null&&n.enabled.x&&(T=P),(l=o.middlewareData.shift)!=null&&l.enabled.y&&(O=z),oe&&!N){const J=is(v.left,0),W=is(v.right,0),ne=is(v.top,0),Ee=is(v.bottom,0);j?T=_-2*(J!==0||W!==0?J+W:is(v.left,v.right)):O=w-2*(ne!==0||Ee!==0?ne+Ee:is(v.top,v.bottom))}await g({...o,availableWidth:T,availableHeight:O});const ge=await h.getDimensions(x.floating);return _!==ge.width||w!==ge.height?{reset:{rects:!0}}:{}}}};function Uc(){return typeof window<"u"}function _o(s){return vv(s)?(s.nodeName||"").toLowerCase():"#document"}function ls(s){var o;return(s==null||(o=s.ownerDocument)==null?void 0:o.defaultView)||window}function Hs(s){var o;return(o=(vv(s)?s.ownerDocument:s.document)||window.document)==null?void 0:o.documentElement}function vv(s){return Uc()?s instanceof Node||s instanceof ls(s).Node:!1}function As(s){return Uc()?s instanceof Element||s instanceof ls(s).Element:!1}function Fs(s){return Uc()?s instanceof HTMLElement||s instanceof ls(s).HTMLElement:!1}function Ug(s){return!Uc()||typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof ls(s).ShadowRoot}const pA=new Set(["inline","contents"]);function Li(s){const{overflow:o,overflowX:n,overflowY:l,display:d}=Cs(s);return/auto|scroll|overlay|hidden|clip/.test(o+l+n)&&!pA.has(d)}const hA=new Set(["table","td","th"]);function xA(s){return hA.has(_o(s))}const fA=[":popover-open",":modal"];function Bc(s){return fA.some(o=>{try{return s.matches(o)}catch{return!1}})}const gA=["transform","translate","scale","rotate","perspective"],bA=["transform","translate","scale","rotate","perspective","filter"],vA=["paint","layout","strict","content"];function Tp(s){const o=Ap(),n=As(s)?Cs(s):s;return gA.some(l=>n[l]?n[l]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!o&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!o&&(n.filter?n.filter!=="none":!1)||bA.some(l=>(n.willChange||"").includes(l))||vA.some(l=>(n.contain||"").includes(l))}function yA(s){let o=Kr(s);for(;Fs(o)&&!bo(o);){if(Tp(o))return o;if(Bc(o))return null;o=Kr(o)}return null}function Ap(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const NA=new Set(["html","body","#document"]);function bo(s){return NA.has(_o(s))}function Cs(s){return ls(s).getComputedStyle(s)}function Vc(s){return As(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.scrollX,scrollTop:s.scrollY}}function Kr(s){if(_o(s)==="html")return s;const o=s.assignedSlot||s.parentNode||Ug(s)&&s.host||Hs(s);return Ug(o)?o.host:o}function yv(s){const o=Kr(s);return bo(o)?s.ownerDocument?s.ownerDocument.body:s.body:Fs(o)&&Li(o)?o:yv(o)}function Ai(s,o,n){var l;o===void 0&&(o=[]),n===void 0&&(n=!0);const d=yv(s),m=d===((l=s.ownerDocument)==null?void 0:l.body),h=ls(d);if(m){const x=Xm(h);return o.concat(h,h.visualViewport||[],Li(d)?d:[],x&&n?Ai(x):[])}return o.concat(d,Ai(d,[],n))}function Xm(s){return s.parent&&Object.getPrototypeOf(s.parent)?s.frameElement:null}function Nv(s){const o=Cs(s);let n=parseFloat(o.width)||0,l=parseFloat(o.height)||0;const d=Fs(s),m=d?s.offsetWidth:n,h=d?s.offsetHeight:l,x=Nc(n)!==m||Nc(l)!==h;return x&&(n=m,l=h),{width:n,height:l,$:x}}function Cp(s){return As(s)?s:s.contextElement}function uo(s){const o=Cp(s);if(!Fs(o))return Bs(1);const n=o.getBoundingClientRect(),{width:l,height:d,$:m}=Nv(o);let h=(m?Nc(n.width):n.width)/l,x=(m?Nc(n.height):n.height)/d;return(!h||!Number.isFinite(h))&&(h=1),(!x||!Number.isFinite(x))&&(x=1),{x:h,y:x}}const jA=Bs(0);function jv(s){const o=ls(s);return!Ap()||!o.visualViewport?jA:{x:o.visualViewport.offsetLeft,y:o.visualViewport.offsetTop}}function _A(s,o,n){return o===void 0&&(o=!1),!n||o&&n!==ls(s)?!1:o}function bn(s,o,n,l){o===void 0&&(o=!1),n===void 0&&(n=!1);const d=s.getBoundingClientRect(),m=Cp(s);let h=Bs(1);o&&(l?As(l)&&(h=uo(l)):h=uo(s));const x=_A(m,n,l)?jv(m):Bs(0);let g=(d.left+x.x)/h.x,b=(d.top+x.y)/h.y,v=d.width/h.x,f=d.height/h.y;if(m){const N=ls(m),j=l&&As(l)?ls(l):l;let _=N,w=Xm(_);for(;w&&l&&j!==_;){const C=uo(w),E=w.getBoundingClientRect(),z=Cs(w),P=E.left+(w.clientLeft+parseFloat(z.paddingLeft))*C.x,V=E.top+(w.clientTop+parseFloat(z.paddingTop))*C.y;g*=C.x,b*=C.y,v*=C.x,f*=C.y,g+=P,b+=V,_=ls(w),w=Xm(_)}}return _c({width:v,height:f,x:g,y:b})}function $c(s,o){const n=Vc(s).scrollLeft;return o?o.left+n:bn(Hs(s)).left+n}function _v(s,o){const n=s.getBoundingClientRect(),l=n.left+o.scrollLeft-$c(s,n),d=n.top+o.scrollTop;return{x:l,y:d}}function SA(s){let{elements:o,rect:n,offsetParent:l,strategy:d}=s;const m=d==="fixed",h=Hs(l),x=o?Bc(o.floating):!1;if(l===h||x&&m)return n;let g={scrollLeft:0,scrollTop:0},b=Bs(1);const v=Bs(0),f=Fs(l);if((f||!f&&!m)&&((_o(l)!=="body"||Li(h))&&(g=Vc(l)),Fs(l))){const j=bn(l);b=uo(l),v.x=j.x+l.clientLeft,v.y=j.y+l.clientTop}const N=h&&!f&&!m?_v(h,g):Bs(0);return{width:n.width*b.x,height:n.height*b.y,x:n.x*b.x-g.scrollLeft*b.x+v.x+N.x,y:n.y*b.y-g.scrollTop*b.y+v.y+N.y}}function wA(s){return Array.from(s.getClientRects())}function TA(s){const o=Hs(s),n=Vc(s),l=s.ownerDocument.body,d=is(o.scrollWidth,o.clientWidth,l.scrollWidth,l.clientWidth),m=is(o.scrollHeight,o.clientHeight,l.scrollHeight,l.clientHeight);let h=-n.scrollLeft+$c(s);const x=-n.scrollTop;return Cs(l).direction==="rtl"&&(h+=is(o.clientWidth,l.clientWidth)-d),{width:d,height:m,x:h,y:x}}const Bg=25;function AA(s,o){const n=ls(s),l=Hs(s),d=n.visualViewport;let m=l.clientWidth,h=l.clientHeight,x=0,g=0;if(d){m=d.width,h=d.height;const v=Ap();(!v||v&&o==="fixed")&&(x=d.offsetLeft,g=d.offsetTop)}const b=$c(l);if(b<=0){const v=l.ownerDocument,f=v.body,N=getComputedStyle(f),j=v.compatMode==="CSS1Compat"&&parseFloat(N.marginLeft)+parseFloat(N.marginRight)||0,_=Math.abs(l.clientWidth-f.clientWidth-j);_<=Bg&&(m-=_)}else b<=Bg&&(m+=b);return{width:m,height:h,x,y:g}}const CA=new Set(["absolute","fixed"]);function kA(s,o){const n=bn(s,!0,o==="fixed"),l=n.top+s.clientTop,d=n.left+s.clientLeft,m=Fs(s)?uo(s):Bs(1),h=s.clientWidth*m.x,x=s.clientHeight*m.y,g=d*m.x,b=l*m.y;return{width:h,height:x,x:g,y:b}}function Vg(s,o,n){let l;if(o==="viewport")l=AA(s,n);else if(o==="document")l=TA(Hs(s));else if(As(o))l=kA(o,n);else{const d=jv(s);l={x:o.x-d.x,y:o.y-d.y,width:o.width,height:o.height}}return _c(l)}function Sv(s,o){const n=Kr(s);return n===o||!As(n)||bo(n)?!1:Cs(n).position==="fixed"||Sv(n,o)}function EA(s,o){const n=o.get(s);if(n)return n;let l=Ai(s,[],!1).filter(x=>As(x)&&_o(x)!=="body"),d=null;const m=Cs(s).position==="fixed";let h=m?Kr(s):s;for(;As(h)&&!bo(h);){const x=Cs(h),g=Tp(h);!g&&x.position==="fixed"&&(d=null),(m?!g&&!d:!g&&x.position==="static"&&!!d&&CA.has(d.position)||Li(h)&&!g&&Sv(s,h))?l=l.filter(v=>v!==h):d=x,h=Kr(h)}return o.set(s,l),l}function RA(s){let{element:o,boundary:n,rootBoundary:l,strategy:d}=s;const h=[...n==="clippingAncestors"?Bc(o)?[]:EA(o,this._c):[].concat(n),l],x=h[0],g=h.reduce((b,v)=>{const f=Vg(o,v,d);return b.top=is(f.top,b.top),b.right=Wr(f.right,b.right),b.bottom=Wr(f.bottom,b.bottom),b.left=is(f.left,b.left),b},Vg(o,x,d));return{width:g.right-g.left,height:g.bottom-g.top,x:g.left,y:g.top}}function LA(s){const{width:o,height:n}=Nv(s);return{width:o,height:n}}function PA(s,o,n){const l=Fs(o),d=Hs(o),m=n==="fixed",h=bn(s,!0,m,o);let x={scrollLeft:0,scrollTop:0};const g=Bs(0);function b(){g.x=$c(d)}if(l||!l&&!m)if((_o(o)!=="body"||Li(d))&&(x=Vc(o)),l){const j=bn(o,!0,m,o);g.x=j.x+o.clientLeft,g.y=j.y+o.clientTop}else d&&b();m&&!l&&d&&b();const v=d&&!l&&!m?_v(d,x):Bs(0),f=h.left+x.scrollLeft-g.x-v.x,N=h.top+x.scrollTop-g.y-v.y;return{x:f,y:N,width:h.width,height:h.height}}function Im(s){return Cs(s).position==="static"}function $g(s,o){if(!Fs(s)||Cs(s).position==="fixed")return null;if(o)return o(s);let n=s.offsetParent;return Hs(s)===n&&(n=n.ownerDocument.body),n}function wv(s,o){const n=ls(s);if(Bc(s))return n;if(!Fs(s)){let d=Kr(s);for(;d&&!bo(d);){if(As(d)&&!Im(d))return d;d=Kr(d)}return n}let l=$g(s,o);for(;l&&xA(l)&&Im(l);)l=$g(l,o);return l&&bo(l)&&Im(l)&&!Tp(l)?n:l||yA(s)||n}const MA=async function(s){const o=this.getOffsetParent||wv,n=this.getDimensions,l=await n(s.floating);return{reference:PA(s.reference,await o(s.floating),s.strategy),floating:{x:0,y:0,width:l.width,height:l.height}}};function IA(s){return Cs(s).direction==="rtl"}const OA={convertOffsetParentRelativeRectToViewportRelativeRect:SA,getDocumentElement:Hs,getClippingRect:RA,getOffsetParent:wv,getElementRects:MA,getClientRects:wA,getDimensions:LA,getScale:uo,isElement:As,isRTL:IA};function Tv(s,o){return s.x===o.x&&s.y===o.y&&s.width===o.width&&s.height===o.height}function DA(s,o){let n=null,l;const d=Hs(s);function m(){var x;clearTimeout(l),(x=n)==null||x.disconnect(),n=null}function h(x,g){x===void 0&&(x=!1),g===void 0&&(g=1),m();const b=s.getBoundingClientRect(),{left:v,top:f,width:N,height:j}=b;if(x||o(),!N||!j)return;const _=oc(f),w=oc(d.clientWidth-(v+N)),C=oc(d.clientHeight-(f+j)),E=oc(v),P={rootMargin:-_+"px "+-w+"px "+-C+"px "+-E+"px",threshold:is(0,Wr(1,g))||1};let V=!0;function Z(oe){const O=oe[0].intersectionRatio;if(O!==g){if(!V)return h();O?h(!1,O):l=setTimeout(()=>{h(!1,1e-7)},1e3)}O===1&&!Tv(b,s.getBoundingClientRect())&&h(),V=!1}try{n=new IntersectionObserver(Z,{...P,root:d.ownerDocument})}catch{n=new IntersectionObserver(Z,P)}n.observe(s)}return h(!0),m}function zA(s,o,n,l){l===void 0&&(l={});const{ancestorScroll:d=!0,ancestorResize:m=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:x=typeof IntersectionObserver=="function",animationFrame:g=!1}=l,b=Cp(s),v=d||m?[...b?Ai(b):[],...Ai(o)]:[];v.forEach(E=>{d&&E.addEventListener("scroll",n,{passive:!0}),m&&E.addEventListener("resize",n)});const f=b&&x?DA(b,n):null;let N=-1,j=null;h&&(j=new ResizeObserver(E=>{let[z]=E;z&&z.target===b&&j&&(j.unobserve(o),cancelAnimationFrame(N),N=requestAnimationFrame(()=>{var P;(P=j)==null||P.observe(o)})),n()}),b&&!g&&j.observe(b),j.observe(o));let _,w=g?bn(s):null;g&&C();function C(){const E=bn(s);w&&!Tv(w,E)&&n(),w=E,_=requestAnimationFrame(C)}return n(),()=>{var E;v.forEach(z=>{d&&z.removeEventListener("scroll",n),m&&z.removeEventListener("resize",n)}),f?.(),(E=j)==null||E.disconnect(),j=null,g&&cancelAnimationFrame(_)}}const qA=cA,UA=dA,BA=oA,VA=mA,$A=iA,Fg=nA,FA=uA,HA=(s,o,n)=>{const l=new Map,d={platform:OA,...n},m={...d.platform,_c:l};return rA(s,o,{...d,platform:m})};var GA=typeof document<"u",WA=function(){},mc=GA?c.useLayoutEffect:WA;function Sc(s,o){if(s===o)return!0;if(typeof s!=typeof o)return!1;if(typeof s=="function"&&s.toString()===o.toString())return!0;let n,l,d;if(s&&o&&typeof s=="object"){if(Array.isArray(s)){if(n=s.length,n!==o.length)return!1;for(l=n;l--!==0;)if(!Sc(s[l],o[l]))return!1;return!0}if(d=Object.keys(s),n=d.length,n!==Object.keys(o).length)return!1;for(l=n;l--!==0;)if(!{}.hasOwnProperty.call(o,d[l]))return!1;for(l=n;l--!==0;){const m=d[l];if(!(m==="_owner"&&s.$$typeof)&&!Sc(s[m],o[m]))return!1}return!0}return s!==s&&o!==o}function Av(s){return typeof window>"u"?1:(s.ownerDocument.defaultView||window).devicePixelRatio||1}function Hg(s,o){const n=Av(s);return Math.round(o*n)/n}function Om(s){const o=c.useRef(s);return mc(()=>{o.current=s}),o}function KA(s){s===void 0&&(s={});const{placement:o="bottom",strategy:n="absolute",middleware:l=[],platform:d,elements:{reference:m,floating:h}={},transform:x=!0,whileElementsMounted:g,open:b}=s,[v,f]=c.useState({x:0,y:0,strategy:n,placement:o,middlewareData:{},isPositioned:!1}),[N,j]=c.useState(l);Sc(N,l)||j(l);const[_,w]=c.useState(null),[C,E]=c.useState(null),z=c.useCallback(F=>{F!==oe.current&&(oe.current=F,w(F))},[]),P=c.useCallback(F=>{F!==O.current&&(O.current=F,E(F))},[]),V=m||_,Z=h||C,oe=c.useRef(null),O=c.useRef(null),T=c.useRef(v),ge=g!=null,J=Om(g),W=Om(d),ne=Om(b),Ee=c.useCallback(()=>{if(!oe.current||!O.current)return;const F={placement:o,strategy:n,middleware:N};W.current&&(F.platform=W.current),HA(oe.current,O.current,F).then(de=>{const ze={...de,isPositioned:ne.current!==!1};Ce.current&&!Sc(T.current,ze)&&(T.current=ze,Pc.flushSync(()=>{f(ze)}))})},[N,o,n,W,ne]);mc(()=>{b===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,f(F=>({...F,isPositioned:!1})))},[b]);const Ce=c.useRef(!1);mc(()=>(Ce.current=!0,()=>{Ce.current=!1}),[]),mc(()=>{if(V&&(oe.current=V),Z&&(O.current=Z),V&&Z){if(J.current)return J.current(V,Z,Ee);Ee()}},[V,Z,Ee,J,ge]);const Le=c.useMemo(()=>({reference:oe,floating:O,setReference:z,setFloating:P}),[z,P]),I=c.useMemo(()=>({reference:V,floating:Z}),[V,Z]),Q=c.useMemo(()=>{const F={position:n,left:0,top:0};if(!I.floating)return F;const de=Hg(I.floating,v.x),ze=Hg(I.floating,v.y);return x?{...F,transform:"translate("+de+"px, "+ze+"px)",...Av(I.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:de,top:ze}},[n,x,I.floating,v.x,v.y]);return c.useMemo(()=>({...v,update:Ee,refs:Le,elements:I,floatingStyles:Q}),[v,Ee,Le,I,Q])}const YA=s=>{function o(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:s,fn(n){const{element:l,padding:d}=typeof s=="function"?s(n):s;return l&&o(l)?l.current!=null?Fg({element:l.current,padding:d}).fn(n):{}:l?Fg({element:l,padding:d}).fn(n):{}}}},XA=(s,o)=>({...qA(s),options:[s,o]}),QA=(s,o)=>({...UA(s),options:[s,o]}),ZA=(s,o)=>({...FA(s),options:[s,o]}),JA=(s,o)=>({...BA(s),options:[s,o]}),eC=(s,o)=>({...VA(s),options:[s,o]}),tC=(s,o)=>({...$A(s),options:[s,o]}),aC=(s,o)=>({...YA(s),options:[s,o]});var sC="Arrow",Cv=c.forwardRef((s,o)=>{const{children:n,width:l=10,height:d=5,...m}=s;return e.jsx(Kt.svg,{...m,ref:o,width:l,height:d,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:s.asChild?n:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});Cv.displayName=sC;var rC=Cv;function kv(s){const[o,n]=c.useState(void 0);return pr(()=>{if(s){n({width:s.offsetWidth,height:s.offsetHeight});const l=new ResizeObserver(d=>{if(!Array.isArray(d)||!d.length)return;const m=d[0];let h,x;if("borderBoxSize"in m){const g=m.borderBoxSize,b=Array.isArray(g)?g[0]:g;h=b.inlineSize,x=b.blockSize}else h=s.offsetWidth,x=s.offsetHeight;n({width:h,height:x})});return l.observe(s,{box:"border-box"}),()=>l.unobserve(s)}else n(void 0)},[s]),o}var kp="Popper",[Ev,Fc]=ks(kp),[nC,Rv]=Ev(kp),Lv=s=>{const{__scopePopper:o,children:n}=s,[l,d]=c.useState(null);return e.jsx(nC,{scope:o,anchor:l,onAnchorChange:d,children:n})};Lv.displayName=kp;var Pv="PopperAnchor",Mv=c.forwardRef((s,o)=>{const{__scopePopper:n,virtualRef:l,...d}=s,m=Rv(Pv,n),h=c.useRef(null),x=xa(o,h),g=c.useRef(null);return c.useEffect(()=>{const b=g.current;g.current=l?.current||h.current,b!==g.current&&m.onAnchorChange(g.current)}),l?null:e.jsx(Kt.div,{...d,ref:x})});Mv.displayName=Pv;var Ep="PopperContent",[oC,iC]=Ev(Ep),Iv=c.forwardRef((s,o)=>{const{__scopePopper:n,side:l="bottom",sideOffset:d=0,align:m="center",alignOffset:h=0,arrowPadding:x=0,avoidCollisions:g=!0,collisionBoundary:b=[],collisionPadding:v=0,sticky:f="partial",hideWhenDetached:N=!1,updatePositionStrategy:j="optimized",onPlaced:_,...w}=s,C=Rv(Ep,n),[E,z]=c.useState(null),P=xa(o,D=>z(D)),[V,Z]=c.useState(null),oe=kv(V),O=oe?.width??0,T=oe?.height??0,ge=l+(m!=="center"?"-"+m:""),J=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},W=Array.isArray(b)?b:[b],ne=W.length>0,Ee={padding:J,boundary:W.filter(cC),altBoundary:ne},{refs:Ce,floatingStyles:Le,placement:I,isPositioned:Q,middlewareData:F}=KA({strategy:"fixed",placement:ge,whileElementsMounted:(...D)=>zA(...D,{animationFrame:j==="always"}),elements:{reference:C.anchor},middleware:[XA({mainAxis:d+T,alignmentAxis:h}),g&&QA({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?ZA():void 0,...Ee}),g&&JA({...Ee}),eC({...Ee,apply:({elements:D,rects:q,availableWidth:G,availableHeight:be})=>{const{width:Ne,height:R}=q.reference,ke=D.floating.style;ke.setProperty("--radix-popper-available-width",`${G}px`),ke.setProperty("--radix-popper-available-height",`${be}px`),ke.setProperty("--radix-popper-anchor-width",`${Ne}px`),ke.setProperty("--radix-popper-anchor-height",`${R}px`)}}),V&&aC({element:V,padding:x}),dC({arrowWidth:O,arrowHeight:T}),N&&tC({strategy:"referenceHidden",...Ee})]}),[de,ze]=zv(I),A=hr(_);pr(()=>{Q&&A?.()},[Q,A]);const $=F.arrow?.x,se=F.arrow?.y,k=F.arrow?.centerOffset!==0,[K,M]=c.useState();return pr(()=>{E&&M(window.getComputedStyle(E).zIndex)},[E]),e.jsx("div",{ref:Ce.setFloating,"data-radix-popper-content-wrapper":"",style:{...Le,transform:Q?Le.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:K,"--radix-popper-transform-origin":[F.transformOrigin?.x,F.transformOrigin?.y].join(" "),...F.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:s.dir,children:e.jsx(oC,{scope:n,placedSide:de,onArrowChange:Z,arrowX:$,arrowY:se,shouldHideArrow:k,children:e.jsx(Kt.div,{"data-side":de,"data-align":ze,...w,ref:P,style:{...w.style,animation:Q?void 0:"none"}})})})});Iv.displayName=Ep;var Ov="PopperArrow",lC={top:"bottom",right:"left",bottom:"top",left:"right"},Dv=c.forwardRef(function(o,n){const{__scopePopper:l,...d}=o,m=iC(Ov,l),h=lC[m.placedSide];return e.jsx("span",{ref:m.onArrowChange,style:{position:"absolute",left:m.arrowX,top:m.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[m.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[m.placedSide],visibility:m.shouldHideArrow?"hidden":void 0},children:e.jsx(rC,{...d,ref:n,style:{...d.style,display:"block"}})})});Dv.displayName=Ov;function cC(s){return s!==null}var dC=s=>({name:"transformOrigin",options:s,fn(o){const{placement:n,rects:l,middlewareData:d}=o,h=d.arrow?.centerOffset!==0,x=h?0:s.arrowWidth,g=h?0:s.arrowHeight,[b,v]=zv(n),f={start:"0%",center:"50%",end:"100%"}[v],N=(d.arrow?.x??0)+x/2,j=(d.arrow?.y??0)+g/2;let _="",w="";return b==="bottom"?(_=h?f:`${N}px`,w=`${-g}px`):b==="top"?(_=h?f:`${N}px`,w=`${l.floating.height+g}px`):b==="right"?(_=`${-g}px`,w=h?f:`${j}px`):b==="left"&&(_=`${l.floating.width+g}px`,w=h?f:`${j}px`),{data:{x:_,y:w}}}});function zv(s){const[o,n="center"]=s.split("-");return[o,n]}var qv=Lv,Uv=Mv,Bv=Iv,Vv=Dv,uC=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),mC="VisuallyHidden",$v=c.forwardRef((s,o)=>e.jsx(Kt.span,{...s,ref:o,style:{...uC,...s.style}}));$v.displayName=mC;var pC=$v,[Hc]=ks("Tooltip",[Fc]),Gc=Fc(),Fv="TooltipProvider",hC=700,Qm="tooltip.open",[xC,Rp]=Hc(Fv),Hv=s=>{const{__scopeTooltip:o,delayDuration:n=hC,skipDelayDuration:l=300,disableHoverableContent:d=!1,children:m}=s,h=c.useRef(!0),x=c.useRef(!1),g=c.useRef(0);return c.useEffect(()=>{const b=g.current;return()=>window.clearTimeout(b)},[]),e.jsx(xC,{scope:o,isOpenDelayedRef:h,delayDuration:n,onOpen:c.useCallback(()=>{window.clearTimeout(g.current),h.current=!1},[]),onClose:c.useCallback(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>h.current=!0,l)},[l]),isPointerInTransitRef:x,onPointerInTransitChange:c.useCallback(b=>{x.current=b},[]),disableHoverableContent:d,children:m})};Hv.displayName=Fv;var Ci="Tooltip",[fC,Pi]=Hc(Ci),Gv=s=>{const{__scopeTooltip:o,children:n,open:l,defaultOpen:d,onOpenChange:m,disableHoverableContent:h,delayDuration:x}=s,g=Rp(Ci,s.__scopeTooltip),b=Gc(o),[v,f]=c.useState(null),N=Us(),j=c.useRef(0),_=h??g.disableHoverableContent,w=x??g.delayDuration,C=c.useRef(!1),[E,z]=gr({prop:l,defaultProp:d??!1,onChange:O=>{O?(g.onOpen(),document.dispatchEvent(new CustomEvent(Qm))):g.onClose(),m?.(O)},caller:Ci}),P=c.useMemo(()=>E?C.current?"delayed-open":"instant-open":"closed",[E]),V=c.useCallback(()=>{window.clearTimeout(j.current),j.current=0,C.current=!1,z(!0)},[z]),Z=c.useCallback(()=>{window.clearTimeout(j.current),j.current=0,z(!1)},[z]),oe=c.useCallback(()=>{window.clearTimeout(j.current),j.current=window.setTimeout(()=>{C.current=!0,z(!0),j.current=0},w)},[w,z]);return c.useEffect(()=>()=>{j.current&&(window.clearTimeout(j.current),j.current=0)},[]),e.jsx(qv,{...b,children:e.jsx(fC,{scope:o,contentId:N,open:E,stateAttribute:P,trigger:v,onTriggerChange:f,onTriggerEnter:c.useCallback(()=>{g.isOpenDelayedRef.current?oe():V()},[g.isOpenDelayedRef,oe,V]),onTriggerLeave:c.useCallback(()=>{_?Z():(window.clearTimeout(j.current),j.current=0)},[Z,_]),onOpen:V,onClose:Z,disableHoverableContent:_,children:n})})};Gv.displayName=Ci;var Zm="TooltipTrigger",Wv=c.forwardRef((s,o)=>{const{__scopeTooltip:n,...l}=s,d=Pi(Zm,n),m=Rp(Zm,n),h=Gc(n),x=c.useRef(null),g=xa(o,x,d.onTriggerChange),b=c.useRef(!1),v=c.useRef(!1),f=c.useCallback(()=>b.current=!1,[]);return c.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),e.jsx(Uv,{asChild:!0,...h,children:e.jsx(Kt.button,{"aria-describedby":d.open?d.contentId:void 0,"data-state":d.stateAttribute,...l,ref:g,onPointerMove:kt(s.onPointerMove,N=>{N.pointerType!=="touch"&&!v.current&&!m.isPointerInTransitRef.current&&(d.onTriggerEnter(),v.current=!0)}),onPointerLeave:kt(s.onPointerLeave,()=>{d.onTriggerLeave(),v.current=!1}),onPointerDown:kt(s.onPointerDown,()=>{d.open&&d.onClose(),b.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:kt(s.onFocus,()=>{b.current||d.onOpen()}),onBlur:kt(s.onBlur,d.onClose),onClick:kt(s.onClick,d.onClose)})})});Wv.displayName=Zm;var Lp="TooltipPortal",[gC,bC]=Hc(Lp,{forceMount:void 0}),Kv=s=>{const{__scopeTooltip:o,forceMount:n,children:l,container:d}=s,m=Pi(Lp,o);return e.jsx(gC,{scope:o,forceMount:n,children:e.jsx(js,{present:n||m.open,children:e.jsx(Dc,{asChild:!0,container:d,children:l})})})};Kv.displayName=Lp;var vo="TooltipContent",Yv=c.forwardRef((s,o)=>{const n=bC(vo,s.__scopeTooltip),{forceMount:l=n.forceMount,side:d="top",...m}=s,h=Pi(vo,s.__scopeTooltip);return e.jsx(js,{present:l||h.open,children:h.disableHoverableContent?e.jsx(Xv,{side:d,...m,ref:o}):e.jsx(vC,{side:d,...m,ref:o})})}),vC=c.forwardRef((s,o)=>{const n=Pi(vo,s.__scopeTooltip),l=Rp(vo,s.__scopeTooltip),d=c.useRef(null),m=xa(o,d),[h,x]=c.useState(null),{trigger:g,onClose:b}=n,v=d.current,{onPointerInTransitChange:f}=l,N=c.useCallback(()=>{x(null),f(!1)},[f]),j=c.useCallback((_,w)=>{const C=_.currentTarget,E={x:_.clientX,y:_.clientY},z=SC(E,C.getBoundingClientRect()),P=wC(E,z),V=TC(w.getBoundingClientRect()),Z=CC([...P,...V]);x(Z),f(!0)},[f]);return c.useEffect(()=>()=>N(),[N]),c.useEffect(()=>{if(g&&v){const _=C=>j(C,v),w=C=>j(C,g);return g.addEventListener("pointerleave",_),v.addEventListener("pointerleave",w),()=>{g.removeEventListener("pointerleave",_),v.removeEventListener("pointerleave",w)}}},[g,v,j,N]),c.useEffect(()=>{if(h){const _=w=>{const C=w.target,E={x:w.clientX,y:w.clientY},z=g?.contains(C)||v?.contains(C),P=!AC(E,h);z?N():P&&(N(),b())};return document.addEventListener("pointermove",_),()=>document.removeEventListener("pointermove",_)}},[g,v,h,b,N]),e.jsx(Xv,{...s,ref:m})}),[yC,NC]=Hc(Ci,{isInside:!1}),jC=Kw("TooltipContent"),Xv=c.forwardRef((s,o)=>{const{__scopeTooltip:n,children:l,"aria-label":d,onEscapeKeyDown:m,onPointerDownOutside:h,...x}=s,g=Pi(vo,n),b=Gc(n),{onClose:v}=g;return c.useEffect(()=>(document.addEventListener(Qm,v),()=>document.removeEventListener(Qm,v)),[v]),c.useEffect(()=>{if(g.trigger){const f=N=>{N.target?.contains(g.trigger)&&v()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[g.trigger,v]),e.jsx(Oc,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:m,onPointerDownOutside:h,onFocusOutside:f=>f.preventDefault(),onDismiss:v,children:e.jsxs(Bv,{"data-state":g.stateAttribute,...b,...x,ref:o,style:{...x.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(jC,{children:l}),e.jsx(yC,{scope:n,isInside:!0,children:e.jsx(pC,{id:g.contentId,role:"tooltip",children:d||l})})]})})});Yv.displayName=vo;var Qv="TooltipArrow",_C=c.forwardRef((s,o)=>{const{__scopeTooltip:n,...l}=s,d=Gc(n);return NC(Qv,n).isInside?null:e.jsx(Vv,{...d,...l,ref:o})});_C.displayName=Qv;function SC(s,o){const n=Math.abs(o.top-s.y),l=Math.abs(o.bottom-s.y),d=Math.abs(o.right-s.x),m=Math.abs(o.left-s.x);switch(Math.min(n,l,d,m)){case m:return"left";case d:return"right";case n:return"top";case l:return"bottom";default:throw new Error("unreachable")}}function wC(s,o,n=5){const l=[];switch(o){case"top":l.push({x:s.x-n,y:s.y+n},{x:s.x+n,y:s.y+n});break;case"bottom":l.push({x:s.x-n,y:s.y-n},{x:s.x+n,y:s.y-n});break;case"left":l.push({x:s.x+n,y:s.y-n},{x:s.x+n,y:s.y+n});break;case"right":l.push({x:s.x-n,y:s.y-n},{x:s.x-n,y:s.y+n});break}return l}function TC(s){const{top:o,right:n,bottom:l,left:d}=s;return[{x:d,y:o},{x:n,y:o},{x:n,y:l},{x:d,y:l}]}function AC(s,o){const{x:n,y:l}=s;let d=!1;for(let m=0,h=o.length-1;m<o.length;h=m++){const x=o[m],g=o[h],b=x.x,v=x.y,f=g.x,N=g.y;v>l!=N>l&&n<(f-b)*(l-v)/(N-v)+b&&(d=!d)}return d}function CC(s){const o=s.slice();return o.sort((n,l)=>n.x<l.x?-1:n.x>l.x?1:n.y<l.y?-1:n.y>l.y?1:0),kC(o)}function kC(s){if(s.length<=1)return s.slice();const o=[];for(let l=0;l<s.length;l++){const d=s[l];for(;o.length>=2;){const m=o[o.length-1],h=o[o.length-2];if((m.x-h.x)*(d.y-h.y)>=(m.y-h.y)*(d.x-h.x))o.pop();else break}o.push(d)}o.pop();const n=[];for(let l=s.length-1;l>=0;l--){const d=s[l];for(;n.length>=2;){const m=n[n.length-1],h=n[n.length-2];if((m.x-h.x)*(d.y-h.y)>=(m.y-h.y)*(d.x-h.x))n.pop();else break}n.push(d)}return n.pop(),o.length===1&&n.length===1&&o[0].x===n[0].x&&o[0].y===n[0].y?o:o.concat(n)}var EC=Hv,RC=Gv,LC=Wv,PC=Kv,MC=Yv;function Zv({delayDuration:s=0,...o}){return e.jsx(EC,{delayDuration:s,...o})}function IC({...s}){return e.jsx(Zv,{children:e.jsx(RC,{...s})})}function OC({...s}){return e.jsx(LC,{...s})}function DC({className:s,sideOffset:o=4,children:n,...l}){return e.jsx(PC,{children:e.jsx(MC,{sideOffset:o,className:Xt("z-50 overflow-hidden rounded-md bg-gray-900 px-3 py-1.5 text-xs text-white animate-in fade-in-0 zoom-in-95",s),...l,children:n})})}const zC="sidebar_state",qC=3600*24*7,UC="16rem",BC="18rem",VC="3rem",$C="b",Jv=c.createContext(null);function So(){const s=c.useContext(Jv);if(!s)throw new Error("useSidebar must be used within a SidebarProvider.");return s}function FC({defaultOpen:s=!0,open:o,onOpenChange:n,className:l,style:d,children:m,...h}){const x=b4(),[g,b]=c.useState(!1),[v,f]=c.useState(s),N=o??v,j=c.useCallback(E=>{const z=typeof E=="function"?E(N):E;n?n(z):f(z),document.cookie=`${zC}=${z}; path=/; max-age=${qC}`},[n,N]),_=c.useCallback(()=>x?b(E=>!E):j(E=>!E),[x,j,b]);c.useEffect(()=>{const E=z=>{z.key===$C&&(z.metaKey||z.ctrlKey)&&(z.preventDefault(),_())};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[_]);const w=N?"expanded":"collapsed",C=c.useMemo(()=>({state:w,open:N,setOpen:j,isMobile:x,openMobile:g,setOpenMobile:b,toggleSidebar:_}),[w,N,j,x,g,b,_]);return e.jsx(Jv.Provider,{value:C,children:e.jsx(Zv,{delayDuration:0,children:e.jsx("div",{style:{"--sidebar-width":UC,"--sidebar-width-icon":VC,...d},className:Xt("group/sidebar-wrapper flex min-h-svh w-full",l),...h,children:m})})})}function HC({side:s="left",variant:o="sidebar",collapsible:n="offcanvas",className:l,children:d,...m}){const{isMobile:h,state:x,openMobile:g,setOpenMobile:b}=So();return n==="none"?e.jsx("div",{className:Xt("flex h-full w-(--sidebar-width) flex-col bg-gray-50 text-gray-950",l),...m,children:d}):h?e.jsx(FT,{open:g,onOpenChange:b,...m,children:e.jsxs(pv,{className:"w-(--sidebar-width) bg-gray-50 p-0 text-gray-950 [&>button]:hidden",style:{"--sidebar-width":BC},side:s,children:[e.jsxs(hv,{className:"sr-only",children:[e.jsx(xv,{children:"Sidebar"}),e.jsx(fv,{children:"Displays the mobile sidebar."})]}),e.jsx("div",{className:"flex h-full w-full flex-col",children:d})]})}):e.jsxs("div",{className:"group peer hidden text-gray-950 md:block","data-state":x,"data-collapsible":x==="collapsed"?n:"","data-variant":o,"data-side":s,children:[e.jsx("div",{className:Xt("relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",o==="floating"||o==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+1rem)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)")}),e.jsx("div",{className:Xt("fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex",s==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",o==="floating"||o==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+1rem+2px)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l",l),...m,children:e.jsx("div",{className:Xt("flex h-full w-full flex-col bg-gray-50",o==="floating"&&"rounded-lg border shadow-sm"),children:d})})]})}function GC({className:s,...o}){const{toggleSidebar:n}=So();return e.jsx("button",{"aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:Xt("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] group-data-[side=left]:-right-4 group-data-[side=right]:left-0 hover:after:bg-gray-950 sm:flex","in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full hover:group-data-[collapsible=offcanvas]:bg-gray-100","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",s),...o})}function WC({className:s,...o}){return e.jsx("div",{className:Xt("flex flex-col gap-2 p-2",s),...o})}function KC({className:s,...o}){return e.jsx("div",{className:Xt("flex flex-col gap-2 p-2",s),...o})}function YC({className:s,...o}){return e.jsx("div",{className:Xt("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",s),...o})}function XC({className:s,...o}){return e.jsx("div",{className:Xt("relative flex w-full min-w-0 flex-col p-2",s),...o})}function QC({className:s,asChild:o=!1,...n}){const l=o?hp:"div";return e.jsx(l,{className:Xt("flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-gray-600 outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",s),...n})}function ZC({className:s,...o}){return e.jsx("ul",{className:Xt("flex w-full min-w-0 flex-col gap-1",s),...o})}function Pp({className:s,...o}){return e.jsx("li",{className:Xt("group/menu-item relative",s),...o})}const JC=Zw("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden transition-[width,height,padding] hover:bg-gray-950 hover:text-gray-50 focus-visible:ring-2 active:bg-gray-950 active:text-gray-50 disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-gray-950 data-[active=true]:font-medium data-[active=true]:text-gray-50 data-[state=open]:hover:bg-gray-950 data-[state=open]:hover:text-gray-50 group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-gray-950 hover:text-gray-50",outline:"bg-white shadow-sm hover:bg-gray-950 hover:text-gray-50 border border-gray-200"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function wc({asChild:s=!1,isActive:o=!1,variant:n="default",size:l="default",tooltip:d,className:m,...h}){const x=s?hp:"button",{isMobile:g,state:b}=So(),v=e.jsx(x,{"data-size":l,"data-active":o,className:Xt(JC({variant:n,size:l}),m),...h});return d?(typeof d=="string"&&(d={children:d}),e.jsxs(IC,{children:[e.jsx(OC,{asChild:!0,children:v}),e.jsx(DC,{side:"right",align:"center",hidden:b!=="collapsed"||g,...d})]})):v}function ek({className:s,...o}){return e.jsx("ul",{className:Xt("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-gray-200 px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",s),...o})}function tk({className:s,...o}){return e.jsx("li",{className:Xt("group/menu-sub-item relative",s),...o})}function ak({asChild:s=!1,size:o="md",isActive:n=!1,className:l,...d}){const m=s?hp:"a";return e.jsx(m,{"data-size":o,"data-active":n,className:Xt("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-gray-950 outline-hidden transition-colors hover:bg-gray-950 hover:text-gray-50 focus-visible:ring-2 active:bg-gray-950 active:text-gray-50 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-gray-50","data-[active=true]:bg-gray-950 data-[active=true]:text-gray-50",o==="sm"&&"text-xs",o==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",l),...d})}var Wc="Collapsible",[sk,ey]=ks(Wc),[rk,Mp]=sk(Wc),ty=c.forwardRef((s,o)=>{const{__scopeCollapsible:n,open:l,defaultOpen:d,disabled:m,onOpenChange:h,...x}=s,[g,b]=gr({prop:l,defaultProp:d??!1,onChange:h,caller:Wc});return e.jsx(rk,{scope:n,disabled:m,contentId:Us(),open:g,onOpenToggle:c.useCallback(()=>b(v=>!v),[b]),children:e.jsx(Kt.div,{"data-state":zp(g),"data-disabled":m?"":void 0,...x,ref:o})})});ty.displayName=Wc;var ay="CollapsibleTrigger",Ip=c.forwardRef((s,o)=>{const{__scopeCollapsible:n,...l}=s,d=Mp(ay,n);return e.jsx(Kt.button,{type:"button","aria-controls":d.contentId,"aria-expanded":d.open||!1,"data-state":zp(d.open),"data-disabled":d.disabled?"":void 0,disabled:d.disabled,...l,ref:o,onClick:kt(s.onClick,d.onOpenToggle)})});Ip.displayName=ay;var Op="CollapsibleContent",Dp=c.forwardRef((s,o)=>{const{forceMount:n,...l}=s,d=Mp(Op,s.__scopeCollapsible);return e.jsx(js,{present:n||d.open,children:({present:m})=>e.jsx(nk,{...l,ref:o,present:m})})});Dp.displayName=Op;var nk=c.forwardRef((s,o)=>{const{__scopeCollapsible:n,present:l,children:d,...m}=s,h=Mp(Op,n),[x,g]=c.useState(l),b=c.useRef(null),v=xa(o,b),f=c.useRef(0),N=f.current,j=c.useRef(0),_=j.current,w=h.open||x,C=c.useRef(w),E=c.useRef(void 0);return c.useEffect(()=>{const z=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(z)},[]),pr(()=>{const z=b.current;if(z){E.current=E.current||{transitionDuration:z.style.transitionDuration,animationName:z.style.animationName},z.style.transitionDuration="0s",z.style.animationName="none";const P=z.getBoundingClientRect();f.current=P.height,j.current=P.width,C.current||(z.style.transitionDuration=E.current.transitionDuration,z.style.animationName=E.current.animationName),g(l)}},[h.open,l]),e.jsx(Kt.div,{"data-state":zp(h.open),"data-disabled":h.disabled?"":void 0,id:h.contentId,hidden:!w,...m,ref:v,style:{"--radix-collapsible-content-height":N?`${N}px`:void 0,"--radix-collapsible-content-width":_?`${_}px`:void 0,...s.style},children:w&&d})});function zp(s){return s?"open":"closed"}var sy=ty,ok=Ip,ik=Dp;const lk=sy,ck=Ip,dk=Dp;function Kc(s){const o=s+"CollectionProvider",[n,l]=ks(o),[d,m]=n(o,{collectionRef:{current:null},itemMap:new Map}),h=w=>{const{scope:C,children:E}=w,z=ga.useRef(null),P=ga.useRef(new Map).current;return e.jsx(d,{scope:C,itemMap:P,collectionRef:z,children:E})};h.displayName=o;const x=s+"CollectionSlot",g=fo(x),b=ga.forwardRef((w,C)=>{const{scope:E,children:z}=w,P=m(x,E),V=xa(C,P.collectionRef);return e.jsx(g,{ref:V,children:z})});b.displayName=x;const v=s+"CollectionItemSlot",f="data-radix-collection-item",N=fo(v),j=ga.forwardRef((w,C)=>{const{scope:E,children:z,...P}=w,V=ga.useRef(null),Z=xa(C,V),oe=m(v,E);return ga.useEffect(()=>(oe.itemMap.set(V,{ref:V,...P}),()=>void oe.itemMap.delete(V))),e.jsx(N,{[f]:"",ref:Z,children:z})});j.displayName=v;function _(w){const C=m(s+"CollectionConsumer",w);return ga.useCallback(()=>{const z=C.collectionRef.current;if(!z)return[];const P=Array.from(z.querySelectorAll(`[${f}]`));return Array.from(C.itemMap.values()).sort((oe,O)=>P.indexOf(oe.ref.current)-P.indexOf(O.ref.current))},[C.collectionRef,C.itemMap])}return[{Provider:h,Slot:b,ItemSlot:j},_,l]}var uk=c.createContext(void 0);function Mi(s){const o=c.useContext(uk);return s||o||"ltr"}var Dm="rovingFocusGroup.onEntryFocus",mk={bubbles:!1,cancelable:!0},Ii="RovingFocusGroup",[Jm,ry,pk]=Kc(Ii),[hk,Yc]=ks(Ii,[pk]),[xk,fk]=hk(Ii),ny=c.forwardRef((s,o)=>e.jsx(Jm.Provider,{scope:s.__scopeRovingFocusGroup,children:e.jsx(Jm.Slot,{scope:s.__scopeRovingFocusGroup,children:e.jsx(gk,{...s,ref:o})})}));ny.displayName=Ii;var gk=c.forwardRef((s,o)=>{const{__scopeRovingFocusGroup:n,orientation:l,loop:d=!1,dir:m,currentTabStopId:h,defaultCurrentTabStopId:x,onCurrentTabStopIdChange:g,onEntryFocus:b,preventScrollOnEntryFocus:v=!1,...f}=s,N=c.useRef(null),j=xa(o,N),_=Mi(m),[w,C]=gr({prop:h,defaultProp:x??null,onChange:g,caller:Ii}),[E,z]=c.useState(!1),P=hr(b),V=ry(n),Z=c.useRef(!1),[oe,O]=c.useState(0);return c.useEffect(()=>{const T=N.current;if(T)return T.addEventListener(Dm,P),()=>T.removeEventListener(Dm,P)},[P]),e.jsx(xk,{scope:n,orientation:l,dir:_,loop:d,currentTabStopId:w,onItemFocus:c.useCallback(T=>C(T),[C]),onItemShiftTab:c.useCallback(()=>z(!0),[]),onFocusableItemAdd:c.useCallback(()=>O(T=>T+1),[]),onFocusableItemRemove:c.useCallback(()=>O(T=>T-1),[]),children:e.jsx(Kt.div,{tabIndex:E||oe===0?-1:0,"data-orientation":l,...f,ref:j,style:{outline:"none",...s.style},onMouseDown:kt(s.onMouseDown,()=>{Z.current=!0}),onFocus:kt(s.onFocus,T=>{const ge=!Z.current;if(T.target===T.currentTarget&&ge&&!E){const J=new CustomEvent(Dm,mk);if(T.currentTarget.dispatchEvent(J),!J.defaultPrevented){const W=V().filter(I=>I.focusable),ne=W.find(I=>I.active),Ee=W.find(I=>I.id===w),Le=[ne,Ee,...W].filter(Boolean).map(I=>I.ref.current);ly(Le,v)}}Z.current=!1}),onBlur:kt(s.onBlur,()=>z(!1))})})}),oy="RovingFocusGroupItem",iy=c.forwardRef((s,o)=>{const{__scopeRovingFocusGroup:n,focusable:l=!0,active:d=!1,tabStopId:m,children:h,...x}=s,g=Us(),b=m||g,v=fk(oy,n),f=v.currentTabStopId===b,N=ry(n),{onFocusableItemAdd:j,onFocusableItemRemove:_,currentTabStopId:w}=v;return c.useEffect(()=>{if(l)return j(),()=>_()},[l,j,_]),e.jsx(Jm.ItemSlot,{scope:n,id:b,focusable:l,active:d,children:e.jsx(Kt.span,{tabIndex:f?0:-1,"data-orientation":v.orientation,...x,ref:o,onMouseDown:kt(s.onMouseDown,C=>{l?v.onItemFocus(b):C.preventDefault()}),onFocus:kt(s.onFocus,()=>v.onItemFocus(b)),onKeyDown:kt(s.onKeyDown,C=>{if(C.key==="Tab"&&C.shiftKey){v.onItemShiftTab();return}if(C.target!==C.currentTarget)return;const E=yk(C,v.orientation,v.dir);if(E!==void 0){if(C.metaKey||C.ctrlKey||C.altKey||C.shiftKey)return;C.preventDefault();let P=N().filter(V=>V.focusable).map(V=>V.ref.current);if(E==="last")P.reverse();else if(E==="prev"||E==="next"){E==="prev"&&P.reverse();const V=P.indexOf(C.currentTarget);P=v.loop?Nk(P,V+1):P.slice(V+1)}setTimeout(()=>ly(P))}}),children:typeof h=="function"?h({isCurrentTabStop:f,hasTabStop:w!=null}):h})})});iy.displayName=oy;var bk={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function vk(s,o){return o!=="rtl"?s:s==="ArrowLeft"?"ArrowRight":s==="ArrowRight"?"ArrowLeft":s}function yk(s,o,n){const l=vk(s.key,n);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(l))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(l)))return bk[l]}function ly(s,o=!1){const n=document.activeElement;for(const l of s)if(l===n||(l.focus({preventScroll:o}),document.activeElement!==n))return}function Nk(s,o){return s.map((n,l)=>s[(o+l)%s.length])}var cy=ny,dy=iy,ep=["Enter"," "],jk=["ArrowDown","PageUp","Home"],uy=["ArrowUp","PageDown","End"],_k=[...jk,...uy],Sk={ltr:[...ep,"ArrowRight"],rtl:[...ep,"ArrowLeft"]},wk={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Oi="Menu",[ki,Tk,Ak]=Kc(Oi),[Nn,my]=ks(Oi,[Ak,Fc,Yc]),Xc=Fc(),py=Yc(),[Ck,jn]=Nn(Oi),[kk,Di]=Nn(Oi),hy=s=>{const{__scopeMenu:o,open:n=!1,children:l,dir:d,onOpenChange:m,modal:h=!0}=s,x=Xc(o),[g,b]=c.useState(null),v=c.useRef(!1),f=hr(m),N=Mi(d);return c.useEffect(()=>{const j=()=>{v.current=!0,document.addEventListener("pointerdown",_,{capture:!0,once:!0}),document.addEventListener("pointermove",_,{capture:!0,once:!0})},_=()=>v.current=!1;return document.addEventListener("keydown",j,{capture:!0}),()=>{document.removeEventListener("keydown",j,{capture:!0}),document.removeEventListener("pointerdown",_,{capture:!0}),document.removeEventListener("pointermove",_,{capture:!0})}},[]),e.jsx(qv,{...x,children:e.jsx(Ck,{scope:o,open:n,onOpenChange:f,content:g,onContentChange:b,children:e.jsx(kk,{scope:o,onClose:c.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:v,dir:N,modal:h,children:l})})})};hy.displayName=Oi;var Ek="MenuAnchor",qp=c.forwardRef((s,o)=>{const{__scopeMenu:n,...l}=s,d=Xc(n);return e.jsx(Uv,{...d,...l,ref:o})});qp.displayName=Ek;var Up="MenuPortal",[Rk,xy]=Nn(Up,{forceMount:void 0}),fy=s=>{const{__scopeMenu:o,forceMount:n,children:l,container:d}=s,m=jn(Up,o);return e.jsx(Rk,{scope:o,forceMount:n,children:e.jsx(js,{present:n||m.open,children:e.jsx(Dc,{asChild:!0,container:d,children:l})})})};fy.displayName=Up;var Ns="MenuContent",[Lk,Bp]=Nn(Ns),gy=c.forwardRef((s,o)=>{const n=xy(Ns,s.__scopeMenu),{forceMount:l=n.forceMount,...d}=s,m=jn(Ns,s.__scopeMenu),h=Di(Ns,s.__scopeMenu);return e.jsx(ki.Provider,{scope:s.__scopeMenu,children:e.jsx(js,{present:l||m.open,children:e.jsx(ki.Slot,{scope:s.__scopeMenu,children:h.modal?e.jsx(Pk,{...d,ref:o}):e.jsx(Mk,{...d,ref:o})})})})}),Pk=c.forwardRef((s,o)=>{const n=jn(Ns,s.__scopeMenu),l=c.useRef(null),d=xa(o,l);return c.useEffect(()=>{const m=l.current;if(m)return Gb(m)},[]),e.jsx(Vp,{...s,ref:d,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:kt(s.onFocusOutside,m=>m.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Mk=c.forwardRef((s,o)=>{const n=jn(Ns,s.__scopeMenu);return e.jsx(Vp,{...s,ref:o,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Ik=fo("MenuContent.ScrollLock"),Vp=c.forwardRef((s,o)=>{const{__scopeMenu:n,loop:l=!1,trapFocus:d,onOpenAutoFocus:m,onCloseAutoFocus:h,disableOutsidePointerEvents:x,onEntryFocus:g,onEscapeKeyDown:b,onPointerDownOutside:v,onFocusOutside:f,onInteractOutside:N,onDismiss:j,disableOutsideScroll:_,...w}=s,C=jn(Ns,n),E=Di(Ns,n),z=Xc(n),P=py(n),V=Tk(n),[Z,oe]=c.useState(null),O=c.useRef(null),T=xa(o,O,C.onContentChange),ge=c.useRef(0),J=c.useRef(""),W=c.useRef(0),ne=c.useRef(null),Ee=c.useRef("right"),Ce=c.useRef(0),Le=_?vp:c.Fragment,I=_?{as:Ik,allowPinchZoom:!0}:void 0,Q=de=>{const ze=J.current+de,A=V().filter(D=>!D.disabled),$=document.activeElement,se=A.find(D=>D.ref.current===$)?.textValue,k=A.map(D=>D.textValue),K=Wk(k,ze,se),M=A.find(D=>D.textValue===K)?.ref.current;(function D(q){J.current=q,window.clearTimeout(ge.current),q!==""&&(ge.current=window.setTimeout(()=>D(""),1e3))})(ze),M&&setTimeout(()=>M.focus())};c.useEffect(()=>()=>window.clearTimeout(ge.current),[]),Db();const F=c.useCallback(de=>Ee.current===ne.current?.side&&Yk(de,ne.current?.area),[]);return e.jsx(Lk,{scope:n,searchRef:J,onItemEnter:c.useCallback(de=>{F(de)&&de.preventDefault()},[F]),onItemLeave:c.useCallback(de=>{F(de)||(O.current?.focus(),oe(null))},[F]),onTriggerLeave:c.useCallback(de=>{F(de)&&de.preventDefault()},[F]),pointerGraceTimerRef:W,onPointerGraceIntentChange:c.useCallback(de=>{ne.current=de},[]),children:e.jsx(Le,{...I,children:e.jsx(bp,{asChild:!0,trapped:d,onMountAutoFocus:kt(m,de=>{de.preventDefault(),O.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:h,children:e.jsx(Oc,{asChild:!0,disableOutsidePointerEvents:x,onEscapeKeyDown:b,onPointerDownOutside:v,onFocusOutside:f,onInteractOutside:N,onDismiss:j,children:e.jsx(cy,{asChild:!0,...P,dir:E.dir,orientation:"vertical",loop:l,currentTabStopId:Z,onCurrentTabStopIdChange:oe,onEntryFocus:kt(g,de=>{E.isUsingKeyboardRef.current||de.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Bv,{role:"menu","aria-orientation":"vertical","data-state":Py(C.open),"data-radix-menu-content":"",dir:E.dir,...z,...w,ref:T,style:{outline:"none",...w.style},onKeyDown:kt(w.onKeyDown,de=>{const A=de.target.closest("[data-radix-menu-content]")===de.currentTarget,$=de.ctrlKey||de.altKey||de.metaKey,se=de.key.length===1;A&&(de.key==="Tab"&&de.preventDefault(),!$&&se&&Q(de.key));const k=O.current;if(de.target!==k||!_k.includes(de.key))return;de.preventDefault();const M=V().filter(D=>!D.disabled).map(D=>D.ref.current);uy.includes(de.key)&&M.reverse(),Hk(M)}),onBlur:kt(s.onBlur,de=>{de.currentTarget.contains(de.target)||(window.clearTimeout(ge.current),J.current="")}),onPointerMove:kt(s.onPointerMove,Ei(de=>{const ze=de.target,A=Ce.current!==de.clientX;if(de.currentTarget.contains(ze)&&A){const $=de.clientX>Ce.current?"right":"left";Ee.current=$,Ce.current=de.clientX}}))})})})})})})});gy.displayName=Ns;var Ok="MenuGroup",$p=c.forwardRef((s,o)=>{const{__scopeMenu:n,...l}=s;return e.jsx(Kt.div,{role:"group",...l,ref:o})});$p.displayName=Ok;var Dk="MenuLabel",by=c.forwardRef((s,o)=>{const{__scopeMenu:n,...l}=s;return e.jsx(Kt.div,{...l,ref:o})});by.displayName=Dk;var Tc="MenuItem",Gg="menu.itemSelect",Qc=c.forwardRef((s,o)=>{const{disabled:n=!1,onSelect:l,...d}=s,m=c.useRef(null),h=Di(Tc,s.__scopeMenu),x=Bp(Tc,s.__scopeMenu),g=xa(o,m),b=c.useRef(!1),v=()=>{const f=m.current;if(!n&&f){const N=new CustomEvent(Gg,{bubbles:!0,cancelable:!0});f.addEventListener(Gg,j=>l?.(j),{once:!0}),Pb(f,N),N.defaultPrevented?b.current=!1:h.onClose()}};return e.jsx(vy,{...d,ref:g,disabled:n,onClick:kt(s.onClick,v),onPointerDown:f=>{s.onPointerDown?.(f),b.current=!0},onPointerUp:kt(s.onPointerUp,f=>{b.current||f.currentTarget?.click()}),onKeyDown:kt(s.onKeyDown,f=>{const N=x.searchRef.current!=="";n||N&&f.key===" "||ep.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});Qc.displayName=Tc;var vy=c.forwardRef((s,o)=>{const{__scopeMenu:n,disabled:l=!1,textValue:d,...m}=s,h=Bp(Tc,n),x=py(n),g=c.useRef(null),b=xa(o,g),[v,f]=c.useState(!1),[N,j]=c.useState("");return c.useEffect(()=>{const _=g.current;_&&j((_.textContent??"").trim())},[m.children]),e.jsx(ki.ItemSlot,{scope:n,disabled:l,textValue:d??N,children:e.jsx(dy,{asChild:!0,...x,focusable:!l,children:e.jsx(Kt.div,{role:"menuitem","data-highlighted":v?"":void 0,"aria-disabled":l||void 0,"data-disabled":l?"":void 0,...m,ref:b,onPointerMove:kt(s.onPointerMove,Ei(_=>{l?h.onItemLeave(_):(h.onItemEnter(_),_.defaultPrevented||_.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:kt(s.onPointerLeave,Ei(_=>h.onItemLeave(_))),onFocus:kt(s.onFocus,()=>f(!0)),onBlur:kt(s.onBlur,()=>f(!1))})})})}),zk="MenuCheckboxItem",yy=c.forwardRef((s,o)=>{const{checked:n=!1,onCheckedChange:l,...d}=s;return e.jsx(wy,{scope:s.__scopeMenu,checked:n,children:e.jsx(Qc,{role:"menuitemcheckbox","aria-checked":Ac(n)?"mixed":n,...d,ref:o,"data-state":Hp(n),onSelect:kt(d.onSelect,()=>l?.(Ac(n)?!0:!n),{checkForDefaultPrevented:!1})})})});yy.displayName=zk;var Ny="MenuRadioGroup",[qk,Uk]=Nn(Ny,{value:void 0,onValueChange:()=>{}}),jy=c.forwardRef((s,o)=>{const{value:n,onValueChange:l,...d}=s,m=hr(l);return e.jsx(qk,{scope:s.__scopeMenu,value:n,onValueChange:m,children:e.jsx($p,{...d,ref:o})})});jy.displayName=Ny;var _y="MenuRadioItem",Sy=c.forwardRef((s,o)=>{const{value:n,...l}=s,d=Uk(_y,s.__scopeMenu),m=n===d.value;return e.jsx(wy,{scope:s.__scopeMenu,checked:m,children:e.jsx(Qc,{role:"menuitemradio","aria-checked":m,...l,ref:o,"data-state":Hp(m),onSelect:kt(l.onSelect,()=>d.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});Sy.displayName=_y;var Fp="MenuItemIndicator",[wy,Bk]=Nn(Fp,{checked:!1}),Ty=c.forwardRef((s,o)=>{const{__scopeMenu:n,forceMount:l,...d}=s,m=Bk(Fp,n);return e.jsx(js,{present:l||Ac(m.checked)||m.checked===!0,children:e.jsx(Kt.span,{...d,ref:o,"data-state":Hp(m.checked)})})});Ty.displayName=Fp;var Vk="MenuSeparator",Ay=c.forwardRef((s,o)=>{const{__scopeMenu:n,...l}=s;return e.jsx(Kt.div,{role:"separator","aria-orientation":"horizontal",...l,ref:o})});Ay.displayName=Vk;var $k="MenuArrow",Cy=c.forwardRef((s,o)=>{const{__scopeMenu:n,...l}=s,d=Xc(n);return e.jsx(Vv,{...d,...l,ref:o})});Cy.displayName=$k;var Fk="MenuSub",[G2,ky]=Nn(Fk),Ni="MenuSubTrigger",Ey=c.forwardRef((s,o)=>{const n=jn(Ni,s.__scopeMenu),l=Di(Ni,s.__scopeMenu),d=ky(Ni,s.__scopeMenu),m=Bp(Ni,s.__scopeMenu),h=c.useRef(null),{pointerGraceTimerRef:x,onPointerGraceIntentChange:g}=m,b={__scopeMenu:s.__scopeMenu},v=c.useCallback(()=>{h.current&&window.clearTimeout(h.current),h.current=null},[]);return c.useEffect(()=>v,[v]),c.useEffect(()=>{const f=x.current;return()=>{window.clearTimeout(f),g(null)}},[x,g]),e.jsx(qp,{asChild:!0,...b,children:e.jsx(vy,{id:d.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":d.contentId,"data-state":Py(n.open),...s,ref:Mc(o,d.onTriggerChange),onClick:f=>{s.onClick?.(f),!(s.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:kt(s.onPointerMove,Ei(f=>{m.onItemEnter(f),!f.defaultPrevented&&!s.disabled&&!n.open&&!h.current&&(m.onPointerGraceIntentChange(null),h.current=window.setTimeout(()=>{n.onOpenChange(!0),v()},100))})),onPointerLeave:kt(s.onPointerLeave,Ei(f=>{v();const N=n.content?.getBoundingClientRect();if(N){const j=n.content?.dataset.side,_=j==="right",w=_?-5:5,C=N[_?"left":"right"],E=N[_?"right":"left"];m.onPointerGraceIntentChange({area:[{x:f.clientX+w,y:f.clientY},{x:C,y:N.top},{x:E,y:N.top},{x:E,y:N.bottom},{x:C,y:N.bottom}],side:j}),window.clearTimeout(x.current),x.current=window.setTimeout(()=>m.onPointerGraceIntentChange(null),300)}else{if(m.onTriggerLeave(f),f.defaultPrevented)return;m.onPointerGraceIntentChange(null)}})),onKeyDown:kt(s.onKeyDown,f=>{const N=m.searchRef.current!=="";s.disabled||N&&f.key===" "||Sk[l.dir].includes(f.key)&&(n.onOpenChange(!0),n.content?.focus(),f.preventDefault())})})})});Ey.displayName=Ni;var Ry="MenuSubContent",Ly=c.forwardRef((s,o)=>{const n=xy(Ns,s.__scopeMenu),{forceMount:l=n.forceMount,...d}=s,m=jn(Ns,s.__scopeMenu),h=Di(Ns,s.__scopeMenu),x=ky(Ry,s.__scopeMenu),g=c.useRef(null),b=xa(o,g);return e.jsx(ki.Provider,{scope:s.__scopeMenu,children:e.jsx(js,{present:l||m.open,children:e.jsx(ki.Slot,{scope:s.__scopeMenu,children:e.jsx(Vp,{id:x.contentId,"aria-labelledby":x.triggerId,...d,ref:b,align:"start",side:h.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:v=>{h.isUsingKeyboardRef.current&&g.current?.focus(),v.preventDefault()},onCloseAutoFocus:v=>v.preventDefault(),onFocusOutside:kt(s.onFocusOutside,v=>{v.target!==x.trigger&&m.onOpenChange(!1)}),onEscapeKeyDown:kt(s.onEscapeKeyDown,v=>{h.onClose(),v.preventDefault()}),onKeyDown:kt(s.onKeyDown,v=>{const f=v.currentTarget.contains(v.target),N=wk[h.dir].includes(v.key);f&&N&&(m.onOpenChange(!1),x.trigger?.focus(),v.preventDefault())})})})})})});Ly.displayName=Ry;function Py(s){return s?"open":"closed"}function Ac(s){return s==="indeterminate"}function Hp(s){return Ac(s)?"indeterminate":s?"checked":"unchecked"}function Hk(s){const o=document.activeElement;for(const n of s)if(n===o||(n.focus(),document.activeElement!==o))return}function Gk(s,o){return s.map((n,l)=>s[(o+l)%s.length])}function Wk(s,o,n){const d=o.length>1&&Array.from(o).every(b=>b===o[0])?o[0]:o,m=n?s.indexOf(n):-1;let h=Gk(s,Math.max(m,0));d.length===1&&(h=h.filter(b=>b!==n));const g=h.find(b=>b.toLowerCase().startsWith(d.toLowerCase()));return g!==n?g:void 0}function Kk(s,o){const{x:n,y:l}=s;let d=!1;for(let m=0,h=o.length-1;m<o.length;h=m++){const x=o[m],g=o[h],b=x.x,v=x.y,f=g.x,N=g.y;v>l!=N>l&&n<(f-b)*(l-v)/(N-v)+b&&(d=!d)}return d}function Yk(s,o){if(!o)return!1;const n={x:s.clientX,y:s.clientY};return Kk(n,o)}function Ei(s){return o=>o.pointerType==="mouse"?s(o):void 0}var Xk=hy,Qk=qp,Zk=fy,Jk=gy,eE=$p,tE=by,aE=Qc,sE=yy,rE=jy,nE=Sy,oE=Ty,iE=Ay,lE=Cy,cE=Ey,dE=Ly,Zc="DropdownMenu",[uE]=ks(Zc,[my]),Ga=my(),[mE,My]=uE(Zc),Iy=s=>{const{__scopeDropdownMenu:o,children:n,dir:l,open:d,defaultOpen:m,onOpenChange:h,modal:x=!0}=s,g=Ga(o),b=c.useRef(null),[v,f]=gr({prop:d,defaultProp:m??!1,onChange:h,caller:Zc});return e.jsx(mE,{scope:o,triggerId:Us(),triggerRef:b,contentId:Us(),open:v,onOpenChange:f,onOpenToggle:c.useCallback(()=>f(N=>!N),[f]),modal:x,children:e.jsx(Xk,{...g,open:v,onOpenChange:f,dir:l,modal:x,children:n})})};Iy.displayName=Zc;var Oy="DropdownMenuTrigger",Dy=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,disabled:l=!1,...d}=s,m=My(Oy,n),h=Ga(n);return e.jsx(Qk,{asChild:!0,...h,children:e.jsx(Kt.button,{type:"button",id:m.triggerId,"aria-haspopup":"menu","aria-expanded":m.open,"aria-controls":m.open?m.contentId:void 0,"data-state":m.open?"open":"closed","data-disabled":l?"":void 0,disabled:l,...d,ref:Mc(o,m.triggerRef),onPointerDown:kt(s.onPointerDown,x=>{!l&&x.button===0&&x.ctrlKey===!1&&(m.onOpenToggle(),m.open||x.preventDefault())}),onKeyDown:kt(s.onKeyDown,x=>{l||(["Enter"," "].includes(x.key)&&m.onOpenToggle(),x.key==="ArrowDown"&&m.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(x.key)&&x.preventDefault())})})})});Dy.displayName=Oy;var pE="DropdownMenuPortal",zy=s=>{const{__scopeDropdownMenu:o,...n}=s,l=Ga(o);return e.jsx(Zk,{...l,...n})};zy.displayName=pE;var qy="DropdownMenuContent",Uy=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=My(qy,n),m=Ga(n),h=c.useRef(!1);return e.jsx(Jk,{id:d.contentId,"aria-labelledby":d.triggerId,...m,...l,ref:o,onCloseAutoFocus:kt(s.onCloseAutoFocus,x=>{h.current||d.triggerRef.current?.focus(),h.current=!1,x.preventDefault()}),onInteractOutside:kt(s.onInteractOutside,x=>{const g=x.detail.originalEvent,b=g.button===0&&g.ctrlKey===!0,v=g.button===2||b;(!d.modal||v)&&(h.current=!0)}),style:{...s.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Uy.displayName=qy;var hE="DropdownMenuGroup",xE=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(eE,{...d,...l,ref:o})});xE.displayName=hE;var fE="DropdownMenuLabel",By=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(tE,{...d,...l,ref:o})});By.displayName=fE;var gE="DropdownMenuItem",Vy=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(aE,{...d,...l,ref:o})});Vy.displayName=gE;var bE="DropdownMenuCheckboxItem",vE=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(sE,{...d,...l,ref:o})});vE.displayName=bE;var yE="DropdownMenuRadioGroup",NE=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(rE,{...d,...l,ref:o})});NE.displayName=yE;var jE="DropdownMenuRadioItem",_E=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(nE,{...d,...l,ref:o})});_E.displayName=jE;var SE="DropdownMenuItemIndicator",wE=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(oE,{...d,...l,ref:o})});wE.displayName=SE;var TE="DropdownMenuSeparator",$y=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(iE,{...d,...l,ref:o})});$y.displayName=TE;var AE="DropdownMenuArrow",CE=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(lE,{...d,...l,ref:o})});CE.displayName=AE;var kE="DropdownMenuSubTrigger",EE=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(cE,{...d,...l,ref:o})});EE.displayName=kE;var RE="DropdownMenuSubContent",LE=c.forwardRef((s,o)=>{const{__scopeDropdownMenu:n,...l}=s,d=Ga(n);return e.jsx(dE,{...d,...l,ref:o,style:{...s.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});LE.displayName=RE;var PE=Iy,ME=Dy,IE=zy,Fy=Uy,Hy=By,Gy=Vy,Wy=$y;const OE=PE,DE=ME,Ky=c.forwardRef(({className:s,sideOffset:o=4,...n},l)=>e.jsx(IE,{children:e.jsx(Fy,{ref:l,sideOffset:o,className:Xt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white p-1 text-gray-950 shadow-md","animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})}));Ky.displayName=Fy.displayName;const Yy=c.forwardRef(({className:s,inset:o,...n},l)=>e.jsx(Gy,{ref:l,className:Xt("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",o&&"pl-8",s),...n}));Yy.displayName=Gy.displayName;const Xy=c.forwardRef(({className:s,inset:o,...n},l)=>e.jsx(Hy,{ref:l,className:Xt("px-2 py-1.5 text-sm font-semibold",o&&"pl-8",s),...n}));Xy.displayName=Hy.displayName;const Qy=c.forwardRef(({className:s,...o},n)=>e.jsx(Wy,{ref:n,className:Xt("-mx-1 my-1 h-px bg-gray-200",s),...o}));Qy.displayName=Wy.displayName;function zE({title:s,items:o}){const{state:n,isMobile:l}=So(),d=Gw({select:m=>m.href});return e.jsxs(XC,{children:[e.jsx(QC,{children:s}),e.jsx(ZC,{children:o.map(m=>{const h=`${m.title}-${m.url}`;return m.items?n==="collapsed"&&!l?e.jsx(BE,{item:m,href:d},h):e.jsx(UE,{item:m,href:d},h):e.jsx(qE,{item:m,href:d},h)})})]})}const wi=({children:s})=>e.jsx("span",{className:"rounded-full bg-gray-950 px-2 py-0.5 text-xs text-gray-50",children:s}),qE=({item:s,href:o})=>{const{setOpenMobile:n}=So();return e.jsx(Pp,{children:e.jsx(wc,{asChild:!0,isActive:mo(o,s),tooltip:s.title,children:e.jsxs(Ts,{to:s.url,onClick:()=>n(!1),children:[s.icon&&e.jsx(s.icon,{}),e.jsx("span",{children:s.title}),s.badge&&e.jsx(wi,{children:s.badge})]})})})},UE=({item:s,href:o})=>{const{setOpenMobile:n}=So(),l=()=>{s.url&&n(!1)};return e.jsx(lk,{asChild:!0,defaultOpen:mo(o,s,!0),className:"group/collapsible",children:e.jsxs(Pp,{children:[e.jsxs("div",{className:"flex items-center gap-0",children:[s.url&&e.jsx(wc,{asChild:!0,isActive:mo(o,s),tooltip:s.title,className:"flex-1 rounded-r-none",children:e.jsxs(Ts,{to:s.url,onClick:l,children:[s.icon&&e.jsx(s.icon,{}),e.jsx("span",{children:s.title}),s.badge&&e.jsx(wi,{children:s.badge})]})}),e.jsx(ck,{asChild:!0,children:e.jsxs(wc,{tooltip:`Expandir ${s.title}`,className:s.url?"w-8 rounded-l-none border-l border-gray-700":"",children:[!s.url&&s.icon&&e.jsx(s.icon,{}),!s.url&&e.jsx("span",{children:s.title}),!s.url&&s.badge&&e.jsx(wi,{children:s.badge}),e.jsx(vb,{className:`${s.url?"":"ml-auto"} transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90`})]})})]}),e.jsx(dk,{className:"CollapsibleContent",children:e.jsx(ek,{children:s.items.map(d=>e.jsx(tk,{children:e.jsx(ak,{asChild:!0,isActive:mo(o,d),children:e.jsxs(Ts,{to:d.url,onClick:()=>n(!1),children:[d.icon&&e.jsx(d.icon,{}),e.jsx("span",{children:d.title}),d.badge&&e.jsx(wi,{children:d.badge})]})})},d.title))})})]})})},BE=({item:s,href:o})=>e.jsx(Pp,{children:e.jsxs(OE,{children:[e.jsx(DE,{asChild:!0,children:e.jsxs(wc,{tooltip:s.title,isActive:mo(o,s),children:[s.icon&&e.jsx(s.icon,{}),e.jsx("span",{children:s.title}),s.badge&&e.jsx(wi,{children:s.badge}),e.jsx(vb,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),e.jsxs(Ky,{side:"right",align:"start",sideOffset:4,children:[e.jsxs(Xy,{children:[s.title," ",s.badge?`(${s.badge})`:""]}),e.jsx(Qy,{}),s.items.map(n=>e.jsx(Yy,{asChild:!0,children:e.jsxs(Ts,{to:n.url,className:`${mo(o,n)?"bg-gray-950 text-white":""}`,children:[n.icon&&e.jsx(n.icon,{}),e.jsx("span",{className:"max-w-52 text-wrap",children:n.title}),n.badge&&e.jsx("span",{className:"ml-auto text-xs",children:n.badge})]})},`${n.title}-${n.url}`))]})]})});function mo(s,o,n=!1){return s===o.url||s.split("?")[0]===o.url||!!o?.items?.filter(l=>l.url===s).length||n&&s.split("/")[1]!==""&&s.split("/")[1]===o?.url?.split("/")[1]}const VE={title:"Actividades",items:[{title:"Inicio",url:"/ActividadesSeminarioSO",icon:b1},{title:"Actividad 11",url:"/ActividadesSeminarioSO/actividad11",icon:Va,items:[{title:"Condición de Carrera",url:"/ActividadesSeminarioSO/actividad11/condicion-carrera",icon:Va},{title:"Deadlock",url:"/ActividadesSeminarioSO/actividad11/deadlock",icon:Va},{title:"Starvation",url:"/ActividadesSeminarioSO/actividad11/starvation",icon:Va},{title:"Livelock",url:"/ActividadesSeminarioSO/actividad11/livelock",icon:Va},{title:"Lectura/Escritura",url:"/ActividadesSeminarioSO/actividad11/lectura-escritura",icon:Va},{title:"Contención de Recursos",url:"/ActividadesSeminarioSO/actividad11/contencion-recursos",icon:Va},{title:"Bloqueos Innecesarios",url:"/ActividadesSeminarioSO/actividad11/bloqueos-innecesarios",icon:Va},{title:"Eventos",url:"/ActividadesSeminarioSO/actividad11/eventos",icon:Va},{title:"Priority Inversion",url:"/ActividadesSeminarioSO/actividad11/priority-inversion",icon:Va},{title:"ABA",url:"/ActividadesSeminarioSO/actividad11/aba",icon:Va},{title:"Memory Consistency",url:"/ActividadesSeminarioSO/actividad11/memory-consistency",icon:Va},{title:"Thundering Herd",url:"/ActividadesSeminarioSO/actividad11/thundering-herd",icon:Va},{title:"Convoying",url:"/ActividadesSeminarioSO/actividad11/convoying",icon:Va},{title:"False Sharing",url:"/ActividadesSeminarioSO/actividad11/false-sharing",icon:Va},{title:"Lost Wakeup",url:"/ActividadesSeminarioSO/actividad11/lost-wakeup",icon:Va}]},{title:"Actividad 12",url:"/ActividadesSeminarioSO/actividad12",icon:jb},{title:"Actividad 13",url:"/ActividadesSeminarioSO/actividad13",icon:h1},{title:"Actividad 14",url:"/ActividadesSeminarioSO/actividad14",icon:Ic}]},$E={navGroups:[VE]};function FE({...s}){return e.jsxs(HC,{className:"bg-gray-50",collapsible:"icon",variant:"floating",...s,children:[e.jsx(WC,{children:e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1",children:[e.jsx("div",{className:"flex size-8 items-center justify-center rounded-lg bg-gray-950 text-gray-50",children:e.jsx("span",{className:"text-sm font-bold",children:"SO"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Seminario SO"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Actividades React"})]})]})}),e.jsx(YC,{children:$E.navGroups.map(o=>!o.title||!o.items?null:e.jsx(zE,{...o},o.title))}),e.jsx(KC,{children:e.jsx("div",{className:"px-2 py-1",children:e.jsx("p",{className:"text-xs text-gray-500",children:"© 2025 Joan Alejandro Piña Puga"})})}),e.jsx(GC,{})]})}const Aa=Pw({component:HE});function HE(){return e.jsxs(FC,{defaultOpen:!0,children:[e.jsxs("div",{className:"flex h-screen w-full",children:[e.jsx(FE,{}),e.jsx("div",{className:"flex flex-1 flex-col overflow-hidden",children:e.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:e.jsx(hb,{})})})]}),!1]})}function GE(){return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"rounded-lg bg-gradient-to-r from-gray-50 to-gray-100 p-12 mb-8 shadow-sm",children:e.jsxs("div",{className:"text-center max-w-3xl mx-auto",children:[e.jsx("h1",{className:"text-5xl font-bold mb-4 text-gray-900",children:"Bienvenido"}),e.jsx("h2",{className:"text-2xl font-semibold mb-6 text-gray-700",children:"Seminario de Solución de Problemas de Uso, Adaptación y Explotación de Sistemas Operativos"}),e.jsx("p",{className:"text-lg mb-6 text-gray-600",children:"Este proyecto está diseñado para visualizar y explorar las diferentes actividades de la materia."}),e.jsx("div",{className:"inline-block bg-gray-900 text-white px-4 py-2 rounded-full text-sm font-medium",children:"Autor: Joan Alejandro Piña Puga"})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-3xl font-bold mb-6 text-center text-gray-900",children:"Actividades Disponibles"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Ts,{to:"/ActividadesSeminarioSO/actividad11",className:"block rounded-lg border border-gray-200 bg-white p-6 shadow-sm transition-all hover:shadow-lg hover:scale-105",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-lg bg-green-100 text-green-600",children:e.jsx(Va,{className:"size-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Actividad 11"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Aplicaciones y soluciones de problemas de concurrencia"}),e.jsx("span",{className:"inline-block bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-medium",children:"Disponible"})]})]})}),e.jsx(Ts,{to:"/ActividadesSeminarioSO/actividad12",className:"block rounded-lg border border-gray-200 bg-white p-6 shadow-sm transition-all hover:shadow-lg hover:scale-105",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-lg bg-purple-100 text-purple-600",children:e.jsx(jb,{className:"size-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Actividad 12"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Problema Productor-Consumidor con semáforos"}),e.jsx("span",{className:"inline-block bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-xs font-medium",children:"Disponible"})]})]})}),e.jsx(Ts,{to:"/ActividadesSeminarioSO/actividad13",className:"block rounded-lg border border-gray-200 bg-white p-6 shadow-sm transition-all hover:shadow-lg hover:scale-105",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-lg bg-orange-100 text-orange-600",children:e.jsx(yi,{className:"size-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Actividad 13"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Scripts en Sistemas Operativos (Windows y Linux)"}),e.jsx("span",{className:"inline-block bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-xs font-medium",children:"Disponible"})]})]})}),e.jsx(Ts,{to:"/ActividadesSeminarioSO/actividad14",className:"block rounded-lg border border-gray-200 bg-white p-6 shadow-sm transition-all hover:shadow-lg hover:scale-105",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-lg bg-blue-100 text-blue-600",children:e.jsx(Ic,{className:"size-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Actividad 14"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Algoritmo del Banquero para prevención de deadlock"}),e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs font-medium",children:"Disponible"})]})]})})]})]}),e.jsxs("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4 flex items-start gap-3",children:[e.jsx(y1,{className:"size-5 text-blue-600 mt-0.5"}),e.jsx("p",{className:"text-sm text-blue-900",children:"Selecciona una actividad disponible del menú lateral o de las tarjetas superiores para comenzar."})]})]})}const WE=Sa("/ActividadesSeminarioSO/")({component:GE});function KE(){const s=["A","B","C"],o=[10,5,7],n=[{id:0,max:[7,5,3],allocation:[0,1,0],need:[7,4,3],finished:!1},{id:1,max:[3,2,2],allocation:[2,0,0],need:[1,2,2],finished:!1},{id:2,max:[9,0,2],allocation:[3,0,2],need:[6,0,0],finished:!1},{id:3,max:[2,2,2],allocation:[2,1,1],need:[0,1,1],finished:!1},{id:4,max:[4,3,3],allocation:[0,0,2],need:[4,3,1],finished:!1}],[l,d]=c.useState(o),[m,h]=c.useState(n),[x,g]=c.useState([]),[b,v]=c.useState(null),[f,N]=c.useState([]),[j,_]=c.useState(0),[w,C]=c.useState([0,0,0]),E=J=>{N(W=>[...W,J])},z=(J,W)=>J.map((ne,Ee)=>ne-W[Ee]),P=(J,W)=>J.every((ne,Ee)=>ne<=W[Ee]),V=(J,W)=>{const ne=[...J],Ee=W.map(()=>!1),Ce=[];E("🔍 Iniciando algoritmo de seguridad..."),E(`📊 Recursos disponibles: [${ne.join(", ")}]`);let Le=!0;for(;Le;){Le=!1;for(let Q=0;Q<W.length;Q++)if(!Ee[Q]&&P(W[Q].need,ne)){E(`✅ P${Q} puede terminar: Need[${W[Q].need.join(", ")}] ≤ Work[${ne.join(", ")}]`);for(let F=0;F<ne.length;F++)ne[F]+=W[Q].allocation[F];E(`   Recursos liberados. Work = [${ne.join(", ")}]`),Ee[Q]=!0,Ce.push(Q),Le=!0;break}}if(Ee.every(Q=>Q))return E("✅ Estado SEGURO encontrado"),E(`🎯 Secuencia segura: ${Ce.map(Q=>`P${Q}`).join(" → ")}`),g(Ce),v(!0),!0;{E("❌ Estado INSEGURO: No todos los procesos pueden terminar");const Q=Ee.map((F,de)=>F?-1:de).filter(F=>F!==-1);return E(`   Procesos bloqueados: ${Q.map(F=>`P${F}`).join(", ")}`),v(!1),!1}},Z=()=>{N([]),g([]),v(null);const J=m.map(W=>({...W,need:z(W.max,W.allocation)}));h(J),V(l,J)},oe=()=>{N([]),g([]),v(null);const J=m[j];if(E(`📝 Proceso P${j} solicita recursos: [${w.join(", ")}]`),w.some((I,Q)=>I>J.need[Q])){E("❌ ERROR: La solicitud excede la necesidad máxima declarada"),E(`   Need: [${J.need.join(", ")}], Request: [${w.join(", ")}]`),v(!1);return}if(w.some((I,Q)=>I>l[Q])){E("❌ No hay suficientes recursos disponibles"),E(`   Available: [${l.join(", ")}], Request: [${w.join(", ")}]`),E("   El proceso debe ESPERAR"),v(!1);return}E("✅ Verificaciones pasadas. Simulando asignación...");const Ee=l.map((I,Q)=>I-w[Q]),Ce=m.map((I,Q)=>{if(Q===j){const F=I.allocation.map((de,ze)=>de+w[ze]);return{...I,allocation:F,need:z(I.max,F)}}return I});E("📊 Nuevo estado simulado:"),E(`   Available: [${Ee.join(", ")}]`),E(`   P${j} Allocation: [${Ce[j].allocation.join(", ")}]`),E(`   P${j} Need: [${Ce[j].need.join(", ")}]`),V(Ee,Ce)?(E("✅ Solicitud CONCEDIDA"),d(Ee),h(Ce)):(E("❌ Solicitud RECHAZADA (llevaría a estado inseguro)"),E(`   El proceso P${j} debe ESPERAR`))},O=()=>{d(o),h(n),g([]),v(null),N([]),_(0),C([0,0,0])},T=(J,W,ne)=>{const Ee=m.map((Ce,Le)=>{if(Le===J){const I=[...Ce.max];return I[W]=Math.max(0,ne),{...Ce,max:I,need:z(I,Ce.allocation)}}return Ce});h(Ee)},ge=(J,W,ne)=>{const Ee=m.map((I,Q)=>{if(Q===J){const F=[...I.allocation];return F[W]=Math.max(0,Math.min(ne,I.max[W])),{...I,allocation:F,need:z(I.max,F)}}return I});h(Ee);const Ce=s.map((I,Q)=>Ee.reduce((F,de)=>F+de.allocation[Q],0)),Le=o.map((I,Q)=>I-Ce[Q]);d(Le)};return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(nt,{className:"size-6 text-blue-400"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Demostración Interactiva"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-white mb-4",children:"Recursos Disponibles (Available)"}),e.jsx("div",{className:"space-y-3",children:s.map((J,W)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-gray-300 font-medium",children:["Recurso ",J,":"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gray-800 rounded-full h-2 w-32",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:`${l[W]/o[W]*100}%`}})}),e.jsx("span",{className:"text-2xl font-bold text-blue-400 w-12 text-right",children:l[W]})]})]},J))})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-white mb-4",children:"Estado del Sistema"}),b===null?e.jsxs("div",{className:"text-gray-400 text-center py-8",children:[e.jsx(yn,{className:"size-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Ejecuta el algoritmo para verificar seguridad"})]}):b?e.jsxs("div",{className:"text-green-400",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(gg,{className:"size-8"}),e.jsx("span",{className:"text-xl font-bold",children:"Estado SEGURO"})]}),e.jsxs("div",{className:"bg-green-900/30 border border-green-700 rounded p-3",children:[e.jsx("p",{className:"text-sm text-green-200 mb-2",children:"Secuencia segura encontrada:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map((J,W)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"bg-green-600 text-white px-3 py-1 rounded font-bold",children:["P",J]}),W<x.length-1&&e.jsx("span",{className:"text-green-400",children:"→"})]},W))})]})]}):e.jsxs("div",{className:"text-red-400",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(u1,{className:"size-8"}),e.jsx("span",{className:"text-xl font-bold",children:"Estado INSEGURO"})]}),e.jsx("div",{className:"bg-red-900/30 border border-red-700 rounded p-3",children:e.jsx("p",{className:"text-sm text-red-200",children:"No existe una secuencia segura. El sistema podría entrar en deadlock."})})]})]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 mb-6 overflow-x-auto",children:[e.jsx("h3",{className:"font-bold text-white mb-4",children:"Estado de Procesos"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsxs("thead",{children:[e.jsxs("tr",{className:"border-b border-gray-600",children:[e.jsx("th",{className:"text-left text-gray-300 p-2",children:"Proceso"}),e.jsx("th",{className:"text-center text-gray-300 p-2",colSpan:3,children:"Max"}),e.jsx("th",{className:"text-center text-gray-300 p-2",colSpan:3,children:"Allocation"}),e.jsx("th",{className:"text-center text-gray-300 p-2",colSpan:3,children:"Need"})]}),e.jsxs("tr",{className:"border-b border-gray-600 text-xs text-gray-400",children:[e.jsx("th",{className:"p-2"}),["A","B","C"].map(J=>e.jsx("th",{className:"p-1",children:J},`max-${J}`)),["A","B","C"].map(J=>e.jsx("th",{className:"p-1",children:J},`alloc-${J}`)),["A","B","C"].map(J=>e.jsx("th",{className:"p-1",children:J},`need-${J}`))]})]}),e.jsx("tbody",{children:m.map(J=>e.jsxs("tr",{className:"border-b border-gray-600 hover:bg-gray-600/50",children:[e.jsxs("td",{className:"text-white font-bold p-2",children:["P",J.id]}),J.max.map((W,ne)=>e.jsx("td",{className:"text-center p-1",children:e.jsx("input",{type:"number",min:"0",max:"20",value:W,onChange:Ee=>T(J.id,ne,Number(Ee.target.value)),className:"w-12 bg-gray-800 text-white text-center rounded px-1 py-0.5"})},`max-${ne}`)),J.allocation.map((W,ne)=>e.jsx("td",{className:"text-center p-1",children:e.jsx("input",{type:"number",min:"0",max:J.max[ne],value:W,onChange:Ee=>ge(J.id,ne,Number(Ee.target.value)),className:"w-12 bg-gray-800 text-orange-400 text-center rounded px-1 py-0.5"})},`alloc-${ne}`)),J.need.map((W,ne)=>e.jsx("td",{className:"text-center text-purple-400 p-1",children:W},`need-${ne}`))]},J.id))})]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ic,{className:"size-5 text-blue-400"}),e.jsx("h3",{className:"font-bold text-white",children:"Solicitar Recursos"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-300 block mb-2",children:"Proceso:"}),e.jsx("select",{value:j,onChange:J=>_(Number(J.target.value)),className:"w-full bg-gray-800 text-white rounded px-3 py-2",children:m.map(J=>e.jsxs("option",{value:J.id,children:["Proceso P",J.id]},J.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-300 block mb-2",children:"Recursos a solicitar:"}),e.jsx("div",{className:"flex gap-2",children:s.map((J,W)=>e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:J}),e.jsx("input",{type:"number",min:"0",max:m[j].need[W],value:w[W],onChange:ne=>{const Ee=[...w];Ee[W]=Number(ne.target.value),C(Ee)},className:"w-full bg-gray-800 text-white rounded px-2 py-1 text-center"})]},J))})]})]}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[e.jsx(nt,{className:"size-4"}),"Solicitar Recursos"]}),e.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:[e.jsx(gg,{className:"size-4"}),"Verificar Seguridad"]}),e.jsxs("button",{onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]})]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-white mb-3",children:"Registro de Ejecución"}),e.jsx("div",{className:"bg-gray-900 rounded p-3 h-64 overflow-y-auto font-mono text-xs text-gray-300",children:f.length===0?e.jsx("div",{className:"text-gray-500 text-center py-8",children:"Ejecuta una operación para ver el registro"}):f.map((J,W)=>e.jsx("div",{className:"mb-1",children:J},W))})]})]})}function YE(){return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100 pb-12",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-lg bg-blue-600 text-white",children:e.jsx(R1,{className:"size-6"})}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Algoritmo del Banquero"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Prevención de interbloqueo mediante asignación segura de recursos"})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"bg-white text-gray-900 rounded-lg p-8 mb-8 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(La,{className:"size-6 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Planteamiento del Problema"})]}),e.jsxs("div",{className:"prose prose-gray max-w-none space-y-4",children:[e.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["El ",e.jsx("strong",{className:"text-blue-600",children:"Algoritmo del Banquero"})," es un algoritmo de prevención de interbloqueo (deadlock) propuesto por Edsger Dijkstra. Su nombre proviene de la analogía con un banquero que debe decidir si otorgar préstamos a clientes de manera que siempre pueda satisfacer todas las necesidades máximas de sus clientes sin quedarse sin recursos."]}),e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 my-4",children:[e.jsx("h3",{className:"font-bold text-blue-900 mb-2",children:"🎯 Objetivo del Algoritmo"}),e.jsxs("p",{className:"text-gray-700 text-sm",children:["Determinar si es ",e.jsx("strong",{children:"seguro"})," asignar recursos a un proceso en un momento dado. Un estado es seguro si existe al menos una secuencia de ejecución que permite a todos los procesos completar su trabajo sin entrar en deadlock."]})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mt-6 mb-3",children:"Conceptos Fundamentales"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-green-900 mb-2",children:"✅ Estado Seguro"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Existe al menos una secuencia de procesos que permite completar todos sin deadlock. El sistema puede satisfacer todas las necesidades máximas de los procesos."})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-red-900 mb-2",children:"❌ Estado Inseguro"}),e.jsx("p",{className:"text-sm text-gray-700",children:"No hay garantía de evitar deadlock. Puede llevar a un estado donde ningún proceso puede continuar por falta de recursos."})]})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mt-6 mb-3",children:"Estructuras de Datos"}),e.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["El algoritmo mantiene cuatro estructuras principales para ",e.jsx("strong",{children:"n"})," procesos y ",e.jsx("strong",{children:"m"})," tipos de recursos:"]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 my-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-600 text-white rounded-full size-8 flex items-center justify-center flex-shrink-0 font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:"Available (Disponible)"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Vector de tamaño ",e.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"m"}),". Indica cuántas instancias de cada tipo de recurso están disponibles actualmente."]}),e.jsx("code",{className:"text-xs bg-gray-200 px-2 py-1 rounded mt-1 inline-block",children:"Available[j] = k → hay k instancias del recurso j disponibles"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-green-600 text-white rounded-full size-8 flex items-center justify-center flex-shrink-0 font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:"Max (Máximo)"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Matriz ",e.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"n × m"}),". Define la demanda máxima de cada proceso. Número máximo de instancias que cada proceso puede solicitar."]}),e.jsx("code",{className:"text-xs bg-gray-200 px-2 py-1 rounded mt-1 inline-block",children:"Max[i][j] = k → proceso i puede solicitar máximo k instancias del recurso j"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-orange-600 text-white rounded-full size-8 flex items-center justify-center flex-shrink-0 font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:"Allocation (Asignación)"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Matriz ",e.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"n × m"}),". Define cuántas instancias de cada recurso están actualmente asignadas a cada proceso."]}),e.jsx("code",{className:"text-xs bg-gray-200 px-2 py-1 rounded mt-1 inline-block",children:"Allocation[i][j] = k → proceso i tiene asignadas k instancias del recurso j"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-purple-600 text-white rounded-full size-8 flex items-center justify-center flex-shrink-0 font-bold",children:"4"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:"Need (Necesidad)"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Matriz ",e.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"n × m"}),". Indica cuántos recursos adicionales puede necesitar cada proceso. Se calcula como: ",e.jsx("strong",{children:"Need = Max - Allocation"})]}),e.jsx("code",{className:"text-xs bg-gray-200 px-2 py-1 rounded mt-1 inline-block",children:"Need[i][j] = Max[i][j] - Allocation[i][j]"})]})]})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mt-6 mb-3",children:"Algoritmo de Seguridad"}),e.jsx("p",{className:"text-gray-700 leading-relaxed mb-3",children:"Para determinar si un estado es seguro, el algoritmo sigue estos pasos:"}),e.jsxs("div",{className:"bg-blue-900/10 border border-blue-300 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"font-bold text-blue-900",children:"1."}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Inicializar ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"Work = Available"})," y",e.jsx("code",{className:"bg-blue-100 px-1 rounded ml-1",children:"Finish[i] = false"})," para todos los procesos."]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"font-bold text-blue-900",children:"2."}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Buscar un proceso ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"i"})," tal que:",e.jsx("br",{}),"• ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"Finish[i] = false"}),e.jsx("br",{}),"• ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"Need[i] ≤ Work"})," (puede completarse con recursos disponibles)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"font-bold text-blue-900",children:"3."}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Si se encuentra tal proceso:",e.jsx("br",{}),"• ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"Work = Work + Allocation[i]"})," (libera recursos)",e.jsx("br",{}),"• ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"Finish[i] = true"}),e.jsx("br",{}),"• Volver al paso 2"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"font-bold text-blue-900",children:"4."}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Si ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"Finish[i] = true"})," para todos, el estado es ",e.jsx("strong",{className:"text-green-600",children:"SEGURO"}),".",e.jsx("br",{}),"Si no, el estado es ",e.jsx("strong",{className:"text-red-600",children:"INSEGURO"}),"."]})]})]}),e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-500 p-4 mt-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(yb,{className:"size-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-yellow-900 mb-1",children:"Decisión de Asignación"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Cuando un proceso solicita recursos, el sistema simula la asignación y ejecuta el algoritmo de seguridad. Solo si el nuevo estado es seguro, se concede la solicitud. De lo contrario, el proceso debe esperar hasta que sea seguro asignar los recursos."})]})]})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mt-6 mb-3",children:"Ventajas y Limitaciones"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-green-900 mb-2",children:"✅ Ventajas"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Previene deadlock de forma proactiva"}),e.jsx("li",{children:"Garantiza que el sistema nunca entre en estado inseguro"}),e.jsx("li",{children:"Permite utilización eficiente de recursos"})]})]}),e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-orange-900 mb-2",children:"⚠️ Limitaciones"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Requiere conocer de antemano las necesidades máximas"}),e.jsx("li",{children:"El número de procesos debe ser fijo"}),e.jsx("li",{children:"Puede ser conservador y rechazar solicitudes seguras"})]})]})]})]})]}),e.jsx(KE,{})]})]})}const XE=Sa("/ActividadesSeminarioSO/actividad14/")({component:YE}),QE=[{id:1,title:"Respaldo Automático de Archivos",description:"Script para copiar archivos de una carpeta a otra ubicación de respaldo con marca de tiempo.",code:`@echo off
REM Respaldo automático con fecha
set "source=C:\\Documentos"
set "backup=D:\\Respaldos"
set fecha=%date:~-4,4%%date:~-10,2%%date:~-7,2%

xcopy "%source%" "%backup%\\Backup_%fecha%\\" /E /I /Y
echo Respaldo completado en %backup%\\Backup_%fecha%
pause`,usage:"Ejecutar como administrador. Modificar rutas de origen y destino según necesidades."},{id:2,title:"Limpieza de Archivos Temporales",description:"Elimina archivos temporales del sistema para liberar espacio en disco.",code:`@echo off
echo Limpiando archivos temporales...

REM Limpiar carpeta Temp del usuario
del /q /f /s %TEMP%\\* 2>nul
for /d %%p in (%TEMP%\\*) do rmdir "%%p" /s /q 2>nul

REM Limpiar carpeta Temp de Windows
del /q /f /s C:\\Windows\\Temp\\* 2>nul
for /d %%p in (C:\\Windows\\Temp\\*) do rmdir "%%p" /s /q 2>nul

echo Limpieza completada.
pause`,usage:"Ejecutar con permisos de administrador para acceder a todas las carpetas temporales."},{id:3,title:"Información del Sistema",description:"Recopila información detallada del sistema y la guarda en un archivo de texto.",code:`@echo off
set "output=C:\\info_sistema.txt"

echo ========== INFORMACION DEL SISTEMA ========== > "%output%"
echo. >> "%output%"

echo Fecha y Hora: %date% %time% >> "%output%"
echo. >> "%output%"

systeminfo >> "%output%"

echo. >> "%output%"
echo ========== DISCOS ========== >> "%output%"
wmic logicaldisk get caption,description,freespace,size >> "%output%"

echo Información guardada en %output%
pause`,usage:"Generar un reporte completo del sistema para documentación o diagnóstico."},{id:4,title:"Gestión de Servicios Windows",description:"Permite iniciar, detener o reiniciar servicios de Windows de manera automatizada.",code:`@echo off
REM Configurar el nombre del servicio
set "servicio=Spooler"

echo Seleccione una opcion:
echo 1. Iniciar servicio
echo 2. Detener servicio
echo 3. Reiniciar servicio
echo 4. Ver estado

set /p opcion="Ingrese opcion (1-4): "

if "%opcion%"=="1" net start "%servicio%"
if "%opcion%"=="2" net stop "%servicio%"
if "%opcion%"=="3" (
    net stop "%servicio%"
    timeout /t 2 /nobreak
    net start "%servicio%"
)
if "%opcion%"=="4" sc query "%servicio%"

pause`,usage:'Modificar la variable "servicio" con el nombre del servicio deseado. Requiere privilegios de administrador.'},{id:5,title:"Creación Masiva de Carpetas",description:"Crea múltiples carpetas organizadas por fecha o proyecto automáticamente.",code:`@echo off
set "ruta_base=C:\\Proyectos"
set fecha=%date:~-4,4%-%date:~-10,2%-%date:~-7,2%

REM Crear estructura de carpetas
mkdir "%ruta_base%\\Proyecto_%fecha%\\Documentos"
mkdir "%ruta_base%\\Proyecto_%fecha%\\Codigo"
mkdir "%ruta_base%\\Proyecto_%fecha%\\Recursos"
mkdir "%ruta_base%\\Proyecto_%fecha%\\Pruebas"

echo Estructura de carpetas creada en:
echo %ruta_base%\\Proyecto_%fecha%
pause`,usage:"Ideal para iniciar proyectos nuevos con una estructura predefinida."},{id:6,title:"Verificación de Conectividad de Red",description:"Comprueba la conectividad a múltiples hosts y registra los resultados.",code:`@echo off
set "log=C:\\conectividad.log"

echo ========== TEST DE CONECTIVIDAD ========== > "%log%"
echo Fecha: %date% %time% >> "%log%"
echo. >> "%log%"

echo Probando Google...
ping -n 4 8.8.8.8 >> "%log%"

echo Probando DNS...
ping -n 4 www.google.com >> "%log%"

echo Probando gateway local...
for /f "tokens=3" %%a in ('route print ^| findstr "0.0.0.0"') do (
    ping -n 4 %%a >> "%log%"
)

echo Resultados guardados en %log%
pause`,usage:"Útil para diagnosticar problemas de red y documentar el estado de conectividad."},{id:7,title:"Instalador Silencioso de Programas",description:"Automatiza la instalación de múltiples programas sin intervención del usuario.",code:`@echo off
echo Iniciando instalaciones automatizadas...

REM Instalar Chrome
start /wait chrome_installer.exe /silent /install

REM Instalar Adobe Reader
start /wait AcroRdrDC.exe /sAll /msi EULA_ACCEPT=YES

REM Instalar 7-Zip
start /wait 7z-x64.msi /quiet /qn

echo Instalaciones completadas.
pause`,usage:"Colocar los instaladores en la misma carpeta del script. Requiere permisos de administrador."},{id:8,title:"Apagado Programado del Sistema",description:"Programa el apagado del sistema después de un tiempo específico o cancelación.",code:`@echo off
echo Seleccione una opcion:
echo 1. Apagar en 30 minutos
echo 2. Apagar en 1 hora
echo 3. Apagar en 2 horas
echo 4. Cancelar apagado programado

set /p opcion="Ingrese opcion (1-4): "

if "%opcion%"=="1" shutdown /s /t 1800
if "%opcion%"=="2" shutdown /s /t 3600
if "%opcion%"=="3" shutdown /s /t 7200
if "%opcion%"=="4" shutdown /a

echo Comando ejecutado.
pause`,usage:"Útil para programar apagados automáticos después de descargas o procesos largos."},{id:9,title:"Gestión de Usuarios Locales",description:"Crear, eliminar o modificar usuarios locales del sistema de manera automatizada.",code:`@echo off
echo === GESTION DE USUARIOS ===
echo.
echo 1. Crear nuevo usuario
echo 2. Eliminar usuario
echo 3. Cambiar contraseña
echo 4. Listar usuarios

set /p opcion="Seleccione opcion: "

if "%opcion%"=="1" (
    set /p usuario="Nombre de usuario: "
    set /p pass="Contraseña: "
    net user %usuario% %pass% /add
)

if "%opcion%"=="2" (
    set /p usuario="Usuario a eliminar: "
    net user %usuario% /delete
)

if "%opcion%"=="3" (
    set /p usuario="Usuario: "
    set /p pass="Nueva contraseña: "
    net user %usuario% %pass%
)

if "%opcion%"=="4" net user

pause`,usage:"Requiere ejecutar como administrador. Útil para gestión rápida de cuentas locales."},{id:10,title:"Monitoreo de Espacio en Disco",description:"Verifica el espacio disponible en discos y alerta si está por debajo de un umbral.",code:`@echo off
set "umbral=10"
set "log=C:\\espacio_disco.log"

echo ========== MONITOREO DE DISCO ========== > "%log%"
echo Fecha: %date% %time% >> "%log%"
echo. >> "%log%"

for /f "tokens=1,2,3" %%a in ('wmic logicaldisk get caption^,freespace^,size ^| findstr /r "^[A-Z]"') do (
    set /a libre=%%b/1073741824
    set /a total=%%c/1073741824
    set /a porcentaje=100*%%b/%%c
    
    echo Disco %%a: !libre! GB libres de !total! GB ^(!porcentaje!%%^) >> "%log%"
    
    if !porcentaje! LSS %umbral% (
        echo ALERTA: Disco %%a tiene menos del %umbral%%% libre >> "%log%"
    )
)

type "%log%"
pause`,usage:"Programar con el Programador de tareas para monitoreo automático del espacio en disco."}];function ZE(){const[s,o]=c.useState(null),n=l=>{o(s===l?null:l)};return e.jsx("div",{className:"space-y-3",children:QE.map(l=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>n(l.id),type:"button",className:"w-full px-6 py-4 bg-gradient-to-r from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 transition-colors flex items-center justify-between text-left cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"flex items-center justify-center size-8 rounded-full bg-blue-600 text-white font-bold text-sm",children:l.id}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900",children:l.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.description})]})]}),e.jsx(xp,{className:`size-5 text-blue-600 transition-transform flex-shrink-0 ml-4 ${s===l.id?"rotate-180":""}`})]}),s===l.id&&e.jsx("div",{className:"px-6 py-4 bg-white border-t border-gray-200",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-600",children:"</>"}),"Código del Script"]}),e.jsx("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm",children:e.jsx("code",{children:l.code})})]}),e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"📝 Instrucciones de Uso"}),e.jsx("p",{className:"text-sm text-gray-700",children:l.usage})]})]})})]},l.id))})}const JE=[{id:1,title:"Respaldo Automatizado con Compresión",description:"Script que crea respaldos comprimidos de directorios importantes con fecha y hora.",code:`#!/bin/bash
# Respaldo automático con tar y gzip

ORIGEN="/home/usuario/documentos"
DESTINO="/backup"
FECHA=$(date +%Y%m%d_%H%M%S)
ARCHIVO="backup_$FECHA.tar.gz"

# Crear directorio de respaldo si no existe
mkdir -p "$DESTINO"

# Crear respaldo comprimido
tar -czf "$DESTINO/$ARCHIVO" "$ORIGEN"

# Verificar si se creó correctamente
if [ $? -eq 0 ]; then
    echo "Respaldo creado exitosamente: $DESTINO/$ARCHIVO"
    ls -lh "$DESTINO/$ARCHIVO"
else
    echo "Error al crear el respaldo"
    exit 1
fi`,usage:"Dar permisos de ejecución con: chmod +x script.sh. Modificar rutas según necesidades. Programar con cron para respaldos automáticos."},{id:2,title:"Monitoreo de Recursos del Sistema",description:"Monitorea CPU, memoria y disco, enviando alertas cuando superan umbrales definidos.",code:`#!/bin/bash
# Monitoreo de recursos del sistema

LOG="/var/log/monitor_recursos.log"
UMBRAL_CPU=80
UMBRAL_MEM=85
UMBRAL_DISK=90

# Fecha y hora
echo "========== $(date) ==========" >> "$LOG"

# Verificar CPU
CPU=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
echo "Uso de CPU: $CPU%" >> "$LOG"
if (( $(echo "$CPU > $UMBRAL_CPU" | bc -l) )); then
    echo "ALERTA: CPU sobre el umbral!" >> "$LOG"
fi

# Verificar Memoria
MEM=$(free | grep Mem | awk '{print ($3/$2) * 100.0}')
echo "Uso de Memoria: \${MEM}%" >> "$LOG"
if (( $(echo "$MEM > $UMBRAL_MEM" | bc -l) )); then
    echo "ALERTA: Memoria sobre el umbral!" >> "$LOG"
fi

# Verificar Disco
DISK=$(df -h / | awk 'NR==2 {print $5}' | cut -d'%' -f1)
echo "Uso de Disco: $DISK%" >> "$LOG"
if [ $DISK -gt $UMBRAL_DISK ]; then
    echo "ALERTA: Disco sobre el umbral!" >> "$LOG"
fi

echo "" >> "$LOG"`,usage:"Ejecutar con permisos de root. Configurar en crontab para monitoreo continuo: */5 * * * * /ruta/script.sh"},{id:3,title:"Actualización Automática del Sistema",description:"Actualiza paquetes del sistema y limpia archivos innecesarios automáticamente.",code:`#!/bin/bash
# Script de actualización automática (Debian/Ubuntu)

LOG="/var/log/actualizacion_sistema.log"

echo "========== Actualización iniciada: $(date) ==========" >> "$LOG"

# Actualizar lista de paquetes
echo "Actualizando lista de paquetes..." >> "$LOG"
apt update >> "$LOG" 2>&1

# Actualizar paquetes instalados
echo "Actualizando paquetes instalados..." >> "$LOG"
apt upgrade -y >> "$LOG" 2>&1

# Actualización de distribución
echo "Verificando actualización de distribución..." >> "$LOG"
apt dist-upgrade -y >> "$LOG" 2>&1

# Limpiar paquetes obsoletos
echo "Limpiando paquetes obsoletos..." >> "$LOG"
apt autoremove -y >> "$LOG" 2>&1
apt autoclean >> "$LOG" 2>&1

echo "========== Actualización completada: $(date) ==========" >> "$LOG"
echo "" >> "$LOG"

# Verificar si requiere reinicio
if [ -f /var/run/reboot-required ]; then
    echo "ATENCIÓN: Se requiere reiniciar el sistema" >> "$LOG"
fi`,usage:"Ejecutar como root o con sudo. Programar con cron para actualizaciones nocturnas: 0 2 * * 0 /ruta/script.sh"},{id:4,title:"Gestión de Usuarios y Permisos",description:"Automatiza la creación de usuarios con configuración predefinida y permisos.",code:`#!/bin/bash
# Script de gestión de usuarios

function crear_usuario() {
    read -p "Nombre de usuario: " username
    read -s -p "Contraseña: " password
    echo
    
    # Crear usuario
    useradd -m -s /bin/bash "$username"
    echo "$username:$password" | chpasswd
    
    # Agregar a grupos
    usermod -aG sudo,www-data "$username"
    
    # Crear estructura de directorios
    mkdir -p /home/$username/{proyectos,documentos,descargas}
    chown -R $username:$username /home/$username
    
    echo "Usuario $username creado exitosamente"
}

function eliminar_usuario() {
    read -p "Usuario a eliminar: " username
    read -p "¿Eliminar directorio home? (s/n): " eliminar_home
    
    if [ "$eliminar_home" = "s" ]; then
        userdel -r "$username"
    else
        userdel "$username"
    fi
    
    echo "Usuario $username eliminado"
}

function listar_usuarios() {
    echo "=== Usuarios del sistema ==="
    awk -F: '$3 >= 1000 && $3 < 65534 {print $1}' /etc/passwd
}

# Menú principal
echo "1. Crear usuario"
echo "2. Eliminar usuario"
echo "3. Listar usuarios"
read -p "Seleccione opción: " opcion

case $opcion in
    1) crear_usuario ;;
    2) eliminar_usuario ;;
    3) listar_usuarios ;;
    *) echo "Opción inválida" ;;
esac`,usage:"Debe ejecutarse como root. Personalizar grupos y estructura de directorios según necesidades organizacionales."},{id:5,title:"Análisis de Logs y Reportes",description:"Analiza archivos de log del sistema y genera reportes de eventos importantes.",code:`#!/bin/bash
# Análisis de logs del sistema

REPORTE="/var/log/analisis_logs_$(date +%Y%m%d).txt"

echo "========== ANÁLISIS DE LOGS ==========" > "$REPORTE"
echo "Fecha: $(date)" >> "$REPORTE"
echo "" >> "$REPORTE"

# Errores en syslog
echo "=== ERRORES EN SYSLOG ===" >> "$REPORTE"
grep -i "error" /var/log/syslog | tail -20 >> "$REPORTE"
echo "" >> "$REPORTE"

# Intentos de login fallidos
echo "=== INTENTOS DE LOGIN FALLIDOS ===" >> "$REPORTE"
grep "Failed password" /var/log/auth.log | tail -20 >> "$REPORTE"
echo "" >> "$REPORTE"

# Servicios reiniciados
echo "=== SERVICIOS REINICIADOS ===" >> "$REPORTE"
grep "Started\\|Stopped" /var/log/syslog | tail -20 >> "$REPORTE"
echo "" >> "$REPORTE"

# Espacio en disco
echo "=== ESPACIO EN DISCO ===" >> "$REPORTE"
df -h >> "$REPORTE"
echo "" >> "$REPORTE"

# Procesos que más consumen
echo "=== TOP 10 PROCESOS (CPU) ===" >> "$REPORTE"
ps aux --sort=-%cpu | head -11 >> "$REPORTE"

echo "Reporte generado: $REPORTE"`,usage:"Ejecutar con permisos de lectura sobre archivos de log. Programar diariamente para análisis rutinario."},{id:6,title:"Configuración de Firewall",description:"Configura reglas básicas de firewall con iptables para seguridad del sistema.",code:`#!/bin/bash
# Configuración básica de firewall con iptables

# Limpiar reglas existentes
iptables -F
iptables -X
iptables -t nat -F
iptables -t nat -X

# Políticas por defecto
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT

# Permitir loopback
iptables -A INPUT -i lo -j ACCEPT

# Permitir conexiones establecidas
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Permitir SSH (puerto 22)
iptables -A INPUT -p tcp --dport 22 -j ACCEPT

# Permitir HTTP y HTTPS
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp --dport 443 -j ACCEPT

# Permitir ping
iptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT

# Protección contra escaneo de puertos
iptables -A INPUT -p tcp --tcp-flags ALL NONE -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP

# Guardar reglas
iptables-save > /etc/iptables/rules.v4

echo "Firewall configurado correctamente"`,usage:"Ejecutar como root. Ajustar puertos según servicios. Hacer backup de reglas antes de aplicar cambios."},{id:7,title:"Sincronización con Servidor Remoto",description:"Sincroniza archivos con un servidor remoto usando rsync de manera eficiente.",code:`#!/bin/bash
# Sincronización de archivos con rsync

LOCAL_DIR="/home/usuario/proyectos"
REMOTE_USER="usuario"
REMOTE_HOST="servidor.ejemplo.com"
REMOTE_DIR="/backup/proyectos"
LOG="/var/log/sincronizacion.log"

echo "========== Sincronización: $(date) ==========" >> "$LOG"

# Sincronizar archivos
rsync -avz --delete \\
    --exclude '*.tmp' \\
    --exclude '.git' \\
    --exclude 'node_modules' \\
    -e "ssh -p 22" \\
    "$LOCAL_DIR/" \\
    "$REMOTE_USER@$REMOTE_HOST:$REMOTE_DIR/" \\
    >> "$LOG" 2>&1

if [ $? -eq 0 ]; then
    echo "Sincronización completada exitosamente" >> "$LOG"
else
    echo "ERROR en la sincronización" >> "$LOG"
fi

echo "" >> "$LOG"`,usage:"Configurar SSH con claves públicas para acceso sin contraseña. Programar con cron para sincronización automática."},{id:8,title:"Verificación de Servicios Críticos",description:"Monitorea servicios críticos y los reinicia automáticamente si están caídos.",code:`#!/bin/bash
# Monitoreo y reinicio de servicios críticos

SERVICIOS=("nginx" "mysql" "ssh" "cron")
LOG="/var/log/servicios_monitor.log"

echo "========== $(date) ==========" >> "$LOG"

for servicio in "\${SERVICIOS[@]}"; do
    if systemctl is-active --quiet "$servicio"; then
        echo "$servicio: ACTIVO" >> "$LOG"
    else
        echo "$servicio: CAÍDO - Intentando reiniciar..." >> "$LOG"
        systemctl start "$servicio"
        
        sleep 2
        
        if systemctl is-active --quiet "$servicio"; then
            echo "$servicio: REINICIADO EXITOSAMENTE" >> "$LOG"
        else
            echo "$servicio: ERROR AL REINICIAR" >> "$LOG"
            # Enviar alerta por email
            echo "Servicio $servicio no pudo reiniciarse" | \\
                mail -s "ALERTA: Servicio caído" admin@ejemplo.com
        fi
    fi
done

echo "" >> "$LOG"`,usage:"Ejecutar como root. Programar cada 5 minutos con cron: */5 * * * * /ruta/script.sh"},{id:9,title:"Rotación de Logs Personalizada",description:"Rota y comprime archivos de log antiguos para gestionar el espacio en disco.",code:`#!/bin/bash
# Rotación personalizada de logs

LOG_DIR="/var/log/aplicacion"
DIAS_RETENCION=30
BACKUP_DIR="/backup/logs"

# Crear directorio de backup
mkdir -p "$BACKUP_DIR"

# Buscar logs antiguos
find "$LOG_DIR" -name "*.log" -type f -mtime +1 | while read logfile; do
    # Nombre del archivo con fecha
    fecha=$(date +%Y%m%d)
    nombre=$(basename "$logfile")
    
    # Comprimir log
    gzip -c "$logfile" > "$BACKUP_DIR/\${nombre}_\${fecha}.gz"
    
    # Limpiar log original
    > "$logfile"
    
    echo "Log rotado: $nombre"
done

# Eliminar logs antiguos del backup
find "$BACKUP_DIR" -name "*.gz" -type f -mtime +$DIAS_RETENCION -delete

echo "Rotación de logs completada"`,usage:"Ejecutar diariamente con cron a medianoche: 0 0 * * * /ruta/script.sh. Ajustar días de retención según políticas."},{id:10,title:"Instalación Automatizada de LAMP Stack",description:"Instala y configura automáticamente Apache, MySQL, PHP (LAMP stack).",code:`#!/bin/bash
# Instalación automatizada de LAMP Stack

echo "Instalando LAMP Stack..."

# Actualizar sistema
apt update && apt upgrade -y

# Instalar Apache
echo "Instalando Apache..."
apt install apache2 -y
systemctl enable apache2
systemctl start apache2

# Instalar MySQL
echo "Instalando MySQL..."
apt install mysql-server -y
systemctl enable mysql
systemctl start mysql

# Configurar MySQL
mysql_secure_installation

# Instalar PHP
echo "Instalando PHP..."
apt install php libapache2-mod-php php-mysql -y

# Instalar extensiones PHP comunes
apt install php-curl php-gd php-mbstring php-xml php-xmlrpc php-zip -y

# Reiniciar Apache
systemctl restart apache2

# Crear archivo de prueba PHP
echo "<?php phpinfo(); ?>" > /var/www/html/info.php

# Verificar instalación
echo "=== Verificación de instalación ==="
apache2 -v
mysql -V
php -v

echo "LAMP Stack instalado correctamente"
echo "Accede a http://tu-servidor/info.php para verificar PHP"`,usage:"Ejecutar como root en sistema Debian/Ubuntu. Seguir prompts de configuración de MySQL. Eliminar info.php después de verificar."}];function eR(){const[s,o]=c.useState(null),n=l=>{o(s===l?null:l)};return e.jsx("div",{className:"space-y-3",children:JE.map(l=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>n(l.id),type:"button",className:"w-full px-6 py-4 bg-gradient-to-r from-green-50 to-green-100 hover:from-green-100 hover:to-green-200 transition-colors flex items-center justify-between text-left cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"flex items-center justify-center size-8 rounded-full bg-green-600 text-white font-bold text-sm",children:l.id}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900",children:l.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.description})]})]}),e.jsx(xp,{className:`size-5 text-green-600 transition-transform flex-shrink-0 ml-4 ${s===l.id?"rotate-180":""}`})]}),s===l.id&&e.jsx("div",{className:"px-6 py-4 bg-white border-t border-gray-200",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"text-green-600",children:"</>"}),"Código del Script"]}),e.jsx("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm",children:e.jsx("code",{children:l.code})})]}),e.jsxs("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-2",children:"📝 Instrucciones de Uso"}),e.jsx("p",{className:"text-sm text-gray-700",children:l.usage})]})]})})]},l.id))})}function tR(){const[s,o]=c.useState("windows"),[n,l]=c.useState("windows");return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-lg bg-blue-600 text-white",children:e.jsx(yi,{className:"size-6"})}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Scripts en Sistemas Operativos"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Automatización de tareas en Windows y Linux mediante scripts"})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8 space-y-8",children:[e.jsxs("div",{className:"bg-white text-gray-900 rounded-lg p-8 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(La,{className:"size-6 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold",children:"¿Qué son los Scripts en Sistemas Operativos?"})]}),e.jsxs("div",{className:"prose prose-gray max-w-none space-y-4",children:[e.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Los ",e.jsx("strong",{className:"text-blue-600",children:"scripts"})," son archivos que contienen una serie de comandos que se ejecutan de manera secuencial para automatizar tareas en el sistema operativo. Son herramientas fundamentales para administradores de sistemas y usuarios avanzados que buscan optimizar y simplificar procesos repetitivos."]}),e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 my-4",children:[e.jsx("h3",{className:"font-bold text-blue-900 mb-2",children:"🎯 Propósito de los Scripts"}),e.jsxs("ul",{className:"list-disc list-inside text-gray-700 text-sm mt-2 space-y-1",children:[e.jsx("li",{children:"Automatizar tareas repetitivas y reducir el trabajo manual"}),e.jsx("li",{children:"Ejecutar múltiples comandos con un solo archivo"}),e.jsx("li",{children:"Programar tareas para que se ejecuten en momentos específicos"}),e.jsx("li",{children:"Administrar sistemas de manera eficiente y consistente"}),e.jsx("li",{children:"Realizar operaciones por lotes (batch operations)"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"bg-blue-600 text-white rounded-lg p-2",children:e.jsx(yi,{className:"size-5"})}),e.jsx("h3",{className:"text-xl font-bold text-blue-900",children:"Scripts en Windows"})]}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-blue-800 mb-1",children:"Batch Scripts (.bat, .cmd)"}),e.jsx("p",{children:"Scripts tradicionales de Windows que ejecutan comandos del símbolo del sistema (CMD)."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-blue-800 mb-1",children:"PowerShell Scripts (.ps1)"}),e.jsx("p",{children:"Scripts más modernos y potentes con acceso completo al .NET Framework y cmdlets especializados."})]}),e.jsxs("div",{className:"bg-white rounded p-3 mt-4",children:[e.jsx("p",{className:"font-semibold text-blue-900 mb-2",children:"¿Qué se puede hacer?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[e.jsx("li",{children:"Gestión de archivos y directorios"}),e.jsx("li",{children:"Configuración del sistema y registro"}),e.jsx("li",{children:"Administración de usuarios y permisos"}),e.jsx("li",{children:"Automatización de instalaciones"}),e.jsx("li",{children:"Tareas de mantenimiento y limpieza"}),e.jsx("li",{children:"Respaldo y sincronización de datos"})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"bg-green-600 text-white rounded-lg p-2",children:e.jsx(yi,{className:"size-5"})}),e.jsx("h3",{className:"text-xl font-bold text-green-900",children:"Scripts en Linux"})]}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-green-800 mb-1",children:"Shell Scripts (.sh)"}),e.jsx("p",{children:"Scripts que utilizan shells como Bash, Zsh, o Fish para automatizar tareas del sistema."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-green-800 mb-1",children:"Python/Perl Scripts"}),e.jsx("p",{children:"Scripts más avanzados usando lenguajes de programación completos para tareas complejas."})]}),e.jsxs("div",{className:"bg-white rounded p-3 mt-4",children:[e.jsx("p",{className:"font-semibold text-green-900 mb-2",children:"¿Qué se puede hacer?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[e.jsx("li",{children:"Administración de paquetes y servicios"}),e.jsx("li",{children:"Configuración de red y firewall"}),e.jsx("li",{children:"Automatización de despliegues"}),e.jsx("li",{children:"Monitoreo del sistema y logs"}),e.jsx("li",{children:"Gestión de usuarios y grupos"}),e.jsx("li",{children:"Tareas programadas con cron"})]})]})]})]})]}),e.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-500 p-4 mt-6",children:[e.jsx("h4",{className:"font-bold text-yellow-900 mb-2",children:"💡 Ventajas de usar Scripts"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-gray-700",children:[e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Eficiencia:"})," Ahorro de tiempo en tareas repetitivas"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Consistencia:"})," Las tareas se ejecutan de la misma manera cada vez"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Documentación:"})," El script sirve como registro de los pasos realizados"]})]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Escalabilidad:"})," Fácil aplicar cambios a múltiples sistemas"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Reducción de errores:"})," Menos intervención manual"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Programación:"})," Ejecución automática en horarios específicos"]})]})]})]})]})]}),e.jsxs("div",{className:"bg-white text-gray-900 rounded-lg shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-6",children:e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(yi,{className:"size-6"}),"Descripción de los Scripts"]})}),e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsx("button",{onClick:()=>o("windows"),className:`flex-1 px-6 py-4 font-semibold transition-colors cursor-pointer ${s==="windows"?"bg-blue-50 text-blue-700 border-b-2 border-blue-600":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,type:"button",children:"Windows"}),e.jsx("button",{onClick:()=>o("linux"),className:`flex-1 px-6 py-4 font-semibold transition-colors cursor-pointer ${s==="linux"?"bg-green-50 text-green-700 border-b-2 border-green-600":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,type:"button",children:"Linux"})]}),e.jsx("div",{className:"p-6",children:s==="windows"?e.jsx(ZE,{}):e.jsx(eR,{})})]}),e.jsxs("div",{className:"bg-white text-gray-900 rounded-lg shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-purple-700 px-8 py-6",children:e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(bg,{className:"size-6"}),"Videos del funcionamiento de Scripts"]})}),e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsx("button",{onClick:()=>l("windows"),className:`flex-1 px-6 py-4 font-semibold transition-colors cursor-pointer ${n==="windows"?"bg-blue-50 text-blue-700 border-b-2 border-blue-600":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,type:"button",children:"Windows"}),e.jsx("button",{onClick:()=>l("linux"),className:`flex-1 px-6 py-4 font-semibold transition-colors cursor-pointer ${n==="linux"?"bg-green-50 text-green-700 border-b-2 border-green-600":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,type:"button",children:"Linux"})]}),e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"aspect-video bg-gray-100 rounded-lg flex items-center justify-center border-2 border-dashed border-gray-300",children:e.jsxs("div",{className:"text-center",children:[e.jsx(bg,{className:"size-16 text-gray-400 mx-auto mb-4"}),e.jsxs("p",{className:"text-gray-600 font-semibold",children:["Video demostrativo de los scripts en ",n==="windows"?"Windows":"Linux"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Próximamente disponible"})]})})})]})]})]})}const aR=Sa("/ActividadesSeminarioSO/actividad13/")({component:tR});function sR(){const[s,o]=c.useState(5),[n,l]=c.useState(2),[d,m]=c.useState(2),[h,x]=c.useState(1e3),[g,b]=c.useState(1200),[v,f]=c.useState([]),[N,j]=c.useState(s),[_,w]=c.useState(0),[C,E]=c.useState(1),[z,P]=c.useState(!1),[V,Z]=c.useState({produced:0,consumed:0,totalProduced:0,totalConsumed:0}),[oe,O]=c.useState([]),[T,ge]=c.useState([]),[J,W]=c.useState([]),ne=c.useRef(null),Ee=c.useRef(null),[Ce,Le]=c.useState(!1),I=c.useRef(!0),Q=c.useRef(1),F=c.useRef(1),de=c.useRef([]),ze=c.useRef([]);c.useEffect(()=>{if(I.current){I.current=!1;return}!Ce&&ne.current&&J.length>0&&ne.current.scrollIntoView({behavior:"smooth"})},[J,Ce]);const A=()=>{if(!Ee.current)return;const{scrollTop:R,scrollHeight:ke,clientHeight:je}=Ee.current,ee=ke-R-je<10;Le(!ee)};c.useEffect(()=>{O(Array(n).fill("idle")),ge(Array(d).fill("idle"))},[n,d]),c.useEffect(()=>{if(!z){const R=s-v.length;j(R),w(v.length)}},[s,z,v.length]);const $=R=>{const ke=new Date().toLocaleTimeString();W(je=>[...je.slice(-49),`[${ke}] ${R}`])},se=(R,ke)=>{O(je=>{const ee=[...je];return ee[R]=ke,ee})},k=(R,ke)=>{ge(je=>{const ee=[...je];return ee[R]=ke,ee})},K=async R=>{if(!z)return;if(se(R,"waiting_empty"),$(`🔵 Productor ${R+1}: Esperando espacio vacío (empty=${N})`),await new Promise(je=>setTimeout(je,200)),N<=0){$(`🔵 Productor ${R+1}: Buffer lleno, bloqueado`),se(R,"blocked");return}if(j(je=>je-1),se(R,"waiting_mutex"),$(`🔵 Productor ${R+1}: Decrementó empty a ${N-1}, esperando mutex`),await new Promise(je=>setTimeout(je,200)),C<=0){$(`🔵 Productor ${R+1}: Esperando acceso exclusivo al buffer`),se(R,"blocked"),j(je=>je+1);return}E(0),se(R,"producing");const ke={id:Q.current++,value:F.current++,producedBy:R};await new Promise(je=>setTimeout(je,300)),f(je=>[...je,ke]),$(`🔵 Productor ${R+1}: Produjo item #${ke.value} y lo agregó al buffer`),Z(je=>({...je,produced:je.produced+1,totalProduced:je.totalProduced+1})),E(1),$(`🔵 Productor ${R+1}: Liberó mutex`),await new Promise(je=>setTimeout(je,100)),w(je=>je+1),$(`🔵 Productor ${R+1}: Incrementó full a ${_+1}`),se(R,"idle")},M=async R=>{if(z){if(k(R,"waiting_full"),$(`🟢 Consumidor ${R+1}: Esperando item disponible (full=${_})`),await new Promise(ke=>setTimeout(ke,200)),_<=0){$(`🟢 Consumidor ${R+1}: Buffer vacío, bloqueado`),k(R,"blocked");return}if(w(ke=>ke-1),k(R,"waiting_mutex"),$(`🟢 Consumidor ${R+1}: Decrementó full a ${_-1}, esperando mutex`),await new Promise(ke=>setTimeout(ke,200)),C<=0){$(`🟢 Consumidor ${R+1}: Esperando acceso exclusivo al buffer`),k(R,"blocked"),w(ke=>ke+1);return}E(0),k(R,"consuming"),await new Promise(ke=>setTimeout(ke,300)),f(ke=>{if(ke.length===0)return ke;const[je,...ee]=ke;return $(`🟢 Consumidor ${R+1}: Consumió item #${je.value} (del Productor ${je.producedBy+1})`),Z(ae=>({...ae,consumed:ae.consumed+1,totalConsumed:ae.totalConsumed+1})),ee}),E(1),$(`🟢 Consumidor ${R+1}: Liberó mutex`),await new Promise(ke=>setTimeout(ke,100)),j(ke=>ke+1),$(`🟢 Consumidor ${R+1}: Incrementó empty a ${N+1}`),k(R,"idle")}};c.useEffect(()=>{if(z){de.current=[];for(let R=0;R<n;R++){const ke=setInterval(()=>{K(R)},h);de.current.push(ke)}return()=>{de.current.forEach(clearInterval)}}},[z,n,h,N,C]),c.useEffect(()=>{if(z){ze.current=[];for(let R=0;R<d;R++){const ke=setInterval(()=>{M(R)},g);ze.current.push(ke)}return()=>{ze.current.forEach(clearInterval)}}},[z,d,g,_,C]);const D=()=>{P(!0),$("▶️ Simulación iniciada")},q=()=>{P(!1),$("⏸️ Simulación pausada")},G=()=>{P(!1),f([]),j(s),w(0),E(1),Z({produced:0,consumed:0,totalProduced:0,totalConsumed:0}),O(Array(n).fill("idle")),ge(Array(d).fill("idle")),W([]),Le(!1),Q.current=1,F.current=1,$("🔄 Sistema reiniciado")},be=R=>{switch(R){case"idle":return"bg-gray-400";case"waiting_empty":case"waiting_full":case"waiting_mutex":return"bg-yellow-500";case"blocked":return"bg-red-500";case"producing":case"consuming":return"bg-green-500";default:return"bg-gray-400"}},Ne=R=>({idle:"Inactivo",waiting_empty:"Esperando espacio",waiting_full:"Esperando item",waiting_mutex:"Esperando mutex",blocked:"Bloqueado",producing:"Produciendo",consuming:"Consumiendo"})[R]||R;return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(nt,{className:"size-6 text-purple-400"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Demostración Interactiva"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ic,{className:"size-5 text-purple-400"}),e.jsx("h3",{className:"font-bold text-white",children:"Configuración"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-300 block mb-1",children:["Tamaño del Buffer: ",s]}),e.jsx("input",{type:"range",min:"3",max:"10",value:s,onChange:R=>!z&&o(Number(R.target.value)),disabled:z,className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-300 block mb-1",children:["Productores: ",n]}),e.jsx("input",{type:"range",min:"1",max:"4",value:n,onChange:R=>!z&&l(Number(R.target.value)),disabled:z,className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-300 block mb-1",children:["Consumidores: ",d]}),e.jsx("input",{type:"range",min:"1",max:"4",value:d,onChange:R=>!z&&m(Number(R.target.value)),disabled:z,className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-300 block mb-1",children:["Velocidad de Producción: ",h,"ms"]}),e.jsx("input",{type:"range",min:"500",max:"3000",step:"100",value:h,onChange:R=>x(Number(R.target.value)),className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-300 block mb-1",children:["Velocidad de Consumo: ",g,"ms"]}),e.jsx("input",{type:"range",min:"500",max:"3000",step:"100",value:g,onChange:R=>b(Number(R.target.value)),className:"w-full"})]})]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-white mb-4",children:"Estado de Semáforos"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-600 rounded p-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"empty (espacios vacíos)"}),e.jsx("span",{className:"text-2xl font-bold text-blue-400",children:N})]}),e.jsx("div",{className:"mt-2 bg-gray-800 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:`${N/s*100}%`}})})]}),e.jsxs("div",{className:"bg-gray-600 rounded p-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"full (items disponibles)"}),e.jsx("span",{className:"text-2xl font-bold text-green-400",children:_})]}),e.jsx("div",{className:"mt-2 bg-gray-800 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all",style:{width:`${_/s*100}%`}})})]}),e.jsx("div",{className:"bg-gray-600 rounded p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"mutex (exclusión mutua)"}),e.jsx("span",{className:`text-2xl font-bold ${C===1?"text-green-400":"text-red-400"}`,children:C===1?"🔓":"🔒"})]})})]})]})]}),e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsxs("button",{onClick:D,disabled:z,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]}),e.jsxs("button",{onClick:q,disabled:!z,className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}),e.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 mb-6",children:[e.jsxs("h3",{className:"font-bold text-white mb-3",children:["Buffer (",v.length,"/",s,")"]}),e.jsx("div",{className:"flex gap-2 flex-wrap min-h-[80px] items-center",children:Array.from({length:s}).map((R,ke)=>e.jsx("div",{className:`w-16 h-16 rounded-lg flex items-center justify-center border-2 transition-all ${ke<v.length?"bg-purple-600 border-purple-400 text-white font-bold":"bg-gray-800 border-gray-600 text-gray-500"}`,children:ke<v.length?`#${v[ke].value}`:"—"},ke))})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-white mb-3",children:"Productores"}),e.jsx("div",{className:"space-y-2",children:oe.map((R,ke)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`size-3 rounded-full ${be(R)}`}),e.jsxs("span",{className:"text-gray-300",children:["Productor ",ke+1,":"]}),e.jsx("span",{className:"text-white font-medium",children:Ne(R)})]},ke))})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-white mb-3",children:"Consumidores"}),e.jsx("div",{className:"space-y-2",children:T.map((R,ke)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`size-3 rounded-full ${be(R)}`}),e.jsxs("span",{className:"text-gray-300",children:["Consumidor ",ke+1,":"]}),e.jsx("span",{className:"text-white font-medium",children:Ne(R)})]},ke))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-blue-400 text-sm mb-1",children:"Items en Buffer"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:v.length})]}),e.jsxs("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-green-400 text-sm mb-1",children:"Total Producido"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:V.totalProduced})]}),e.jsxs("div",{className:"bg-orange-900/30 border border-orange-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-orange-400 text-sm mb-1",children:"Total Consumido"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:V.totalConsumed})]}),e.jsxs("div",{className:"bg-purple-900/30 border border-purple-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"En Tránsito"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:V.totalProduced-V.totalConsumed})]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-white mb-3",children:"Registro de Eventos"}),e.jsxs("div",{ref:Ee,onScroll:A,className:"bg-gray-900 rounded p-3 h-64 overflow-y-auto font-mono text-xs text-gray-300",children:[J.length===0?e.jsx("div",{className:"text-gray-500 text-center py-8",children:'Presiona "Iniciar" para comenzar la simulación'}):J.map((R,ke)=>e.jsx("div",{className:"mb-1",children:R},ke)),e.jsx("div",{ref:ne})]})]})]})}function rR(){return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-lg bg-purple-600 text-white",children:e.jsx(La,{className:"size-6"})}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Problema Productor-Consumidor"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Sincronización clásica con buffer limitado usando semáforos"})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"bg-white text-gray-900 rounded-lg p-8 mb-8 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(La,{className:"size-6 text-purple-600"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Planteamiento del Problema"})]}),e.jsxs("div",{className:"prose prose-gray max-w-none space-y-4",children:[e.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["El problema del ",e.jsx("strong",{className:"text-purple-600",children:"Productor-Consumidor"})," es uno de los problemas clásicos de sincronización en sistemas concurrentes. En este escenario, uno o más hilos productores generan datos que son depositados en un buffer compartido, mientras que uno o más hilos consumidores retiran datos de ese buffer para procesarlos."]}),e.jsxs("div",{className:"bg-purple-50 border-l-4 border-purple-500 p-4 my-4",children:[e.jsx("h3",{className:"font-bold text-purple-900 mb-2",children:"🎯 Objetivo del Problema"}),e.jsx("p",{className:"text-gray-700 text-sm",children:"Coordinar el acceso al buffer compartido de manera que:"}),e.jsxs("ul",{className:"list-disc list-inside text-gray-700 text-sm mt-2 space-y-1",children:[e.jsx("li",{children:"Los productores no intenten agregar elementos cuando el buffer está lleno"}),e.jsx("li",{children:"Los consumidores no intenten retirar elementos cuando el buffer está vacío"}),e.jsx("li",{children:"No ocurran condiciones de carrera al acceder al buffer"})]})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mt-6 mb-3",children:"Componentes del Sistema"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-blue-900 mb-2",children:"👷 Productor"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Genera items y los deposita en el buffer compartido. Debe esperar si el buffer está lleno."})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-green-900 mb-2",children:"📦 Buffer"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Estructura de datos compartida con capacidad limitada que almacena temporalmente los items."})]}),e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-orange-900 mb-2",children:"👨‍💼 Consumidor"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Retira items del buffer para procesarlos. Debe esperar si el buffer está vacío."})]})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mt-6 mb-3",children:"Solución con Semáforos"}),e.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Para resolver este problema utilizamos ",e.jsx("strong",{children:"tres semáforos"})," que coordinan el acceso al buffer:"]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 my-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-purple-600 text-white rounded-full size-8 flex items-center justify-center flex-shrink-0 font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:"mutex (binario)"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Garantiza exclusión mutua al acceder al buffer. Solo un hilo (productor o consumidor) puede modificar el buffer a la vez."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-600 text-white rounded-full size-8 flex items-center justify-center flex-shrink-0 font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:"empty (contador)"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Cuenta los espacios vacíos en el buffer. Inicializado con el tamaño del buffer. Los productores esperan (wait) en este semáforo antes de agregar items."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-green-600 text-white rounded-full size-8 flex items-center justify-center flex-shrink-0 font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:"full (contador)"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Cuenta los items disponibles en el buffer. Inicializado en 0. Los consumidores esperan (wait) en este semáforo antes de retirar items."})]})]})]}),e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-500 p-4 mt-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(yb,{className:"size-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-yellow-900 mb-1",children:"Orden Crítico"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Es crucial que los productores hagan ",e.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"wait(empty)"})," antes de ",e.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"wait(mutex)"}),", y los consumidores hagan"," ",e.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"wait(full)"})," antes de"," ",e.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"wait(mutex)"}),". De lo contrario, puede ocurrir un deadlock."]})]})]})})]})]}),e.jsx(sR,{})]})]})}const nR=Sa("/ActividadesSeminarioSO/actividad12/")({component:rR}),oR=[{id:"condicion-carrera",titulo:"Condición de Carrera",icon:"⚡",color:"from-red-400 to-red-600"},{id:"deadlock",titulo:"Deadlock",icon:"🔒",color:"from-orange-400 to-orange-600"},{id:"starvation",titulo:"Starvation",icon:"🍽️",color:"from-yellow-400 to-yellow-600"},{id:"livelock",titulo:"Livelock",icon:"🔄",color:"from-green-400 to-green-600"},{id:"lectura-escritura",titulo:"Lectura/Escritura",icon:"📖",color:"from-teal-400 to-teal-600"},{id:"contencion-recursos",titulo:"Contención de Recursos",icon:"⚔️",color:"from-cyan-400 to-cyan-600"},{id:"bloqueos-innecesarios",titulo:"Bloqueos Innecesarios",icon:"🚧",color:"from-blue-400 to-blue-600"},{id:"eventos",titulo:"Eventos",icon:"📡",color:"from-indigo-400 to-indigo-600"},{id:"priority-inversion",titulo:"Priority Inversion",icon:"⬆️",color:"from-purple-400 to-purple-600"},{id:"aba-problem",titulo:"ABA Problem",icon:"🔀",color:"from-pink-400 to-pink-600"},{id:"memory-consistency",titulo:"Memory Consistency",icon:"💾",color:"from-rose-400 to-rose-600"},{id:"thundering-herd",titulo:"Thundering Herd",icon:"🦬",color:"from-amber-400 to-amber-600"},{id:"convoying",titulo:"Convoying",icon:"🚛",color:"from-lime-400 to-lime-600"},{id:"false-sharing",titulo:"False Sharing",icon:"🔗",color:"from-emerald-400 to-emerald-600"},{id:"lost-wakeup",titulo:"Lost Wakeup",icon:"😴",color:"from-sky-400 to-sky-600"}];function iR(){return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-lg bg-gray-700 text-white",children:e.jsx(Nb,{className:"size-6"})}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Aplicaciones y Solución de Problemas de Concurrencia"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Análisis de 15 problemas clásicos y sus soluciones"})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"bg-white text-gray-900 rounded-lg p-8 mb-8 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(La,{className:"size-6 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold",children:"¿Qué es la Concurrencia?"})]}),e.jsxs("div",{className:"prose prose-gray max-w-none",children:[e.jsxs("p",{className:"text-gray-700 leading-relaxed mb-4",children:["La ",e.jsx("strong",{className:"text-blue-600",children:"concurrencia"})," es la capacidad de un sistema para ejecutar múltiples tareas aparentemente al mismo tiempo. En sistemas modernos, esto permite aprovechar procesadores multinúcleo y mejorar significativamente el rendimiento de las aplicaciones."]}),e.jsxs("p",{className:"text-gray-700 leading-relaxed mb-4",children:["Sin embargo, la programación concurrente introduce ",e.jsx("strong",{className:"text-red-600",children:"complejidad adicional"})," y diversos problemas que pueden afectar la correctitud y rendimiento del sistema. Estos problemas pueden ser sutiles, difíciles de reproducir y detectar."]})]})]}),e.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-8 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(yn,{className:"size-6 text-red-600"}),e.jsx("h2",{className:"text-2xl font-bold text-red-900",children:"Problemas Más Comunes"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white border-l-4 border-red-500 p-4 rounded shadow-sm",children:[e.jsx("h3",{className:"font-bold text-red-900 mb-2",children:"⚡ Condiciones de Carrera"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Múltiples threads acceden a datos compartidos simultáneamente."})]}),e.jsxs("div",{className:"bg-white border-l-4 border-orange-500 p-4 rounded shadow-sm",children:[e.jsx("h3",{className:"font-bold text-orange-900 mb-2",children:"🔒 Deadlocks"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Procesos bloqueados esperando recursos mutuamente."})]}),e.jsxs("div",{className:"bg-white border-l-4 border-yellow-500 p-4 rounded shadow-sm",children:[e.jsx("h3",{className:"font-bold text-yellow-900 mb-2",children:"🍽️ Starvation"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Un proceso nunca obtiene los recursos necesarios."})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(fp,{className:"size-6 text-blue-400"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"15 Problemas de Concurrencia"})]}),e.jsx("p",{className:"text-gray-300 mb-6",children:"A continuación se presentan 15 problemas clásicos de concurrencia. Cada uno incluye una descripción detallada y múltiples soluciones implementadas. Haz clic en cualquier problema para explorar su análisis completo:"}),e.jsx("div",{className:"grid md:grid-cols-3 lg:grid-cols-5 gap-4",children:oR.map(s=>e.jsxs(Ts,{to:`/actividad11/${s.id}`,className:`block rounded-lg bg-gradient-to-br ${s.color} p-6 shadow-lg transition-all hover:shadow-xl hover:scale-105`,children:[e.jsx("div",{className:"text-4xl mb-3",children:s.icon}),e.jsx("h3",{className:"text-lg font-bold text-white",children:s.titulo})]},s.id))})]}),e.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(j1,{className:"size-5 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-blue-200",children:"Explora cada problema de concurrencia para entender sus causas, consecuencias y las diferentes estrategias para resolverlo de manera efectiva."})]})]})]})}const lR=Sa("/ActividadesSeminarioSO/actividad11/")({component:iR});var Rs="Accordion",cR=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Gp,dR,uR]=Kc(Rs),[Jc]=ks(Rs,[uR,ey]),Wp=ey(),Zy=ga.forwardRef((s,o)=>{const{type:n,...l}=s,d=l,m=l;return e.jsx(Gp.Provider,{scope:s.__scopeAccordion,children:n==="multiple"?e.jsx(xR,{...m,ref:o}):e.jsx(hR,{...d,ref:o})})});Zy.displayName=Rs;var[Jy,mR]=Jc(Rs),[eN,pR]=Jc(Rs,{collapsible:!1}),hR=ga.forwardRef((s,o)=>{const{value:n,defaultValue:l,onValueChange:d=()=>{},collapsible:m=!1,...h}=s,[x,g]=gr({prop:n,defaultProp:l??"",onChange:d,caller:Rs});return e.jsx(Jy,{scope:s.__scopeAccordion,value:ga.useMemo(()=>x?[x]:[],[x]),onItemOpen:g,onItemClose:ga.useCallback(()=>m&&g(""),[m,g]),children:e.jsx(eN,{scope:s.__scopeAccordion,collapsible:m,children:e.jsx(tN,{...h,ref:o})})})}),xR=ga.forwardRef((s,o)=>{const{value:n,defaultValue:l,onValueChange:d=()=>{},...m}=s,[h,x]=gr({prop:n,defaultProp:l??[],onChange:d,caller:Rs}),g=ga.useCallback(v=>x((f=[])=>[...f,v]),[x]),b=ga.useCallback(v=>x((f=[])=>f.filter(N=>N!==v)),[x]);return e.jsx(Jy,{scope:s.__scopeAccordion,value:h,onItemOpen:g,onItemClose:b,children:e.jsx(eN,{scope:s.__scopeAccordion,collapsible:!0,children:e.jsx(tN,{...m,ref:o})})})}),[fR,ed]=Jc(Rs),tN=ga.forwardRef((s,o)=>{const{__scopeAccordion:n,disabled:l,dir:d,orientation:m="vertical",...h}=s,x=ga.useRef(null),g=xa(x,o),b=dR(n),f=Mi(d)==="ltr",N=kt(s.onKeyDown,j=>{if(!cR.includes(j.key))return;const _=j.target,w=b().filter(T=>!T.ref.current?.disabled),C=w.findIndex(T=>T.ref.current===_),E=w.length;if(C===-1)return;j.preventDefault();let z=C;const P=0,V=E-1,Z=()=>{z=C+1,z>V&&(z=P)},oe=()=>{z=C-1,z<P&&(z=V)};switch(j.key){case"Home":z=P;break;case"End":z=V;break;case"ArrowRight":m==="horizontal"&&(f?Z():oe());break;case"ArrowDown":m==="vertical"&&Z();break;case"ArrowLeft":m==="horizontal"&&(f?oe():Z());break;case"ArrowUp":m==="vertical"&&oe();break}const O=z%E;w[O].ref.current?.focus()});return e.jsx(fR,{scope:n,disabled:l,direction:d,orientation:m,children:e.jsx(Gp.Slot,{scope:n,children:e.jsx(Kt.div,{...h,"data-orientation":m,ref:g,onKeyDown:l?void 0:N})})})}),Cc="AccordionItem",[gR,Kp]=Jc(Cc),aN=ga.forwardRef((s,o)=>{const{__scopeAccordion:n,value:l,...d}=s,m=ed(Cc,n),h=mR(Cc,n),x=Wp(n),g=Us(),b=l&&h.value.includes(l)||!1,v=m.disabled||s.disabled;return e.jsx(gR,{scope:n,open:b,disabled:v,triggerId:g,children:e.jsx(sy,{"data-orientation":m.orientation,"data-state":lN(b),...x,...d,ref:o,disabled:v,open:b,onOpenChange:f=>{f?h.onItemOpen(l):h.onItemClose(l)}})})});aN.displayName=Cc;var sN="AccordionHeader",rN=ga.forwardRef((s,o)=>{const{__scopeAccordion:n,...l}=s,d=ed(Rs,n),m=Kp(sN,n);return e.jsx(Kt.h3,{"data-orientation":d.orientation,"data-state":lN(m.open),"data-disabled":m.disabled?"":void 0,...l,ref:o})});rN.displayName=sN;var tp="AccordionTrigger",nN=ga.forwardRef((s,o)=>{const{__scopeAccordion:n,...l}=s,d=ed(Rs,n),m=Kp(tp,n),h=pR(tp,n),x=Wp(n);return e.jsx(Gp.ItemSlot,{scope:n,children:e.jsx(ok,{"aria-disabled":m.open&&!h.collapsible||void 0,"data-orientation":d.orientation,id:m.triggerId,...x,...l,ref:o})})});nN.displayName=tp;var oN="AccordionContent",iN=ga.forwardRef((s,o)=>{const{__scopeAccordion:n,...l}=s,d=ed(Rs,n),m=Kp(oN,n),h=Wp(n);return e.jsx(ik,{role:"region","aria-labelledby":m.triggerId,"data-orientation":d.orientation,...h,...l,ref:o,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...s.style}})});iN.displayName=oN;function lN(s){return s?"open":"closed"}var bR=Zy,vR=aN,yR=rN,cN=nN,dN=iN;const Da=bR,sa=c.forwardRef(({className:s,...o},n)=>e.jsx(vR,{ref:n,className:Xt("border-b border-gray-700",s),...o}));sa.displayName="AccordionItem";const ra=c.forwardRef(({className:s,children:o,...n},l)=>e.jsx(yR,{className:"flex",children:e.jsxs(cN,{ref:l,className:Xt("flex flex-1 items-center justify-between py-4 px-6 font-medium transition-all hover:bg-gray-800/50 [&[data-state=open]>svg]:rotate-180",s),...n,children:[o,e.jsx(xp,{className:"size-5 shrink-0 transition-transform duration-200"})]})}));ra.displayName=cN.displayName;const na=c.forwardRef(({className:s,children:o,...n},l)=>e.jsx(dN,{ref:l,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:e.jsx("div",{className:Xt("pb-4 pt-0 px-6",s),children:o})}));na.displayName=dN.displayName;var td="Tabs",[NR]=ks(td,[Yc]),uN=Yc(),[jR,Yp]=NR(td),mN=c.forwardRef((s,o)=>{const{__scopeTabs:n,value:l,onValueChange:d,defaultValue:m,orientation:h="horizontal",dir:x,activationMode:g="automatic",...b}=s,v=Mi(x),[f,N]=gr({prop:l,onChange:d,defaultProp:m??"",caller:td});return e.jsx(jR,{scope:n,baseId:Us(),value:f,onValueChange:N,orientation:h,dir:v,activationMode:g,children:e.jsx(Kt.div,{dir:v,"data-orientation":h,...b,ref:o})})});mN.displayName=td;var pN="TabsList",hN=c.forwardRef((s,o)=>{const{__scopeTabs:n,loop:l=!0,...d}=s,m=Yp(pN,n),h=uN(n);return e.jsx(cy,{asChild:!0,...h,orientation:m.orientation,dir:m.dir,loop:l,children:e.jsx(Kt.div,{role:"tablist","aria-orientation":m.orientation,...d,ref:o})})});hN.displayName=pN;var xN="TabsTrigger",fN=c.forwardRef((s,o)=>{const{__scopeTabs:n,value:l,disabled:d=!1,...m}=s,h=Yp(xN,n),x=uN(n),g=vN(h.baseId,l),b=yN(h.baseId,l),v=l===h.value;return e.jsx(dy,{asChild:!0,...x,focusable:!d,active:v,children:e.jsx(Kt.button,{type:"button",role:"tab","aria-selected":v,"aria-controls":b,"data-state":v?"active":"inactive","data-disabled":d?"":void 0,disabled:d,id:g,...m,ref:o,onMouseDown:kt(s.onMouseDown,f=>{!d&&f.button===0&&f.ctrlKey===!1?h.onValueChange(l):f.preventDefault()}),onKeyDown:kt(s.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&h.onValueChange(l)}),onFocus:kt(s.onFocus,()=>{const f=h.activationMode!=="manual";!v&&!d&&f&&h.onValueChange(l)})})})});fN.displayName=xN;var gN="TabsContent",bN=c.forwardRef((s,o)=>{const{__scopeTabs:n,value:l,forceMount:d,children:m,...h}=s,x=Yp(gN,n),g=vN(x.baseId,l),b=yN(x.baseId,l),v=l===x.value,f=c.useRef(v);return c.useEffect(()=>{const N=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(N)},[]),e.jsx(js,{present:d||v,children:({present:N})=>e.jsx(Kt.div,{"data-state":v?"active":"inactive","data-orientation":x.orientation,role:"tabpanel","aria-labelledby":g,hidden:!N,id:b,tabIndex:0,...h,ref:o,style:{...s.style,animationDuration:f.current?"0s":void 0},children:N&&m})})});bN.displayName=gN;function vN(s,o){return`${s}-trigger-${o}`}function yN(s,o){return`${s}-content-${o}`}var _R=mN,NN=hN,jN=fN,_N=bN;const ia=_R,Qt=c.forwardRef(({className:s,...o},n)=>e.jsx(NN,{ref:n,className:Xt("inline-flex h-10 items-center justify-center rounded-md bg-gray-800 p-1 text-gray-400",s),...o}));Qt.displayName=NN.displayName;const le=c.forwardRef(({className:s,...o},n)=>e.jsx(jN,{ref:n,className:Xt("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-2 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-blue-600 data-[state=active]:text-white data-[state=active]:shadow-lg data-[state=inactive]:text-gray-400 cursor-pointer hover:bg-gray-700 hover:text-white",s),...o}));le.displayName=jN.displayName;const ue=c.forwardRef(({className:s,...o},n)=>e.jsx(_N,{ref:n,className:Xt("mt-2 ring-offset-gray-950 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-300 focus-visible:ring-offset-2",s),...o}));ue.displayName=_N.displayName;function SN(s,[o,n]){return Math.min(n,Math.max(o,s))}function SR(s){const o=c.useRef({value:s,previous:s});return c.useMemo(()=>(o.current.value!==s&&(o.current.previous=o.current.value,o.current.value=s),o.current.previous),[s])}var wN=["PageUp","PageDown"],TN=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],AN={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},wo="Slider",[ap,wR,TR]=Kc(wo),[CN]=ks(wo,[TR]),[AR,ad]=CN(wo),kN=c.forwardRef((s,o)=>{const{name:n,min:l=0,max:d=100,step:m=1,orientation:h="horizontal",disabled:x=!1,minStepsBetweenThumbs:g=0,defaultValue:b=[l],value:v,onValueChange:f=()=>{},onValueCommit:N=()=>{},inverted:j=!1,form:_,...w}=s,C=c.useRef(new Set),E=c.useRef(0),P=h==="horizontal"?CR:kR,[V=[],Z]=gr({prop:v,defaultProp:b,onChange:W=>{[...C.current][E.current]?.focus(),f(W)}}),oe=c.useRef(V);function O(W){const ne=MR(V,W);J(W,ne)}function T(W){J(W,E.current)}function ge(){const W=oe.current[E.current];V[E.current]!==W&&N(V)}function J(W,ne,{commit:Ee}={commit:!1}){const Ce=zR(m),Le=qR(Math.round((W-l)/m)*m+l,Ce),I=SN(Le,[l,d]);Z((Q=[])=>{const F=LR(Q,I,ne);if(DR(F,g*m)){E.current=F.indexOf(I);const de=String(F)!==String(Q);return de&&Ee&&N(F),de?F:Q}else return Q})}return e.jsx(AR,{scope:s.__scopeSlider,name:n,disabled:x,min:l,max:d,valueIndexToChangeRef:E,thumbs:C.current,values:V,orientation:h,form:_,children:e.jsx(ap.Provider,{scope:s.__scopeSlider,children:e.jsx(ap.Slot,{scope:s.__scopeSlider,children:e.jsx(P,{"aria-disabled":x,"data-disabled":x?"":void 0,...w,ref:o,onPointerDown:kt(w.onPointerDown,()=>{x||(oe.current=V)}),min:l,max:d,inverted:j,onSlideStart:x?void 0:O,onSlideMove:x?void 0:T,onSlideEnd:x?void 0:ge,onHomeKeyDown:()=>!x&&J(l,0,{commit:!0}),onEndKeyDown:()=>!x&&J(d,V.length-1,{commit:!0}),onStepKeyDown:({event:W,direction:ne})=>{if(!x){const Le=wN.includes(W.key)||W.shiftKey&&TN.includes(W.key)?10:1,I=E.current,Q=V[I],F=m*Le*ne;J(Q+F,I,{commit:!0})}}})})})})});kN.displayName=wo;var[EN,RN]=CN(wo,{startEdge:"left",endEdge:"right",size:"width",direction:1}),CR=c.forwardRef((s,o)=>{const{min:n,max:l,dir:d,inverted:m,onSlideStart:h,onSlideMove:x,onSlideEnd:g,onStepKeyDown:b,...v}=s,[f,N]=c.useState(null),j=xa(o,P=>N(P)),_=c.useRef(void 0),w=Mi(d),C=w==="ltr",E=C&&!m||!C&&m;function z(P){const V=_.current||f.getBoundingClientRect(),Z=[0,V.width],O=Xp(Z,E?[n,l]:[l,n]);return _.current=V,O(P-V.left)}return e.jsx(EN,{scope:s.__scopeSlider,startEdge:E?"left":"right",endEdge:E?"right":"left",direction:E?1:-1,size:"width",children:e.jsx(LN,{dir:w,"data-orientation":"horizontal",...v,ref:j,style:{...v.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:P=>{const V=z(P.clientX);h?.(V)},onSlideMove:P=>{const V=z(P.clientX);x?.(V)},onSlideEnd:()=>{_.current=void 0,g?.()},onStepKeyDown:P=>{const Z=AN[E?"from-left":"from-right"].includes(P.key);b?.({event:P,direction:Z?-1:1})}})})}),kR=c.forwardRef((s,o)=>{const{min:n,max:l,inverted:d,onSlideStart:m,onSlideMove:h,onSlideEnd:x,onStepKeyDown:g,...b}=s,v=c.useRef(null),f=xa(o,v),N=c.useRef(void 0),j=!d;function _(w){const C=N.current||v.current.getBoundingClientRect(),E=[0,C.height],P=Xp(E,j?[l,n]:[n,l]);return N.current=C,P(w-C.top)}return e.jsx(EN,{scope:s.__scopeSlider,startEdge:j?"bottom":"top",endEdge:j?"top":"bottom",size:"height",direction:j?1:-1,children:e.jsx(LN,{"data-orientation":"vertical",...b,ref:f,style:{...b.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:w=>{const C=_(w.clientY);m?.(C)},onSlideMove:w=>{const C=_(w.clientY);h?.(C)},onSlideEnd:()=>{N.current=void 0,x?.()},onStepKeyDown:w=>{const E=AN[j?"from-bottom":"from-top"].includes(w.key);g?.({event:w,direction:E?-1:1})}})})}),LN=c.forwardRef((s,o)=>{const{__scopeSlider:n,onSlideStart:l,onSlideMove:d,onSlideEnd:m,onHomeKeyDown:h,onEndKeyDown:x,onStepKeyDown:g,...b}=s,v=ad(wo,n);return e.jsx(Kt.span,{...b,ref:o,onKeyDown:kt(s.onKeyDown,f=>{f.key==="Home"?(h(f),f.preventDefault()):f.key==="End"?(x(f),f.preventDefault()):wN.concat(TN).includes(f.key)&&(g(f),f.preventDefault())}),onPointerDown:kt(s.onPointerDown,f=>{const N=f.target;N.setPointerCapture(f.pointerId),f.preventDefault(),v.thumbs.has(N)?N.focus():l(f)}),onPointerMove:kt(s.onPointerMove,f=>{f.target.hasPointerCapture(f.pointerId)&&d(f)}),onPointerUp:kt(s.onPointerUp,f=>{const N=f.target;N.hasPointerCapture(f.pointerId)&&(N.releasePointerCapture(f.pointerId),m(f))})})}),PN="SliderTrack",MN=c.forwardRef((s,o)=>{const{__scopeSlider:n,...l}=s,d=ad(PN,n);return e.jsx(Kt.span,{"data-disabled":d.disabled?"":void 0,"data-orientation":d.orientation,...l,ref:o})});MN.displayName=PN;var sp="SliderRange",IN=c.forwardRef((s,o)=>{const{__scopeSlider:n,...l}=s,d=ad(sp,n),m=RN(sp,n),h=c.useRef(null),x=xa(o,h),g=d.values.length,b=d.values.map(N=>zN(N,d.min,d.max)),v=g>1?Math.min(...b):0,f=100-Math.max(...b);return e.jsx(Kt.span,{"data-orientation":d.orientation,"data-disabled":d.disabled?"":void 0,...l,ref:x,style:{...s.style,[m.startEdge]:v+"%",[m.endEdge]:f+"%"}})});IN.displayName=sp;var rp="SliderThumb",ON=c.forwardRef((s,o)=>{const n=wR(s.__scopeSlider),[l,d]=c.useState(null),m=xa(o,x=>d(x)),h=c.useMemo(()=>l?n().findIndex(x=>x.ref.current===l):-1,[n,l]);return e.jsx(ER,{...s,ref:m,index:h})}),ER=c.forwardRef((s,o)=>{const{__scopeSlider:n,index:l,name:d,...m}=s,h=ad(rp,n),x=RN(rp,n),[g,b]=c.useState(null),v=xa(o,z=>b(z)),f=g?h.form||!!g.closest("form"):!0,N=kv(g),j=h.values[l],_=j===void 0?0:zN(j,h.min,h.max),w=PR(l,h.values.length),C=N?.[x.size],E=C?IR(C,_,x.direction):0;return c.useEffect(()=>{if(g)return h.thumbs.add(g),()=>{h.thumbs.delete(g)}},[g,h.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[x.startEdge]:`calc(${_}% + ${E}px)`},children:[e.jsx(ap.ItemSlot,{scope:s.__scopeSlider,children:e.jsx(Kt.span,{role:"slider","aria-label":s["aria-label"]||w,"aria-valuemin":h.min,"aria-valuenow":j,"aria-valuemax":h.max,"aria-orientation":h.orientation,"data-orientation":h.orientation,"data-disabled":h.disabled?"":void 0,tabIndex:h.disabled?void 0:0,...m,ref:v,style:j===void 0?{display:"none"}:s.style,onFocus:kt(s.onFocus,()=>{h.valueIndexToChangeRef.current=l})})}),f&&e.jsx(DN,{name:d??(h.name?h.name+(h.values.length>1?"[]":""):void 0),form:h.form,value:j},l)]})});ON.displayName=rp;var RR="RadioBubbleInput",DN=c.forwardRef(({__scopeSlider:s,value:o,...n},l)=>{const d=c.useRef(null),m=xa(d,l),h=SR(o);return c.useEffect(()=>{const x=d.current;if(!x)return;const g=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(g,"value").set;if(h!==o&&v){const f=new Event("input",{bubbles:!0});v.call(x,o),x.dispatchEvent(f)}},[h,o]),e.jsx(Kt.input,{style:{display:"none"},...n,ref:m,defaultValue:o})});DN.displayName=RR;function LR(s=[],o,n){const l=[...s];return l[n]=o,l.sort((d,m)=>d-m)}function zN(s,o,n){const m=100/(n-o)*(s-o);return SN(m,[0,100])}function PR(s,o){return o>2?`Value ${s+1} of ${o}`:o===2?["Minimum","Maximum"][s]:void 0}function MR(s,o){if(s.length===1)return 0;const n=s.map(d=>Math.abs(d-o)),l=Math.min(...n);return n.indexOf(l)}function IR(s,o,n){const l=s/2,m=Xp([0,50],[0,l]);return(l-m(o)*n)*n}function OR(s){return s.slice(0,-1).map((o,n)=>s[n+1]-o)}function DR(s,o){if(o>0){const n=OR(s);return Math.min(...n)>=o}return!0}function Xp(s,o){return n=>{if(s[0]===s[1]||o[0]===o[1])return o[0];const l=(o[1]-o[0])/(s[1]-s[0]);return o[0]+l*(n-s[0])}}function zR(s){return(String(s).split(".")[1]||"").length}function qR(s,o){const n=Math.pow(10,o);return Math.round(s*n)/n}var qN=kN,UR=MN,BR=IN,VR=ON;const dt=c.forwardRef(({className:s,...o},n)=>e.jsxs(qN,{ref:n,className:Xt("relative flex w-full touch-none select-none items-center",s),...o,children:[e.jsx(UR,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-gray-700",children:e.jsx(BR,{className:"absolute h-full bg-blue-500"})}),e.jsx(VR,{className:"block h-5 w-5 rounded-full border-2 border-blue-500 bg-white ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));dt.displayName=qN.displayName;function $R(){const[s,o]=c.useState(!1),[n,l]=c.useState(1e3),[d,m]=c.useState([]),[h,x]=c.useState(5),[g,b]=c.useState(null),[v,f]=c.useState([]),[N,j]=c.useState(!1),[_,w]=c.useState(1e3),[C,E]=c.useState("normal"),[z,P]=c.useState([1,2,3,4,5,6]),[V,Z]=c.useState([]),[oe,O]=c.useState(0),[T,ge]=c.useState([]),[J,W]=c.useState(!1),[ne,Ee]=c.useState(1e3),[Ce,Le]=c.useState([[3,2,1],[5,4],[],[8,7,6]]),[I,Q]=c.useState([]),[F,de]=c.useState(null),[ze,A]=c.useState([]),[$,se]=c.useState(!1),[k,K]=c.useState(1e3),[M,D]=c.useState(3),[q]=c.useState(3),[G,be]=c.useState([4,5,6,7,8]),[Ne,R]=c.useState([1,2,3]),[ke,je]=c.useState([]),[ee,ae]=c.useState(!1),[rt,jt]=c.useState(1e3),[xe,Me]=c.useState([{id:1,inUse:!1,thread:null,health:100},{id:2,inUse:!1,thread:null,health:100},{id:3,inUse:!1,thread:null,health:100},{id:4,inUse:!1,thread:null,health:100},{id:5,inUse:!1,thread:null,health:100}]),[De,Ge]=c.useState([]),[qe,Se]=c.useState(0),[Xe,We]=c.useState([]),xt=c.useRef(null),Ot=c.useRef(null),It=c.useRef(null),Ue=c.useRef(null),At=c.useRef(null);c.useEffect(()=>{xt.current&&(xt.current.scrollTop=xt.current.scrollHeight)},[v]),c.useEffect(()=>{Ot.current&&(Ot.current.scrollTop=Ot.current.scrollHeight)},[T]),c.useEffect(()=>{It.current&&(It.current.scrollTop=It.current.scrollHeight)},[ze]),c.useEffect(()=>{Ue.current&&(Ue.current.scrollTop=Ue.current.scrollHeight)},[ke]),c.useEffect(()=>{At.current&&(At.current.scrollTop=At.current.scrollHeight)},[Xe]),c.useEffect(()=>{if(!s)return;const Te=setInterval(()=>{f(_t=>{const St=[..._t];if(Math.random()>.3&&x(tt=>{const Ye=tt+1;return St.push({id:Date.now(),message:`📦 Nuevo trabajo en cola (total: ${Ye})`,type:"info",timestamp:Date.now()}),Ye}),h>0&&d.length>0&&!g&&m(tt=>{if(tt.length===0)return tt;const Ye=tt[0],ft=tt.slice(1);return b(Ye),St.push({id:Date.now()+1,message:`🎯 Despertar selectivo: Thread ${Ye} (${tt.length-1} siguen dormidos)`,type:"success",timestamp:Date.now()}),ft}),g!==null&&Math.random()>.4){x(Ye=>Math.max(0,Ye-1)),St.push({id:Date.now()+2,message:`✅ Thread ${g} completó trabajo`,type:"success",timestamp:Date.now()});const tt=g;b(null),m(Ye=>[...Ye,tt])}if(d.length<8&&Math.random()>.7){const tt=Math.floor(Math.random()*100)+1;m(Ye=>[...Ye,tt]),St.push({id:Date.now()+3,message:`😴 Thread ${tt} se añadió a la cola de espera`,type:"info",timestamp:Date.now()})}return St.slice(-15)})},n);return()=>clearInterval(Te)},[s,n,h,d,g]),c.useEffect(()=>{if(!N)return;const Te=setInterval(()=>{ge(_t=>{const St=[..._t];O(Ye=>Ye+1);const tt=oe+1;if(St.push({id:Date.now(),message:`🔔 Evento ${tt}: Nueva conexión entrante`,type:"info",timestamp:Date.now()}),C==="normal"){const Ye=[...z];Z(Ye),St.push({id:Date.now()+1,message:`⚠️ Modo NORMAL: Despertados ${Ye.length} threads`,type:"warning",timestamp:Date.now()}),setTimeout(()=>{if(Ye.length>0){const ft=Ye[0];St.push({id:Date.now()+2,message:`✅ Thread ${ft} aceptó conexión`,type:"success",timestamp:Date.now()});const Ct=Ye.slice(1);Ct.length>0&&St.push({id:Date.now()+3,message:`💤 ${Ct.length} threads volvieron a dormir (context switches desperdiciados)`,type:"error",timestamp:Date.now()}),Z([]),ge(St.slice(-15))}},500)}else if(z.length>0){const Ye=z[0];Z([Ye]),St.push({id:Date.now()+1,message:`🎯 Modo EXCLUSIVE: Solo Thread ${Ye} despertado`,type:"success",timestamp:Date.now()}),setTimeout(()=>{St.push({id:Date.now()+2,message:`✅ Thread ${Ye} procesó conexión eficientemente`,type:"success",timestamp:Date.now()}),Z([]),ge(St.slice(-15))},500)}return St.slice(-15)})},_);return()=>clearInterval(Te)},[N,_,C,z,oe]),c.useEffect(()=>{if(!J)return;const Te=setInterval(()=>{A(_t=>{const St=[..._t],tt=[],Ye=[];if(Ce.forEach((ft,Ct)=>{ft.length>0?tt.push(Ct):Ye.push(Ct)}),Ye.length>0&&tt.length>0){const ft=Ye[0],Ct=tt[Math.floor(Math.random()*tt.length)];Le(ve=>{const gt=ve.map($e=>[...$e]);if(gt[Ct].length>0){const $e=gt[Ct].shift();gt[ft].push($e),de({from:Ct,to:ft}),St.push({id:Date.now(),message:`🔄 Thread ${ft} robó tarea ${$e} de Thread ${Ct}`,type:"info",timestamp:Date.now()}),setTimeout(()=>de(null),500)}return gt})}if(Le(ft=>ft.map((ve,gt)=>{if(ve.length>0&&Math.random()>.4){const $e=ve[ve.length-1],B=ve.slice(0,-1);return Q(U=>U.includes(gt)?U:[...U,gt]),St.push({id:Date.now()+gt,message:`⚙️ Thread ${gt} procesando tarea ${$e}`,type:"success",timestamp:Date.now()}),setTimeout(()=>{Q(U=>U.filter(Dt=>Dt!==gt))},300),B}return ve})),Math.random()>.6){const ft=Math.floor(Math.random()*Ce.length),Ct=Math.floor(Math.random()*100)+10;Le(ve=>ve.map(($e,B)=>B===ft?[...$e,Ct]:$e)),St.push({id:Date.now()+100,message:`📦 Nueva tarea ${Ct} asignada a Thread ${ft}`,type:"info",timestamp:Date.now()})}return St.slice(-15)})},ne);return()=>clearInterval(Te)},[J,ne,Ce]),c.useEffect(()=>{if(!$)return;const Te=setInterval(()=>{je(_t=>{const St=[..._t];if(M>0&&G.length>0&&be(tt=>{if(tt.length===0)return tt;const Ye=tt[0],ft=tt.slice(1);return D(Ct=>Ct-1),R(Ct=>[...Ct,Ye]),St.push({id:Date.now(),message:`🔢 wait(): Thread ${Ye} adquirió semáforo (contador: ${M-1})`,type:"success",timestamp:Date.now()}),ft}),Ne.length>0&&Math.random()>.5){const tt=Ne[Math.floor(Math.random()*Ne.length)];R(Ye=>Ye.filter(ft=>ft!==tt)),D(Ye=>Math.min(Ye+1,q)),St.push({id:Date.now()+1,message:`🔓 signal(): Thread ${tt} liberó semáforo (contador: ${M+1})`,type:"info",timestamp:Date.now()})}if(Math.random()>.6){const tt=Math.floor(Math.random()*100)+10;M>0?(D(Ye=>Ye-1),R(Ye=>[...Ye,tt]),St.push({id:Date.now()+2,message:`✅ Thread ${tt} accedió inmediatamente (contador: ${M-1})`,type:"success",timestamp:Date.now()})):(be(Ye=>[...Ye,tt]),St.push({id:Date.now()+2,message:`⏳ Thread ${tt} bloqueado - esperando recurso`,type:"warning",timestamp:Date.now()}))}return St.slice(-15)})},k);return()=>clearInterval(Te)},[$,k,M,G,Ne,q]),c.useEffect(()=>{if(!ee)return;const Te=setInterval(()=>{We(_t=>{const St=[..._t];if(Math.random()>.3){Se(ft=>ft+1);const tt=Math.floor(Math.random()*100)+1,Ye=xe.find(ft=>!ft.inUse);Ye?(Me(ft=>ft.map(Ct=>Ct.id===Ye.id?{...Ct,inUse:!0,thread:tt}:Ct)),St.push({id:Date.now(),message:`🏊 Thread ${tt} adquirió Conexión ${Ye.id} del pool`,type:"success",timestamp:Date.now()})):Ge(ft=>ft.includes(tt)?ft:(St.push({id:Date.now(),message:`⏳ Thread ${tt} esperando - pool exhausted`,type:"warning",timestamp:Date.now()}),[...ft,tt]))}if(Math.random()>.4){const tt=xe.filter(Ye=>Ye.inUse);if(tt.length>0){const Ye=tt[Math.floor(Math.random()*tt.length)];if(Me(ft=>ft.map(Ct=>Ct.id===Ye.id?{...Ct,inUse:!1,thread:null,health:Math.max(80,Ct.health-5)}:Ct)),St.push({id:Date.now()+1,message:`🔄 Thread ${Ye.thread} liberó Conexión ${Ye.id}`,type:"info",timestamp:Date.now()}),De.length>0){const ft=De[0];Ge(Ct=>Ct.slice(1)),Me(Ct=>Ct.map(ve=>ve.id===Ye.id?{...ve,inUse:!0,thread:ft}:ve)),St.push({id:Date.now()+2,message:`✅ Thread ${ft} (esperando) adquirió Conexión ${Ye.id}`,type:"success",timestamp:Date.now()})}}}return Math.random()>.8&&Me(tt=>tt.map(Ye=>!Ye.inUse&&Ye.health<100?{...Ye,health:Math.min(100,Ye.health+10)}:Ye)),St.slice(-15)})},rt);return()=>clearInterval(Te)},[ee,rt,xe,De]);const et=()=>{o(!1),m([1,2,3,4,5]),x(5),b(null),f([{id:Date.now(),message:"🎯 Despertar Selectivo reiniciado",type:"info",timestamp:Date.now()}])},L=()=>{j(!1),P([1,2,3,4,5,6]),Z([]),O(0),ge([{id:Date.now(),message:"⚡ Epoll/Kqueue reiniciado",type:"info",timestamp:Date.now()}])},re=()=>{W(!1),Le([[3,2,1],[5,4],[],[8,7,6]]),Q([]),de(null),A([{id:Date.now(),message:"🔄 Work Stealing reiniciado",type:"info",timestamp:Date.now()}])},Ve=()=>{se(!1),D(3),be([4,5,6,7,8]),R([1,2,3]),je([{id:Date.now(),message:"🔢 Semáforos reiniciado",type:"info",timestamp:Date.now()}])},ce=()=>{ae(!1),Me([{id:1,inUse:!1,thread:null,health:100},{id:2,inUse:!1,thread:null,health:100},{id:3,inUse:!1,thread:null,health:100},{id:4,inUse:!1,thread:null,health:100},{id:5,inUse:!1,thread:null,health:100}]),Ge([]),Se(0),We([{id:Date.now(),message:"🏊 Connection Pool reiniciado",type:"info",timestamp:Date.now()}])};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(La,{className:"size-8 text-amber-400"}),e.jsx("h1",{className:"text-4xl font-bold",children:"Thundering Herd — Pseudocódigos"})]}),e.jsx("p",{className:"text-lg text-gray-300 leading-relaxed",children:'Colección de pseudocódigos para las técnicas principales que previenen el problema del "rebaño atronador" (thundering herd): despertar selectivo, epoll/kqueue exclusivo, work stealing, semáforos con contadores y connection pooling.'})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs(Da,{type:"multiple",defaultValue:["pseudocodigos","demos"],className:"space-y-4",children:[e.jsxs(sa,{value:"pseudocodigos",className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700",children:[e.jsx(ra,{className:"px-6 py-4 hover:bg-slate-700/30 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(oa,{className:"size-6 text-blue-400"}),e.jsx("span",{className:"text-2xl font-semibold",children:"Pseudocódigos de Soluciones"})]})}),e.jsx(na,{className:"px-6 pb-6",children:e.jsxs(ia,{defaultValue:"selective",className:"w-full",children:[e.jsxs(Qt,{className:"grid w-full grid-cols-5 bg-slate-900/50 p-1 rounded-lg mb-6",children:[e.jsx(le,{value:"selective",className:"data-[state=active]:bg-blue-600",children:"Despertar Selectivo"}),e.jsx(le,{value:"epoll",className:"data-[state=active]:bg-blue-600",children:"Epoll/Kqueue"}),e.jsx(le,{value:"workstealing",className:"data-[state=active]:bg-blue-600",children:"Work Stealing"}),e.jsx(le,{value:"semaphore",className:"data-[state=active]:bg-blue-600",children:"Semáforos"}),e.jsx(le,{value:"pooling",className:"data-[state=active]:bg-blue-600",children:"Connection Pooling"})]}),e.jsxs(ue,{value:"selective",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/30 to-slate-800/30 p-6 rounded-lg border border-blue-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-300 mb-3",children:"🎯 Solución 1: Despertar Selectivo"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"En lugar de despertar todos los threads en espera, el sistema despierta solo uno o un número controlado de threads. Esto evita la competencia masiva por recursos y reduce el overhead del sistema."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Despierta solo los threads necesarios"}),e.jsx("li",{children:"• Reduce contención y context switches"}),e.jsx("li",{children:"• Mejora eficiencia del sistema"}),e.jsx("li",{children:"• Evita desperdicios de CPU"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Despertar Selectivo"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Estructura de cola de espera
estructura WaitQueue {
    cola: Lista<Thread>
    mutex: Mutex
    wakeup_count: entero
}

// Thread esperando por un evento
función wait_selective(queue: WaitQueue) {
    queue.mutex.lock()
    
    // Añadir thread actual a la cola
    queue.cola.append(thread_actual)
    
    // Liberar mutex y dormir
    thread_actual.dormir()
    queue.mutex.unlock()
    
    // Al despertar, verificar si somos el elegido
    si thread_actual.wakeup_received entonces
        return EXITO
    sino
        // Volver a dormir si no fuimos seleccionados
        return wait_selective(queue)
}

// Despertar solo un thread
función wakeup_single(queue: WaitQueue) {
    queue.mutex.lock()
    
    si queue.cola.no_vacia() entonces
        // Seleccionar el primer thread
        thread = queue.cola.pop_front()
        
        // Marcar thread para despertar
        thread.wakeup_received = verdadero
        
        // Despertar solo este thread
        thread.despertar()
        
        queue.wakeup_count++
    fin si
    
    queue.mutex.unlock()
}

// Despertar N threads (selectivo múltiple)
función wakeup_n_threads(queue: WaitQueue, n: entero) {
    queue.mutex.lock()
    
    despertados = 0
    mientras despertados < n Y queue.cola.no_vacia() hacer
        thread = queue.cola.pop_front()
        thread.wakeup_received = verdadero
        thread.despertar()
        despertados++
    fin mientras
    
    queue.wakeup_count += despertados
    queue.mutex.unlock()
    
    return despertados
}

// Patrón productor-consumidor con despertar selectivo
función producer_consumer_selective() {
    cola_trabajo: Cola<Trabajo>
    wait_queue: WaitQueue
    workers: entero = 4
    
    // Productor
    función producer() {
        mientras verdadero hacer
            trabajo = generar_trabajo()
            cola_trabajo.push(trabajo)
            
            // Despertar solo UN worker
            wakeup_single(wait_queue)
        fin mientras
    }
    
    // Worker (consumidor)
    función worker() {
        mientras verdadero hacer
            si cola_trabajo.vacia() entonces
                // Esperar selectivamente
                wait_selective(wait_queue)
            sino
                trabajo = cola_trabajo.pop()
                procesar(trabajo)
            fin si
        fin mientras
    }
    
    // Iniciar threads
    crear_thread(producer)
    para i = 1 hasta workers hacer
        crear_thread(worker)
    fin para
}

// Ejemplo: Servidor con despertar selectivo
función servidor_selective() {
    socket_listener: Socket
    wait_queue: WaitQueue
    
    mientras verdadero hacer
        // Aceptar nueva conexión
        client = socket_listener.accept()
        
        // Despertar SOLO un thread worker
        wakeup_single(wait_queue)
        
        // El worker despertado procesará el cliente
    fin mientras
}

// Métricas de eficiencia
función medir_eficiencia() {
    inicio = tiempo_actual()
    threads_despertados = 0
    threads_productivos = 0
    
    // Procesar trabajos
    mientras hay_trabajos() hacer
        wakeup_single(wait_queue)
        threads_despertados++
        
        si thread_proceso_trabajo() entonces
            threads_productivos++
        fin si
    fin mientras
    
    tiempo_total = tiempo_actual() - inicio
    eficiencia = threads_productivos / threads_despertados
    
    imprimir("Eficiencia: " + (eficiencia * 100) + "%")
    imprimir("Context switches evitados: " + 
             (threads_totales - threads_despertados))
}`})})]})]}),e.jsxs(ue,{value:"epoll",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/30 to-slate-800/30 p-6 rounded-lg border border-purple-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-300 mb-3",children:"⚡ Solución 2: Epoll/Kqueue con EPOLLEXCLUSIVE"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Utiliza mecanismos de I/O multiplexing del kernel con el flag EPOLLEXCLUSIVE para despertar solo un thread cuando hay un evento disponible. Común en servidores de alto rendimiento (Linux epoll, BSD kqueue)."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Despertar exclusivo en epoll_wait"}),e.jsx("li",{children:"• Soportado por el kernel (Linux 4.5+)"}),e.jsx("li",{children:"• Ideal para servidores multi-threaded"}),e.jsx("li",{children:"• Reduce thundering herd en accept()"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Epoll/Kqueue Exclusivo"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Flags de epoll
constante EPOLLIN = 0x001
constante EPOLLET = 0x80000000  // Edge-triggered
constante EPOLLEXCLUSIVE = 1 << 28  // Despertar solo un thread

// Estructura de eventos
estructura epoll_event {
    events: entero
    data: puntero
}

// Crear epoll con EPOLLEXCLUSIVE
función crear_servidor_epoll(puerto: entero) {
    // Crear descriptor epoll
    epfd = epoll_create1(0)
    
    // Crear socket listener
    listen_fd = socket(AF_INET, SOCK_STREAM, 0)
    bind(listen_fd, puerto)
    listen(listen_fd, 128)
    
    // Configurar evento con EPOLLEXCLUSIVE
    evento: epoll_event
    evento.events = EPOLLIN | EPOLLEXCLUSIVE
    evento.data = listen_fd
    
    // Registrar socket en epoll
    epoll_ctl(epfd, EPOLL_CTL_ADD, listen_fd, &evento)
    
    return epfd, listen_fd
}

// Worker thread con epoll exclusivo
función worker_epoll(epfd: entero, listen_fd: entero) {
    eventos: arreglo[64] de epoll_event
    
    mientras verdadero hacer
        // Esperar eventos (SOLO un thread será despertado)
        nfds = epoll_wait(epfd, eventos, 64, -1)
        
        para i = 0 hasta nfds - 1 hacer
            si eventos[i].data == listen_fd entonces
                // Aceptar conexión
                client_fd = accept(listen_fd, NULL, NULL)
                
                si client_fd >= 0 entonces
                    // Procesar cliente
                    manejar_cliente(client_fd)
                    close(client_fd)
                fin si
            fin si
        fin para
    fin mientras
}

// Servidor multi-threaded con EPOLLEXCLUSIVE
función servidor_multithreaded(puerto: entero, num_workers: entero) {
    epfd, listen_fd = crear_servidor_epoll(puerto)
    
    // Crear threads workers
    threads: arreglo[num_workers] de Thread
    
    para i = 0 hasta num_workers - 1 hacer
        threads[i] = crear_thread(worker_epoll, epfd, listen_fd)
    fin para
    
    // Esperar threads
    para cada thread en threads hacer
        thread.join()
    fin para
}

// Comparación: epoll normal vs EPOLLEXCLUSIVE
función comparar_epoll() {
    // SIN EPOLLEXCLUSIVE (thundering herd)
    función epoll_normal(epfd: entero) {
        evento: epoll_event
        evento.events = EPOLLIN  // Sin flag exclusivo
        epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &evento)
        
        // Al llegar un evento:
        // - TODOS los threads son despertados
        // - Solo UNO puede accept()
        // - Los demás vuelven a dormir (desperdicio)
    }
    
    // CON EPOLLEXCLUSIVE (eficiente)
    función epoll_exclusivo(epfd: entero) {
        evento: epoll_event
        evento.events = EPOLLIN | EPOLLEXCLUSIVE
        epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &evento)
        
        // Al llegar un evento:
        // - SOLO UN thread es despertado
        // - Ese thread hace accept()
        // - Sin context switches innecesarios
    }
}

// Kqueue equivalente (BSD/macOS)
función worker_kqueue(kq: entero, listen_fd: entero) {
    eventos: arreglo[64] de kevent
    
    // Configurar evento con EV_DISPATCH (similar a EPOLLEXCLUSIVE)
    cambio: kevent
    cambio.ident = listen_fd
    cambio.filter = EVFILT_READ
    cambio.flags = EV_ADD | EV_DISPATCH  // Despertar solo un thread
    
    kevent(kq, &cambio, 1, NULL, 0, NULL)
    
    mientras verdadero hacer
        // Esperar eventos
        nev = kevent(kq, NULL, 0, eventos, 64, NULL)
        
        para i = 0 hasta nev - 1 hacer
            si eventos[i].ident == listen_fd entonces
                client_fd = accept(listen_fd, NULL, NULL)
                
                si client_fd >= 0 entonces
                    manejar_cliente(client_fd)
                    close(client_fd)
                fin si
                
                // Re-armar evento (EV_DISPATCH lo desactiva)
                kevent(kq, &cambio, 1, NULL, 0, NULL)
            fin si
        fin para
    fin mientras
}

// Servidor híbrido: epoll + thread pool
función servidor_hibrido(puerto: entero) {
    epfd, listen_fd = crear_servidor_epoll(puerto)
    pool: ThreadPool = crear_pool(8)
    
    // Thread aceptador (único)
    función acceptor() {
        eventos: arreglo[64] de epoll_event
        
        mientras verdadero hacer
            nfds = epoll_wait(epfd, eventos, 64, -1)
            
            para i = 0 hasta nfds - 1 hacer
                client_fd = accept(listen_fd, NULL, NULL)
                
                // Delegar procesamiento al pool
                pool.submit(lambda: manejar_cliente(client_fd))
            fin para
        fin mientras
    }
    
    crear_thread(acceptor)
    pool.wait_all()
}

// Métricas de rendimiento
función medir_rendimiento_epoll() {
    conexiones = 10000
    threads_despertados_normal = conexiones * num_workers
    threads_despertados_exclusivo = conexiones
    
    mejora = ((threads_despertados_normal - threads_despertados_exclusivo) /
              threads_despertados_normal) * 100
    
    imprimir("Reducción de wakeups: " + mejora + "%")
    imprimir("Context switches evitados: " + 
             (threads_despertados_normal - threads_despertados_exclusivo))
}`})})]})]}),e.jsxs(ue,{value:"workstealing",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-900/30 to-slate-800/30 p-6 rounded-lg border border-green-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-green-300 mb-3",children:"🔄 Solución 3: Work Stealing"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:'Cada thread tiene su propia cola de trabajo. Cuando un thread se queda sin trabajo, "roba" tareas de las colas de otros threads ocupados. Evita despertar todos los threads simultáneamente y balancea la carga automáticamente.'}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Cada thread tiene cola local"}),e.jsx("li",{children:"• Robo desde colas de otros threads"}),e.jsx("li",{children:"• Balanceo de carga automático"}),e.jsx("li",{children:"• Usado en ForkJoinPool de Java"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Work Stealing"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Deque thread-safe (doble cola)
estructura WorkStealingDeque<T> {
    elementos: arreglo circular de T
    top: entero atómico    // Extremo para push/pop local
    bottom: entero atómico // Extremo para steal
    mutex: Mutex
}

// Operaciones en el deque
función push(deque: WorkStealingDeque, tarea: T) {
    // Push en el bottom (extremo local)
    b = deque.bottom.load()
    deque.elementos[b % tamaño] = tarea
    deque.bottom.store(b + 1)
}

función pop(deque: WorkStealingDeque) -> T {
    // Pop desde el bottom (LIFO local - mejor localidad de caché)
    b = deque.bottom.load() - 1
    deque.bottom.store(b)
    
    t = deque.top.load()
    
    si b < t entonces
        // Deque vacío
        deque.bottom.store(t)
        return NULL
    fin si
    
    tarea = deque.elementos[b % tamaño]
    
    si b > t entonces
        // Más de un elemento, operación exitosa
        return tarea
    fin si
    
    // Competencia con steal, usar CAS
    deque.bottom.store(t + 1)
    
    si compare_and_swap(deque.top, t, t + 1) entonces
        return tarea
    sino
        return NULL  // Perdimos la carrera
    fin si
}

función steal(deque: WorkStealingDeque) -> T {
    // Robar desde el top (FIFO - tareas más antiguas)
    mientras verdadero hacer
        t = deque.top.load()
        b = deque.bottom.load()
        
        si t >= b entonces
            return NULL  // Deque vacío
        fin si
        
        tarea = deque.elementos[t % tamaño]
        
        si compare_and_swap(deque.top, t, t + 1) entonces
            return tarea  // Robo exitoso
        fin si
        // CAS falló, reintentar
    fin mientras
}

// Thread pool con work stealing
estructura WorkStealingPool {
    threads: arreglo de Thread
    deques: arreglo de WorkStealingDeque
    num_threads: entero
    activo: booleano atómico
}

función crear_pool(num_threads: entero) -> WorkStealingPool {
    pool: WorkStealingPool
    pool.num_threads = num_threads
    pool.activo = verdadero
    
    // Crear deque para cada thread
    pool.deques = nuevo arreglo[num_threads] de WorkStealingDeque
    
    // Iniciar threads workers
    para i = 0 hasta num_threads - 1 hacer
        pool.threads[i] = crear_thread(worker, pool, i)
    fin para
    
    return pool
}

// Worker con work stealing
función worker(pool: WorkStealingPool, id: entero) {
    mi_deque = pool.deques[id]
    intentos_robo = 0
    max_intentos = pool.num_threads * 2
    
    mientras pool.activo hacer
        // 1. Intentar tomar tarea de mi cola local
        tarea = pop(mi_deque)
        
        si tarea != NULL entonces
            ejecutar(tarea)
            intentos_robo = 0  // Resetear contador
            continuar
        fin si
        
        // 2. Intentar robar de otros threads
        tarea = intentar_robar(pool, id)
        
        si tarea != NULL entonces
            ejecutar(tarea)
            intentos_robo = 0
            continuar
        fin si
        
        // 3. No hay trabajo, estrategia de espera
        intentos_robo++
        
        si intentos_robo < max_intentos entonces
            // Spin breve (busy-wait)
            spin_wait(10)
        sino
            // Dormir para ahorrar CPU
            thread_sleep(1ms)
        fin si
    fin mientras
}

// Estrategia de robo: víctima aleatoria
función intentar_robar(pool: WorkStealingPool, mi_id: entero) -> Tarea {
    num_threads = pool.num_threads
    inicio = random(num_threads)
    
    // Intentar robar de cada thread (orden aleatorio)
    para i = 0 hasta num_threads - 1 hacer
        victima = (inicio + i) % num_threads
        
        si victima == mi_id entonces
            continuar  // No robar de mi mismo
        fin si
        
        tarea = steal(pool.deques[victima])
        
        si tarea != NULL entonces
            return tarea  // Robo exitoso
        fin si
    fin para
    
    return NULL  // No se encontró trabajo
}

// Submit tarea al pool
función submit(pool: WorkStealingPool, tarea: Tarea) {
    // Seleccionar thread con menos carga (heurística)
    thread_id = seleccionar_thread_menos_cargado(pool)
    
    // Push a su deque
    push(pool.deques[thread_id], tarea)
}

// Ejemplo: procesamiento paralelo con work stealing
función procesar_arbol_paralelo(nodo: Nodo, pool: WorkStealingPool) {
    si nodo es hoja entonces
        procesar(nodo)
        return
    fin si
    
    // Dividir trabajo recursivamente
    para cada hijo en nodo.hijos hacer
        tarea = lambda: procesar_arbol_paralelo(hijo, pool)
        submit(pool, tarea)
    fin para
}

// ForkJoin pattern (divide and conquer)
función fork_join_sort(arr: arreglo, inicio: entero, fin: entero) {
    si fin - inicio <= UMBRAL entonces
        // Caso base: ordenar secuencialmente
        insertion_sort(arr, inicio, fin)
        return
    fin si
    
    // Dividir
    medio = (inicio + fin) / 2
    
    // Fork: crear subtareas
    tarea_izq = crear_tarea(fork_join_sort, arr, inicio, medio)
    tarea_der = crear_tarea(fork_join_sort, arr, medio, fin)
    
    // Push a mi deque local
    mi_id = thread_actual_id()
    push(pool.deques[mi_id], tarea_izq)
    push(pool.deques[mi_id], tarea_der)
    
    // Procesar una subtarea localmente (ayudar)
    fork_join_sort(arr, inicio, medio)
    
    // Join: esperar resultado de la otra subtarea
    mientras tarea_der no completada hacer
        // Intentar robar y ejecutar trabajo mientras esperamos
        tarea = intentar_robar(pool, mi_id)
        si tarea != NULL entonces
            ejecutar(tarea)
        fin si
    fin mientras
    
    // Merge resultados
    merge(arr, inicio, medio, fin)
}

// Métricas de eficiencia
función medir_work_stealing() {
    tareas_totales = 1000
    tareas_locales = 0
    tareas_robadas = 0
    
    // Contadores por thread
    para cada thread hacer
        tareas_locales += thread.stats.local_pops
        tareas_robadas += thread.stats.steals
    fin para
    
    ratio_robo = (tareas_robadas / tareas_totales) * 100
    
    imprimir("Tareas locales: " + tareas_locales)
    imprimir("Tareas robadas: " + tareas_robadas)
    imprimir("Ratio de robo: " + ratio_robo + "%")
    imprimir("Balanceo de carga: " + evaluar_balance())
}`})})]})]}),e.jsxs(ue,{value:"semaphore",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-orange-900/30 to-slate-800/30 p-6 rounded-lg border border-orange-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-orange-300 mb-3",children:"🔢 Solución 4: Semáforos con Contadores"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Usa semáforos contadores para controlar exactamente cuántos threads pueden acceder simultáneamente a un recurso. El contador limita los despertares al número exacto de recursos disponibles, evitando despertares masivos innecesarios."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Contador de recursos disponibles"}),e.jsx("li",{children:"• Despierta solo N threads (N recursos)"}),e.jsx("li",{children:"• Control fino de concurrencia"}),e.jsx("li",{children:"• Evita sobre-suscripción"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Semáforos con Contadores"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Semáforo contador básico
estructura Semaphore {
    contador: entero atómico
    wait_queue: Cola<Thread>
    mutex: Mutex
}

función crear_semaforo(valor_inicial: entero) -> Semaphore {
    sem: Semaphore
    sem.contador = valor_inicial
    sem.wait_queue = nueva_cola()
    return sem
}

// Wait (P operation / down)
función wait(sem: Semaphore) {
    sem.mutex.lock()
    
    mientras sem.contador <= 0 hacer
        // No hay recursos, esperar
        thread_actual = obtener_thread_actual()
        sem.wait_queue.enqueue(thread_actual)
        
        // Liberar mutex y dormir
        sem.mutex.unlock()
        thread_actual.dormir()
        sem.mutex.lock()
    fin mientras
    
    // Hay recursos disponibles
    sem.contador--
    sem.mutex.unlock()
}

// Signal (V operation / up)
función signal(sem: Semaphore) {
    sem.mutex.lock()
    
    sem.contador++
    
    // Despertar UN thread esperando (si hay)
    si no sem.wait_queue.vacia() entonces
        thread = sem.wait_queue.dequeue()
        thread.despertar()
    fin si
    
    sem.mutex.unlock()
}

// Signal múltiple (despertar N threads)
función signal_n(sem: Semaphore, n: entero) {
    sem.mutex.lock()
    
    sem.contador += n
    despertados = 0
    
    // Despertar exactamente N threads (o todos los que esperan)
    mientras despertados < n Y no sem.wait_queue.vacia() hacer
        thread = sem.wait_queue.dequeue()
        thread.despertar()
        despertados++
    fin mientras
    
    sem.mutex.unlock()
}

// Pool de conexiones con semáforo
función connection_pool_semaforo(max_conexiones: entero) {
    semaforo: Semaphore = crear_semaforo(max_conexiones)
    conexiones: arreglo[max_conexiones] de Connection
    
    // Inicializar pool
    para i = 0 hasta max_conexiones - 1 hacer
        conexiones[i] = crear_conexion()
    fin para
    
    // Adquirir conexión
    función acquire() -> Connection {
        wait(semaforo)  // Esperar si no hay conexiones
        
        // Buscar conexión disponible
        para cada conn en conexiones hacer
            si conn.disponible entonces
                conn.disponible = falso
                return conn
            fin si
        fin para
    }
    
    // Liberar conexión
    función release(conn: Connection) {
        conn.disponible = verdadero
        signal(semaforo)  // Despertar UN thread esperando
    }
}

// Semáforo con prioridad (evita starvation)
estructura PrioritySemaphore {
    contador: entero atómico
    colas: arreglo de Cola<Thread>  // Una cola por prioridad
    num_prioridades: entero
    mutex: Mutex
}

función wait_priority(sem: PrioritySemaphore, prioridad: entero) {
    sem.mutex.lock()
    
    mientras sem.contador <= 0 hacer
        thread_actual = obtener_thread_actual()
        // Encolar en cola de prioridad correspondiente
        sem.colas[prioridad].enqueue(thread_actual)
        
        sem.mutex.unlock()
        thread_actual.dormir()
        sem.mutex.lock()
    fin mientras
    
    sem.contador--
    sem.mutex.unlock()
}

función signal_priority(sem: PrioritySemaphore) {
    sem.mutex.lock()
    
    sem.contador++
    
    // Despertar thread de mayor prioridad
    para prioridad = sem.num_prioridades - 1 hasta 0 hacer
        si no sem.colas[prioridad].vacia() entonces
            thread = sem.colas[prioridad].dequeue()
            thread.despertar()
            break
        fin si
    fin para
    
    sem.mutex.unlock()
}

// Barrera con semáforos (sincronización de fase)
estructura Barrier {
    num_threads: entero
    contador: entero atómico
    semaforo: Semaphore
    mutex: Mutex
}

función wait_barrier(barrier: Barrier) {
    barrier.mutex.lock()
    barrier.contador++
    
    si barrier.contador == barrier.num_threads entonces
        // Último thread, liberar todos
        barrier.contador = 0
        barrier.mutex.unlock()
        
        // Despertar TODOS los threads (todos los recursos listos)
        signal_n(barrier.semaforo, barrier.num_threads - 1)
    sino
        // No soy el último, esperar
        barrier.mutex.unlock()
        wait(barrier.semaforo)
    fin si
}

// Rate limiter con semáforo (token bucket)
función rate_limiter(tokens_por_segundo: entero) {
    semaforo: Semaphore = crear_semaforo(tokens_por_segundo)
    
    // Thread que regenera tokens
    función regenerador() {
        mientras verdadero hacer
            dormir(1 segundo)
            signal_n(semaforo, tokens_por_segundo)
        fin mientras
    }
    
    crear_thread(regenerador)
    
    // Consumir token
    función acquire_token() {
        wait(semaforo)
        // Token adquirido, proceder con operación
    }
    
    return acquire_token
}

// Thread pool con semáforo (limitar workers activos)
función thread_pool_semaforo(max_workers: entero) {
    semaforo_workers: Semaphore = crear_semaforo(max_workers)
    cola_trabajos: Cola<Trabajo> sincronizada
    
    función worker() {
        mientras verdadero hacer
            trabajo = cola_trabajos.dequeue()
            
            // Adquirir slot de worker
            wait(semaforo_workers)
            
            ejecutar(trabajo)
            
            // Liberar slot (despertar siguiente worker)
            signal(semaforo_workers)
        fin mientras
    }
    
    // Crear pool de threads
    para i = 1 hasta max_workers * 2 hacer
        crear_thread(worker)
    fin para
}

// Productor-Consumidor con semáforos duales
función producer_consumer_semaphores(buffer_size: entero) {
    buffer: arreglo circular[buffer_size]
    sem_vacios: Semaphore = crear_semaforo(buffer_size)  // Espacios vacíos
    sem_llenos: Semaphore = crear_semaforo(0)            // Items disponibles
    mutex: Mutex
    
    función producer() {
        mientras verdadero hacer
            item = producir()
            
            wait(sem_vacios)    // Esperar espacio disponible
            mutex.lock()
            buffer.push(item)
            mutex.unlock()
            signal(sem_llenos)  // Señalar item disponible
        fin mientras
    }
    
    función consumer() {
        mientras verdadero hacer
            wait(sem_llenos)    // Esperar item disponible
            mutex.lock()
            item = buffer.pop()
            mutex.unlock()
            signal(sem_vacios)  // Señalar espacio disponible
            
            consumir(item)
        fin mientras
    }
}

// Métricas de uso
función medir_semaforos() {
    max_recursos = 10
    threads_totales = 50
    threads_bloqueados = 0
    
    para cada thread hacer
        si thread.estado == ESPERANDO entonces
            threads_bloqueados++
        fin si
    fin para
    
    utilizacion = ((threads_totales - threads_bloqueados) / max_recursos) * 100
    eficiencia = min(utilizacion, 100)
    
    imprimir("Recursos máximos: " + max_recursos)
    imprimir("Threads activos: " + (threads_totales - threads_bloqueados))
    imprimir("Threads bloqueados: " + threads_bloqueados)
    imprimir("Eficiencia: " + eficiencia + "%")
}`})})]})]}),e.jsxs(ue,{value:"pooling",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-cyan-900/30 to-slate-800/30 p-6 rounded-lg border border-cyan-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-cyan-300 mb-3",children:"🏊 Solución 5: Connection Pooling"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Mantiene un pool de conexiones pre-establecidas y reutilizables. En lugar de crear conexiones bajo demanda (causando thundering herd), los threads toman conexiones existentes del pool. Común en bases de datos y servicios de red."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Reutilización de conexiones"}),e.jsx("li",{children:"• Evita creación masiva simultánea"}),e.jsx("li",{children:"• Gestión de timeouts y validación"}),e.jsx("li",{children:"• Control de tamaño máximo"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Connection Pooling"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Estructura de conexión
estructura Connection {
    id: entero
    socket: Socket
    en_uso: booleano atómico
    ultimo_uso: Timestamp
    creada: Timestamp
    validaciones_fallidas: entero
}

// Pool de conexiones
estructura ConnectionPool {
    conexiones: Lista<Connection>
    min_size: entero
    max_size: entero
    current_size: entero atómico
    semaforo: Semaphore
    mutex: Mutex
    timeout_ms: entero
    max_lifetime_ms: entero
}

// Crear pool
función crear_pool(host: cadena, puerto: entero, 
                   min: entero, max: entero) -> ConnectionPool {
    pool: ConnectionPool
    pool.min_size = min
    pool.max_size = max
    pool.current_size = 0
    pool.timeout_ms = 30000  // 30 segundos
    pool.max_lifetime_ms = 1800000  // 30 minutos
    pool.semaforo = crear_semaforo(max)
    
    // Crear conexiones iniciales (min_size)
    para i = 1 hasta min hacer
        conn = crear_conexion(host, puerto)
        pool.conexiones.append(conn)
        pool.current_size++
    fin para
    
    // Iniciar thread de mantenimiento
    crear_thread(mantener_pool, pool)
    
    return pool
}

// Adquirir conexión del pool
función acquire(pool: ConnectionPool, timeout_ms: entero) -> Connection {
    inicio = timestamp_actual()
    
    mientras verdadero hacer
        pool.mutex.lock()
        
        // 1. Buscar conexión disponible y válida
        para cada conn en pool.conexiones hacer
            si no conn.en_uso entonces
                si validar_conexion(conn) entonces
                    conn.en_uso = verdadero
                    conn.ultimo_uso = timestamp_actual()
                    pool.mutex.unlock()
                    return conn
                sino
                    // Conexión inválida, remover
                    pool.conexiones.remove(conn)
                    pool.current_size--
                    cerrar(conn)
                fin si
            fin si
        fin para
        
        // 2. No hay conexiones disponibles
        si pool.current_size < pool.max_size entonces
            // Crear nueva conexión
            conn = crear_nueva_conexion(pool)
            si conn != NULL entonces
                conn.en_uso = verdadero
                conn.ultimo_uso = timestamp_actual()
                pool.conexiones.append(conn)
                pool.current_size++
                pool.mutex.unlock()
                return conn
            fin si
        fin si
        
        pool.mutex.unlock()
        
        // 3. Pool lleno, esperar
        tiempo_transcurrido = timestamp_actual() - inicio
        
        si tiempo_transcurrido >= timeout_ms entonces
            lanzar TimeoutException("Pool exhausted")
        fin si
        
        // Esperar con semáforo (despertar selectivo)
        wait_timeout(pool.semaforo, timeout_ms - tiempo_transcurrido)
    fin mientras
}

// Liberar conexión al pool
función release(pool: ConnectionPool, conn: Connection) {
    pool.mutex.lock()
    
    si conn.en_uso entonces
        conn.en_uso = falso
        conn.ultimo_uso = timestamp_actual()
        
        // Verificar si debe ser descartada
        si debe_descartar(conn, pool) entonces
            pool.conexiones.remove(conn)
            pool.current_size--
            cerrar(conn)
        fin si
    fin si
    
    pool.mutex.unlock()
    
    // Señalar que hay conexión disponible
    signal(pool.semaforo)
}

// Validar conexión
función validar_conexion(conn: Connection) -> booleano {
    // 1. Verificar timeout de vida
    edad = timestamp_actual() - conn.creada
    si edad > pool.max_lifetime_ms entonces
        return falso
    fin si
    
    // 2. Ping rápido (opcional)
    si no ping(conn.socket) entonces
        conn.validaciones_fallidas++
        si conn.validaciones_fallidas >= 3 entonces
            return falso
        fin si
    sino
        conn.validaciones_fallidas = 0
    fin si
    
    return verdadero
}

// Thread de mantenimiento
función mantener_pool(pool: ConnectionPool) {
    mientras verdadero hacer
        dormir(60000)  // Cada minuto
        
        pool.mutex.lock()
        
        // 1. Remover conexiones expiradas
        para cada conn en pool.conexiones hacer
            si no conn.en_uso entonces
                si debe_descartar(conn, pool) entonces
                    pool.conexiones.remove(conn)
                    pool.current_size--
                    cerrar(conn)
                fin si
            fin si
        fin para
        
        // 2. Mantener mínimo de conexiones
        mientras pool.current_size < pool.min_size hacer
            conn = crear_nueva_conexion(pool)
            si conn != NULL entonces
                pool.conexiones.append(conn)
                pool.current_size++
            fin si
        fin mientras
        
        pool.mutex.unlock()
    fin mientras
}

// Verificar si descartar conexión
función debe_descartar(conn: Connection, pool: ConnectionPool) -> booleano {
    // Excede tiempo de vida
    edad = timestamp_actual() - conn.creada
    si edad > pool.max_lifetime_ms entonces
        return verdadero
    fin si
    
    // Idle timeout (30 min sin uso)
    idle_time = timestamp_actual() - conn.ultimo_uso
    si idle_time > 1800000 entonces
        return verdadero
    fin si
    
    // Muchas validaciones fallidas
    si conn.validaciones_fallidas >= 3 entonces
        return verdadero
    fin si
    
    return falso
}

// Pool con particionamiento (sharding)
estructura ShardedConnectionPool {
    shards: arreglo de ConnectionPool
    num_shards: entero
}

función crear_sharded_pool(num_shards: entero, 
                           size_por_shard: entero) -> ShardedConnectionPool {
    pool: ShardedConnectionPool
    pool.num_shards = num_shards
    
    para i = 0 hasta num_shards - 1 hacer
        pool.shards[i] = crear_pool(host, puerto, 
                                     size_por_shard / 2, 
                                     size_por_shard)
    fin para
    
    return pool
}

función acquire_sharded(pool: ShardedConnectionPool) -> Connection {
    // Seleccionar shard basado en thread ID (menos contención)
    shard_id = thread_id() % pool.num_shards
    return acquire(pool.shards[shard_id], 30000)
}

// Ejemplo: Base de datos con pooling
función ejemplo_database_pool() {
    pool = crear_pool("localhost", 5432, min=5, max=20)
    
    función worker_thread() {
        mientras verdadero hacer
            trabajo = obtener_trabajo()
            
            // Adquirir conexión (espera si no hay disponibles)
            conn = acquire(pool, timeout_ms=5000)
            
            intentar {
                resultado = conn.query(trabajo.sql)
                procesar(resultado)
            } capturar error {
                manejar_error(error)
            } finalmente {
                // SIEMPRE liberar conexión
                release(pool, conn)
            }
        fin mientras
    }
    
    // Crear threads workers
    para i = 1 hasta 100 hacer
        crear_thread(worker_thread)
    fin para
}

// Pool elástico (escala automáticamente)
función pool_elastico() {
    pool: ConnectionPool
    metricas: Metricas
    
    función ajustar_tamaño() {
        mientras verdadero hacer
            dormir(10000)  // Cada 10 segundos
            
            carga = metricas.wait_time_promedio
            
            si carga > 100ms Y pool.current_size < pool.max_size entonces
                // Alta carga, expandir
                agregar_conexiones(pool, 2)
            fin si
            
            si carga < 10ms Y pool.current_size > pool.min_size entonces
                // Baja carga, contraer
                remover_conexiones_idle(pool, 2)
            fin si
        fin mientras
    }
    
    crear_thread(ajustar_tamaño)
}

// Métricas de pool
función medir_pool(pool: ConnectionPool) {
    pool.mutex.lock()
    
    total = pool.current_size
    en_uso = 0
    disponibles = 0
    
    para cada conn en pool.conexiones hacer
        si conn.en_uso entonces
            en_uso++
        sino
            disponibles++
        fin si
    fin para
    
    pool.mutex.unlock()
    
    utilizacion = (en_uso / total) * 100
    
    imprimir("Conexiones totales: " + total)
    imprimir("Conexiones en uso: " + en_uso)
    imprimir("Conexiones disponibles: " + disponibles)
    imprimir("Utilización: " + utilizacion + "%")
    imprimir("Capacidad restante: " + (pool.max_size - total))
}`})})]})]})]})})]}),e.jsxs(sa,{value:"demos",className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700",children:[e.jsx(ra,{className:"px-6 py-4 hover:bg-slate-700/30 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(vn,{className:"size-6 text-emerald-400"}),e.jsx("span",{className:"text-2xl font-semibold",children:"Demostraciones Interactivas"})]})}),e.jsx(na,{className:"px-6 pb-6",children:e.jsxs(ia,{defaultValue:"demo-selective",className:"w-full",children:[e.jsxs(Qt,{className:"grid w-full grid-cols-5 bg-slate-900/50 p-1 rounded-lg mb-6",children:[e.jsx(le,{value:"demo-selective",className:"data-[state=active]:bg-emerald-600",children:"Demo Selectivo"}),e.jsx(le,{value:"demo-epoll",className:"data-[state=active]:bg-emerald-600",children:"Demo Epoll"}),e.jsx(le,{value:"demo-ws",className:"data-[state=active]:bg-emerald-600",children:"Demo WS"}),e.jsx(le,{value:"demo-sem",className:"data-[state=active]:bg-emerald-600",children:"Demo Semáforos"}),e.jsx(le,{value:"demo-pool",className:"data-[state=active]:bg-emerald-600",children:"Demo Pool"})]}),e.jsx(ue,{value:"demo-selective",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/20 to-slate-900/50 p-6 rounded-lg border border-blue-700/30",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-300 mb-4",children:"🎯 Demostración: Despertar Selectivo"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>o(!s),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-semibold transition-colors ${s?"bg-red-600 hover:bg-red-700":"bg-emerald-600 hover:bg-emerald-700"}`,children:[s?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),s?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:et,className:"flex items-center gap-2 px-4 py-2 rounded-lg font-semibold bg-slate-600 hover:bg-slate-700 transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Velocidad:"}),e.jsx(dt,{value:[n],onValueChange:Te=>l(Te[0]),min:200,max:2e3,step:100,className:"flex-1"}),e.jsxs("span",{className:"text-sm text-gray-400 w-16",children:[n,"ms"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-sm font-semibold text-blue-300 mb-2",children:["😴 Cola de Espera (",d.length,")"]}),e.jsxs("div",{className:"space-y-1",children:[d.map((Te,_t)=>e.jsxs("div",{className:"bg-blue-900/30 px-2 py-1 rounded text-sm border border-blue-700/50",children:["Thread ",Te]},_t)),d.length===0&&e.jsx("div",{className:"text-gray-500 text-xs italic",children:"Vacía"})]})]}),e.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"text-sm font-semibold text-amber-300 mb-2",children:"📦 Trabajos Pendientes"}),e.jsx("div",{className:"text-4xl font-bold text-center text-amber-400 py-4",children:h})]}),e.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"text-sm font-semibold text-emerald-300 mb-2",children:"⚙️ Thread Trabajando"}),e.jsx("div",{className:"text-center py-4",children:g!==null?e.jsxs("div",{className:"bg-emerald-900/30 px-3 py-2 rounded border border-emerald-700/50 inline-block",children:[e.jsxs("div",{className:"text-2xl font-bold text-emerald-400",children:["Thread ",g]}),e.jsx("div",{className:"text-xs text-emerald-300 mt-1",children:"Procesando..."})]}):e.jsx("div",{className:"text-gray-500 text-sm italic",children:"Idle"})})]})]}),e.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 border border-slate-700",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"📋 Log de Eventos"}),e.jsx("div",{ref:xt,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:v.map(Te=>e.jsx("div",{className:`${Te.type==="success"?"text-emerald-400":Te.type==="warning"?"text-amber-400":Te.type==="error"?"text-red-400":"text-gray-400"}`,children:Te.message},Te.id))})]})]})}),e.jsx(ue,{value:"demo-epoll",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/20 to-slate-900/50 p-6 rounded-lg border border-purple-700/30",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-300 mb-4",children:"⚡ Demostración: Epoll/Kqueue EPOLLEXCLUSIVE"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>j(!N),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-semibold transition-colors ${N?"bg-red-600 hover:bg-red-700":"bg-emerald-600 hover:bg-emerald-700"}`,children:[N?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),N?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:L,className:"flex items-center gap-2 px-4 py-2 rounded-lg font-semibold bg-slate-600 hover:bg-slate-700 transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("button",{onClick:()=>E(C==="normal"?"exclusive":"normal"),className:`px-4 py-2 rounded-lg font-semibold transition-colors ${C==="exclusive"?"bg-emerald-600 hover:bg-emerald-700":"bg-amber-600 hover:bg-amber-700"}`,children:["Modo: ",C==="exclusive"?"EXCLUSIVE ✅":"NORMAL ⚠️"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Velocidad:"}),e.jsx(dt,{value:[_],onValueChange:Te=>w(Te[0]),min:200,max:2e3,step:100,className:"flex-1"}),e.jsxs("span",{className:"text-sm text-gray-400 w-16",children:[_,"ms"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-sm font-semibold text-purple-300 mb-3",children:["😴 Threads en epoll_wait() (",z.length,")"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:z.map(Te=>{const _t=V.includes(Te);return e.jsxs("div",{className:`px-3 py-2 rounded text-center font-semibold transition-all ${_t?"bg-emerald-600 border-emerald-400 scale-110":"bg-purple-900/30 border-purple-700/50"} border`,children:["T",Te]},Te)})})]}),e.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"text-sm font-semibold text-purple-300 mb-3",children:"🔔 Eventos Procesados"}),e.jsx("div",{className:"text-5xl font-bold text-center text-purple-400 py-4",children:oe}),e.jsx("div",{className:"text-center text-sm text-gray-400",children:C==="normal"?"⚠️ Thundering Herd Activo":"✅ Despertar Exclusivo"})]})]}),e.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 border border-slate-700",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"📋 Log de Eventos"}),e.jsx("div",{ref:Ot,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:T.map(Te=>e.jsx("div",{className:`${Te.type==="success"?"text-emerald-400":Te.type==="warning"?"text-amber-400":Te.type==="error"?"text-red-400":"text-gray-400"}`,children:Te.message},Te.id))})]})]})}),e.jsx(ue,{value:"demo-ws",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-green-900/20 to-slate-900/50 p-6 rounded-lg border border-green-700/30",children:[e.jsx("h3",{className:"text-xl font-bold text-green-300 mb-4",children:"🔄 Demostración: Work Stealing"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>W(!J),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-semibold transition-colors ${J?"bg-red-600 hover:bg-red-700":"bg-emerald-600 hover:bg-emerald-700"}`,children:[J?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),J?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:re,className:"flex items-center gap-2 px-4 py-2 rounded-lg font-semibold bg-slate-600 hover:bg-slate-700 transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Velocidad:"}),e.jsx(dt,{value:[ne],onValueChange:Te=>Ee(Te[0]),min:200,max:2e3,step:100,className:"flex-1"}),e.jsxs("span",{className:"text-sm text-gray-400 w-16",children:[ne,"ms"]})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-4",children:Ce.map((Te,_t)=>e.jsxs("div",{className:`bg-slate-800/50 p-4 rounded-lg border transition-all ${I.includes(_t)?"border-emerald-500 bg-emerald-900/20":F?.to===_t?"border-blue-500 bg-blue-900/20":F?.from===_t?"border-amber-500 bg-amber-900/20":"border-slate-600"}`,children:[e.jsxs("h4",{className:"text-sm font-semibold text-green-300 mb-2",children:["Thread ",_t," (",Te.length,")"]}),e.jsxs("div",{className:"space-y-1",children:[Te.slice().reverse().map((St,tt)=>e.jsxs("div",{className:"bg-green-900/30 px-2 py-1 rounded text-sm border border-green-700/50 text-center",children:["T",St]},tt)),Te.length===0&&e.jsx("div",{className:"text-gray-500 text-xs italic text-center py-2",children:I.includes(_t)?"Robando...":"Vacía"})]})]},_t))}),e.jsx("div",{className:"bg-slate-800/50 p-3 rounded-lg border border-slate-600 mb-4",children:e.jsxs("div",{className:"flex gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded"}),e.jsx("span",{children:"Procesando"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),e.jsx("span",{children:"Robando a..."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-amber-500 rounded"}),e.jsx("span",{children:"Siendo robado"})]})]})}),e.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 border border-slate-700",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"📋 Log de Eventos"}),e.jsx("div",{ref:It,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:ze.map(Te=>e.jsx("div",{className:`${Te.type==="success"?"text-emerald-400":Te.type==="warning"?"text-amber-400":Te.type==="error"?"text-red-400":"text-gray-400"}`,children:Te.message},Te.id))})]})]})}),e.jsx(ue,{value:"demo-sem",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-orange-900/20 to-slate-900/50 p-6 rounded-lg border border-orange-700/30",children:[e.jsx("h3",{className:"text-xl font-bold text-orange-300 mb-4",children:"🔢 Demostración: Semáforos con Contadores"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>se(!$),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-semibold transition-colors ${$?"bg-red-600 hover:bg-red-700":"bg-emerald-600 hover:bg-emerald-700"}`,children:[$?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),$?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:Ve,className:"flex items-center gap-2 px-4 py-2 rounded-lg font-semibold bg-slate-600 hover:bg-slate-700 transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Velocidad:"}),e.jsx(dt,{value:[k],onValueChange:Te=>K(Te[0]),min:200,max:2e3,step:100,className:"flex-1"}),e.jsxs("span",{className:"text-sm text-gray-400 w-16",children:[k,"ms"]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 p-6 rounded-lg border border-slate-600 mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-orange-300 mb-3 text-center",children:"Contador del Semáforo"}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("div",{className:"text-6xl font-bold text-orange-400",children:M}),e.jsx("div",{className:"text-2xl text-gray-400",children:"/"}),e.jsx("div",{className:"text-4xl text-gray-500",children:q})]}),e.jsx("div",{className:"text-center text-sm text-gray-400 mt-2",children:"Recursos disponibles"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-sm font-semibold text-amber-300 mb-3",children:["⏳ Threads Esperando (",G.length,")"]}),e.jsxs("div",{className:"space-y-1",children:[G.map((Te,_t)=>e.jsxs("div",{className:"bg-amber-900/30 px-3 py-2 rounded border border-amber-700/50 text-center",children:["Thread ",Te]},_t)),G.length===0&&e.jsx("div",{className:"text-gray-500 text-xs italic text-center",children:"No hay threads esperando"})]})]}),e.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-sm font-semibold text-emerald-300 mb-3",children:["⚙️ Threads Activos (",Ne.length,"/",q,")"]}),e.jsxs("div",{className:"space-y-1",children:[Ne.map((Te,_t)=>e.jsxs("div",{className:"bg-emerald-900/30 px-3 py-2 rounded border border-emerald-700/50 text-center",children:["Thread ",Te]},_t)),Ne.length===0&&e.jsx("div",{className:"text-gray-500 text-xs italic text-center",children:"No hay threads activos"})]})]})]}),e.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 border border-slate-700",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"📋 Log de Eventos"}),e.jsx("div",{ref:Ue,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:ke.map(Te=>e.jsx("div",{className:`${Te.type==="success"?"text-emerald-400":Te.type==="warning"?"text-amber-400":Te.type==="error"?"text-red-400":"text-gray-400"}`,children:Te.message},Te.id))})]})]})}),e.jsx(ue,{value:"demo-pool",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-cyan-900/20 to-slate-900/50 p-6 rounded-lg border border-cyan-700/30",children:[e.jsx("h3",{className:"text-xl font-bold text-cyan-300 mb-4",children:"🏊 Demostración: Connection Pooling"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>ae(!ee),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-semibold transition-colors ${ee?"bg-red-600 hover:bg-red-700":"bg-emerald-600 hover:bg-emerald-700"}`,children:[ee?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),ee?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:ce,className:"flex items-center gap-2 px-4 py-2 rounded-lg font-semibold bg-slate-600 hover:bg-slate-700 transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Velocidad:"}),e.jsx(dt,{value:[rt],onValueChange:Te=>jt(Te[0]),min:200,max:2e3,step:100,className:"flex-1"}),e.jsxs("span",{className:"text-sm text-gray-400 w-16",children:[rt,"ms"]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-lg border border-slate-600 mb-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-cyan-300 mb-3",children:"🏊 Connection Pool (5 conexiones)"}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:xe.map(Te=>e.jsxs("div",{className:`p-3 rounded-lg border transition-all ${Te.inUse?"bg-emerald-900/30 border-emerald-600":"bg-cyan-900/30 border-cyan-700"}`,children:[e.jsxs("div",{className:"text-center font-semibold mb-1",children:["Conn ",Te.id]}),e.jsx("div",{className:"text-xs text-center text-gray-400 mb-2",children:Te.inUse?`Thread ${Te.thread}`:"Disponible"}),e.jsx("div",{className:"bg-slate-900 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${Te.health>80?"bg-emerald-500":Te.health>50?"bg-amber-500":"bg-red-500"}`,style:{width:`${Te.health}%`}})}),e.jsxs("div",{className:"text-xs text-center text-gray-500 mt-1",children:[Te.health,"%"]})]},Te.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-sm font-semibold text-amber-300 mb-3",children:["⏳ Threads Esperando (",De.length,")"]}),e.jsxs("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:[De.map((Te,_t)=>e.jsxs("div",{className:"bg-amber-900/30 px-3 py-1 rounded border border-amber-700/50 text-center text-sm",children:["Thread ",Te]},_t)),De.length===0&&e.jsx("div",{className:"text-gray-500 text-xs italic text-center py-4",children:"No hay threads esperando"})]})]}),e.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"text-sm font-semibold text-cyan-300 mb-3",children:"📊 Estadísticas"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Total Peticiones:"}),e.jsx("span",{className:"font-semibold text-cyan-400",children:qe})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Conexiones en uso:"}),e.jsx("span",{className:"font-semibold text-emerald-400",children:xe.filter(Te=>Te.inUse).length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Disponibles:"}),e.jsx("span",{className:"font-semibold text-cyan-400",children:xe.filter(Te=>!Te.inUse).length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Utilización:"}),e.jsxs("span",{className:"font-semibold text-amber-400",children:[Math.round(xe.filter(Te=>Te.inUse).length/xe.length*100),"%"]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 border border-slate-700",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"📋 Log de Eventos"}),e.jsx("div",{ref:At,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:Xe.map(Te=>e.jsx("div",{className:`${Te.type==="success"?"text-emerald-400":Te.type==="warning"?"text-amber-400":Te.type==="error"?"text-red-400":"text-gray-400"}`,children:Te.message},Te.id))})]})]})})]})})]})]})})]})}const FR=Sa("/ActividadesSeminarioSO/actividad11/thundering-herd")({component:$R});function HR(){const[s,o]=c.useState([{id:1,priority:10,effectivePriority:10,arrivalTime:0,tickets:10,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-blue-500",status:"waiting"},{id:2,priority:50,effectivePriority:50,arrivalTime:0,tickets:5,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-green-500",status:"waiting"},{id:3,priority:80,effectivePriority:80,arrivalTime:0,tickets:2,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-purple-500",status:"waiting"}]),[n,l]=c.useState(!1),[d,m]=c.useState(0),[h,x]=c.useState([500]),[g,b]=c.useState(["Sistema iniciado. Esperando..."]),v=c.useRef(null),[f,N]=c.useState([{id:1,priority:0,effectivePriority:0,arrivalTime:0,tickets:10,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-cyan-500",status:"waiting"},{id:2,priority:0,effectivePriority:0,arrivalTime:0,tickets:5,level:0,bypassCount:0,virtualTime:0,weight:512,executionTime:0,waitTime:0,color:"bg-pink-500",status:"waiting"}]),[j,_]=c.useState(!1),[w,C]=c.useState(0),[E,z]=c.useState([500]),[P,V]=c.useState(["Sistema Fair Scheduler iniciado."]),Z=c.useRef(null),[oe,O]=c.useState([{id:1,priority:10,effectivePriority:10,arrivalTime:0,tickets:10,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-red-500",status:"waiting"},{id:2,priority:50,effectivePriority:50,arrivalTime:0,tickets:5,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-yellow-500",status:"waiting"},{id:3,priority:80,effectivePriority:80,arrivalTime:0,tickets:2,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-indigo-500",status:"waiting"}]),[T,ge]=c.useState(!1),[J,W]=c.useState(0),[ne,Ee]=c.useState([500]),[Ce,Le]=c.useState(["Sistema Bounded Waiting iniciado (MAX_BYPASS=3)."]),I=c.useRef(null),[Q,F]=c.useState([{id:1,priority:0,effectivePriority:0,arrivalTime:0,tickets:10,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-orange-500",status:"waiting"},{id:2,priority:0,effectivePriority:0,arrivalTime:0,tickets:5,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-teal-500",status:"waiting"}]),[de,ze]=c.useState(!1),[A,$]=c.useState(0),[se,k]=c.useState([500]),[K,M]=c.useState(["Sistema Multilevel FIFO iniciado (4 niveles)."]),D=c.useRef(null),[q,G]=c.useState([{id:1,priority:0,effectivePriority:0,arrivalTime:0,tickets:10,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-lime-500",status:"waiting"},{id:2,priority:0,effectivePriority:0,arrivalTime:0,tickets:5,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-rose-500",status:"waiting"},{id:3,priority:0,effectivePriority:0,arrivalTime:0,tickets:2,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-amber-500",status:"waiting"}]),[be,Ne]=c.useState(!1),[R,ke]=c.useState(0),[je,ee]=c.useState([500]),[ae,rt]=c.useState(["Sistema Lottery Scheduling iniciado."]),jt=c.useRef(null);return c.useEffect(()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)},[g]),c.useEffect(()=>{Z.current&&(Z.current.scrollTop=Z.current.scrollHeight)},[P]),c.useEffect(()=>{I.current&&(I.current.scrollTop=I.current.scrollHeight)},[Ce]),c.useEffect(()=>{D.current&&(D.current.scrollTop=D.current.scrollHeight)},[K]),c.useEffect(()=>{jt.current&&(jt.current.scrollTop=jt.current.scrollHeight)},[ae]),c.useEffect(()=>{if(!n)return;const xe=setInterval(()=>{m(Me=>Me+h[0]),o(Me=>{const De=Me.map(qe=>{if(qe.status==="completed")return qe;const Se=qe.status==="waiting"?qe.waitTime+h[0]:qe.waitTime,Xe=Math.floor(Se/100),We=Math.max(0,qe.priority-Xe);return{...qe,waitTime:Se,effectivePriority:We}}),Ge=De.filter(qe=>qe.status==="waiting");if(Ge.length>0){const qe=Ge.reduce((Se,Xe)=>Xe.effectivePriority<Se.effectivePriority?Xe:Se);return b(Se=>[...Se,`[${d}ms] Aging aplicado. Seleccionado P${qe.id} (prioridad efectiva: ${qe.effectivePriority.toFixed(1)})`]),De.map(Se=>({...Se,status:Se.id===qe.id?"executing":Se.status==="completed"?"completed":"waiting",executionTime:Se.id===qe.id?Se.executionTime+h[0]:Se.executionTime}))}return De})},h[0]);return()=>clearInterval(xe)},[n,h,d]),c.useEffect(()=>{if(!be)return;const xe=setInterval(()=>{ke(Me=>Me+je[0]),G(Me=>{const De=Me.filter(We=>We.status!=="completed");if(De.length===0)return Me;const Ge=De.reduce((We,xt)=>We+xt.tickets,0),qe=Math.floor(Math.random()*Ge)+1;let Se=0,Xe=De[0];for(const We of De)if(Se+=We.tickets,qe<=Se){Xe=We;break}return rt(We=>[...We,`🎲 Sorteo: Ticket #${qe}/${Ge} → P${Xe.id} GANA (${Xe.tickets} tickets, ${(Xe.tickets/Ge*100).toFixed(1)}%)`]),Me.map(We=>{const xt=We.id===Xe.id?0:We.waitTime+je[0],Ot=xt>2e3?1:0;return Ot>0&&rt(It=>[...It,`⭐ P${We.id} recibe +1 ticket por espera prolongada (total: ${We.tickets+Ot})`]),{...We,status:We.id===Xe.id?"executing":We.status,executionTime:We.id===Xe.id?We.executionTime+je[0]:We.executionTime,waitTime:xt,tickets:We.id===Xe.id?We.tickets:We.tickets+Ot}})}),setTimeout(()=>{G(Me=>Me.map(De=>({...De,status:De.status==="completed"?"completed":"waiting"})))},je[0]/2)},je[0]);return()=>clearInterval(xe)},[be,je]),c.useEffect(()=>{if(!j)return;const xe=setInterval(()=>{C(Me=>Me+E[0]),N(Me=>{const De=Me.filter(We=>We.status!=="completed");if(De.length===0)return Me;const Ge=De.reduce((We,xt)=>xt.virtualTime<We.virtualTime?xt:We),qe=De.reduce((We,xt)=>We+xt.weight,0),Se=Ge.weight/qe,Xe=Math.max(E[0],Se*100);return V(We=>[...We,`⏰ P${Ge.id} ejecuta (vTime: ${Ge.virtualTime.toFixed(1)}, CPU: ${(Se*100).toFixed(1)}%, quantum: ${Xe.toFixed(0)}ms)`]),Me.map(We=>{const xt=We.id===Ge.id,Ot=xt?E[0]*1024/We.weight:0;return{...We,status:xt?"executing":We.status,virtualTime:We.virtualTime+Ot,executionTime:xt?We.executionTime+E[0]:We.executionTime,waitTime:xt?0:We.waitTime+E[0]}})}),setTimeout(()=>{N(Me=>Me.map(De=>({...De,status:De.status==="completed"?"completed":"waiting"})))},E[0]/2)},E[0]);return()=>clearInterval(xe)},[j,E]),c.useEffect(()=>{if(!T)return;const xe=setInterval(()=>{W(Me=>Me+ne[0]),O(Me=>{const De=Me.filter(Se=>Se.status!=="completed");if(De.length===0)return Me;const Ge=De.find(Se=>Se.bypassCount>=3),qe=Ge||De.reduce((Se,Xe)=>Xe.priority>Se.priority?Xe:Se);return Le(Ge?Se=>[...Se,`⚠️ P${qe.id} FORZADO a ejecutar (bypass: ${qe.bypassCount}/3, prioridad: ${qe.priority})`]:Se=>[...Se,`▶️ P${qe.id} ejecuta (prioridad: ${qe.priority})`]),Me.map(Se=>{const Xe=Se.id===qe.id;return{...Se,status:Xe?"executing":Se.status,bypassCount:Xe?0:Se.bypassCount+1,executionTime:Xe?Se.executionTime+ne[0]:Se.executionTime,waitTime:Xe?0:Se.waitTime+ne[0]}})}),setTimeout(()=>{O(Me=>Me.map(De=>({...De,status:De.status==="completed"?"completed":"waiting"})))},ne[0]/2)},ne[0]);return()=>clearInterval(xe)},[T,ne]),c.useEffect(()=>{if(!de)return;const xe=setInterval(()=>{$(Me=>Me+se[0]),F(Me=>{const De=Me.filter(Se=>Se.status!=="completed");if(De.length===0)return Me;let Ge=null;for(let Se=0;Se<=3;Se++){const Xe=De.filter(We=>We.level===Se);if(Xe.length>0){Ge=Xe[0];break}}if(!Ge)return Me;const qe=10*Math.pow(2,Ge.level);return M(Se=>[...Se,`📋 P${Ge.id} ejecuta en nivel ${Ge.level} (quantum: ${qe}ms)`]),Me.map(Se=>{const Xe=Se.id===Ge.id,We=Xe?0:Se.waitTime+se[0],xt=Xe?Se.executionTime+se[0]:Se.executionTime;let Ot=Se.level;return!Xe&&We>50&&Se.level>0&&(Ot=Se.level-1,M(It=>[...It,`⬆️ P${Se.id} PROMOCIONADO nivel ${Se.level} → ${Ot} (espera: ${We}ms)`])),Xe&&Se.level<3&&(Ot=Se.level+1,M(It=>[...It,`⬇️ P${Se.id} DEGRADADO nivel ${Se.level} → ${Ot}`])),{...Se,status:Xe?"executing":Se.status,level:Ot,executionTime:xt,waitTime:We}})}),setTimeout(()=>{F(Me=>Me.map(De=>({...De,status:De.status==="completed"?"completed":"waiting"})))},se[0]/2)},se[0]);return()=>clearInterval(xe)},[de,se]),e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto px-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"text-5xl",children:"🍽️"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Starvation"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Inanición / Hambruna"})]})]})})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"bg-white text-gray-900 rounded-lg p-8 mb-8 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(La,{className:"size-6 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Descripción del Problema"})]}),e.jsxs("p",{className:"text-gray-700 leading-relaxed mb-4",children:["La ",e.jsx("strong",{className:"text-orange-600",children:"inanición"})," (starvation) ocurre cuando un proceso o thread espera indefinidamente para acceder a un recurso porque otros procesos con mayor prioridad lo acaparan continuamente. A diferencia del deadlock, el sistema sigue funcionando, pero algunos procesos nunca obtienen los recursos necesarios."]}),e.jsx("div",{className:"bg-orange-50 border-l-4 border-orange-500 p-4 rounded mt-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(yn,{className:"size-5 text-orange-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-orange-900 mb-2",children:"Causas Comunes de Starvation"}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"Situaciones típicas que provocan inanición:"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 ml-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"1. Algoritmos de scheduling injustos:"})," Procesos de baja prioridad nunca ejecutan"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"2. Políticas LIFO:"})," Los nuevos procesos se atienden primero"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"3. Asignación preferencial:"})," Ciertos procesos siempre obtienen los recursos"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"4. Prioridades estáticas:"})," Sin mecanismo para aumentar prioridad con el tiempo"]})]})]})]})}),e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"💡 Ejemplo Clásico:"})," En el problema de los Filósofos Cenando, un filósofo que nunca logra tomar ambos tenedores sufre starvation, mientras los demás siguen comiendo y liberando recursos."]})})]}),e.jsxs(Da,{type:"multiple",defaultValue:["soluciones","demostracion"],className:"space-y-4",children:[e.jsxs(sa,{value:"soluciones",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Soluciones (Pseudocódigo)"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"aging",className:"w-full",children:[e.jsxs(Qt,{className:"w-full justify-start flex-wrap h-auto gap-2 bg-gray-900 p-2",children:[e.jsx(le,{value:"aging",children:"⏰ Aging"}),e.jsx(le,{value:"fair",children:"⚖️ Fair Scheduling"}),e.jsx(le,{value:"bounded",children:"🔢 Bounded Waiting"}),e.jsx(le,{value:"fifo",children:"📋 FIFO con Prioridad"}),e.jsx(le,{value:"lottery",children:"🎰 Lottery Scheduling"})]}),"                ",e.jsx(ue,{value:"aging",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"⏰ Aging (Envejecimiento)"}),e.jsx("p",{className:"text-gray-300",children:"Aumenta gradualmente la prioridad de los procesos que esperan mucho tiempo. Garantiza que eventualmente todos los procesos sean atendidos."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`CONSTANTES:
    AGING_INTERVAL = 100
    AGING_FACTOR = 1

ESTRUCTURA Proceso:
    id: entero
    prioridad_base: entero
    prioridad_efectiva: entero
    tiempo_llegada: timestamp
FIN ESTRUCTURA

FUNCIÓN scheduler_con_aging():
    MIENTRAS sistema_activo:
        tiempo_actual = obtener_tiempo()
        
        PARA CADA proceso EN cola_listos:
            tiempo_espera = tiempo_actual - proceso.tiempo_llegada
            incrementos = tiempo_espera / AGING_INTERVAL
            proceso.prioridad_efectiva = proceso.prioridad_base - incrementos * AGING_FACTOR
            
            SI proceso.prioridad_efectiva < 0:
                proceso.prioridad_efectiva = 0
            FIN SI
        FIN PARA
        
        proceso_siguiente = MIN_PRIORIDAD(cola_listos)
        ejecutar(proceso_siguiente)
    FIN MIENTRAS
FIN FUNCIÓN`})})})]})}),e.jsx(ue,{value:"fair",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"⚖️ Fair Scheduling (CFS)"}),e.jsx("p",{className:"text-gray-300",children:'Reparte el tiempo de CPU equitativamente. Cada proceso mantiene un "tiempo virtual" que representa cuánto ha ejecutado. Siempre se elige el proceso con menor tiempo virtual.'}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`CONSTANTES:
    MIN_GRANULARITY = 1
    PESO_NORMAL = 1024

ESTRUCTURA Proceso:
    id: entero
    tiempo_virtual: real
    peso: entero
FIN ESTRUCTURA

GLOBAL arbol_procesos: ArbolRB<Proceso>

FUNCIÓN calcular_tiempo_virtual(tiempo_real, peso):
    RETORNAR tiempo_real * (PESO_NORMAL / peso)
FIN FUNCIÓN

FUNCIÓN fair_scheduler():
    MIENTRAS sistema_activo:
        proceso = arbol_procesos.minimo()
        SI proceso == NULL: CONTINUAR
        
        total_peso = SUMA(p.peso PARA p EN arbol_procesos)
        proporcion = proceso.peso / total_peso
        quantum = MAX(proporcion * PERIODO, MIN_GRANULARITY)
        
        tiempo_ejecutado = ejecutar_por(proceso, quantum)
        incremento_virtual = calcular_tiempo_virtual(tiempo_ejecutado, proceso.peso)
        proceso.tiempo_virtual += incremento_virtual
        
        arbol_procesos.remover(proceso)
        arbol_procesos.insertar(proceso)
    FIN MIENTRAS
FIN FUNCIÓN`})})})]})}),e.jsx(ue,{value:"bounded",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"🔢 Bounded Waiting (Espera Acotada)"}),e.jsx("p",{className:"text-gray-300",children:"Establece un límite máximo de veces que un proceso puede ser omitido. Después de N omisiones, el proceso debe ser atendido obligatoriamente."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`CONSTANTES:
    MAX_BYPASS = 3

ESTRUCTURA Proceso:
    id: entero
    bypass_count: entero
    timestamp_llegada: timestamp
FIN ESTRUCTURA

FUNCIÓN asignar_recurso_con_bounded_waiting():
    proceso_seleccionado = NULL
    
    PARA CADA proceso EN cola_espera:
        SI proceso.bypass_count >= MAX_BYPASS:
            proceso_seleccionado = proceso
            ROMPER
        FIN SI
    FIN PARA
    
    SI proceso_seleccionado == NULL:
        proceso_seleccionado = SELECCIONAR_POR_PRIORIDAD(cola_espera)
    FIN SI
    
    PARA CADA p EN cola_espera:
        SI p != proceso_seleccionado:
            p.bypass_count++
        SINO:
            p.bypass_count = 0
        FIN SI
    FIN PARA
    
    asignar_recurso_a(proceso_seleccionado)
    remover_de_cola(proceso_seleccionado)
FIN FUNCIÓN`})})})]})}),e.jsx(ue,{value:"fifo",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"📋 FIFO con Prioridad (Multilevel Feedback Queue)"}),e.jsx("p",{className:"text-gray-300",children:"Múltiples colas FIFO con diferentes prioridades. Los procesos pueden ser promovidos o demotados entre niveles según su comportamiento y tiempo de espera."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`CONSTANTES:
    NUM_NIVELES = 4
    QUANTUM_BASE = 10
    PROMOTE_THRESHOLD = 50

GLOBAL colas[NUM_NIVELES]: ColaProcesos

FUNCIÓN multilevel_scheduler():
    MIENTRAS sistema_activo:
        proceso = NULL
        
        PARA nivel DESDE 0 HASTA NUM_NIVELES-1:
            SI NO colas[nivel].esta_vacia():
                proceso = colas[nivel].desencolar()
                ROMPER
            FIN SI
        FIN PARA
        
        SI proceso == NULL: CONTINUAR
        
        quantum = QUANTUM_BASE * (2 ** proceso.nivel)
        tiempo_espera = tiempo_actual() - proceso.tiempo_llegada
        
        SI tiempo_espera > PROMOTE_THRESHOLD Y proceso.nivel > 0:
            proceso.nivel--
        FIN SI
        
        tiempo_usado = ejecutar_por(proceso, quantum)
        
        SI tiempo_usado >= quantum Y proceso.nivel < NUM_NIVELES-1:
            proceso.nivel++
        FIN SI
        
        colas[proceso.nivel].encolar(proceso)
    FIN MIENTRAS
FIN FUNCIÓN`})})})]})}),e.jsx(ue,{value:"lottery",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"🎰 Lottery Scheduling"}),e.jsx("p",{className:"text-gray-300",children:"Sorteo aleatorio de tickets. Cada proceso tiene tickets, y el ganador del sorteo obtiene CPU. Todos los procesos tienen probabilidad mayor que 0 de ser elegidos, evitando starvation."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`ESTRUCTURA Proceso:
    id: entero
    tickets: entero

FUNCIÓN lottery_scheduler():
    MIENTRAS sistema_activo:
        total_tickets = 0
        
        PARA CADA proceso EN procesos_listos:
            total_tickets += proceso.tickets
        FIN PARA
        
        SI total_tickets == 0: CONTINUAR
        
        ticket_ganador = RANDOM(1, total_tickets)
        suma_acumulada = 0
        
        PARA CADA proceso EN procesos_listos:
            suma_acumulada += proceso.tickets
            
            SI ticket_ganador <= suma_acumulada:
                ejecutar(proceso)
                ROMPER
            FIN SI
        FIN PARA
    FIN MIENTRAS
FIN FUNCIÓN

FUNCIÓN compensar_starvation():
    PARA CADA proceso EN procesos_listos:
        SI proceso.tiempo_espera > UMBRAL:
            proceso.tickets += BONUS_TICKETS
        FIN SI
    FIN PARA
FIN FUNCIÓN`})})})]})})]})})]}),e.jsxs(sa,{value:"demostracion",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"size-5"}),e.jsx("span",{children:"Demostración Interactiva"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"demo-aging",className:"w-full",children:[e.jsxs(Qt,{className:"w-full justify-start flex-wrap h-auto gap-2 bg-gray-900 p-2",children:[e.jsx(le,{value:"demo-aging",children:"⏰ Aging"}),e.jsx(le,{value:"demo-fair",children:"⚖️ Fair"}),e.jsx(le,{value:"demo-bounded",children:"🔢 Bounded"}),e.jsx(le,{value:"demo-fifo",children:"📋 FIFO"}),e.jsx(le,{value:"demo-lottery",children:"🎰 Lottery"})]}),e.jsx(ue,{value:"demo-aging",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Demostración: Aging (Envejecimiento)"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("button",{onClick:()=>l(!n),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium flex items-center gap-2",children:[n?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),n?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{l(!1),m(0),o([{id:1,priority:10,effectivePriority:10,arrivalTime:0,tickets:10,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-blue-500",status:"waiting"},{id:2,priority:50,effectivePriority:50,arrivalTime:0,tickets:5,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-green-500",status:"waiting"},{id:3,priority:80,effectivePriority:80,arrivalTime:0,tickets:2,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-purple-500",status:"waiting"}]),b(["Sistema reiniciado."])},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:h,onValueChange:x,min:100,max:1e3,step:100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[h[0],"ms"]})]}),e.jsxs("div",{className:"ml-auto text-gray-400",children:["Tiempo: ",d,"ms"]})]})}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-4",children:"Estados de Procesos"}),e.jsx("div",{className:"space-y-3",children:s.map(xe=>e.jsxs("div",{className:"bg-gray-800 rounded p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded ${xe.color}`}),e.jsxs("span",{className:"font-bold",children:["Proceso ",xe.id]}),xe.status==="executing"&&e.jsx("span",{className:"text-xs bg-green-600 px-2 py-1 rounded",children:"EJECUTANDO"}),xe.status==="waiting"&&e.jsx("span",{className:"text-xs bg-yellow-600 px-2 py-1 rounded",children:"ESPERANDO"})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Prioridad Base:"}),e.jsx("span",{className:"ml-2 text-white font-mono",children:xe.priority})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Prioridad Efectiva:"}),e.jsx("span",{className:"ml-2 text-green-400 font-mono font-bold",children:xe.effectivePriority.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Tiempo Espera:"}),e.jsxs("span",{className:"ml-2 text-orange-400 font-mono",children:[xe.waitTime,"ms"]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${xe.color}`,style:{width:`${Math.max(0,100-xe.effectivePriority)}%`}})})})]},xe.id))})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-2",children:"Registro de Eventos"}),e.jsx("div",{ref:v,className:"bg-black rounded p-3 font-mono text-xs text-green-400 h-48 overflow-y-auto",children:g.map((xe,Me)=>e.jsx("div",{children:xe},Me))})]})]})}),e.jsx(ue,{value:"demo-fair",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Demostración: Fair Scheduling (CFS) ⚖️"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("button",{onClick:()=>_(!j),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium flex items-center gap-2",children:[j?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),j?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{_(!1),C(0),N([{id:1,priority:0,effectivePriority:0,arrivalTime:0,tickets:10,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-cyan-500",status:"waiting"},{id:2,priority:0,effectivePriority:0,arrivalTime:0,tickets:5,level:0,bypassCount:0,virtualTime:0,weight:512,executionTime:0,waitTime:0,color:"bg-pink-500",status:"waiting"}]),V(["Sistema Fair Scheduler reiniciado."])},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("button",{onClick:()=>{const xe=[2048,1024,512,256],Me={id:f.length+1,priority:0,effectivePriority:0,arrivalTime:w,tickets:0,level:0,bypassCount:0,virtualTime:0,weight:xe[f.length%xe.length],executionTime:0,waitTime:0,color:`bg-${["violet","emerald","fuchsia","amber"][f.length%4]}-500`,status:"waiting"};N([...f,Me]),V(De=>[...De,`P${Me.id} añadido con peso ${Me.weight}`])},className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(dr,{className:"size-4"}),"Añadir Proceso"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:E,onValueChange:z,min:100,max:1e3,step:100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[E[0],"ms"]})]}),e.jsxs("div",{className:"ml-auto text-gray-400",children:["Tiempo: ",w,"ms"]})]})}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-4",children:"Tiempo Virtual (Red-Black Tree) 🌳"}),e.jsx("div",{className:"space-y-3",children:f.slice().sort((xe,Me)=>xe.virtualTime-Me.virtualTime).map((xe,Me)=>{const De=f.reduce((qe,Se)=>qe+Se.weight,0),Ge=(xe.weight/De*100).toFixed(1);return e.jsxs("div",{className:"bg-gray-800 rounded p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded ${xe.color}`}),Me===0&&e.jsx("span",{className:"text-xs bg-green-600 px-2 py-1 rounded",children:"⬅️ MÍNIMO"}),e.jsxs("span",{className:"font-bold",children:["Proceso ",xe.id]}),xe.status==="executing"&&e.jsx("span",{className:"text-xs bg-blue-600 px-2 py-1 rounded",children:"EJECUTANDO"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{N(f.map(qe=>qe.id===xe.id?{...qe,weight:Math.max(256,qe.weight/2)}:qe))},className:"p-1 bg-red-600 hover:bg-red-700 rounded text-xs",children:e.jsx(go,{className:"size-3"})}),e.jsxs("span",{className:"text-xs text-gray-400",children:["Peso: ",xe.weight]}),e.jsx("button",{onClick:()=>{N(f.map(qe=>qe.id===xe.id?{...qe,weight:Math.min(4096,qe.weight*2)}:qe))},className:"p-1 bg-green-600 hover:bg-green-700 rounded text-xs",children:e.jsx(dr,{className:"size-3"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Tiempo Virtual:"}),e.jsx("span",{className:"ml-2 text-cyan-400 font-mono font-bold",children:xe.virtualTime.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"CPU Share:"}),e.jsxs("span",{className:"ml-2 text-green-400 font-mono",children:[Ge,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Ejecutado:"}),e.jsxs("span",{className:"ml-2 text-white font-mono",children:[xe.executionTime,"ms"]})]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${xe.color}`,style:{width:`${Math.min(100,xe.virtualTime/10*100)}%`}})})]},xe.id)})})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-2",children:"Eventos del Scheduler"}),e.jsx("div",{ref:Z,className:"bg-black rounded p-3 font-mono text-xs text-green-400 h-48 overflow-y-auto",children:P.map((xe,Me)=>e.jsx("div",{children:xe},Me))})]})]})}),e.jsx(ue,{value:"demo-bounded",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Demostración: Bounded Waiting 🔢"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("button",{onClick:()=>ge(!T),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium flex items-center gap-2",children:[T?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),T?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{ge(!1),W(0),O([{id:1,priority:10,effectivePriority:10,arrivalTime:0,tickets:10,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-red-500",status:"waiting"},{id:2,priority:50,effectivePriority:50,arrivalTime:0,tickets:5,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-yellow-500",status:"waiting"},{id:3,priority:80,effectivePriority:80,arrivalTime:0,tickets:2,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-indigo-500",status:"waiting"}]),Le(["Sistema Bounded Waiting reiniciado (MAX_BYPASS=3)."])},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:ne,onValueChange:Ee,min:100,max:1e3,step:100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[ne[0],"ms"]})]}),e.jsxs("div",{className:"ml-auto text-gray-400",children:["Ciclos: ",Math.floor(J/(ne[0]||500))]})]})}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-4",children:"Bypass Counter (MAX = 3) �"}),e.jsx("div",{className:"space-y-3",children:oe.map(xe=>e.jsxs("div",{className:"bg-gray-800 rounded p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded ${xe.color}`}),e.jsxs("span",{className:"font-bold",children:["Proceso ",xe.id]}),xe.status==="executing"&&e.jsx("span",{className:"text-xs bg-green-600 px-2 py-1 rounded",children:"✅ EJECUTANDO"}),xe.bypassCount>=3&&e.jsx("span",{className:"text-xs bg-red-600 px-2 py-1 rounded animate-pulse",children:"⚠️ FORZAR"})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Prioridad:"}),e.jsx("span",{className:"ml-2 text-white font-mono",children:xe.priority})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Bypass Count:"}),e.jsxs("span",{className:`ml-2 font-mono font-bold ${xe.bypassCount>=3?"text-red-400":"text-yellow-400"}`,children:[xe.bypassCount,"/3"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Ejecutado:"}),e.jsxs("span",{className:"ml-2 text-green-400 font-mono",children:[xe.executionTime,"ms"]})]})]}),e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(Me=>e.jsx("div",{className:`flex-1 h-3 rounded ${Me<xe.bypassCount?xe.bypassCount>=3?"bg-red-500 animate-pulse":"bg-yellow-500":"bg-gray-700"}`},Me))})]},xe.id))})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-2",children:"Registro de Asignación de Recursos"}),e.jsx("div",{ref:I,className:"bg-black rounded p-3 font-mono text-xs text-green-400 h-48 overflow-y-auto",children:Ce.map((xe,Me)=>e.jsx("div",{children:xe},Me))})]})]})}),e.jsx(ue,{value:"demo-fifo",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Demostración: Multilevel FIFO con Prioridad 📋"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("button",{onClick:()=>ze(!de),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium flex items-center gap-2",children:[de?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),de?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{ze(!1),$(0),F([{id:1,priority:0,effectivePriority:0,arrivalTime:0,tickets:10,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-orange-500",status:"waiting"},{id:2,priority:0,effectivePriority:0,arrivalTime:0,tickets:5,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-teal-500",status:"waiting"}]),M(["Sistema Multilevel FIFO reiniciado (4 niveles)."])},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("button",{onClick:()=>{const xe={id:Q.length+1,priority:0,effectivePriority:0,arrivalTime:A,tickets:0,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:`bg-${["sky","rose","lime","purple"][Q.length%4]}-500`,status:"waiting"};F([...Q,xe]),M(Me=>[...Me,`P${xe.id} añadido en nivel 0`])},className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(dr,{className:"size-4"}),"Añadir Proceso"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:se,onValueChange:k,min:100,max:1e3,step:100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[se[0],"ms"]})]}),e.jsxs("div",{className:"ml-auto text-gray-400",children:["Tiempo: ",A,"ms"]})]})}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-4",children:"Colas por Nivel de Prioridad 🎚️"}),e.jsx("div",{className:"grid grid-cols-4 gap-3 mb-4",children:[0,1,2,3].map(xe=>{const Me=Q.filter(Ge=>Ge.level===xe),De=10*Math.pow(2,xe);return e.jsxs("div",{className:`border-2 rounded-lg p-3 ${xe===0?"border-green-500":xe===1?"border-blue-500":xe===2?"border-yellow-500":"border-red-500"}`,children:[e.jsxs("div",{className:"text-center mb-2",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["Nivel ",xe]}),e.jsxs("div",{className:"text-lg font-bold",children:["Q=",De,"ms"]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[Me.length," procesos"]})]}),e.jsx("div",{className:"space-y-1",children:Me.map(Ge=>e.jsxs("div",{className:`${Ge.color} rounded px-2 py-1 text-xs text-center font-bold`,children:["P",Ge.id,Ge.status==="executing"&&" ▶"]},Ge.id))})]},xe)})}),e.jsx("div",{className:"space-y-2 mt-4",children:Q.map(xe=>e.jsxs("div",{className:"bg-gray-800 rounded p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded ${xe.color}`}),e.jsxs("span",{className:"font-bold",children:["P",xe.id]}),xe.status==="executing"&&e.jsx("span",{className:"text-xs bg-green-600 px-2 py-1 rounded",children:"▶ EJECUTANDO"})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Nivel:"}),e.jsx("span",{className:"ml-2 text-white font-mono font-bold",children:xe.level})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Espera:"}),e.jsxs("span",{className:"ml-2 text-yellow-400 font-mono",children:[xe.waitTime,"ms"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Ejecutado:"}),e.jsxs("span",{className:"ml-2 text-green-400 font-mono",children:[xe.executionTime,"ms"]})]})]})]},xe.id))})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-2",children:"Eventos de Promoción/Degradación"}),e.jsx("div",{ref:D,className:"bg-black rounded p-3 font-mono text-xs text-green-400 h-48 overflow-y-auto",children:K.map((xe,Me)=>e.jsx("div",{children:xe},Me))})]})]})}),e.jsx(ue,{value:"demo-lottery",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Demostración: Lottery Scheduling 🎰"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("button",{onClick:()=>Ne(!be),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium flex items-center gap-2",children:[be?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),be?"Pausar":"Iniciar Sorteo"]}),e.jsxs("button",{onClick:()=>{Ne(!1),ke(0),G([{id:1,priority:0,effectivePriority:0,arrivalTime:0,tickets:10,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-lime-500",status:"waiting"},{id:2,priority:0,effectivePriority:0,arrivalTime:0,tickets:5,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-rose-500",status:"waiting"},{id:3,priority:0,effectivePriority:0,arrivalTime:0,tickets:2,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:"bg-amber-500",status:"waiting"}]),rt(["Sistema Lottery reiniciado. Total: 17 tickets"])},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("button",{onClick:()=>{const xe={id:q.length+1,priority:0,effectivePriority:0,arrivalTime:R,tickets:3,level:0,bypassCount:0,virtualTime:0,weight:1024,executionTime:0,waitTime:0,color:`bg-${["violet","fuchsia","sky","emerald"][q.length%4]}-500`,status:"waiting"};G([...q,xe]),rt(Me=>[...Me,`Proceso ${xe.id} añadido con 3 tickets`])},className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(dr,{className:"size-4"}),"Añadir Proceso"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:je,onValueChange:ee,min:100,max:1e3,step:100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[je[0],"ms"]})]}),e.jsxs("div",{className:"ml-auto text-gray-400",children:["Sorteos: ",Math.floor(R/(je[0]||500))]})]})}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-4",children:"Distribución de Tickets 🎫"}),e.jsx("div",{className:"space-y-3",children:q.map(xe=>{const Me=q.reduce((Ge,qe)=>Ge+qe.tickets,0),De=(xe.tickets/Me*100).toFixed(1);return e.jsxs("div",{className:"bg-gray-800 rounded p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded ${xe.color}`}),e.jsxs("span",{className:"font-bold",children:["Proceso ",xe.id]}),xe.status==="executing"&&e.jsx("span",{className:"text-xs bg-green-600 px-2 py-1 rounded",children:"🎉 GANADOR"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>{G(q.map(Ge=>Ge.id===xe.id?{...Ge,tickets:Math.max(1,Ge.tickets-1)}:Ge))},className:"p-1 bg-red-600 hover:bg-red-700 rounded",children:e.jsx(go,{className:"size-3"})}),e.jsxs("span",{className:"font-mono text-lg font-bold text-yellow-400",children:[xe.tickets," 🎫"]}),e.jsx("button",{onClick:()=>{G(q.map(Ge=>Ge.id===xe.id?{...Ge,tickets:Ge.tickets+1}:Ge))},className:"p-1 bg-green-600 hover:bg-green-700 rounded",children:e.jsx(dr,{className:"size-3"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Probabilidad:"}),e.jsxs("span",{className:"text-cyan-400 font-mono font-bold",children:[De,"%"]}),e.jsxs("span",{className:"text-sm text-gray-400 ml-auto",children:["Ejecutado: ",xe.executionTime,"ms"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full ${xe.color} transition-all duration-300`,style:{width:`${De}%`}})})]},xe.id)})}),e.jsxs("div",{className:"mt-4 text-center text-sm text-gray-400",children:["Total de tickets en circulación: ",e.jsx("span",{className:"text-white font-bold",children:q.reduce((xe,Me)=>xe+Me.tickets,0)})]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-2",children:"Historial de Sorteos 🎲"}),e.jsx("div",{ref:jt,className:"bg-black rounded p-3 font-mono text-xs text-green-400 h-48 overflow-y-auto",children:ae.map((xe,Me)=>e.jsx("div",{children:xe},Me))})]})]})})]})})]})]})]})]})}const GR=Sa("/ActividadesSeminarioSO/actividad11/starvation")({component:HR});function WR(){const[s,o]=c.useState(!1),[n,l]=c.useState(500),[d,m]=c.useState([{id:1,priority:10,originalPriority:10,status:"idle",holdingMutex:!1,progress:0},{id:2,priority:5,originalPriority:5,status:"idle",holdingMutex:!1,progress:0},{id:3,priority:1,originalPriority:1,status:"idle",holdingMutex:!1,progress:0}]),[h,x]=c.useState([]),[,g]=c.useState(0),[b,v]=c.useState(!1),[f,N]=c.useState(500),[j,_]=c.useState([{id:1,priority:10,originalPriority:10,status:"idle",holdingMutex:!1,progress:0},{id:2,priority:5,originalPriority:5,status:"idle",holdingMutex:!1,progress:0},{id:3,priority:1,originalPriority:1,status:"idle",holdingMutex:!1,progress:0}]),[w,C]=c.useState([]),[,E]=c.useState(0),[z]=c.useState(10),[P,V]=c.useState(!1),[Z,oe]=c.useState(500),[O,T]=c.useState([{id:1,priority:10,originalPriority:10,status:"idle",holdingMutex:!1,progress:0},{id:2,priority:5,originalPriority:5,status:"idle",holdingMutex:!1,progress:0},{id:3,priority:1,originalPriority:1,status:"idle",holdingMutex:!1,progress:0}]),[ge,J]=c.useState([]),[,W]=c.useState(0),[ne,Ee]=c.useState(!0),[Ce,Le]=c.useState(!1),[I,Q]=c.useState(500),[F,de]=c.useState([{id:1,priority:10,originalPriority:10,status:"idle",holdingMutex:!1,progress:0},{id:2,priority:5,originalPriority:5,status:"idle",holdingMutex:!1,progress:0},{id:3,priority:1,originalPriority:1,status:"idle",holdingMutex:!1,progress:0}]),[ze,A]=c.useState([]),[$,se]=c.useState([]),k=c.useRef(null),K=c.useRef(null),M=c.useRef(null),D=c.useRef(null);c.useEffect(()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},[h]),c.useEffect(()=>{K.current&&(K.current.scrollTop=K.current.scrollHeight)},[w]),c.useEffect(()=>{M.current&&(M.current.scrollTop=M.current.scrollHeight)},[ge]),c.useEffect(()=>{D.current&&(D.current.scrollTop=D.current.scrollHeight)},[ze]),c.useEffect(()=>{if(!s)return;const R=setInterval(()=>{g(ke=>{const je=ke+1;if(je===1)x(ee=>[...ee,"⏱️ T=0: T3 (baja prioridad=1) adquiere el mutex"]),m(ee=>ee.map(ae=>ae.id===3?{...ae,status:"running",holdingMutex:!0,progress:20}:ae));else if(je===2)x(ee=>[...ee,"⏱️ T=1: T2 (media prioridad=5) comienza a ejecutar (sin necesitar mutex)"]),m(ee=>ee.map(ae=>ae.id===2?{...ae,status:"running",progress:15}:ae));else if(je===3)x(ee=>[...ee,"⏱️ T=2: T1 (alta prioridad=10) intenta adquirir mutex"]),m(ee=>ee.map(ae=>ae.id===1?{...ae,status:"waiting"}:ae));else if(je===4)x(ee=>[...ee,"🔼 HERENCIA: T3 hereda prioridad 10 de T1"]),m(ee=>ee.map(ae=>ae.id===3?{...ae,priority:10}:ae));else if(je===5)x(ee=>[...ee,"⏱️ T=3: T3 (ahora prioridad=10) expulsa a T2 y continúa"]),m(ee=>ee.map(ae=>ae.id===2?{...ae,status:"blocked"}:ae.id===3?{...ae,progress:50}:ae));else if(je===6)m(ee=>ee.map(ae=>ae.id===3?{...ae,progress:80}:ae));else if(je===7)x(ee=>[...ee,"✅ T3 completa su sección crítica y libera mutex"]),x(ee=>[...ee,"🔽 T3 restaura prioridad original = 1"]),m(ee=>ee.map(ae=>ae.id===3?{...ae,status:"completed",holdingMutex:!1,priority:1,progress:100}:ae));else if(je===8)x(ee=>[...ee,"⏱️ T=4: T1 adquiere mutex y ejecuta"]),m(ee=>ee.map(ae=>ae.id===1?{...ae,status:"running",holdingMutex:!0,progress:40}:ae));else if(je===9)m(ee=>ee.map(ae=>ae.id===1?{...ae,progress:100}:ae));else if(je===10)x(ee=>[...ee,"✅ T1 completa su trabajo"]),m(ee=>ee.map(ae=>ae.id===1?{...ae,status:"completed",holdingMutex:!1}:ae));else if(je===11)x(ee=>[...ee,"⏱️ T=5: T2 completa su ejecución"]),m(ee=>ee.map(ae=>ae.id===2?{...ae,status:"completed",progress:100}:ae));else if(je===12)return x(ee=>[...ee,"✅ Simulación completada - Priority Inheritance previno inversión de prioridad"]),o(!1),0;return je})},n);return()=>clearInterval(R)},[s,n]),c.useEffect(()=>{if(!b)return;const R=setInterval(()=>{E(ke=>{const je=ke+1;if(je===1)C(ee=>[...ee,`⏱️ T=0: Mutex configurado con ceiling = ${z}`]),C(ee=>[...ee,"⏱️ T3 (baja prioridad=1) intenta adquirir mutex"]);else if(je===2)C(ee=>[...ee,`🔝 T3 elevada INMEDIATAMENTE a ceiling = ${z}`]),_(ee=>ee.map(ae=>ae.id===3?{...ae,status:"running",holdingMutex:!0,priority:z,progress:20}:ae));else if(je===3)C(ee=>[...ee,"⏱️ T=1: T2 (media prioridad=5) intenta ejecutar"]),C(ee=>[...ee,"❌ T2 bloqueada: T3 tiene prioridad mayor (ceiling=10)"]),_(ee=>ee.map(ae=>ae.id===2?{...ae,status:"blocked"}:ae));else if(je===4)C(ee=>[...ee,"⏱️ T=2: T1 (alta prioridad=10) intenta adquirir mutex"]),C(ee=>[...ee,"⏳ T1 debe esperar: mutex ocupado por T3"]),_(ee=>ee.map(ae=>ae.id===1?{...ae,status:"waiting"}:ae));else if(je===5)C(ee=>[...ee,"⏱️ T=3: T3 continúa ejecutando con prioridad máxima"]),_(ee=>ee.map(ae=>ae.id===3?{...ae,progress:50}:ae));else if(je===6)_(ee=>ee.map(ae=>ae.id===3?{...ae,progress:80}:ae));else if(je===7)C(ee=>[...ee,"✅ T3 completa sección crítica y libera mutex"]),C(ee=>[...ee,"🔽 T3 restaura prioridad original = 1"]),_(ee=>ee.map(ae=>ae.id===3?{...ae,status:"completed",holdingMutex:!1,priority:1,progress:100}:ae));else if(je===8)C(ee=>[...ee,"⏱️ T=4: T1 adquiere mutex con ceiling=10"]),_(ee=>ee.map(ae=>ae.id===1?{...ae,status:"running",holdingMutex:!0,progress:40}:ae));else if(je===9)_(ee=>ee.map(ae=>ae.id===1?{...ae,progress:100}:ae));else if(je===10)C(ee=>[...ee,"✅ T1 completa su trabajo"]),_(ee=>ee.map(ae=>ae.id===1?{...ae,status:"completed",holdingMutex:!1}:ae));else if(je===11)C(ee=>[...ee,"⏱️ T=5: T2 puede ejecutar ahora"]),_(ee=>ee.map(ae=>ae.id===2?{...ae,status:"running",progress:100}:ae));else if(je===12)C(ee=>[...ee,"✅ T2 completada"]),_(ee=>ee.map(ae=>ae.id===2?{...ae,status:"completed"}:ae));else if(je===13)return C(ee=>[...ee,"✅ Simulación completada - Priority Ceiling previno inversión"]),v(!1),0;return je})},f);return()=>clearInterval(R)},[b,f,z]),c.useEffect(()=>{if(!P)return;const R=setInterval(()=>{W(ke=>{const je=ke+1;if(je===1)J(ee=>[...ee,"⏱️ T=0: T3 (baja prioridad=1) entra a sección crítica"]),J(ee=>[...ee,"🚫 T3 DESACTIVA PREEMPTION"]),Ee(!1),T(ee=>ee.map(ae=>ae.id===3?{...ae,status:"running",holdingMutex:!0,progress:20}:ae));else if(je===2)J(ee=>[...ee,"⏱️ T=1: T2 (media) y T1 (alta) intentan ejecutar"]),J(ee=>[...ee,"❌ Preemption desactivada: T3 NO puede ser interrumpida"]),T(ee=>ee.map(ae=>ae.id===1?{...ae,status:"blocked"}:ae.id===2?{...ae,status:"blocked"}:ae));else if(je===3)J(ee=>[...ee,"⏱️ T=2: T3 continúa ejecutando sin interrupciones"]),T(ee=>ee.map(ae=>ae.id===3?{...ae,progress:50}:ae));else if(je===4)T(ee=>ee.map(ae=>ae.id===3?{...ae,progress:80}:ae));else if(je===5)J(ee=>[...ee,"✅ T3 completa sección crítica"]),J(ee=>[...ee,"✅ T3 REACTIVA PREEMPTION"]),Ee(!0),T(ee=>ee.map(ae=>ae.id===3?{...ae,status:"completed",holdingMutex:!1,progress:100}:ae));else if(je===6)J(ee=>[...ee,"⏱️ T=3: T1 (alta prioridad) expulsa a T2 y ejecuta"]),T(ee=>ee.map(ae=>ae.id===1?{...ae,status:"running",progress:50}:ae));else if(je===7)T(ee=>ee.map(ae=>ae.id===1?{...ae,progress:100}:ae));else if(je===8)J(ee=>[...ee,"✅ T1 completada"]),T(ee=>ee.map(ae=>ae.id===1?{...ae,status:"completed"}:ae));else if(je===9)J(ee=>[...ee,"⏱️ T=4: T2 ejecuta"]),T(ee=>ee.map(ae=>ae.id===2?{...ae,status:"running",progress:100}:ae));else if(je===10)J(ee=>[...ee,"✅ T2 completada"]),T(ee=>ee.map(ae=>ae.id===2?{...ae,status:"completed"}:ae));else if(je===11)return J(ee=>[...ee,"✅ Simulación completada - Disable Preemption previno inversión"]),V(!1),0;return je})},Z);return()=>clearInterval(R)},[P,Z]),c.useEffect(()=>{if(!Ce)return;const R=setInterval(()=>{A(ke=>{const je=[...ke];return de(ae=>ae.map(rt=>rt.status==="idle"?(je.push(`⏱️ T${rt.id} (prioridad=${rt.priority}) inicia con datos locales`),{...rt,status:"running",progress:10}):rt.status==="running"&&rt.progress<100?{...rt,progress:Math.min(100,rt.progress+15)}:rt.status==="running"&&rt.progress>=100?(je.push(`✅ T${rt.id} completada (sin bloqueos, sin inversión)`),{...rt,status:"completed"}):rt)),ke.length===1?(se([{from:1,to:3,msg:"DATA_REQUEST"}]),je.push("📨 T1 envía mensaje a T3: DATA_REQUEST")):ke.length===3&&(se(ae=>[...ae,{from:3,to:1,msg:"DATA_RESPONSE"}]),je.push("📨 T3 responde a T1: DATA_RESPONSE")),F.every(ae=>ae.status==="completed")&&ke.length>5&&(je.push("✅ Simulación completada - Sin recursos compartidos = Sin inversión"),Le(!1)),je})},I);return()=>clearInterval(R)},[Ce,I,F]);const q=()=>{o(!1),g(0),x([]),m([{id:1,priority:10,originalPriority:10,status:"idle",holdingMutex:!1,progress:0},{id:2,priority:5,originalPriority:5,status:"idle",holdingMutex:!1,progress:0},{id:3,priority:1,originalPriority:1,status:"idle",holdingMutex:!1,progress:0}])},G=()=>{v(!1),E(0),C([]),_([{id:1,priority:10,originalPriority:10,status:"idle",holdingMutex:!1,progress:0},{id:2,priority:5,originalPriority:5,status:"idle",holdingMutex:!1,progress:0},{id:3,priority:1,originalPriority:1,status:"idle",holdingMutex:!1,progress:0}])},be=()=>{V(!1),W(0),J([]),Ee(!0),T([{id:1,priority:10,originalPriority:10,status:"idle",holdingMutex:!1,progress:0},{id:2,priority:5,originalPriority:5,status:"idle",holdingMutex:!1,progress:0},{id:3,priority:1,originalPriority:1,status:"idle",holdingMutex:!1,progress:0}])},Ne=()=>{Le(!1),A([]),se([]),de([{id:1,priority:10,originalPriority:10,status:"idle",holdingMutex:!1,progress:0},{id:2,priority:5,originalPriority:5,status:"idle",holdingMutex:!1,progress:0},{id:3,priority:1,originalPriority:1,status:"idle",holdingMutex:!1,progress:0}])};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white",children:[e.jsx("div",{className:"bg-gradient-to-r from-red-900/50 to-purple-900/50 border-b border-red-700/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(vn,{className:"size-8 text-red-400"}),e.jsx("h1",{className:"text-4xl font-bold",children:"Priority Inversion"})]}),e.jsxs("p",{className:"text-lg text-gray-300 leading-relaxed",children:["La ",e.jsx("span",{className:"text-red-400 font-semibold",children:"inversión de prioridad"})," ocurre cuando una tarea de alta prioridad se ve forzada a esperar por una tarea de baja prioridad que posee un recurso compartido. Esto puede llevar a que tareas críticas pierdan sus deadlines."]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{className:"bg-red-900/30 border border-red-700/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-red-300 mb-2",children:"⚠️ Problema"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Tarea de alta prioridad bloqueada indefinidamente por tarea de baja prioridad que tiene el lock, mientras tareas de media prioridad ejecutan libremente."})]}),e.jsxs("div",{className:"bg-purple-900/30 border border-purple-700/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-purple-300 mb-2",children:"✅ Soluciones"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Priority inheritance, priority ceiling, desactivar prioridades temporalmente, o evitar compartir recursos entre tareas de diferentes prioridades."})]})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs(Da,{type:"multiple",defaultValue:["pseudocodigos","demos"],className:"space-y-4",children:[e.jsxs(sa,{value:"pseudocodigos",className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(ra,{className:"text-xl font-bold px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Pseudocódigos de las Soluciones"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"ps-inheritance",className:"px-6 pb-6",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs(Qt,{className:"grid grid-cols-4 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"ps-inheritance",children:"⬆️ Inheritance"}),e.jsx(le,{value:"ps-ceiling",children:"🔝 Ceiling"}),e.jsx(le,{value:"ps-disable",children:"🚫 Disable"}),e.jsx(le,{value:"ps-avoid",children:"🔒 Avoid"})]})}),e.jsx(ue,{value:"ps-inheritance",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-blue-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-400 mb-4",children:"⬆️ Priority Inheritance Protocol"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"1. Implementación Básica"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura PriorityInheritanceMutex {
  owner: Thread | null           // Dueño actual del mutex
  waitQueue: PriorityQueue<Thread>  // Cola de threads esperando
  locked: booleano = false
  originalPriority: entero | null   // Prioridad original del owner
}

función lock(thread: Thread) {
  si no locked:
    // Caso simple: mutex disponible
    locked = true
    owner = thread
    originalPriority = null
  sino:
    // Mutex ocupado: aplicar priority inheritance
    si thread.priority > owner.priority:
      // Thread con mayor prioridad está esperando
      si originalPriority == null:
        // Guardar prioridad original del owner (primera vez)
        originalPriority = owner.priority
      
      // HERENCIA: elevar prioridad del owner
      owner.priority = thread.priority
      logInheritance(owner, thread.priority)
    
    // Agregar thread a cola de espera
    waitQueue.enqueue(thread)
    thread.block()  // Bloquear thread
}

función unlock(thread: Thread) {
  si thread != owner:
    throw IllegalStateException("Thread no es dueño del mutex")
  
  // Restaurar prioridad original del owner
  si originalPriority != null:
    thread.priority = originalPriority
    originalPriority = null
    logRestore(thread)
  
  // Despertar siguiente thread en espera
  si no waitQueue.isEmpty():
    nextThread = waitQueue.dequeue()
    owner = nextThread
    nextThread.unblock()
  sino:
    locked = false
    owner = null
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"2. Herencia Transitiva (Cadenas)"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Caso: Thread A espera por B, B espera por C
// Solución: C debe heredar prioridad de A (transitivamente)

estructura ChainedInheritanceMutex {
  owner: Thread | null
  waitQueue: PriorityQueue<Thread>
  originalPriority: entero | null
}

función lock(thread: Thread) {
  si no locked:
    locked = true
    owner = thread
    retornar
  
  // Agregar a cola de espera
  waitQueue.enqueue(thread)
  
  // Propagar prioridad a través de la cadena
  si thread.priority > owner.priority:
    propagatePriority(owner, thread.priority)
  
  thread.block()
}

función propagatePriority(thread: Thread, newPriority: entero) {
  si thread.priority >= newPriority:
    retornar  // Ya tiene prioridad suficiente
  
  // Guardar prioridad original (solo primera vez)
  si thread.inheritedPriority == null:
    thread.originalPriority = thread.priority
  
  // Elevar prioridad
  thread.priority = newPriority
  thread.inheritedPriority = newPriority
  logInheritance(thread, newPriority)
  
  // Si este thread está esperando otro mutex, propagar
  si thread.blockingMutex != null:
    mutexOwner = thread.blockingMutex.owner
    si mutexOwner != null:
      propagatePriority(mutexOwner, newPriority)  // RECURSIÓN
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"3. Manejo de Múltiples Mutexes"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura Thread {
  priority: entero
  originalPriority: entero
  ownedMutexes: Set<Mutex>       // Mutexes que posee
  blockingMutex: Mutex | null     // Mutex por el que está bloqueado
}

función unlock(mutex: Mutex, thread: Thread) {
  si thread != mutex.owner:
    throw IllegalStateException()
  
  // Remover de lista de mutexes poseídos
  thread.ownedMutexes.remove(mutex)
  
  // Calcular nueva prioridad efectiva
  nuevaPrioridad = thread.originalPriority
  
  // Buscar la mayor prioridad heredada de otros mutexes
  para cadaMutex en thread.ownedMutexes:
    para cadaWaiter en cadaMutex.waitQueue:
      si cadaWaiter.priority > nuevaPrioridad:
        nuevaPrioridad = cadaWaiter.priority
  
  // Actualizar prioridad del thread
  thread.priority = nuevaPrioridad
  
  // Liberar mutex y despertar siguiente
  si no mutex.waitQueue.isEmpty():
    nextThread = mutex.waitQueue.dequeue()
    mutex.owner = nextThread
    nextThread.ownedMutexes.add(mutex)
    nextThread.unblock()
  sino:
    mutex.locked = false
    mutex.owner = null
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"4. Ejemplo de Uso"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Configuración de threads
threadAlta = new Thread(id: 1, priority: 10)   // Alta prioridad
threadMedia = new Thread(id: 2, priority: 5)   // Media prioridad
threadBaja = new Thread(id: 3, priority: 1)    // Baja prioridad

mutex = new PriorityInheritanceMutex()

// Ejecución simulada
función simulacion() {
  // T3 (baja) adquiere el mutex
  mutex.lock(threadBaja)
  logState("T3 tiene mutex, prioridad = 1")
  
  // T2 (media) comienza a ejecutar (sin necesitar mutex)
  schedule(threadMedia)
  
  // T1 (alta) intenta adquirir mutex
  mutex.lock(threadAlta)
  // ¡INHERITANCE! T3 ahora tiene prioridad 10
  logState("T3 hereda prioridad 10 de T1")
  
  // T3 con prioridad 10 expulsa a T2 y termina
  schedule(threadBaja)  // Ahora con prioridad heredada
  mutex.unlock(threadBaja)
  logState("T3 libera mutex, prioridad restaurada a 1")
  
  // T1 despierta y obtiene mutex
  schedule(threadAlta)
  logState("T1 obtiene mutex y ejecuta")
}`})]}),e.jsx("div",{className:"p-4 bg-blue-900/30 border border-blue-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Ventajas:"})," Previene inversión de prioridad sin conocimiento previo de las prioridades. Dinámico y flexible.",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"Desventajas:"})," Overhead en tiempo de ejecución, complejidad en cadenas de herencia, puede causar efectos dominó."]})}),e.jsx("div",{className:"p-4 bg-blue-900/30 border border-blue-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," RTOS (FreeRTOS, VxWorks), sistemas embebidos, control industrial, robótica, aviación, Mars Pathfinder (bug famoso)."]})})]})]})}),e.jsx(ue,{value:"ps-ceiling",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-green-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-green-400 mb-4",children:"🔝 Priority Ceiling Protocol"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"1. Implementación Básica"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura PriorityCeilingMutex {
  owner: Thread | null
  waitQueue: PriorityQueue<Thread>
  locked: booleano = false
  ceiling: entero                    // TECHO DE PRIORIDAD (fijo)
}

// El ceiling se establece al crear el mutex
función crearMutex(recursosCompartidos: Array<Thread>) -> PriorityCeilingMutex {
  // Ceiling = mayor prioridad de todos los threads que usarán el mutex
  maxPriority = 0
  para thread en recursosCompartidos:
    si thread.priority > maxPriority:
      maxPriority = thread.priority
  
  retornar new PriorityCeilingMutex(ceiling: maxPriority)
}

función lock(thread: Thread, mutex: PriorityCeilingMutex) {
  // Verificar si el thread puede adquirir el mutex
  si no mutex.locked:
    // Verificar que no haya deadlock potencial
    si thread.priority > systemCeiling():
      throw PriorityCeilingViolation()
    
    mutex.locked = true
    mutex.owner = thread
    
    // ELEVAR prioridad del thread al ceiling del mutex
    thread.originalPriority = thread.priority
    thread.priority = mutex.ceiling
    logCeilingApplied(thread, mutex.ceiling)
  sino:
    // Mutex ocupado: esperar
    mutex.waitQueue.enqueue(thread)
    thread.block()
}

función unlock(mutex: PriorityCeilingMutex) {
  thread = currentThread()
  si thread != mutex.owner:
    throw IllegalStateException()
  
  // RESTAURAR prioridad original
  thread.priority = thread.originalPriority
  logPriorityRestored(thread)
  
  // Liberar mutex
  si no mutex.waitQueue.isEmpty():
    nextThread = mutex.waitQueue.dequeue()
    mutex.owner = nextThread
    nextThread.originalPriority = nextThread.priority
    nextThread.priority = mutex.ceiling  // Elevar al ceiling
    nextThread.unblock()
  sino:
    mutex.locked = false
    mutex.owner = null
}

función systemCeiling() -> entero {
  // Ceiling del sistema = máximo ceiling de mutexes actualmente locked
  maxCeiling = 0
  para mutex en todosLosMutexes:
    si mutex.locked Y mutex.ceiling > maxCeiling:
      maxCeiling = mutex.ceiling
  retornar maxCeiling
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"2. Immediate Ceiling Priority Protocol (ICPP)"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Variante: elevar prioridad INMEDIATAMENTE al hacer lock
// No esperar a que otro thread de mayor prioridad intente acceder

estructura ICPPMutex {
  ceiling: entero
  owner: Thread | null
  locked: booleano = false
}

función lock(thread: Thread, mutex: ICPPMutex) {
  // Verificar system ceiling para prevenir deadlock
  currentSystemCeiling = systemCeiling()
  
  si currentSystemCeiling > thread.priority:
    // No puede adquirir: hay un mutex con ceiling mayor locked
    throw CeilingViolation("System ceiling too high")
  
  // Esperar si está locked
  mientras mutex.locked:
    thread.waitFor(mutex)
  
  // Adquirir mutex
  mutex.locked = true
  mutex.owner = thread
  
  // INMEDIATAMENTE elevar a ceiling (antes de crítica)
  thread.originalPriority = thread.priority
  thread.priority = mutex.ceiling
  
  logICPP("Thread " + thread.id + " elevado a ceiling " + mutex.ceiling)
}

función unlock(mutex: ICPPMutex) {
  thread = currentThread()
  
  // Restaurar prioridad original
  thread.priority = thread.originalPriority
  
  // Liberar mutex
  mutex.locked = false
  mutex.owner = null
  
  // Despertar threads esperando
  notifyWaiters(mutex)
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"3. Original Ceiling Priority Protocol (OCPP)"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Variante original: thread solo puede hacer lock si su prioridad
// es MAYOR que todos los ceilings de mutexes actualmente locked

estructura OCPPMutex {
  ceiling: entero
  owner: Thread | null
  locked: booleano = false
}

función canLock(thread: Thread, mutex: OCPPMutex) -> booleano {
  si mutex.locked Y mutex.owner == thread:
    retornar true  // Reentrant lock
  
  // Verificar contra system ceiling
  sysceiling = systemCeiling()
  
  // Thread debe tener prioridad > system ceiling
  retornar thread.priority > sysceiling
}

función lock(thread: Thread, mutex: OCPPMutex) {
  mientras true:
    si no mutex.locked:
      si canLock(thread, mutex):
        // Puede adquirir el mutex
        mutex.locked = true
        mutex.owner = thread
        
        // Elevar a ceiling del mutex
        thread.originalPriority = thread.priority
        thread.priority = max(thread.priority, mutex.ceiling)
        retornar
      sino:
        // No puede adquirir: prioridad insuficiente
        thread.block()
    sino:
      // Mutex ocupado: esperar
      thread.waitFor(mutex)
}

// Ejemplo de ceilings
función ejemploCeilings() {
  // Tres threads con prioridades 10, 5, 1
  T1 = new Thread(priority: 10)  // Alta
  T2 = new Thread(priority: 5)   // Media
  T3 = new Thread(priority: 1)   // Baja
  
  // Dos recursos compartidos
  // R1: usado por T1 y T3 -> ceiling = 10
  // R2: usado por T2 y T3 -> ceiling = 5
  R1 = new OCPPMutex(ceiling: 10)
  R2 = new OCPPMutex(ceiling: 5)
  
  // Si T3 tiene R2 (ceiling 5), T1 puede adquirir R1
  // porque priority(T1)=10 > systemCeiling(R2)=5
  
  // Si T3 tiene R1 (ceiling 10), T2 NO puede adquirir R2
  // porque priority(T2)=5 < systemCeiling(R1)=10
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"4. Comparación de Variantes"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`tabla ComparacionProtocolos:

| Aspecto              | ICPP                    | OCPP                    |
|---------------------|-------------------------|-------------------------|
| Cuándo eleva        | Inmediato al lock       | Solo si necesario       |
| Chequeo previo      | System ceiling simple   | Ceiling más estricto    |
| Bloqueos            | Menos frecuentes        | Más frecuentes          |
| Cambios prioridad   | Más frecuentes          | Menos frecuentes        |
| Complejidad         | Más simple              | Más compleja            |
| Overhead            | Moderado                | Menor                   |
| Deadlock prevention | Más agresiva            | Más conservadora        |

función elegirProtocolo(requisitos: Requisitos) -> Protocolo {
  si requisitos.latenciaCritica:
    retornar ICPP  // Menor jitter, más predecible
  sino si requisitos.eficienciaEnergia:
    retornar OCPP  // Menos cambios de prioridad
  sino:
    retornar ICPP  // Default: más simple y robusto
}`})]}),e.jsx("div",{className:"p-4 bg-green-900/30 border border-green-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-200",children:[e.jsx("span",{className:"font-bold",children:"Ventajas:"})," Previene deadlocks, acotamiento en tiempo de bloqueo, análisis estático posible, predecible para hard real-time.",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"Desventajas:"})," Requiere conocimiento a priori de prioridades, puede elevar prioridad innecesariamente, menos flexible que inheritance."]})}),e.jsx("div",{className:"p-4 bg-green-900/30 border border-green-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," Sistemas hard real-time, aviación crítica (DO-178C), sistemas médicos, automotriz (AUTOSAR), análisis WCET, certificación safety-critical."]})})]})]})}),e.jsx(ue,{value:"ps-disable",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-purple-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-400 mb-4",children:"🚫 Disable Priority Scheduling"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"1. Desactivación de Interrupciones"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura DisableInterruptsMutex {
  locked: booleano = false
  owner: Thread | null
  savedInterruptState: booleano
}

función lock(mutex: DisableInterruptsMutex) {
  // Desactivar interrupciones (hardware)
  mutex.savedInterruptState = getInterruptState()
  disableInterrupts()  // CLI en x86, CPSID en ARM
  
  // Adquirir mutex (sin competencia ahora)
  mientras mutex.locked:
    spin()  // Busy-wait (no hay preemption)
  
  mutex.locked = true
  mutex.owner = currentThread()
  
  logDisabled("Interrupts disabled, mutex acquired")
}

función unlock(mutex: DisableInterruptsMutex) {
  si currentThread() != mutex.owner:
    throw IllegalStateException()
  
  // Liberar mutex
  mutex.locked = false
  mutex.owner = null
  
  // RESTAURAR interrupciones al estado previo
  si mutex.savedInterruptState:
    enableInterrupts()  // STI en x86, CPSIE en ARM
  
  logEnabled("Interrupts restored")
}

// Uso típico en sección crítica corta
función criticalSection() {
  disableInterruptsMutex.lock()
  intentar:
    // Sección crítica (MUY CORTA - pocos microsegundos)
    sharedData.update()
  finalmente:
    disableInterruptsMutex.unlock()
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"2. Desactivación de Preemption"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura NonPreemptiveMutex {
  locked: booleano = false
  owner: Thread | null
  savedPreemptionState: booleano
}

función lock(mutex: NonPreemptiveMutex) {
  // Desactivar preemption (scheduler no cambiará de thread)
  mutex.savedPreemptionState = isPreemptionEnabled()
  disablePreemption()
  
  // Adquirir mutex
  mientras mutex.locked:
    // Si está locked, tenemos problema (no deberíamos estar aquí)
    // porque preemption está desactivada
    panic("Deadlock: mutex locked with preemption disabled")
  
  mutex.locked = true
  mutex.owner = currentThread()
  
  logNonPreemptive("Preemption disabled, mutex acquired")
}

función unlock(mutex: NonPreemptiveMutex) {
  si currentThread() != mutex.owner:
    throw IllegalStateException()
  
  // Liberar mutex
  mutex.locked = false
  mutex.owner = null
  
  // Restaurar preemption
  si mutex.savedPreemptionState:
    enablePreemption()
    // Puede haber cambio de contexto aquí si hay thread de mayor prioridad listo
  
  logPreemptionEnabled("Preemption restored")
}

// API típica de kernel
función kernel_disable_preemption() {
  currentCPU().preemption_count++
}

función kernel_enable_preemption() {
  currentCPU().preemption_count--
  si currentCPU().preemption_count == 0:
    si need_resched():
      schedule()  // Cambiar a thread de mayor prioridad
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"3. Priority Boosting Temporal"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Alternativa: elevar temporalmente a prioridad máxima

estructura TemporaryBoostMutex {
  locked: booleano = false
  owner: Thread | null
  maxPriority: entero = 999  // Prioridad máxima del sistema
}

función lock(mutex: TemporaryBoostMutex) {
  thread = currentThread()
  
  // Guardar prioridad original
  originalPriority = thread.priority
  
  // BOOST: elevar a prioridad máxima
  thread.priority = mutex.maxPriority
  logBoost("Thread boosted to max priority")
  
  // Adquirir mutex (ahora con máxima prioridad)
  mientras mutex.locked:
    yield()  // Ceder CPU pero mantener alta prioridad
  
  mutex.locked = true
  mutex.owner = thread
  thread.savedPriority = originalPriority
}

función unlock(mutex: TemporaryBoostMutex) {
  thread = currentThread()
  si thread != mutex.owner:
    throw IllegalStateException()
  
  // Liberar mutex
  mutex.locked = false
  mutex.owner = null
  
  // Restaurar prioridad original
  thread.priority = thread.savedPriority
  logRestore("Priority restored")
  
  // Puede haber cambio de contexto si otro thread tiene mayor prioridad
  yield()
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"4. Non-Preemptive Critical Section"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Enfoque más simple: sección crítica no interrumpible

macro ENTER_CRITICAL_SECTION() {
  cli()  // Clear Interrupt Flag
  preempt_disable()
}

macro EXIT_CRITICAL_SECTION() {
  preempt_enable()
  sti()  // Set Interrupt Flag
}

// Uso en código
función actualizarRecursoCompartido() {
  ENTER_CRITICAL_SECTION()
  
  // Código crítico - NO SE PUEDE INTERRUMPIR
  recursoCompartido.valor++
  recursoCompartido.timestamp = getTime()
  recursoCompartido.checksum = calcularChecksum()
  
  EXIT_CRITICAL_SECTION()
}

// Variante con spinlock
estructura CriticalSection {
  spinlock: AtomicBoolean = false
}

función enter(cs: CriticalSection) {
  disablePreemption()
  
  // Spinlock para multicore
  mientras no cs.spinlock.compareAndSwap(false, true):
    spin()  // Busy-wait
}

función exit(cs: CriticalSection) {
  cs.spinlock.set(false)
  enablePreemption()
}`})]}),e.jsx("div",{className:"p-4 bg-purple-900/30 border border-purple-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-purple-200",children:[e.jsx("span",{className:"font-bold",children:"Ventajas:"})," Solución simple y efectiva, muy bajo overhead, no hay inversión de prioridad posible, predecible.",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"Desventajas:"})," Aumenta latencia de interrupciones, no escalable, solo para secciones críticas MUY cortas (< 100μs), problemas en multicore."]})}),e.jsx("div",{className:"p-4 bg-purple-900/30 border border-purple-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-purple-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," Kernels de OS (Linux, Windows), drivers de dispositivos, secciones críticas de hardware, inicialización de sistema, manejo de errores críticos."]})})]})]})}),e.jsx(ue,{value:"ps-avoid",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-yellow-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-4",children:"🔒 Evitar Compartir Recursos"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"1. Thread-Local Storage"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Cada thread tiene su propia copia de los datos

estructura ThreadLocalStorage<T> {
  storage: Map<ThreadID, T>
  mutex: Lock
  initializer: Function<T>
}

función get() -> T {
  threadId = currentThread().id
  
  si no storage.contains(threadId):
    mutex.lock()
    intentar:
      // Double-check locking
      si no storage.contains(threadId):
        valor = initializer()
        storage[threadId] = valor
    finalmente:
      mutex.unlock()
  
  retornar storage[threadId]  // Sin lock: cada thread su copia
}

función set(valor: T) {
  threadId = currentThread().id
  mutex.lock()
  intentar:
    storage[threadId] = valor
  finalmente:
    mutex.unlock()
}

// Ejemplo: buffer de logs por thread
threadLocalBuffer = new ThreadLocalStorage<LogBuffer>(
  initializer: función() {
    retornar new LogBuffer(size: 1024)
  }
)

función log(mensaje: String) {
  buffer = threadLocalBuffer.get()  // Sin contención
  buffer.append(mensaje)            // Sin locks
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"2. Message Passing (Actor Model)"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Threads no comparten memoria: se comunican por mensajes

estructura Actor {
  id: ActorID
  mailbox: Queue<Message>  // Solo este actor accede su mailbox
  state: Estado            // Estado privado (no compartido)
}

función send(destino: ActorID, mensaje: Message) {
  actor = actors.get(destino)
  actor.mailbox.enqueue(mensaje)  // Queue thread-safe
}

función processMessages() {
  mientras running:
    mensaje = mailbox.dequeue()  // Bloquea si vacío
    
    // Procesar mensaje (sin locks: estado es privado)
    cuando mensaje.type:
      GET_DATA:
        resultado = state.getData()
        send(mensaje.sender, new Response(resultado))
      
      SET_DATA:
        state.setData(mensaje.data)  // Sin locks
        send(mensaje.sender, new Ack())
      
      COMPUTE:
        resultado = state.compute(mensaje.params)
        send(mensaje.sender, new Result(resultado))
}

// Ejemplo: sistema bancario con actors
estructura AccountActor extends Actor {
  balance: entero  // Estado privado
}

función transferencia(origen: ActorID, destino: ActorID, monto: entero) {
  // No hay locks: solo mensajes
  send(origen, new WithdrawMessage(monto, requestId: 1))
  
  // Esperar confirmación
  respuesta = waitForResponse(requestId: 1)
  
  si respuesta.success:
    send(destino, new DepositMessage(monto, requestId: 2))
    waitForResponse(requestId: 2)
  
  // Sin deadlocks: no hay locks compartidos
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"3. Inmutabilidad y Shared-Nothing"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Datos inmutables: pueden compartirse sin locks

estructura InmutableData {
  valores: Array<entero>  // Inmutable después de construcción
  timestamp: entero       // Inmutable
}

// Constructor: única vez que se modifica
función crear(valores: Array<entero>) -> InmutableData {
  copia = copiar(valores)
  retornar new InmutableData(copia, now())
}

// Lecturas sin locks (datos nunca cambian)
función leer(data: InmutableData, indice: entero) -> entero {
  retornar data.valores[indice]  // Sin lock: es inmutable
}

// "Modificación" = crear nueva instancia
función modificar(data: InmutableData, indice: entero, valor: entero) -> InmutableData {
  nuevosValores = copiar(data.valores)
  nuevosValores[indice] = valor
  retornar crear(nuevosValores)  // Nueva instancia
}

// Uso en sistema concurrente
estructura SharedState {
  data: Atomic<InmutableData>  // Referencia atómica
}

función actualizarEstado(state: SharedState, cambio: Cambio) {
  mientras true:
    actual = state.data.get()            // Leer sin lock
    nuevo = aplicarCambio(actual, cambio)  // Crear nuevo
    
    si state.data.compareAndSwap(actual, nuevo):
      break  // Éxito: publicado nuevo estado
    // Fallo: otro thread actualizó, reintentar
}

// Lectura siempre sin locks
función leerEstado(state: SharedState) -> InmutableData {
  retornar state.data.get()  // Atómico, sin locks
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"4. Particionamiento de Datos"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Dividir datos para que cada thread tenga su partición

estructura PartitionedData<T> {
  partitions: Array<Partition<T>>
  numPartitions: entero
}

estructura Partition<T> {
  data: Map<Key, T>
  mutex: Lock  // Lock solo para esta partición
}

función getPartition(key: Key) -> entero {
  retornar hash(key) % numPartitions
}

función get(key: Key) -> T {
  partitionId = getPartition(key)
  partition = partitions[partitionId]
  
  partition.mutex.lock()
  intentar:
    retornar partition.data.get(key)
  finalmente:
    partition.mutex.unlock()
}

función put(key: Key, valor: T) {
  partitionId = getPartition(key)
  partition = partitions[partitionId]
  
  partition.mutex.lock()
  intentar:
    partition.data.put(key, valor)
  finalmente:
    partition.mutex.unlock()
}

// Ventaja: threads accediendo diferentes particiones no compiten

// Ejemplo: cache particionada
función ejemploCache() {
  // 16 particiones para reducir contención
  cache = new PartitionedData<CacheEntry>(numPartitions: 16)
  
  // Thread 1 accede keys con hash 0-3
  // Thread 2 accede keys con hash 4-7
  // Thread 3 accede keys con hash 8-11
  // Thread 4 accede keys con hash 12-15
  
  // Contención solo si dos threads acceden misma partición
  // Probabilidad: 1/16 con buena función hash
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"5. Wait-Free Data Structures"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Estructuras sin locks usando operaciones atómicas

estructura WaitFreeQueue<T> {
  buffer: Array<AtomicReference<T>>
  head: AtomicInteger
  tail: AtomicInteger
  capacity: entero
}

función enqueue(item: T) -> booleano {
  mientras true:
    currentTail = tail.get()
    nextTail = (currentTail + 1) % capacity
    
    si nextTail == head.get():
      retornar false  // Cola llena
    
    // Intentar colocar item
    si buffer[currentTail].compareAndSwap(null, item):
      // Avanzar tail
      tail.compareAndSwap(currentTail, nextTail)
      retornar true
    
    // Otro thread tomó este slot, reintentar
}

función dequeue() -> T {
  mientras true:
    currentHead = head.get()
    
    si currentHead == tail.get():
      retornar null  // Cola vacía
    
    item = buffer[currentHead].get()
    si item != null:
      // Intentar tomar item
      si buffer[currentHead].compareAndSwap(item, null):
        // Avanzar head
        head.compareAndSwap(currentHead, (currentHead + 1) % capacity)
        retornar item
    
    // Reintentar
}

// Sin locks: múltiples producers y consumers sin bloqueo
// Wait-free: cada operación termina en tiempo acotado`})]}),e.jsx("div",{className:"p-4 bg-yellow-900/30 border border-yellow-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Ventajas:"})," Elimina completamente la inversión de prioridad, alta escalabilidad, sin deadlocks, mejor rendimiento en multicore.",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"Desventajas:"})," Mayor uso de memoria, complejidad de diseño, no siempre es posible evitar compartir, overhead de sincronización alternativa."]})}),e.jsx("div",{className:"p-4 bg-yellow-900/30 border border-yellow-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," Sistemas funcionales (Erlang/Elixir), microservicios, bases de datos distribuidas (Cassandra, Riak), sistemas reactivos, event-driven architectures, lock-free data structures (Java concurrent package)."]})})]})]})})]})})]}),e.jsxs(sa,{value:"demos",className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(ra,{className:"text-xl font-bold px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(La,{className:"size-5"}),e.jsx("span",{children:"Demostraciones Interactivas"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"demo-inheritance",className:"px-6 pb-6",children:[e.jsxs(Qt,{className:"grid grid-cols-4 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"demo-inheritance",children:"⬆️ Inheritance"}),e.jsx(le,{value:"demo-ceiling",children:"🔝 Ceiling"}),e.jsx(le,{value:"demo-disable",children:"🚫 Disable"}),e.jsx(le,{value:"demo-avoid",children:"🔒 Avoid"})]}),e.jsx(ue,{value:"demo-inheritance",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-blue-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-400 mb-4",children:"⬆️ Demostración: Priority Inheritance"}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>o(!s),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center gap-2 transition-colors",children:[s?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),s?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:q,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:[n],onValueChange:([R])=>l(R),min:200,max:1500,step:100,className:"w-32"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[n,"ms"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"Estado de los Threads"}),e.jsx("div",{className:"space-y-3",children:d.map(R=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:`font-bold ${R.status==="running"?"text-green-400":R.status==="waiting"?"text-yellow-400":R.status==="blocked"?"text-red-400":R.status==="completed"?"text-blue-400":"text-gray-400"}`,children:["T",R.id," - ",R.id===1?"Alta":R.id===2?"Media":"Baja"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`text-xs ${R.priority!==R.originalPriority?"text-yellow-300 font-bold":"text-gray-400"}`,children:["Prioridad: ",R.originalPriority," → ",R.priority,R.priority!==R.originalPriority&&" (heredada)"]}),R.holdingMutex&&e.jsx("span",{className:"text-xs bg-blue-600 px-2 py-0.5 rounded",children:"🔒 Mutex"}),e.jsx("span",{className:"text-xs text-gray-500",children:R.status==="running"?"🟢 Ejecutando":R.status==="waiting"?"🟡 Esperando":R.status==="blocked"?"🔴 Bloqueado":R.status==="completed"?"✅ Completado":"⚪ Inactivo"})]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${R.status==="running"?"bg-green-500":R.status==="completed"?"bg-blue-500":"bg-gray-600"}`,style:{width:`${R.progress}%`}})})]},R.id))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:k,className:"h-48 overflow-y-auto font-mono text-xs space-y-1",children:h.length===0?e.jsx("div",{className:"text-gray-500 italic",children:'Presiona "Iniciar" para comenzar la simulación...'}):h.map((R,ke)=>e.jsx("div",{className:"text-gray-300",children:R},ke))})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-900/30 border border-blue-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Observa:"})," Cuando T1 (alta) intenta adquirir el mutex ocupado por T3 (baja), T3 hereda la prioridad de T1 dinámicamente, permitiendo completar rápido y ceder el recurso."]})})]})}),e.jsx(ue,{value:"demo-ceiling",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-green-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-green-400 mb-4",children:"🔝 Demostración: Priority Ceiling"}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>v(!b),className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg flex items-center gap-2 transition-colors",children:[b?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),b?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:G,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:[f],onValueChange:([R])=>N(R),min:200,max:1500,step:100,className:"w-32"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[f,"ms"]})]}),e.jsx("div",{className:"px-4 py-2 bg-green-900/50 border border-green-700 rounded-lg",children:e.jsxs("span",{className:"text-sm text-green-300",children:["Mutex Ceiling: ",e.jsx("span",{className:"font-bold",children:z})]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"Estado de los Threads"}),e.jsx("div",{className:"space-y-3",children:j.map(R=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:`font-bold ${R.status==="running"?"text-green-400":R.status==="waiting"?"text-yellow-400":R.status==="blocked"?"text-red-400":R.status==="completed"?"text-blue-400":"text-gray-400"}`,children:["T",R.id," - ",R.id===1?"Alta":R.id===2?"Media":"Baja"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`text-xs ${R.priority!==R.originalPriority?"text-yellow-300 font-bold":"text-gray-400"}`,children:["Prioridad: ",R.originalPriority," → ",R.priority,R.priority===z&&R.holdingMutex&&" (ceiling)"]}),R.holdingMutex&&e.jsx("span",{className:"text-xs bg-green-600 px-2 py-0.5 rounded",children:"🔒 Mutex"}),e.jsx("span",{className:"text-xs text-gray-500",children:R.status==="running"?"🟢 Ejecutando":R.status==="waiting"?"🟡 Esperando":R.status==="blocked"?"🔴 Bloqueado":R.status==="completed"?"✅ Completado":"⚪ Inactivo"})]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${R.status==="running"?"bg-green-500":R.status==="completed"?"bg-blue-500":"bg-gray-600"}`,style:{width:`${R.progress}%`}})})]},R.id))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:K,className:"h-48 overflow-y-auto font-mono text-xs space-y-1",children:w.length===0?e.jsx("div",{className:"text-gray-500 italic",children:'Presiona "Iniciar" para comenzar la simulación...'}):w.map((R,ke)=>e.jsx("div",{className:"text-gray-300",children:R},ke))})]}),e.jsx("div",{className:"mt-4 p-4 bg-green-900/30 border border-green-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-200",children:[e.jsx("span",{className:"font-bold",children:"Observa:"})," T3 es elevada inmediatamente al ceiling del mutex (10) al adquirirlo, previniendo que T2 la interrumpa. Esto evita la inversión de prioridad de forma proactiva."]})})]})}),e.jsx(ue,{value:"demo-disable",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-purple-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-400 mb-4",children:"🚫 Demostración: Disable Preemption"}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>V(!P),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg flex items-center gap-2 transition-colors",children:[P?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),P?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:be,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:[Z],onValueChange:([R])=>oe(R),min:200,max:1500,step:100,className:"w-32"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[Z,"ms"]})]}),e.jsx("div",{className:`px-4 py-2 border rounded-lg ${ne?"bg-green-900/50 border-green-700 text-green-300":"bg-red-900/50 border-red-700 text-red-300"}`,children:e.jsxs("span",{className:"text-sm font-bold",children:["Preemption: ",ne?"✅ Activa":"🚫 Desactivada"]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"Estado de los Threads"}),e.jsx("div",{className:"space-y-3",children:O.map(R=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:`font-bold ${R.status==="running"?"text-green-400":R.status==="waiting"?"text-yellow-400":R.status==="blocked"?"text-red-400":R.status==="completed"?"text-blue-400":"text-gray-400"}`,children:["T",R.id," - ",R.id===1?"Alta":R.id===2?"Media":"Baja"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:["Prioridad: ",R.priority]}),R.holdingMutex&&e.jsx("span",{className:"text-xs bg-purple-600 px-2 py-0.5 rounded",children:"🔒 Sección Crítica"}),e.jsx("span",{className:"text-xs text-gray-500",children:R.status==="running"?"🟢 Ejecutando":R.status==="waiting"?"🟡 Esperando":R.status==="blocked"?"🔴 Bloqueado":R.status==="completed"?"✅ Completado":"⚪ Inactivo"})]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${R.status==="running"?"bg-green-500":R.status==="completed"?"bg-blue-500":"bg-gray-600"}`,style:{width:`${R.progress}%`}})})]},R.id))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:M,className:"h-48 overflow-y-auto font-mono text-xs space-y-1",children:ge.length===0?e.jsx("div",{className:"text-gray-500 italic",children:'Presiona "Iniciar" para comenzar la simulación...'}):ge.map((R,ke)=>e.jsx("div",{className:"text-gray-300",children:R},ke))})]}),e.jsx("div",{className:"mt-4 p-4 bg-purple-900/30 border border-purple-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-purple-200",children:[e.jsx("span",{className:"font-bold",children:"Observa:"})," Cuando T3 entra a su sección crítica, desactiva la preemption, haciendo imposible que T1 o T2 la interrumpan. Esto elimina completamente la inversión de prioridad."]})})]})}),e.jsx(ue,{value:"demo-avoid",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-yellow-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-4",children:"🔒 Demostración: Evitar Compartir Recursos"}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>Le(!Ce),className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded-lg flex items-center gap-2 transition-colors",children:[Ce?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),Ce?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:Ne,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:[I],onValueChange:([R])=>Q(R),min:200,max:1500,step:100,className:"w-32"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[I,"ms"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"Threads con Datos Locales (Thread-Local Storage)"}),e.jsx("div",{className:"space-y-3",children:F.map(R=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:`font-bold ${R.status==="running"?"text-green-400":R.status==="completed"?"text-blue-400":"text-gray-400"}`,children:["T",R.id," - Prioridad ",R.priority]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs bg-yellow-600 px-2 py-0.5 rounded",children:"📦 Datos Propios"}),e.jsx("span",{className:"text-xs text-gray-500",children:R.status==="running"?"🟢 Ejecutando":R.status==="completed"?"✅ Completado":"⚪ Inactivo"})]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${R.status==="running"?"bg-green-500":R.status==="completed"?"bg-blue-500":"bg-gray-600"}`,style:{width:`${R.progress}%`}})})]},R.id))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"Message Passing (Actor Model)"}),e.jsxs("div",{className:"h-32 flex items-center justify-around relative",children:[F.map(R=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:`w-16 h-16 rounded-full border-2 flex items-center justify-center font-bold text-lg ${R.status==="running"?"bg-green-600 border-green-400":R.status==="completed"?"bg-blue-600 border-blue-400":"bg-gray-700 border-gray-500"}`,children:["T",R.id]}),e.jsxs("span",{className:"text-xs text-gray-400 mt-1",children:["P:",R.priority]})]},R.id)),$.map((R,ke)=>e.jsxs("div",{className:"absolute top-8 text-xs bg-yellow-600 px-2 py-1 rounded animate-pulse",style:{left:`${R.from*30+10}%`,transform:"translateX(-50%)"},children:["📨 ",R.msg]},ke))]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:D,className:"h-48 overflow-y-auto font-mono text-xs space-y-1",children:ze.length===0?e.jsx("div",{className:"text-gray-500 italic",children:'Presiona "Iniciar" para comenzar la simulación...'}):ze.map((R,ke)=>e.jsx("div",{className:"text-gray-300",children:R},ke))})]}),e.jsx("div",{className:"mt-4 p-4 bg-yellow-900/30 border border-yellow-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Observa:"})," Cada thread trabaja con sus propios datos locales, sin necesidad de locks ni sincronización. La comunicación se hace por mensajes, eliminando completamente la posibilidad de inversión de prioridad."]})})]})})]})})]})]})})]})}const KR=Sa("/ActividadesSeminarioSO/actividad11/priority-inversion")({component:WR});function YR(){const[s,o]=c.useState(!1),[n,l]=c.useState(1e3),[d,m]=c.useState({x:0,y:0,flag:0}),[h,x]=c.useState({r1:0,r2:0}),[g,b]=c.useState({r3:0,r4:0}),[v,f]=c.useState(["🚧 Sistema de Memory Fences inicializado"]),[,N]=c.useState(0),[j,_]=c.useState(!1),[w,C]=c.useState(1e3),[E,z]=c.useState(0),[P,V]=c.useState(0),[Z,oe]=c.useState(null),[O,T]=c.useState(["💫 Sistema Volatile inicializado"]),[,ge]=c.useState(0),[J,W]=c.useState(!1),[ne,Ee]=c.useState(1e3),[Ce,Le]=c.useState([0,0,0,0]),[I,Q]=c.useState(0),[F,de]=c.useState(0),[ze,A]=c.useState(["🔄 Ring Buffer con Acquire/Release inicializado"]),[,$]=c.useState(0),[se,k]=c.useState(!1),[K,M]=c.useState(1e3),[D,q]=c.useState(0),[G,be]=c.useState(0),[Ne,R]=c.useState(null),[ke,je]=c.useState(null),[ee,ae]=c.useState(["📊 Sistema Sequential Consistency inicializado"]),[,rt]=c.useState(0),[jt,xe]=c.useState(!1),[Me,De]=c.useState(1e3),[Ge,qe]=c.useState([]),[Se,Xe]=c.useState([]),[We,xt]=c.useState(["🔗 Sistema Happens-Before inicializado"]),[,Ot]=c.useState(0),[It,Ue]=c.useState(!1),[At,et]=c.useState(1e3),[L,re]=c.useState(0),[Ve,ce]=c.useState(0),[Te,_t]=c.useState(0),[St,tt]=c.useState(["⚛️ Contador Atómico inicializado"]),[,Ye]=c.useState(0),ft=c.useRef(null),Ct=c.useRef(null),ve=c.useRef(null),gt=c.useRef(null),$e=c.useRef(null),B=c.useRef(null);c.useEffect(()=>{ft.current&&(ft.current.scrollTop=ft.current.scrollHeight)},[v]),c.useEffect(()=>{Ct.current&&(Ct.current.scrollTop=Ct.current.scrollHeight)},[O]),c.useEffect(()=>{ve.current&&(ve.current.scrollTop=ve.current.scrollHeight)},[ze]),c.useEffect(()=>{gt.current&&(gt.current.scrollTop=gt.current.scrollHeight)},[ee]),c.useEffect(()=>{$e.current&&($e.current.scrollTop=$e.current.scrollHeight)},[We]),c.useEffect(()=>{B.current&&(B.current.scrollTop=B.current.scrollHeight)},[St]),c.useEffect(()=>{if(!s)return;const pt=setInterval(()=>{N(zt=>{const lt=zt+1;return lt===1?(f(Be=>[...Be,"🔵 Thread 1: x = 1"]),m(Be=>({...Be,x:1}))):lt===2?f(Be=>[...Be,"🔵 Thread 1: fence_release()"]):lt===3?(f(Be=>[...Be,"🔵 Thread 1: flag = 1"]),m(Be=>({...Be,flag:1}))):lt===4?(f(Be=>[...Be,"🔴 Thread 2: r1 = flag (lee 1)"]),b({r3:1,r4:0})):lt===5?f(Be=>[...Be,"🔴 Thread 2: fence_acquire()"]):lt===6?(f(Be=>[...Be,"🔴 Thread 2: r2 = x (lee 1)"]),b({r3:1,r4:1})):lt===7&&(f(Be=>[...Be,"✅ Gracias a las fences, Thread 2 ve x=1","Sin fences, podría ver x=0 (reordenamiento)"]),o(!1)),lt})},n);return()=>clearInterval(pt)},[s,n]),c.useEffect(()=>{if(!j)return;const pt=setInterval(()=>{ge(zt=>{const lt=zt+1;return lt===1?(T(Be=>[...Be,"🔵 Writer: data = 42"]),V(42)):lt===2?(T(Be=>[...Be,"🔵 Writer: volatile flag = 1 (release)"]),z(1)):lt===3?T(Be=>[...Be,"🔴 Reader: lee volatile flag (acquire)"]):lt===4?T(Be=>[...Be,"🔴 Reader: flag == 1, procede a leer data"]):lt===5?(T(Be=>[...Be,`🔴 Reader: data = ${P}`]),oe(42)):lt===6&&(T(Be=>[...Be,"✅ Volatile garantiza que Reader ve data=42","Sin volatile, podría ver data=0 (cached)"]),_(!1)),lt})},w);return()=>clearInterval(pt)},[j,w,P]),c.useEffect(()=>{if(!J)return;const pt=setInterval(()=>{$(zt=>{const lt=zt+1;if(lt===1){A(Ie=>[...Ie,"🔵 Producer: produce(100)"]);const Be=(F+1)%4;Le(Ie=>{const Je=[...Ie];return Je[F]=100,Je}),de(Be)}else if(lt===2)A(Be=>[...Be,"🔵 Producer: tail.store(1, release)"]);else if(lt===3)A(Be=>[...Be,"🔴 Consumer: head.load(acquire)"]);else if(lt===4){A(Ie=>[...Ie,`🔴 Consumer: consume() → ${Ce[I]}`]);const Be=(I+1)%4;Q(Be)}else if(lt===5){A(Ie=>[...Ie,"🔵 Producer: produce(200)"]);const Be=(F+1)%4;Le(Ie=>{const Je=[...Ie];return Je[F]=200,Je}),de(Be)}else if(lt===6){A(Ie=>[...Ie,"🔴 Consumer: consume() → 200"]);const Be=(I+1)%4;Q(Be)}else lt===7&&(A(Be=>[...Be,"✅ Acquire/Release garantiza orden sin fences completas"]),W(!1));return lt})},ne);return()=>clearInterval(pt)},[J,ne,F,I,Ce]),c.useEffect(()=>{if(!se)return;const pt=setInterval(()=>{rt(zt=>{const lt=zt+1;return lt===1?(ae(Be=>[...Be,"🔵 Thread 1: x = 1"]),q(1)):lt===2?(ae(Be=>[...Be,"🔴 Thread 2: y = 1"]),be(1)):lt===3?(ae(Be=>[...Be,"🔵 Thread 1: r1 = y"]),R(G)):lt===4?(ae(Be=>[...Be,"🔴 Thread 2: r2 = x"]),je(D)):lt===5?ae(Be=>[...Be,`📊 Resultados: r1=${Ne}, r2=${ke}`]):lt===6&&(ae(Ne===0&&ke===0?Be=>[...Be,"❌ r1=0 y r2=0 IMPOSIBLE en Sequential Consistency","Debe existir un orden total que respete program order"]:Be=>[...Be,"✅ Resultado válido en Sequential Consistency"]),k(!1)),lt})},K);return()=>clearInterval(pt)},[se,K,D,G,Ne,ke]),c.useEffect(()=>{if(!jt)return;const pt=setInterval(()=>{Ot(zt=>{const lt=zt+1;if(lt===1){const Be={id:1,thread:1,type:"WRITE",variable:"x",value:1,timestamp:Date.now()};qe([Be]),xt(Ie=>[...Ie,"🔵 T1: W(x, 1) [E1]"])}else if(lt===2)Xe([[1,2]]),xt(Be=>[...Be,"→ Program order: E1 -> E2"]);else if(lt===3){const Be={id:2,thread:1,type:"WRITE",variable:"flag",value:1,timestamp:Date.now()};qe(Ie=>[...Ie,Be]),xt(Ie=>[...Ie,"🔵 T1: W(flag, 1) [E2] (release)"])}else if(lt===4){const Be={id:3,thread:2,type:"READ",variable:"flag",value:1,timestamp:Date.now()};qe(Ie=>[...Ie,Be]),xt(Ie=>[...Ie,"🔴 T2: R(flag) = 1 [E3] (acquire)"]),Xe(Ie=>[...Ie,[2,3]])}else if(lt===5)xt(Be=>[...Be,"→ Synchronizes-with: E2 -> E3"]);else if(lt===6){const Be={id:4,thread:2,type:"READ",variable:"x",value:1,timestamp:Date.now()};qe(Ie=>[...Ie,Be]),xt(Ie=>[...Ie,"🔴 T2: R(x) = 1 [E4]"]),Xe(Ie=>[...Ie,[3,4]])}else lt===7&&(xt(Be=>[...Be,"→ Program order: E3 -> E4","🔗 Happens-before: E1 -> E2 -> E3 -> E4","✅ E4 ve el write de E1 (guaranteed)"]),xe(!1));return lt})},Me);return()=>clearInterval(pt)},[jt,Me]),c.useEffect(()=>{if(!It)return;const pt=setInterval(()=>{Ye(zt=>{const lt=zt+1;return lt===1?(tt(Be=>[...Be,"🔵 Thread 1: CAS(0 → 1)"]),ce(1),re(1)):lt===2?tt(Be=>[...Be,"✅ Thread 1: CAS exitoso, counter = 1"]):lt===3?(tt(Be=>[...Be,"🔴 Thread 2: CAS(0 → 1)"]),_t(1)):lt===4?tt(Be=>[...Be,"❌ Thread 2: CAS falló (counter ya es 1)"]):lt===5?(tt(Be=>[...Be,"🔴 Thread 2: reintenta CAS(1 → 2)"]),_t(2),re(2)):lt===6?tt(Be=>[...Be,"✅ Thread 2: CAS exitoso, counter = 2"]):lt===7?(tt(Be=>[...Be,"🔵 Thread 1: CAS(1 → 2)","❌ Thread 1: CAS falló (counter ya es 2)"]),ce(2)):lt===8&&(tt(Be=>[...Be,"✅ CAS garantiza atomicidad de read-modify-write",`Final counter: ${L}`]),Ue(!1)),lt})},At);return()=>clearInterval(pt)},[It,At,L]);const U=()=>{o(!1),N(0),m({x:0,y:0,flag:0}),x({r1:0,r2:0}),b({r3:0,r4:0}),f(["🚧 Sistema reinicializado"])},Dt=()=>{_(!1),ge(0),z(0),V(0),oe(null),T(["💫 Sistema reinicializado"])},Ke=()=>{W(!1),$(0),Le([0,0,0,0]),Q(0),de(0),A(["🔄 Ring Buffer reinicializado"])},fe=()=>{k(!1),rt(0),q(0),be(0),R(null),je(null),ae(["📊 Sistema reinicializado"])},$t=()=>{xe(!1),Ot(0),qe([]),Xe([]),xt(["🔗 Sistema reinicializado"])},Zt=()=>{Ue(!1),Ye(0),re(0),ce(0),_t(0),tt(["⚛️ Contador reinicializado"])};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(La,{className:"size-8 text-amber-400"}),e.jsx("h1",{className:"text-4xl font-bold",children:"Memory Consistency — Pseudocódigos"})]}),e.jsx("p",{className:"text-lg text-gray-300 leading-relaxed",children:"Colección de pseudocódigos para las técnicas principales que garantizan consistencia de memoria en programación concurrente: barreras, variables volátiles, adquisición/liberación, consistencia secuencial, relaciones happens-before y operaciones atómicas."})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs(Da,{type:"multiple",defaultValue:["pseudocodigos","demos"],className:"space-y-4",children:[e.jsxs(sa,{value:"pseudocodigos",className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(ra,{className:"text-xl font-bold px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Pseudocódigos"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"fences",className:"px-6 pb-6",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs(Qt,{className:"grid grid-cols-6 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"fences",children:"Memory Barriers / Fences"}),e.jsx(le,{value:"volatile",children:"Volatile Variables"}),e.jsx(le,{value:"acqrel",children:"Acquire / Release"}),e.jsx(le,{value:"seq",children:"Sequential Consistency"}),e.jsx(le,{value:"happens",children:"Happens-Before"}),e.jsx(le,{value:"atomic",children:"Atomic Operations"})]})}),e.jsx(ue,{value:"fences",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-sky-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-sky-400 mb-4",children:"Memory Barriers / Fences"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-sky-300 mb-2",children:"Concepto"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Una fence es una instrucción que impone un orden entre operaciones de memoria; evita reordenamientos por el compilador o la CPU. Hay fences de lectura, escritura y completas."})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-sky-300 mb-2",children:"Pseudocódigo — abstracción de fences"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Definición abstracta de barreras
func fence_acquire() {
  // Garantiza que las lecturas posteriores no se muevan antes de esta instrucción
  CPU.memoryFenceAcquire()
}

func fence_release() {
  // Garantiza que las escrituras previas sean visibles antes de las escrituras posteriores
  CPU.memoryFenceRelease()
}

func fence_full() {
  // Barrera completa: no reordenar ni lecturas ni escrituras a través de la barrera
  CPU.memoryFenceFull()
}

// Uso típico: implementación de un spinlock simple
estructura SpinLock { locked: Atomic<int> }

func lock(l: SpinLock) {
  while (!l.locked.compareAndSwap(0, 1)) {
    // busy-wait
  }
  // A partir de aquí, las lecturas/escrituras posteriores deben ver el estado protegido
  fence_acquire()  // Asegura que lecturas posteriores no se muevan antes del lock
}

func unlock(l: SpinLock) {
  // Asegurar que todas las escrituras dentro del lock sean visibles antes de liberar
  fence_release()
  l.locked.store(0)
}

// Nota: dependiendo de la plataforma, fence_acquire/fence_release pueden mapear a
// LDAR/STLR (ARM) o a instrucciones de compilador como atomic_thread_fence(memory_order_acquire)
`})]}),e.jsx("div",{className:"bg-sky-900/20 p-3 rounded",children:e.jsx("p",{className:"text-sm text-sky-100",children:"Ventajas: control fino del orden de memoria; esencial en implementaciones lock-free. Desventajas: propenso a errores si se usan incorrectamente; diferencias entre arquitecturas."})})]})]})}),e.jsx(ue,{value:"volatile",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-emerald-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-emerald-400 mb-4",children:"Volatile Variables"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-emerald-300 mb-2",children:"Concepto"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Una variable marcada como volatile garantiza que las lecturas y escrituras se hagan directamente en memoria (no caché de CPU o registros), y a menudo impone restricciones de reordenamiento por el compilador. Semánticas concretas dependen del lenguaje."})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-emerald-300 mb-2",children:"Pseudocódigo — Java/C# style"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Java: volatile garantiza visibilidad y prohibits certain reorderings
volatile int flag = 0

// Thread 1
func writer() {
  data = 42
  // publicar dato antes de señalar flag
  flag = 1  // write to volatile: flush stores
}

// Thread 2
func reader() {
  while (flag == 0) {}
  // una vez que flag==1, reader debe ver data==42
  assert(data == 42)
}

// Puntos importantes:
// - Escribiendo a una volatile crea un 'release' en muchas plataformas de alto nivel.
// - Leer una volatile actúa como 'acquire'.
// - No sustituye completamente a locks para operaciones compuestas (ej: read-modify-write).
`})]}),e.jsx("div",{className:"bg-emerald-900/20 p-3 rounded",children:e.jsx("p",{className:"text-sm text-emerald-100",children:"Ventajas: sencillo para señalización y flags. Desventajas: no protege operaciones compuestas ni sustituye a primitivas atómicas."})})]})]})}),e.jsx(ue,{value:"acqrel",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-violet-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-violet-400 mb-4",children:"Acquire / Release Semantics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-violet-300 mb-2",children:"Concepto"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Acquire (lectura) y Release (escritura) son órdenes de memoria usadas con operaciones atómicas para garantizar visibilidad sin necesidad de fences completas."})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-violet-300 mb-2",children:"Pseudocódigo — Prod/Cons seguro con acquire/release"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Buffer circular simple: producer/consumer con acquire/release
estructura RingBuffer {
  data: Array<T>
  head: Atomic<int>
  tail: Atomic<int>
}

func produce(buffer: RingBuffer, value: T) {
  while (true) {
    tail = buffer.tail.load()  // load_relaxed
    next = (tail + 1) % buffer.data.length
    if (next == buffer.head.load()) {
      // full
      continue
    }
    buffer.data[tail] = value
    // publicar el dato y luego actualizar tail con release
    buffer.tail.store(next, memory_order_release)
    return
  }
}

func consume(buffer: RingBuffer) -> T {
  while (true) {
    head = buffer.head.load(memory_order_acquire)
    if (head == buffer.tail.load(memory_order_relaxed)) {
      // empty
      continue
    }
    value = buffer.data[head]
    buffer.head.store((head + 1) % buffer.data.length, memory_order_release)
    return value
  }
}

// Explicación:
// - producer hace store_release en tail después de escribir data.
// - consumer hace load_acquire en head/tail para asegurar que vean el dato escrito.
`})]}),e.jsx("div",{className:"bg-violet-900/20 p-3 rounded",children:e.jsx("p",{className:"text-sm text-violet-100",children:"Ventajas: eficiente para patrones prod/cons lock-free; menor overhead que fences completas. Desventajas: requiere disciplina y comprensión de memory orders."})})]})]})}),e.jsx(ue,{value:"seq",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-rose-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-rose-400 mb-4",children:"Sequential Consistency"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-rose-300 mb-2",children:"Concepto"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Un modelo es secuencialmente consistente si existe un orden total de operaciones de todos los threads que respeta el orden programado dentro de cada thread y produce el mismo comportamiento observado por cada thread."})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-rose-300 mb-2",children:"Pseudocódigo — comprobador de SC (modelo simplificado)"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Modelo de verificación simple por interleavings
lista ops_thread1 = [W(x,1), R(y)]
lista ops_thread2 = [W(y,1), R(x)]

// Generar todas las interleavings que respetan orden dentro de cada thread
func generate_interleavings(t1, t2) -> lista<lista<op>> {
  if t1.empty() return [t2]
  if t2.empty() return [t1]
  res = []
  // tomar op de t1
  for rest in generate_interleavings(t1.tail(), t2):
    res.add([t1.head()] + rest)
  // tomar op de t2
  for rest in generate_interleavings(t1, t2.tail()):
    res.add([t2.head()] + rest)
  return res
}

func check_SC(opsLists) {
  interleavings = generate_interleavings(ops_thread1, ops_thread2)
  for each inter in interleavings:
    state = {}
    for op in inter:
      apply(op, state)
    collect final observations
  // Si todas las observaciones son consistentes con algún interleaving, modelo es SC
}

// Ejemplo: si observamos R(x)==0 y R(y)==0 para ambos, en SC esto es imposible
`})]}),e.jsx("div",{className:"bg-rose-900/20 p-3 rounded",children:e.jsx("p",{className:"text-sm text-rose-100",children:"Ventajas: modelo intuitivo y sencillo para razonar. Desventajas: demasiado restrictivo; costo de implementar en hardware moderno."})})]})]})}),e.jsx(ue,{value:"happens",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-indigo-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-indigo-400 mb-4",children:"Happens-Before Relationships"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-indigo-300 mb-2",children:"Concepto"}),e.jsx("p",{className:"text-sm text-gray-300",children:"La relación happens-before describe cuándo un efecto (escritura) es observable por otra operación (lectura). Construida por orden intra-thread, sincronización y otras reglas."})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-indigo-300 mb-2",children:"Pseudocódigo — construir grafo happens-before"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Eventos: cada lectura/escritura es un nodo
estructura Event { id, threadId, type: { READ, WRITE }, varName, value }

// Reglas para aristas HB:
// 1. Program order: dentro de un mismo thread, op_i -> op_{i+1}
// 2. Synchronization: unlock -> lock, write_release -> read_acquire, volatile write -> volatile read
// 3. Transitive closure

func build_happens_before(events) -> Graph {
  G = new Graph()
  // añadir aristas de program order
  for each thread in events.groupBy(threadId):
    for i in 0..thread.events.length-2:
      G.addEdge(thread.events[i], thread.events[i+1])

  // añadir aristas por sincronización (ejemplo: release->acquire)
  for each e in events:
    if e.type == WRITE and isRelease(e):
      for each r in events:
        if r.type == READ and isAcquire(r) and r.varName == e.varName and r.value == e.value:
          G.addEdge(e, r)

  // cerrar transitivamente
  G.transitiveClosure()
  return G
}

// Determinar si una lectura ve una escritura legalmente
func read_sees_write(readEvent, writeEvent, hbGraph) -> boolean {
  // debe existir writeEvent -> readEvent en hbGraph
  return hbGraph.hasPath(writeEvent, readEvent)
}
`})]}),e.jsx("div",{className:"bg-indigo-900/20 p-3 rounded",children:e.jsx("p",{className:"text-sm text-indigo-100",children:"Ventajas: formaliza visibilidad y permite razonar sobre seguridad en concurrencia. Desventajas: puede ser complejo construir grafos grandes; requiere registros de eventos para análisis post-mortem."})})]})]})}),e.jsx(ue,{value:"atomic",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-lime-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-lime-400 mb-4",children:"Atomic Operations"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-lime-300 mb-2",children:"Concepto"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Operaciones atómicas (CAS, fetch_add, exchange) proporcionan indivisibilidad para operaciones de lectura-modificación-escritura y pueden incluir memory orders (relaxed, acquire, release, seq_cst)."})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-lime-300 mb-2",children:"Pseudocódigo — Compare-And-Swap (CAS)"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Atomic CAS: compara y actualiza en una operación atómica
func compareAndSwap(addr: Atomic<int>, expected: int, newVal: int) -> boolean {
  atomic { // bloque atómico provisto por hardware
    if (*addr == expected) {
      *addr = newVal
      return true
    } else {
      return false
    }
  }
}

// Ejemplo: contador lock-free
estructura AtomicCounter { value: Atomic<int> }

func increment(counter: AtomicCounter) {
  while (true) {
    old = counter.value.load(memory_order_relaxed)
    if (compareAndSwap(&counter.value, old, old + 1)) {
      return
    }
    // retry
  }
}

// Pseudocódigo — fetch_add (Instrumental)
func fetch_add(addr: Atomic<int>, delta: int) -> int {
  while (true) {
    old = addr.load(memory_order_relaxed)
    if (compareAndSwap(addr, old, old + delta)) return old
  }
}

// Notas: memory_order_seq_cst es la semántica más fuerte (sequentially consistent for atomics)
`})]}),e.jsx("div",{className:"bg-lime-900/20 p-3 rounded",children:e.jsx("p",{className:"text-sm text-lime-100",children:"Ventajas: primitives atómicas son building blocks para algoritmos lock-free. Desventajas: pueden ser difíciles de usar correctamente; operaciones compuestas requieren patrones adicionales (ej: DCAS, descriptors)."})})]})]})})]})})]}),e.jsxs(sa,{value:"demos",className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(ra,{className:"text-xl font-bold px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vn,{className:"size-5"}),e.jsx("span",{children:"Demostraciones Interactivas"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"demo-fences",className:"px-6 pb-6",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs(Qt,{className:"grid grid-cols-6 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"demo-fences",children:"Fences"}),e.jsx(le,{value:"demo-volatile",children:"Volatile"}),e.jsx(le,{value:"demo-acqrel",children:"Acq/Rel"}),e.jsx(le,{value:"demo-seq",children:"Seq Consistency"}),e.jsx(le,{value:"demo-hb",children:"Happens-Before"}),e.jsx(le,{value:"demo-atomic",children:"Atomic Ops"})]})}),e.jsx(ue,{value:"demo-fences",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-sky-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-sky-400 mb-4",children:"Demo: Memory Fences"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>o(!s),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors ${s?"bg-yellow-600 hover:bg-yellow-700":"bg-sky-600 hover:bg-sky-700"}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:U,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",n,"ms"]}),e.jsx(dt,{value:[n],onValueChange:([pt])=>l(pt),min:200,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-sky-300 mb-3",children:"Shared Memory"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{className:"bg-sky-900/30 p-2 rounded",children:[e.jsx("span",{className:"text-sky-300 font-bold",children:"x:"})," ",d.x]}),e.jsxs("div",{className:"bg-sky-900/30 p-2 rounded",children:[e.jsx("span",{className:"text-sky-300 font-bold",children:"y:"})," ",d.y]}),e.jsxs("div",{className:"bg-sky-900/30 p-2 rounded",children:[e.jsx("span",{className:"text-sky-300 font-bold",children:"flag:"})," ",d.flag]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-2",children:"Thread 1"}),e.jsxs("div",{className:"text-xs space-y-1 text-gray-300",children:[e.jsxs("div",{children:["r1: ",h.r1]}),e.jsxs("div",{children:["r2: ",h.r2]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-red-300 mb-2",children:"Thread 2"}),e.jsxs("div",{className:"text-xs space-y-1 text-gray-300",children:[e.jsxs("div",{children:["r3: ",g.r3]}),e.jsxs("div",{children:["r4: ",g.r4]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-sky-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:ft,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:v.map((pt,zt)=>e.jsx("div",{className:"text-gray-300",children:pt},zt))})]})]})}),e.jsx(ue,{value:"demo-volatile",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-emerald-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-emerald-400 mb-4",children:"Demo: Volatile Variables"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>_(!j),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors ${j?"bg-yellow-600 hover:bg-yellow-700":"bg-emerald-600 hover:bg-emerald-700"}`,children:j?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:Dt,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",w,"ms"]}),e.jsx(dt,{value:[w],onValueChange:([pt])=>C(pt),min:200,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-emerald-300 mb-3",children:"Variables"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-emerald-900/30 p-3 rounded",children:[e.jsx("div",{className:"text-emerald-300 font-bold mb-1",children:"data"}),e.jsx("div",{className:"text-2xl",children:P})]}),e.jsxs("div",{className:"bg-emerald-900/30 p-3 rounded",children:[e.jsx("div",{className:"text-emerald-300 font-bold mb-1",children:"volatile flag"}),e.jsx("div",{className:"text-2xl",children:E})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-emerald-300 mb-3",children:"Reader vio"}),e.jsx("div",{className:"text-xl text-emerald-400",children:Z!==null?Z:"esperando..."})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-emerald-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:Ct,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:O.map((pt,zt)=>e.jsx("div",{className:"text-gray-300",children:pt},zt))})]})]})}),e.jsx(ue,{value:"demo-acqrel",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-violet-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-violet-400 mb-4",children:"Demo: Acquire/Release Ring Buffer"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>W(!J),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors ${J?"bg-yellow-600 hover:bg-yellow-700":"bg-violet-600 hover:bg-violet-700"}`,children:J?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:Ke,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",ne,"ms"]}),e.jsx(dt,{value:[ne],onValueChange:([pt])=>Ee(pt),min:200,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-violet-300 mb-3",children:"Ring Buffer"}),e.jsx("div",{className:"flex items-center gap-2 justify-center",children:Ce.map((pt,zt)=>e.jsx("div",{className:`w-16 h-16 flex items-center justify-center rounded font-bold text-lg ${zt===I?"bg-blue-600 ring-2 ring-blue-400":zt===F?"bg-violet-600 ring-2 ring-violet-400":"bg-gray-700"}`,children:pt},zt))}),e.jsxs("div",{className:"flex justify-around mt-2 text-xs",children:[e.jsxs("div",{className:"text-blue-300",children:["HEAD: ",I]}),e.jsxs("div",{className:"text-violet-300",children:["TAIL: ",F]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-violet-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:ve,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:ze.map((pt,zt)=>e.jsx("div",{className:"text-gray-300",children:pt},zt))})]})]})}),e.jsx(ue,{value:"demo-seq",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-rose-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-rose-400 mb-4",children:"Demo: Sequential Consistency"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>k(!se),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors ${se?"bg-yellow-600 hover:bg-yellow-700":"bg-rose-600 hover:bg-rose-700"}`,children:se?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:fe,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",K,"ms"]}),e.jsx(dt,{value:[K],onValueChange:([pt])=>M(pt),min:200,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-rose-300 mb-3",children:"Shared Variables"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-rose-900/30 p-3 rounded",children:[e.jsx("div",{className:"text-rose-300 font-bold",children:"x"}),e.jsx("div",{className:"text-2xl",children:D})]}),e.jsxs("div",{className:"bg-rose-900/30 p-3 rounded",children:[e.jsx("div",{className:"text-rose-300 font-bold",children:"y"}),e.jsx("div",{className:"text-2xl",children:G})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-2",children:"Thread 1"}),e.jsxs("div",{className:"text-xs text-gray-300",children:["r1 (lee y): ",Ne!==null?Ne:"—"]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-red-300 mb-2",children:"Thread 2"}),e.jsxs("div",{className:"text-xs text-gray-300",children:["r2 (lee x): ",ke!==null?ke:"—"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-rose-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:gt,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:ee.map((pt,zt)=>e.jsx("div",{className:"text-gray-300",children:pt},zt))})]})]})}),e.jsx(ue,{value:"demo-hb",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-indigo-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-indigo-400 mb-4",children:"Demo: Happens-Before Graph"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>xe(!jt),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors ${jt?"bg-yellow-600 hover:bg-yellow-700":"bg-indigo-600 hover:bg-indigo-700"}`,children:jt?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:$t,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",Me,"ms"]}),e.jsx(dt,{value:[Me],onValueChange:([pt])=>De(pt),min:200,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-indigo-300 mb-3",children:"Events"}),e.jsx("div",{className:"space-y-2",children:Ge.map(pt=>e.jsxs("div",{className:`p-2 rounded text-xs ${pt.thread===1?"bg-blue-900/30":"bg-red-900/30"}`,children:["E",pt.id," (T",pt.thread,"): ",pt.type,"(",pt.variable,pt.value!==void 0?`, ${pt.value}`:"",")"]},pt.id))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-indigo-300 mb-3",children:"Happens-Before Relations"}),e.jsx("div",{className:"space-y-1 text-xs text-gray-300",children:Se.map(([pt,zt],lt)=>e.jsxs("div",{children:["E",pt," → E",zt]},lt))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-indigo-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:$e,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:We.map((pt,zt)=>e.jsx("div",{className:"text-gray-300",children:pt},zt))})]})]})}),e.jsx(ue,{value:"demo-atomic",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-lime-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-lime-400 mb-4",children:"Demo: Atomic CAS Operations"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>Ue(!It),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors ${It?"bg-yellow-600 hover:bg-yellow-700":"bg-lime-600 hover:bg-lime-700"}`,children:It?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:Zt,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",At,"ms"]}),e.jsx(dt,{value:[At],onValueChange:([pt])=>et(pt),min:200,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-lime-300 mb-3",children:"Atomic Counter"}),e.jsx("div",{className:"text-4xl font-bold text-lime-400 text-center",children:L})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-2",children:"Thread 1"}),e.jsxs("div",{className:"text-xs text-gray-300",children:["CAS attempts: ",Ve]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-red-300 mb-2",children:"Thread 2"}),e.jsxs("div",{className:"text-xs text-gray-300",children:["CAS attempts: ",Te]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-lime-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:B,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:St.map((pt,zt)=>e.jsx("div",{className:"text-gray-300",children:pt},zt))})]})]})})]})})]})]})})]})}const XR=Sa("/ActividadesSeminarioSO/actividad11/memory-consistency")({component:YR});function QR(){const[s,o]=c.useState(!1),[n,l]=c.useState(800),[d,m]=c.useState(0),[h,x]=c.useState(!1),[g,b]=c.useState("checking"),[v,f]=c.useState("idle"),[N,j]=c.useState([]),[_,w]=c.useState(!1),[C,E]=c.useState(800),[z,P]=c.useState(0),[V,Z]=c.useState(0),[oe,O]=c.useState("waiting"),[T,ge]=c.useState("idle"),[J,W]=c.useState([]),[ne,Ee]=c.useState(!1),[Ce,Le]=c.useState(800),[I,Q]=c.useState(0),[F,de]=c.useState(!1),[ze,A]=c.useState(0),[$,se]=c.useState("checking"),[k,K]=c.useState("idle"),[M,D]=c.useState([]),[q,G]=c.useState(!1),[be,Ne]=c.useState(800),[R,ke]=c.useState(0),[je,ee]=c.useState(!1),[ae,rt]=c.useState([{id:1,state:"waiting"},{id:2,state:"waiting"},{id:3,state:"waiting"}]),[jt,xe]=c.useState("idle"),[Me,De]=c.useState([]),[Ge,qe]=c.useState(!1),[Se,Xe]=c.useState(800),[We,xt]=c.useState(0),[Ot,It]=c.useState(!1),[Ue,At]=c.useState("waiting"),[et,L]=c.useState(5),[re,Ve]=c.useState(!1),[ce,Te]=c.useState([]),_t=c.useRef(null),St=c.useRef(null),tt=c.useRef(null),Ye=c.useRef(null),ft=c.useRef(null);c.useEffect(()=>{_t.current&&(_t.current.scrollTop=_t.current.scrollHeight)},[N]),c.useEffect(()=>{St.current&&(St.current.scrollTop=St.current.scrollHeight)},[J]),c.useEffect(()=>{tt.current&&(tt.current.scrollTop=tt.current.scrollHeight)},[M]),c.useEffect(()=>{Ye.current&&(Ye.current.scrollTop=Ye.current.scrollHeight)},[Me]),c.useEffect(()=>{ft.current&&(ft.current.scrollTop=ft.current.scrollHeight)},[ce]),c.useEffect(()=>{if(!s)return;const U=setTimeout(()=>{m(Dt=>{const Ke=Dt+1;if(Ke===1)j(fe=>[...fe,{message:"Thread Waiter: Iniciando...",type:"info"}]),b("checking");else if(Ke===2)j(fe=>[...fe,{message:"Thread Waiter: Adquiriendo mutex...",type:"info"}]);else if(Ke===3)j(fe=>[...fe,{message:"Thread Waiter: Verificando condición (false)",type:"warning"}]);else if(Ke===4)j(fe=>[...fe,{message:"Thread Waiter: Esperando en CV (libera mutex)...",type:"info"}]),b("waiting");else if(Ke===5)j(fe=>[...fe,{message:"Thread Signaler: Iniciando...",type:"success"}]),f("preparing");else if(Ke===6)j(fe=>[...fe,{message:"Thread Signaler: Adquiriendo mutex...",type:"success"}]);else if(Ke===7)x(!0),j(fe=>[...fe,{message:"Thread Signaler: Condición = true",type:"success"}]);else if(Ke===8)j(fe=>[...fe,{message:"Thread Signaler: pthread_cond_signal()",type:"success"}]),f("signaling");else if(Ke===9)j(fe=>[...fe,{message:"Thread Signaler: Liberando mutex",type:"success"}]),f("done");else if(Ke===10)j(fe=>[...fe,{message:"Thread Waiter: Despertando, re-adquiriendo mutex...",type:"info"}]);else if(Ke===11)j(fe=>[...fe,{message:"Thread Waiter: Re-verificando condición (true) ✓",type:"success"}]),b("processing");else if(Ke===12)j(fe=>[...fe,{message:"Thread Waiter: Procesando datos...",type:"success"}]);else if(Ke===13)j(fe=>[...fe,{message:"Thread Waiter: Liberando mutex",type:"success"}]);else if(Ke===14)return j(fe=>[...fe,{message:"✅ Sincronización completa - No lost wakeup!",type:"success"}]),b("done"),o(!1),Ke;return Ke})},n);return()=>clearTimeout(U)},[s,d,n]),c.useEffect(()=>{if(!_)return;const U=setTimeout(()=>{P(Dt=>{const Ke=Dt+1;if(Ke===1)W(fe=>[...fe,{message:"Thread Waiter: Iniciando...",type:"info"}]);else if(Ke===2)W(fe=>[...fe,{message:"Thread Waiter: sem_wait() - bloqueando (contador=0)",type:"warning"}]),O("waiting");else if(Ke===3)W(fe=>[...fe,{message:"Thread Signaler: Iniciando...",type:"success"}]),ge("posting");else if(Ke===4)Z(1),W(fe=>[...fe,{message:"Thread Signaler: sem_post() - contador: 0→1",type:"success"}]);else if(Ke===5)W(fe=>[...fe,{message:"Thread Signaler: Señal enviada ✓",type:"success"}]),ge("done");else if(Ke===6)Z(0),W(fe=>[...fe,{message:"Thread Waiter: Despertando, sem_wait() éxito - contador: 1→0",type:"info"}]),O("acquired");else if(Ke===7)W(fe=>[...fe,{message:"Thread Waiter: Procesando datos...",type:"success"}]),O("processing");else if(Ke===8)return W(fe=>[...fe,{message:"✅ Semáforo preservó señal - No lost wakeup!",type:"success"}]),O("done"),w(!1),Ke;return Ke})},C);return()=>clearTimeout(U)},[_,z,C]),c.useEffect(()=>{if(!ne)return;const U=setTimeout(()=>{Q(Dt=>{const Ke=Dt+1;if(Ke===1)D(fe=>[...fe,{message:"Thread Signaler: Iniciando primero...",type:"success"}]),K("marking");else if(Ke===2)D(fe=>[...fe,{message:"Thread Signaler: Adquiriendo mutex...",type:"success"}]);else if(Ke===3)de(!0),A(42),D(fe=>[...fe,{message:"Thread Signaler: event_occurred = true, data = 42",type:"success"}]);else if(Ke===4)D(fe=>[...fe,{message:"Thread Signaler: Señalizando...",type:"success"}]);else if(Ke===5)D(fe=>[...fe,{message:"Thread Signaler: Liberando mutex",type:"success"}]),K("done");else if(Ke===6)D(fe=>[...fe,{message:"Thread Waiter: Iniciando (después de signaler)...",type:"info"}]),se("checking");else if(Ke===7)D(fe=>[...fe,{message:"Thread Waiter: Adquiriendo mutex...",type:"info"}]);else if(Ke===8)D(fe=>[...fe,{message:"Thread Waiter: Verificando event_occurred (true) ✓",type:"success"}]);else if(Ke===9)D(fe=>[...fe,{message:"Thread Waiter: Estado persistió - NO espera!",type:"success"}]),se("processing");else if(Ke===10)D(fe=>[...fe,{message:`Thread Waiter: Procesando data=${ze}`,type:"success"}]);else if(Ke===11)D(fe=>[...fe,{message:"Thread Waiter: Liberando mutex",type:"success"}]);else if(Ke===12)return D(fe=>[...fe,{message:"✅ Estado rastreado - Señal no se perdió!",type:"success"}]),se("done"),Ee(!1),Ke;return Ke})},Ce);return()=>clearTimeout(U)},[ne,I,Ce,ze]),c.useEffect(()=>{if(!q)return;const U=setTimeout(()=>{ke(Dt=>{const Ke=Dt+1;if(Ke===1)De(fe=>[...fe,{message:"3 Threads Waiters iniciando...",type:"info"}]);else if(Ke===2)De(fe=>[...fe,{message:"Thread 1: Esperando en CV...",type:"info"}]);else if(Ke===3)De(fe=>[...fe,{message:"Thread 2: Esperando en CV...",type:"info"}]);else if(Ke===4)De(fe=>[...fe,{message:"Thread 3: Esperando en CV...",type:"info"}]);else if(Ke===5)De(fe=>[...fe,{message:"Thread Signaler: Iniciando...",type:"success"}]),xe("broadcasting");else if(Ke===6)ee(!0),De(fe=>[...fe,{message:"Thread Signaler: Condición = true",type:"success"}]);else if(Ke===7)De(fe=>[...fe,{message:"Thread Signaler: pthread_cond_broadcast() 📢",type:"success"}]);else if(Ke===8)rt(fe=>fe.map(($t,Zt)=>Zt===0?{...$t,state:"awakened"}:$t)),De(fe=>[...fe,{message:"Thread 1: Despertando... ✓",type:"success"}]);else if(Ke===9)rt(fe=>fe.map(($t,Zt)=>Zt===1?{...$t,state:"awakened"}:$t)),De(fe=>[...fe,{message:"Thread 2: Despertando... ✓",type:"success"}]);else if(Ke===10)rt(fe=>fe.map(($t,Zt)=>Zt===2?{...$t,state:"awakened"}:$t)),De(fe=>[...fe,{message:"Thread 3: Despertando... ✓",type:"success"}]);else if(Ke===11)xe("done"),De(fe=>[...fe,{message:"Thread Signaler: Broadcast completado",type:"success"}]);else if(Ke===12)rt(fe=>fe.map(($t,Zt)=>Zt===0?{...$t,state:"done"}:$t)),De(fe=>[...fe,{message:"Thread 1: Procesamiento completo",type:"success"}]);else if(Ke===13)rt(fe=>fe.map(($t,Zt)=>Zt===1?{...$t,state:"done"}:$t)),De(fe=>[...fe,{message:"Thread 2: Procesamiento completo",type:"success"}]);else if(Ke===14)rt(fe=>fe.map(($t,Zt)=>Zt===2?{...$t,state:"done"}:$t)),De(fe=>[...fe,{message:"Thread 3: Procesamiento completo",type:"success"}]);else if(Ke===15)return De(fe=>[...fe,{message:"✅ Broadcast despertó TODOS los threads!",type:"success"}]),G(!1),Ke;return Ke})},be);return()=>clearTimeout(U)},[q,R,be]),c.useEffect(()=>{if(!Ge)return;const U=setTimeout(()=>{xt(Dt=>{const Ke=Dt+1;if(Ke===1)Te(fe=>[...fe,{message:"Thread Waiter: Iniciando con timeout de 5s...",type:"info"}]),At("waiting"),L(5);else if(Ke>=2&&Ke<=6){const fe=6-Ke;L(fe),Te($t=>[...$t,{message:`Thread Waiter: Esperando... (${fe}s restantes)`,type:"warning"}])}else if(Ke===7)re?(It(!0),Te(fe=>[...fe,{message:"Thread Signaler: Señal enviada a tiempo! ✓",type:"success"}]),At("success")):(Te(fe=>[...fe,{message:"⏱️ TIMEOUT! Condición no cumplida en 5 segundos",type:"error"}]),At("timeout"));else if(Ke===8)Te(re?fe=>[...fe,{message:"Thread Waiter: Procesando datos...",type:"success"}]:fe=>[...fe,{message:"Thread Waiter: Recovery - continuando sin dato",type:"warning"}]);else if(Ke===9)return Te(re?fe=>[...fe,{message:"✅ Datos recibidos antes del timeout!",type:"success"}]:fe=>[...fe,{message:"❌ Timeout detectó problema - evitó deadlock!",type:"warning"}]),At("done"),qe(!1),Ke;return Ke})},Se);return()=>clearTimeout(U)},[Ge,We,Se,re]);const Ct=()=>{o(!1),m(0),x(!1),b("checking"),f("idle"),j([])},ve=()=>{w(!1),P(0),Z(0),O("waiting"),ge("idle"),W([])},gt=()=>{Ee(!1),Q(0),de(!1),A(0),se("checking"),K("idle"),D([])},$e=()=>{G(!1),ke(0),ee(!1),rt([{id:1,state:"waiting"},{id:2,state:"waiting"},{id:3,state:"waiting"}]),xe("idle"),De([])},B=()=>{qe(!1),xt(0),It(!1),At("waiting"),L(5),Ve(!1),Te([])};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-pink-900/20 to-purple-900/20 border-b border-pink-700/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-12",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-pink-600 rounded-lg",children:e.jsx(La,{className:"size-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-400 to-purple-400",children:"Lost Wakeup Problem"}),e.jsx("p",{className:"text-gray-300 mt-2",children:"Problema donde un thread pierde una señal de wake-up porque llegó antes de que el thread estuviera esperando"})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-pink-700/30",children:[e.jsx("h2",{className:"text-xl font-semibold text-pink-300 mb-3",children:"¿Qué es Lost Wakeup?"}),e.jsx("p",{className:"text-gray-300 mb-4",children:'El problema de Lost Wakeup ocurre cuando un thread señaliza (wakeup) a otro thread antes de que este último comience a esperar. La señal se "pierde" porque no hay nadie esperándola, y el thread que eventualmente espera puede bloquearse indefinidamente.'}),e.jsxs("div",{className:"bg-pink-900/20 p-4 rounded border border-pink-600/30",children:[e.jsx("h3",{className:"font-semibold text-pink-300 mb-2",children:"Escenario Problemático:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-gray-300 text-sm",children:[e.jsx("li",{children:"Thread A verifica condición (falsa), decide esperar"}),e.jsx("li",{children:"Thread B cambia condición, envía señal (pero A aún no está esperando)"}),e.jsx("li",{children:"Thread A comienza a esperar (señal ya se perdió)"}),e.jsx("li",{children:"Thread A queda bloqueado indefinidamente"})]})]})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsx(Da,{type:"single",defaultValue:"pseudocodes",collapsible:!0,className:"space-y-4",children:e.jsxs(sa,{value:"pseudocodes",className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700",children:[e.jsx(ra,{className:"px-6 py-4 hover:bg-slate-700/30 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(oa,{className:"size-6 text-pink-400"}),e.jsx("span",{className:"text-2xl font-semibold text-white",children:"Pseudocódigos de Soluciones"})]})}),e.jsx(na,{className:"px-6 pb-6",children:e.jsxs(ia,{defaultValue:"cv",className:"w-full",children:[e.jsxs(Qt,{className:"grid w-full grid-cols-5 bg-slate-900/50 p-1 rounded-lg mb-6",children:[e.jsx(le,{value:"cv",className:"data-[state=active]:bg-pink-600",children:"Condition Variables"}),e.jsx(le,{value:"semaphore",className:"data-[state=active]:bg-pink-600",children:"Semáforos"}),e.jsx(le,{value:"state",className:"data-[state=active]:bg-pink-600",children:"State Tracking"}),e.jsx(le,{value:"broadcast",className:"data-[state=active]:bg-pink-600",children:"Broadcast"}),e.jsx(le,{value:"timeout",className:"data-[state=active]:bg-pink-600",children:"Timeout"})]}),e.jsx(ue,{value:"cv",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/20 to-slate-800/20 p-6 rounded-lg border border-blue-700/50",children:[e.jsxs("h3",{className:"text-2xl font-bold text-blue-300 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl",children:"🔒"}),"Solución 1: Condition Variables Correctamente"]}),e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("p",{className:"text-gray-300 mb-4",children:"Uso correcto de condition variables con mutex para garantizar atomicidad entre verificación de condición y espera. La clave es mantener el mutex durante toda la operación crítica."})}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-blue-600/30 mb-6",children:[e.jsx("h4",{className:"font-semibold text-blue-300 mb-3",children:"Conceptos Clave:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Mutex + Condition Variable:"})," Siempre usados juntos"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Atomicidad:"})," wait() libera mutex atómicamente al esperar"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"While Loop:"})," Re-verificar condición después de despertar"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Signal bajo Lock:"})," Señalizar con mutex adquirido"]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-300 mb-3",children:"Estructuras de Datos:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-green-400 overflow-x-auto",children:`struct SharedState {
    pthread_mutex_t mutex;        // Mutex para proteger estado
    pthread_cond_t  cond_var;     // Condition variable
    bool            condition;     // Condición que esperamos
    int             data;          // Datos compartidos
    bool            ready;         // Estado de preparación
};

// Inicialización
void init_shared_state(SharedState* state) {
    pthread_mutex_init(&state->mutex, NULL);
    pthread_cond_init(&state->cond_var, NULL);
    state->condition = false;
    state->data = 0;
    state->ready = false;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-300 mb-3",children:"Thread Waiter (Consumer):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-cyan-400 overflow-x-auto",children:`void* waiter_thread(void* arg) {
    SharedState* state = (SharedState*)arg;
    
    // 1. Adquirir mutex ANTES de verificar condición
    pthread_mutex_lock(&state->mutex);
    
    // 2. Esperar mientras condición no se cumpla (WHILE, no IF)
    while (!state->condition) {
        // wait() hace 3 cosas ATÓMICAMENTE:
        // a) Libera el mutex
        // b) Pone thread en cola de espera
        // c) Al despertar, re-adquiere el mutex
        pthread_cond_wait(&state->cond_var, &state->mutex);
        
        // Al despertar, tenemos el mutex nuevamente
        // Re-verificamos condición por spurious wakeups
    }
    
    // 3. Condición es verdadera, procesamos datos
    printf("Condición cumplida, data = %d\\n", state->data);
    
    // 4. Modificar estado si necesario
    state->ready = true;
    
    // 5. Liberar mutex
    pthread_mutex_unlock(&state->mutex);
    
    return NULL;
}

// Ejemplo con timeout
int waiter_with_timeout(SharedState* state, int seconds) {
    struct timespec timeout;
    clock_gettime(CLOCK_REALTIME, &timeout);
    timeout.tv_sec += seconds;
    
    pthread_mutex_lock(&state->mutex);
    
    int result = 0;
    while (!state->condition && result == 0) {
        result = pthread_cond_timedwait(
            &state->cond_var,
            &state->mutex,
            &timeout
        );
    }
    
    if (result == ETIMEDOUT) {
        printf("Timeout esperando condición\\n");
        pthread_mutex_unlock(&state->mutex);
        return -1;
    }
    
    // Condición cumplida
    printf("Data recibida: %d\\n", state->data);
    pthread_mutex_unlock(&state->mutex);
    return 0;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-300 mb-3",children:"Thread Signaler (Producer):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-yellow-400 overflow-x-auto",children:`void* signaler_thread(void* arg) {
    SharedState* state = (SharedState*)arg;
    
    // Simular trabajo
    sleep(1);
    
    // 1. Adquirir mutex ANTES de modificar estado
    pthread_mutex_lock(&state->mutex);
    
    // 2. Modificar condición y datos
    state->data = 42;
    state->condition = true;
    
    printf("Condición establecida, señalizando...\\n");
    
    // 3. Señalizar (con mutex adquirido)
    // pthread_cond_signal():  Despierta 1 thread
    // pthread_cond_broadcast(): Despierta TODOS los threads
    pthread_cond_signal(&state->cond_var);
    
    // 4. Liberar mutex
    pthread_mutex_unlock(&state->mutex);
    
    // Nota: El waiter despertará DESPUÉS de que liberemos el mutex
    // Si intentara despertar antes, tendría que esperar el mutex
    
    return NULL;
}

// Versión con múltiples waiters
void signal_all_waiters(SharedState* state, int new_data) {
    pthread_mutex_lock(&state->mutex);
    
    state->data = new_data;
    state->condition = true;
    
    // Broadcast despierta TODOS los threads esperando
    pthread_cond_broadcast(&state->cond_var);
    
    pthread_mutex_unlock(&state->mutex);
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-300 mb-3",children:"Programa Principal:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-purple-400 overflow-x-auto",children:`int main() {
    SharedState state;
    pthread_t waiter, signaler;
    
    // Inicializar
    init_shared_state(&state);
    
    // Crear threads en cualquier orden
    // (El orden NO importa con condition variables correctas)
    pthread_create(&waiter, NULL, waiter_thread, &state);
    pthread_create(&signaler, NULL, signaler_thread, &state);
    
    // Esperar ambos threads
    pthread_join(waiter, NULL);
    pthread_join(signaler, NULL);
    
    // Cleanup
    pthread_mutex_destroy(&state.mutex);
    pthread_cond_destroy(&state.cond_var);
    
    return 0;
}

// Ejemplo con múltiples waiters
int main_multiple_waiters() {
    SharedState state;
    pthread_t waiters[3], signaler;
    
    init_shared_state(&state);
    
    // Crear múltiples waiters
    for (int i = 0; i < 3; i++) {
        pthread_create(&waiters[i], NULL, waiter_thread, &state);
    }
    
    // Crear signaler
    pthread_create(&signaler, NULL, signaler_thread, &state);
    
    // Join todos
    for (int i = 0; i < 3; i++) {
        pthread_join(waiters[i], NULL);
    }
    pthread_join(signaler, NULL);
    
    pthread_mutex_destroy(&state.mutex);
    pthread_cond_destroy(&state.cond_var);
    
    return 0;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-red-300 mb-3",children:"❌ Patrones Incorrectos (Causan Lost Wakeup):"}),e.jsx("div",{className:"bg-red-950/30 p-4 rounded-lg border border-red-600/30",children:e.jsx("pre",{className:"text-sm text-red-400 overflow-x-auto",children:`// ERROR 1: Verificar sin mutex
void bad_waiter_1() {
    // ❌ Race condition entre check y wait
    if (!condition) {
        pthread_mutex_lock(&mutex);
        pthread_cond_wait(&cond_var, &mutex);  // Puede perder signal
        pthread_mutex_unlock(&mutex);
    }
}

// ERROR 2: Usar IF en lugar de WHILE
void bad_waiter_2() {
    pthread_mutex_lock(&mutex);
    if (!condition) {  // ❌ Debería ser WHILE
        pthread_cond_wait(&cond_var, &mutex);
        // No re-verifica después de spurious wakeup
    }
    pthread_mutex_unlock(&mutex);
}

// ERROR 3: No mantener mutex al señalizar
void bad_signaler() {
    condition = true;  // ❌ Modificar sin mutex
    pthread_cond_signal(&cond_var);  // ❌ Signal sin mutex
}

// ERROR 4: Liberar mutex antes de wait
void bad_waiter_3() {
    pthread_mutex_lock(&mutex);
    if (!condition) {
        pthread_mutex_unlock(&mutex);  // ❌ Libera antes de wait
        pthread_cond_wait(&cond_var, &mutex);  // Race condition
    }
}`})})]}),e.jsxs("div",{className:"bg-green-900/20 p-4 rounded-lg border border-green-600/30",children:[e.jsx("h4",{className:"font-semibold text-green-300 mb-3",children:"✅ Patrón Correcto Completo:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg",children:e.jsx("pre",{className:"text-sm text-green-400 overflow-x-auto",children:`// WAITER: Patrón correcto
pthread_mutex_lock(&mutex);
while (!condition) {              // WHILE, no IF
    pthread_cond_wait(&cv, &mutex);  // Atomic unlock + wait
}
// Hacer trabajo con condición cumplida
pthread_mutex_unlock(&mutex);

// SIGNALER: Patrón correcto
pthread_mutex_lock(&mutex);
condition = true;                 // Modificar bajo lock
pthread_cond_signal(&cv);         // Signal bajo lock
pthread_mutex_unlock(&mutex);

// Propiedades garantizadas:
// 1. No lost wakeups (signal nunca se pierde)
// 2. No spurious wakeups ignorados (while loop)
// 3. No race conditions (todo bajo mutex)
// 4. Ordenamiento correcto (mutex garantiza happens-before)`})})]})]})}),e.jsx(ue,{value:"semaphore",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/20 to-slate-800/20 p-6 rounded-lg border border-purple-700/50",children:[e.jsxs("h3",{className:"text-2xl font-bold text-purple-300 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl",children:"🚦"}),"Solución 2: Semáforos en lugar de Signals"]}),e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("p",{className:"text-gray-300 mb-4",children:'Los semáforos tienen un contador interno que "recuerda" signals previos, evitando el problema de lost wakeup. Si se señaliza antes de esperar, el contador se incrementa y el wait posterior será inmediato.'})}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-purple-600/30 mb-6",children:[e.jsx("h4",{className:"font-semibold text-purple-300 mb-3",children:"Conceptos Clave:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Contador Persistente:"})," Semáforo mantiene cuenta de signals"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"sem_post():"})," Incrementa contador (signal)"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"sem_wait():"})," Decrementa contador o bloquea si es 0"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"No Lost Signals:"})," Signals previos se preservan"]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-300 mb-3",children:"Estructuras de Datos:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-green-400 overflow-x-auto",children:`#include <semaphore.h>
#include <pthread.h>

struct SemaphoreState {
    sem_t       semaphore;     // Semáforo para sincronización
    pthread_mutex_t mutex;     // Mutex para proteger datos
    int         data;          // Datos compartidos
    bool        ready;         // Estado adicional
};

// Inicialización
void init_semaphore_state(SemaphoreState* state) {
    // Inicializar semáforo en 0 (bloqueado inicialmente)
    // Parámetros: sem, pshared, initial_value
    sem_init(&state->semaphore, 0, 0);
    
    pthread_mutex_init(&state->mutex, NULL);
    state->data = 0;
    state->ready = false;
}

// Cleanup
void destroy_semaphore_state(SemaphoreState* state) {
    sem_destroy(&state->semaphore);
    pthread_mutex_destroy(&state->mutex);
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-300 mb-3",children:"Patrón Básico (Sincronización Simple):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-cyan-400 overflow-x-auto",children:`void* waiter_thread(void* arg) {
    SemaphoreState* state = (SemaphoreState*)arg;
    
    printf("Waiter: Esperando señal...\\n");
    
    // Esperar señal (bloquea si contador es 0)
    // Si contador > 0, decrementa y continúa inmediatamente
    sem_wait(&state->semaphore);
    
    printf("Waiter: Señal recibida!\\n");
    
    // Leer datos (proteger con mutex si hay modificaciones)
    pthread_mutex_lock(&state->mutex);
    printf("Waiter: Data = %d\\n", state->data);
    pthread_mutex_unlock(&state->mutex);
    
    return NULL;
}

void* signaler_thread(void* arg) {
    SemaphoreState* state = (SemaphoreState*)arg;
    
    sleep(1);  // Simular trabajo
    
    // Preparar datos (proteger con mutex)
    pthread_mutex_lock(&state->mutex);
    state->data = 42;
    state->ready = true;
    pthread_mutex_unlock(&state->mutex);
    
    printf("Signaler: Enviando señal...\\n");
    
    // Incrementar contador del semáforo
    // Si hay waiters, despierta uno
    // Si no hay waiters, incrementa contador (no se pierde!)
    sem_post(&state->semaphore);
    
    printf("Signaler: Señal enviada\\n");
    
    return NULL;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-300 mb-3",children:"Semáforo Counting (Múltiples Recursos):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-yellow-400 overflow-x-auto",children:`struct ResourcePool {
    sem_t available_resources;  // Contador de recursos disponibles
    pthread_mutex_t mutex;
    int resource_ids[10];       // Pool de recursos
    int count;
};

void init_resource_pool(ResourcePool* pool, int initial_count) {
    // Inicializar con N recursos disponibles
    sem_init(&pool->available_resources, 0, initial_count);
    pthread_mutex_init(&pool->mutex, NULL);
    pool->count = initial_count;
    
    for (int i = 0; i < initial_count; i++) {
        pool->resource_ids[i] = i;
    }
}

// Adquirir recurso
int acquire_resource(ResourcePool* pool) {
    // Esperar hasta que haya recurso disponible
    // Decrementa contador atómicamente
    sem_wait(&pool->available_resources);
    
    // Obtener recurso del pool
    pthread_mutex_lock(&pool->mutex);
    int resource_id = pool->resource_ids[--pool->count];
    pthread_mutex_unlock(&pool->mutex);
    
    printf("Thread %ld: Adquirió recurso %d\\n", 
           pthread_self(), resource_id);
    
    return resource_id;
}

// Liberar recurso
void release_resource(ResourcePool* pool, int resource_id) {
    // Devolver recurso al pool
    pthread_mutex_lock(&pool->mutex);
    pool->resource_ids[pool->count++] = resource_id;
    pthread_mutex_unlock(&pool->mutex);
    
    printf("Thread %ld: Liberó recurso %d\\n", 
           pthread_self(), resource_id);
    
    // Incrementar contador (señalizar disponibilidad)
    sem_post(&pool->available_resources);
}

void* worker_thread(void* arg) {
    ResourcePool* pool = (ResourcePool*)arg;
    
    // Adquirir recurso (puede esperar si no hay disponibles)
    int resource = acquire_resource(pool);
    
    // Usar recurso
    sleep(2);
    printf("Thread %ld: Usando recurso %d\\n", 
           pthread_self(), resource);
    
    // Liberar recurso
    release_resource(pool, resource);
    
    return NULL;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-300 mb-3",children:"Producer-Consumer con Semáforos:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-orange-400 overflow-x-auto",children:`#define BUFFER_SIZE 10

struct BoundedBuffer {
    sem_t empty_slots;   // Contador de espacios vacíos
    sem_t full_slots;    // Contador de items disponibles
    pthread_mutex_t mutex;
    int buffer[BUFFER_SIZE];
    int in;              // Índice de inserción
    int out;             // Índice de extracción
};

void init_bounded_buffer(BoundedBuffer* bb) {
    sem_init(&bb->empty_slots, 0, BUFFER_SIZE);  // Inicialmente todos vacíos
    sem_init(&bb->full_slots, 0, 0);              // Inicialmente ninguno lleno
    pthread_mutex_init(&bb->mutex, NULL);
    bb->in = 0;
    bb->out = 0;
}

void produce(BoundedBuffer* bb, int item) {
    // Esperar por espacio vacío
    // Si buffer lleno, bloquea aquí
    sem_wait(&bb->empty_slots);
    
    // Insertar item (proteger con mutex)
    pthread_mutex_lock(&bb->mutex);
    bb->buffer[bb->in] = item;
    bb->in = (bb->in + 1) % BUFFER_SIZE;
    printf("Produced: %d\\n", item);
    pthread_mutex_unlock(&bb->mutex);
    
    // Señalizar que hay nuevo item disponible
    sem_post(&bb->full_slots);
}

int consume(BoundedBuffer* bb) {
    // Esperar por item disponible
    // Si buffer vacío, bloquea aquí
    sem_wait(&bb->full_slots);
    
    // Extraer item (proteger con mutex)
    pthread_mutex_lock(&bb->mutex);
    int item = bb->buffer[bb->out];
    bb->out = (bb->out + 1) % BUFFER_SIZE;
    printf("Consumed: %d\\n", item);
    pthread_mutex_unlock(&bb->mutex);
    
    // Señalizar que hay nuevo espacio vacío
    sem_post(&bb->empty_slots);
    
    return item;
}

void* producer(void* arg) {
    BoundedBuffer* bb = (BoundedBuffer*)arg;
    for (int i = 0; i < 20; i++) {
        produce(bb, i);
        usleep(100000);  // 100ms
    }
    return NULL;
}

void* consumer(void* arg) {
    BoundedBuffer* bb = (BoundedBuffer*)arg;
    for (int i = 0; i < 20; i++) {
        int item = consume(bb);
        usleep(150000);  // 150ms
    }
    return NULL;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-300 mb-3",children:"Semáforo con Timeout:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-pink-400 overflow-x-auto",children:`#include <time.h>
#include <errno.h>

int wait_with_timeout(sem_t* sem, int timeout_seconds) {
    struct timespec ts;
    
    // Calcular tiempo absoluto de timeout
    clock_gettime(CLOCK_REALTIME, &ts);
    ts.tv_sec += timeout_seconds;
    
    // Esperar con timeout
    int result = sem_timedwait(sem, &ts);
    
    if (result == -1) {
        if (errno == ETIMEDOUT) {
            printf("Timeout: No se recibió señal en %d segundos\\n", 
                   timeout_seconds);
            return -1;
        } else {
            perror("sem_timedwait");
            return -1;
        }
    }
    
    printf("Señal recibida dentro del timeout\\n");
    return 0;
}

void* waiter_with_timeout_thread(void* arg) {
    sem_t* sem = (sem_t*)arg;
    
    printf("Esperando señal (timeout 5s)...\\n");
    
    if (wait_with_timeout(sem, 5) == 0) {
        printf("Procesando después de recibir señal\\n");
    } else {
        printf("Procediendo sin señal (timeout)\\n");
    }
    
    return NULL;
}`})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-900/20 p-4 rounded-lg border border-green-600/30",children:[e.jsx("h4",{className:"font-semibold text-green-300 mb-3",children:"✅ Ventajas:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsx("li",{children:"• No lost wakeups (contador persiste)"}),e.jsx("li",{children:"• Más simple que condition variables"}),e.jsx("li",{children:"• No necesita loop de verificación"}),e.jsx("li",{children:"• Ideal para producer-consumer"}),e.jsx("li",{children:"• Soporte para counting semaphore"})]})]}),e.jsxs("div",{className:"bg-red-900/20 p-4 rounded-lg border border-red-600/30",children:[e.jsx("h4",{className:"font-semibold text-red-300 mb-3",children:"❌ Limitaciones:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsx("li",{children:"• No puede esperar múltiples condiciones"}),e.jsx("li",{children:"• No hay broadcast nativo"}),e.jsx("li",{children:"• Menos flexible que CV"}),e.jsx("li",{children:"• Difícil debugging del contador"}),e.jsx("li",{children:"• No es reentrant en algunos sistemas"})]})]})]}),e.jsxs("div",{className:"bg-blue-900/20 p-4 rounded-lg border border-blue-600/30",children:[e.jsx("h4",{className:"font-semibold text-blue-300 mb-3",children:"Comparación: Semáforo vs Condition Variable"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-blue-600/50",children:[e.jsx("th",{className:"text-left p-2 text-blue-300",children:"Característica"}),e.jsx("th",{className:"text-left p-2 text-blue-300",children:"Semáforo"}),e.jsx("th",{className:"text-left p-2 text-blue-300",children:"Condition Variable"})]})}),e.jsxs("tbody",{className:"text-gray-300",children:[e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("td",{className:"p-2",children:"Lost Wakeup"}),e.jsx("td",{className:"p-2 text-green-400",children:"✓ Evita (contador)"}),e.jsx("td",{className:"p-2 text-yellow-400",children:"Requiere mutex"})]}),e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("td",{className:"p-2",children:"Complejidad"}),e.jsx("td",{className:"p-2 text-green-400",children:"Simple"}),e.jsx("td",{className:"p-2 text-yellow-400",children:"Media (requiere mutex)"})]}),e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("td",{className:"p-2",children:"Broadcast"}),e.jsx("td",{className:"p-2 text-red-400",children:"No nativo"}),e.jsx("td",{className:"p-2 text-green-400",children:"✓ Soportado"})]}),e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("td",{className:"p-2",children:"Múltiples Condiciones"}),e.jsx("td",{className:"p-2 text-red-400",children:"Difícil"}),e.jsx("td",{className:"p-2 text-green-400",children:"✓ Fácil"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2",children:"Uso Típico"}),e.jsx("td",{className:"p-2",children:"Producer-Consumer"}),e.jsx("td",{className:"p-2",children:"Sincronización compleja"})]})]})]})})]})]})}),e.jsx(ue,{value:"state",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-green-900/20 to-slate-800/20 p-6 rounded-lg border border-green-700/50",children:[e.jsxs("h3",{className:"text-2xl font-bold text-green-300 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl",children:"📊"}),"Solución 3: State Tracking (Seguimiento de Estado)"]}),e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("p",{className:"text-gray-300 mb-4",children:"Mantener un estado explícito que persiste entre señalización y espera. El waiter verifica el estado antes de esperar, evitando esperas innecesarias si la condición ya se cumplió."})}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-green-600/30 mb-6",children:[e.jsx("h4",{className:"font-semibold text-green-300 mb-3",children:"Conceptos Clave:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Estado Persistente:"})," Flag booleano o contador que persiste"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Check Before Wait:"})," Verificar estado antes de esperar"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Protección Atómica:"})," Mutex protege estado y signal"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Event History:"})," Rastrea si evento ya ocurrió"]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-green-300 mb-3",children:"Patrón Básico (Flag Booleano):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-green-400 overflow-x-auto",children:`struct StateTracking {
    pthread_mutex_t mutex;
    pthread_cond_t  cond_var;
    bool            event_occurred;  // ¡Clave! Persiste el estado
    int             data;
};

void init_state_tracking(StateTracking* st) {
    pthread_mutex_init(&st->mutex, NULL);
    pthread_cond_init(&st->cond_var, NULL);
    st->event_occurred = false;
    st->data = 0;
}

// WAITER: Verifica estado antes de esperar
void* waiter_thread(void* arg) {
    StateTracking* st = (StateTracking*)arg;
    
    pthread_mutex_lock(&st->mutex);
    
    // Verificar estado - si ya ocurrió, no esperamos
    while (!st->event_occurred) {
        printf("Waiter: Evento no ocurrido, esperando...\\n");
        pthread_cond_wait(&st->cond_var, &st->mutex);
    }
    
    // Evento ya ocurrió (o acabamos de recibirlo)
    printf("Waiter: Evento detectado! Data = %d\\n", st->data);
    
    // Opcional: Resetear para permitir re-uso
    st->event_occurred = false;
    
    pthread_mutex_unlock(&st->mutex);
    return NULL;
}

// SIGNALER: Establece estado y señaliza
void* signaler_thread(void* arg) {
    StateTracking* st = (StateTracking*)arg;
    
    sleep(1);
    
    pthread_mutex_lock(&st->mutex);
    
    // Establecer estado ANTES de señalizar
    st->data = 42;
    st->event_occurred = true;  // Marca que evento ocurrió
    
    printf("Signaler: Evento marcado, señalizando...\\n");
    
    pthread_cond_signal(&st->cond_var);
    
    pthread_mutex_unlock(&st->mutex);
    return NULL;
}

// Si waiter llega tarde, ve event_occurred=true y no espera
// Si waiter llega temprano, espera pero estado está protegido`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-green-300 mb-3",children:"Tracking con Contador (Múltiples Eventos):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-cyan-400 overflow-x-auto",children:`struct EventCounter {
    pthread_mutex_t mutex;
    pthread_cond_t  cond_var;
    int             event_count;     // Cuenta cuántos eventos ocurrieron
    int             processed_count; // Cuántos procesamos
};

void init_event_counter(EventCounter* ec) {
    pthread_mutex_init(&ec->mutex, NULL);
    pthread_cond_init(&ec->cond_var, NULL);
    ec->event_count = 0;
    ec->processed_count = 0;
}

// Producer: Incrementa contador
void signal_event(EventCounter* ec, int value) {
    pthread_mutex_lock(&ec->mutex);
    
    ec->event_count++;
    printf("Event #%d signaled\\n", ec->event_count);
    
    pthread_cond_signal(&ec->cond_var);
    
    pthread_mutex_unlock(&ec->mutex);
}

// Consumer: Procesa eventos pendientes
void* event_processor(void* arg) {
    EventCounter* ec = (EventCounter*)arg;
    
    pthread_mutex_lock(&ec->mutex);
    
    while (ec->processed_count < 10) {  // Procesar 10 eventos
        // Esperar mientras no haya eventos nuevos
        while (ec->event_count == ec->processed_count) {
            printf("Processor: Esperando eventos...\\n");
            pthread_cond_wait(&ec->cond_var, &ec->mutex);
        }
        
        // Procesar eventos pendientes
        while (ec->processed_count < ec->event_count) {
            ec->processed_count++;
            printf("Processor: Procesado evento #%d\\n", 
                   ec->processed_count);
        }
    }
    
    pthread_mutex_unlock(&ec->mutex);
    return NULL;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-green-300 mb-3",children:"Estado Complejo (Máquina de Estados):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-yellow-400 overflow-x-auto",children:`enum TaskState {
    IDLE,
    PENDING,
    RUNNING,
    COMPLETED,
    FAILED
};

struct Task {
    pthread_mutex_t mutex;
    pthread_cond_t  state_changed;
    TaskState       state;
    int             result;
    char            error_msg[256];
};

void init_task(Task* task) {
    pthread_mutex_init(&task->mutex, NULL);
    pthread_cond_init(&task->state_changed, NULL);
    task->state = IDLE;
    task->result = 0;
    task->error_msg[0] = '\\0';
}

// Worker: Ejecuta tarea y actualiza estado
void* worker_thread(void* arg) {
    Task* task = (Task*)arg;
    
    pthread_mutex_lock(&task->mutex);
    task->state = RUNNING;
    pthread_cond_broadcast(&task->state_changed);
    pthread_mutex_unlock(&task->mutex);
    
    printf("Worker: Ejecutando tarea...\\n");
    sleep(2);  // Simular trabajo
    
    // Completar con éxito o error
    pthread_mutex_lock(&task->mutex);
    if (rand() % 2) {
        task->state = COMPLETED;
        task->result = 42;
    } else {
        task->state = FAILED;
        strcpy(task->error_msg, "Error simulado");
    }
    pthread_cond_broadcast(&task->state_changed);
    pthread_mutex_unlock(&task->mutex);
    
    return NULL;
}

// Waiter: Espera estado específico
TaskState wait_for_completion(Task* task) {
    pthread_mutex_lock(&task->mutex);
    
    // Esperar hasta que tarea complete (éxito o error)
    while (task->state != COMPLETED && task->state != FAILED) {
        printf("Waiting for task completion...\\n");
        pthread_cond_wait(&task->state_changed, &task->mutex);
    }
    
    TaskState final_state = task->state;
    
    if (final_state == COMPLETED) {
        printf("Task completed successfully: %d\\n", task->result);
    } else {
        printf("Task failed: %s\\n", task->error_msg);
    }
    
    pthread_mutex_unlock(&task->mutex);
    return final_state;
}

// Enviar tarea
void submit_task(Task* task) {
    pthread_mutex_lock(&task->mutex);
    task->state = PENDING;
    pthread_cond_broadcast(&task->state_changed);
    pthread_mutex_unlock(&task->mutex);
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-green-300 mb-3",children:"Message Queue con State Tracking:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-purple-400 overflow-x-auto",children:`#define MAX_MESSAGES 100

struct Message {
    int id;
    int value;
    time_t timestamp;
};

struct MessageQueue {
    pthread_mutex_t mutex;
    pthread_cond_t  not_empty;
    pthread_cond_t  not_full;
    
    Message messages[MAX_MESSAGES];
    int     count;          // Estado: cuántos mensajes
    int     head;
    int     tail;
    bool    shutdown;       // Estado: shutdown solicitado
};

void init_message_queue(MessageQueue* mq) {
    pthread_mutex_init(&mq->mutex, NULL);
    pthread_cond_init(&mq->not_empty, NULL);
    pthread_cond_init(&mq->not_full, NULL);
    mq->count = 0;
    mq->head = 0;
    mq->tail = 0;
    mq->shutdown = false;
}

// Producer
void enqueue_message(MessageQueue* mq, Message msg) {
    pthread_mutex_lock(&mq->mutex);
    
    // Esperar si cola llena (verificar estado)
    while (mq->count == MAX_MESSAGES && !mq->shutdown) {
        pthread_cond_wait(&mq->not_full, &mq->mutex);
    }
    
    if (mq->shutdown) {
        pthread_mutex_unlock(&mq->mutex);
        return;
    }
    
    // Agregar mensaje
    mq->messages[mq->tail] = msg;
    mq->tail = (mq->tail + 1) % MAX_MESSAGES;
    mq->count++;
    
    // Señalizar que hay nuevo mensaje
    pthread_cond_signal(&mq->not_empty);
    
    pthread_mutex_unlock(&mq->mutex);
}

// Consumer
bool dequeue_message(MessageQueue* mq, Message* msg) {
    pthread_mutex_lock(&mq->mutex);
    
    // Esperar mientras vacía (verificar estado)
    while (mq->count == 0 && !mq->shutdown) {
        pthread_cond_wait(&mq->not_empty, &mq->mutex);
    }
    
    // Si shutdown y vacía, terminar
    if (mq->shutdown && mq->count == 0) {
        pthread_mutex_unlock(&mq->mutex);
        return false;
    }
    
    // Extraer mensaje
    *msg = mq->messages[mq->head];
    mq->head = (mq->head + 1) % MAX_MESSAGES;
    mq->count--;
    
    // Señalizar que hay espacio
    pthread_cond_signal(&mq->not_full);
    
    pthread_mutex_unlock(&mq->mutex);
    return true;
}

// Shutdown graceful
void shutdown_queue(MessageQueue* mq) {
    pthread_mutex_lock(&mq->mutex);
    mq->shutdown = true;
    
    // Despertar todos los waiters
    pthread_cond_broadcast(&mq->not_empty);
    pthread_cond_broadcast(&mq->not_full);
    
    pthread_mutex_unlock(&mq->mutex);
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-green-300 mb-3",children:"Generation Counter (Detectar Cambios):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-orange-400 overflow-x-auto",children:`struct GenerationState {
    pthread_mutex_t mutex;
    pthread_cond_t  cond_var;
    unsigned long   generation;  // Incrementa en cada cambio
    int             value;
};

void init_generation_state(GenerationState* gs) {
    pthread_mutex_init(&gs->mutex, NULL);
    pthread_cond_init(&gs->cond_var, NULL);
    gs->generation = 0;
    gs->value = 0;
}

// Actualizar valor e incrementar generación
void update_value(GenerationState* gs, int new_value) {
    pthread_mutex_lock(&gs->mutex);
    
    gs->value = new_value;
    gs->generation++;  // Nueva generación
    
    printf("Updated to generation %lu, value=%d\\n", 
           gs->generation, gs->value);
    
    pthread_cond_broadcast(&gs->cond_var);
    
    pthread_mutex_unlock(&gs->mutex);
}

// Esperar cambio específico desde generación conocida
int wait_for_change(GenerationState* gs, unsigned long last_gen) {
    pthread_mutex_lock(&gs->mutex);
    
    // Esperar hasta que generación cambie
    while (gs->generation == last_gen) {
        printf("Waiting for generation change from %lu...\\n", last_gen);
        pthread_cond_wait(&gs->cond_var, &gs->mutex);
    }
    
    int current_value = gs->value;
    unsigned long current_gen = gs->generation;
    
    printf("Detected change: gen %lu -> %lu, value=%d\\n", 
           last_gen, current_gen, current_value);
    
    pthread_mutex_unlock(&gs->mutex);
    return current_value;
}

// Observer que procesa todos los cambios
void* observer_thread(void* arg) {
    GenerationState* gs = (GenerationState*)arg;
    unsigned long my_generation = 0;
    
    for (int i = 0; i < 5; i++) {
        int value = wait_for_change(gs, my_generation);
        
        pthread_mutex_lock(&gs->mutex);
        my_generation = gs->generation;
        pthread_mutex_unlock(&gs->mutex);
        
        printf("Observer processed value %d\\n", value);
    }
    
    return NULL;
}`})})]}),e.jsxs("div",{className:"bg-green-900/20 p-4 rounded-lg border border-green-600/30 mb-6",children:[e.jsx("h4",{className:"font-semibold text-green-300 mb-3",children:"✅ Ventajas del State Tracking:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"No Lost Signals:"})," Estado persiste independientemente del timing"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Debugging Fácil:"})," Estado visible inspecciona fácilmente"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Flexible:"})," Puede rastrear estados complejos (FSM, counters, flags)"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Historial:"})," Generation counters permiten detectar cambios perdidos"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Graceful Shutdown:"})," Flag de shutdown permite terminación limpia"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Múltiples Condiciones:"})," Diferentes estados para diferentes eventos"]})]})]}),e.jsxs("div",{className:"bg-blue-900/20 p-4 rounded-lg border border-blue-600/30",children:[e.jsx("h4",{className:"font-semibold text-blue-300 mb-3",children:"📋 Best Practices:"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"1."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Siempre proteger estado con mutex"})," - Evita race conditions"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"2."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Usar WHILE loop para verificar"})," - Maneja spurious wakeups"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"3."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Broadcast para múltiples waiters"})," - Todos ven el cambio de estado"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"4."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Documentar transiciones de estado"})," - FSM diagrams ayudan"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"5."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Generation counters para secuencias"})," - Detecta eventos perdidos"]})]})]})]})]})}),e.jsx(ue,{value:"broadcast",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-orange-900/20 to-slate-800/20 p-6 rounded-lg border border-orange-700/50",children:[e.jsxs("h3",{className:"text-2xl font-bold text-orange-300 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl",children:"📢"}),"Solución 4: Broadcast en lugar de Signal"]}),e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("p",{className:"text-gray-300 mb-4",children:"Usar broadcast (pthread_cond_broadcast) en lugar de signal garantiza que todos los threads esperando sean notificados. Esto es especialmente útil cuando múltiples threads pueden estar esperando la misma condición o cuando no sabemos cuántos waiters hay."})}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-orange-600/30 mb-6",children:[e.jsx("h4",{className:"font-semibold text-orange-300 mb-3",children:"Conceptos Clave:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"pthread_cond_broadcast():"})," Despierta TODOS los threads esperando"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"pthread_cond_signal():"})," Despierta solo UN thread (puede ser el incorrecto)"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Thundering Herd:"})," Trade-off - broadcast puede causar despertar innecesario"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Safety over Performance:"})," Broadcast es más seguro pero menos eficiente"]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-orange-300 mb-3",children:"Signal vs Broadcast:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-yellow-900/20 p-4 rounded-lg border border-yellow-600/30",children:[e.jsx("h5",{className:"font-semibold text-yellow-300 mb-2",children:"pthread_cond_signal()"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-300",children:[e.jsx("li",{children:"• Despierta 1 thread aleatorio"}),e.jsx("li",{children:"• Más eficiente (menos context switches)"}),e.jsx("li",{children:"• Puede despertar thread incorrecto"}),e.jsx("li",{children:"• Riesgo de lost wakeup si hay múltiples condiciones"}),e.jsx("li",{children:"• Uso: 1 waiter o condición única"})]})]}),e.jsxs("div",{className:"bg-orange-900/20 p-4 rounded-lg border border-orange-600/30",children:[e.jsx("h5",{className:"font-semibold text-orange-300 mb-2",children:"pthread_cond_broadcast()"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-300",children:[e.jsx("li",{children:"• Despierta TODOS los threads"}),e.jsx("li",{children:"• Menos eficiente (más wakeups)"}),e.jsx("li",{children:"• Garantiza que ninguno se pierda"}),e.jsx("li",{children:"• Seguro con múltiples condiciones"}),e.jsx("li",{children:"• Uso: Múltiples waiters o condiciones"})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-orange-300 mb-3",children:"Caso 1: Múltiples Condiciones (Broadcast necesario):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-cyan-400 overflow-x-auto",children:`struct MultiConditionState {
    pthread_mutex_t mutex;
    pthread_cond_t  cond_var;
    int             value;
    bool            threshold_reached;  // Condición 1
    bool            data_ready;         // Condición 2
    bool            shutdown;           // Condición 3
};

// Waiter 1: Espera threshold
void* threshold_waiter(void* arg) {
    MultiConditionState* state = (MultiConditionState*)arg;
    
    pthread_mutex_lock(&state->mutex);
    
    while (!state->threshold_reached && !state->shutdown) {
        pthread_cond_wait(&state->cond_var, &state->mutex);
    }
    
    if (state->shutdown) {
        printf("Threshold waiter: Shutdown\\n");
    } else {
        printf("Threshold waiter: Threshold reached (value=%d)\\n", 
               state->value);
    }
    
    pthread_mutex_unlock(&state->mutex);
    return NULL;
}

// Waiter 2: Espera data ready
void* data_waiter(void* arg) {
    MultiConditionState* state = (MultiConditionState*)arg;
    
    pthread_mutex_lock(&state->mutex);
    
    while (!state->data_ready && !state->shutdown) {
        pthread_cond_wait(&state->cond_var, &state->mutex);
    }
    
    if (state->shutdown) {
        printf("Data waiter: Shutdown\\n");
    } else {
        printf("Data waiter: Data ready (value=%d)\\n", 
               state->value);
    }
    
    pthread_mutex_unlock(&state->mutex);
    return NULL;
}

// Signaler: DEBE usar broadcast
void signal_threshold(MultiConditionState* state, int new_value) {
    pthread_mutex_lock(&state->mutex);
    
    state->value = new_value;
    state->threshold_reached = (new_value > 100);
    
    // ❌ signal() puede despertar data_waiter (thread incorrecto!)
    // ✅ broadcast() despierta ambos, cada uno verifica su condición
    pthread_cond_broadcast(&state->cond_var);
    
    pthread_mutex_unlock(&state->mutex);
}

void signal_data_ready(MultiConditionState* state, int data) {
    pthread_mutex_lock(&state->mutex);
    
    state->value = data;
    state->data_ready = true;
    
    // broadcast() garantiza que data_waiter recibe señal
    pthread_cond_broadcast(&state->cond_var);
    
    pthread_mutex_unlock(&state->mutex);
}

void signal_shutdown(MultiConditionState* state) {
    pthread_mutex_lock(&state->mutex);
    state->shutdown = true;
    
    // broadcast() para despertar TODOS los waiters
    pthread_cond_broadcast(&state->cond_var);
    
    pthread_mutex_unlock(&state->mutex);
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-orange-300 mb-3",children:"Caso 2: Barrier Pattern (Broadcast esencial):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-green-400 overflow-x-auto",children:`struct Barrier {
    pthread_mutex_t mutex;
    pthread_cond_t  cond_var;
    int             count;          // Threads esperando
    int             threshold;      // Total threads necesarios
    int             generation;     // Para reutilizar barrier
};

void init_barrier(Barrier* barrier, int num_threads) {
    pthread_mutex_init(&barrier->mutex, NULL);
    pthread_cond_init(&barrier->cond_var, NULL);
    barrier->count = 0;
    barrier->threshold = num_threads;
    barrier->generation = 0;
}

// Todos los threads esperan hasta que todos lleguen
void barrier_wait(Barrier* barrier) {
    pthread_mutex_lock(&barrier->mutex);
    
    int my_generation = barrier->generation;
    barrier->count++;
    
    if (barrier->count == barrier->threshold) {
        // Último thread: despertar a TODOS
        barrier->count = 0;
        barrier->generation++;
        
        printf("Barrier: Todos llegaron, liberando...\\n");
        
        // ❌ signal() solo despertaría 1 thread!
        // ✅ broadcast() despierta a TODOS
        pthread_cond_broadcast(&barrier->cond_var);
    } else {
        // Esperar hasta que todos lleguen
        while (my_generation == barrier->generation) {
            pthread_cond_wait(&barrier->cond_var, &barrier->mutex);
        }
    }
    
    pthread_mutex_unlock(&barrier->mutex);
}

void* worker_with_barrier(void* arg) {
    Barrier* barrier = (Barrier*)arg;
    int tid = (int)(long)pthread_self();
    
    printf("Thread %d: Fase 1\\n", tid);
    sleep(rand() % 3);
    
    printf("Thread %d: Llegó al barrier\\n", tid);
    barrier_wait(barrier);
    
    printf("Thread %d: Fase 2 (después del barrier)\\n", tid);
    
    return NULL;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-orange-300 mb-3",children:"Caso 3: Read-Write Lock (Broadcast selectivo):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-yellow-400 overflow-x-auto",children:`struct RWLock {
    pthread_mutex_t mutex;
    pthread_cond_t  read_cond;
    pthread_cond_t  write_cond;
    int             readers;        // Número de readers activos
    int             writers;        // Número de writers activos (0 o 1)
    int             waiting_writers;
};

void init_rwlock(RWLock* rwl) {
    pthread_mutex_init(&rwl->mutex, NULL);
    pthread_cond_init(&rwl->read_cond, NULL);
    pthread_cond_init(&rwl->write_cond, NULL);
    rwl->readers = 0;
    rwl->writers = 0;
    rwl->waiting_writers = 0;
}

void read_lock(RWLock* rwl) {
    pthread_mutex_lock(&rwl->mutex);
    
    // Esperar mientras hay writer activo
    while (rwl->writers > 0 || rwl->waiting_writers > 0) {
        pthread_cond_wait(&rwl->read_cond, &rwl->mutex);
    }
    
    rwl->readers++;
    
    pthread_mutex_unlock(&rwl->mutex);
}

void read_unlock(RWLock* rwl) {
    pthread_mutex_lock(&rwl->mutex);
    
    rwl->readers--;
    
    // Si último reader, despertar writers esperando
    if (rwl->readers == 0) {
        // signal() suficiente - solo 1 writer puede proceder
        pthread_cond_signal(&rwl->write_cond);
    }
    
    pthread_mutex_unlock(&rwl->mutex);
}

void write_lock(RWLock* rwl) {
    pthread_mutex_lock(&rwl->mutex);
    
    rwl->waiting_writers++;
    
    // Esperar mientras hay readers o writers activos
    while (rwl->readers > 0 || rwl->writers > 0) {
        pthread_cond_wait(&rwl->write_cond, &rwl->mutex);
    }
    
    rwl->waiting_writers--;
    rwl->writers = 1;
    
    pthread_mutex_unlock(&rwl->mutex);
}

void write_unlock(RWLock* rwl) {
    pthread_mutex_lock(&rwl->mutex);
    
    rwl->writers = 0;
    
    if (rwl->waiting_writers > 0) {
        // Despertar próximo writer
        pthread_cond_signal(&rwl->write_cond);
    } else {
        // ✅ Despertar TODOS los readers esperando
        // broadcast() permite múltiples readers concurrentes
        pthread_cond_broadcast(&rwl->read_cond);
    }
    
    pthread_mutex_unlock(&rwl->mutex);
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-orange-300 mb-3",children:"Caso 4: Phase Change (Global State Change):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-purple-400 overflow-x-auto",children:`enum Phase {
    INITIALIZING,
    RUNNING,
    PAUSED,
    TERMINATING
};

struct Application {
    pthread_mutex_t mutex;
    pthread_cond_t  phase_changed;
    Phase           current_phase;
    int             active_workers;
};

void init_application(Application* app) {
    pthread_mutex_init(&app->mutex, NULL);
    pthread_cond_init(&app->phase_changed, NULL);
    app->current_phase = INITIALIZING;
    app->active_workers = 0;
}

// Cambiar fase global
void change_phase(Application* app, Phase new_phase) {
    pthread_mutex_lock(&app->mutex);
    
    Phase old_phase = app->current_phase;
    app->current_phase = new_phase;
    
    printf("Phase change: %d -> %d\\n", old_phase, new_phase);
    
    // ✅ Broadcast: TODOS los workers deben reaccionar al cambio
    pthread_cond_broadcast(&app->phase_changed);
    
    pthread_mutex_unlock(&app->mutex);
}

void* worker(void* arg) {
    Application* app = (Application*)arg;
    
    pthread_mutex_lock(&app->mutex);
    
    // Esperar fase RUNNING
    while (app->current_phase == INITIALIZING) {
        pthread_cond_wait(&app->phase_changed, &app->mutex);
    }
    
    app->active_workers++;
    pthread_mutex_unlock(&app->mutex);
    
    // Loop principal
    while (true) {
        pthread_mutex_lock(&app->mutex);
        
        Phase phase = app->current_phase;
        
        if (phase == TERMINATING) {
            app->active_workers--;
            pthread_mutex_unlock(&app->mutex);
            break;
        }
        
        if (phase == PAUSED) {
            // Esperar hasta que no esté pausado
            while (app->current_phase == PAUSED) {
                pthread_cond_wait(&app->phase_changed, &app->mutex);
            }
        }
        
        pthread_mutex_unlock(&app->mutex);
        
        // Hacer trabajo
        printf("Worker: Procesando...\\n");
        usleep(500000);
    }
    
    printf("Worker: Terminado\\n");
    return NULL;
}

// Shutdown graceful
void shutdown_application(Application* app) {
    change_phase(app, TERMINATING);
    
    // Esperar que todos los workers terminen
    pthread_mutex_lock(&app->mutex);
    while (app->active_workers > 0) {
        pthread_cond_wait(&app->phase_changed, &app->mutex);
    }
    pthread_mutex_unlock(&app->mutex);
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-orange-300 mb-3",children:"Optimización: Broadcast Condicional:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-pink-400 overflow-x-auto",children:`struct SmartQueue {
    pthread_mutex_t mutex;
    pthread_cond_t  cond_var;
    int             queue[100];
    int             count;
    int             waiting_consumers;
};

void smart_enqueue(SmartQueue* sq, int item) {
    pthread_mutex_lock(&sq->mutex);
    
    bool was_empty = (sq->count == 0);
    
    sq->queue[sq->count++] = item;
    
    // Optimización inteligente:
    if (sq->waiting_consumers == 0) {
        // Sin waiters, no señalizar
    } else if (sq->waiting_consumers == 1) {
        // Solo 1 waiter, signal suficiente
        pthread_cond_signal(&sq->cond_var);
    } else if (was_empty) {
        // Múltiples waiters Y cola estaba vacía
        // Broadcast para que todos tengan oportunidad
        pthread_cond_broadcast(&sq->cond_var);
    } else {
        // Ya había items, signal para 1 waiter
        pthread_cond_signal(&sq->cond_var);
    }
    
    pthread_mutex_unlock(&sq->mutex);
}

int smart_dequeue(SmartQueue* sq) {
    pthread_mutex_lock(&sq->mutex);
    
    sq->waiting_consumers++;
    
    while (sq->count == 0) {
        pthread_cond_wait(&sq->cond_var, &sq->mutex);
    }
    
    sq->waiting_consumers--;
    
    int item = sq->queue[0];
    for (int i = 0; i < sq->count - 1; i++) {
        sq->queue[i] = sq->queue[i + 1];
    }
    sq->count--;
    
    pthread_mutex_unlock(&sq->mutex);
    return item;
}`})})]}),e.jsxs("div",{className:"bg-blue-900/20 p-4 rounded-lg border border-blue-600/30",children:[e.jsx("h4",{className:"font-semibold text-blue-300 mb-3",children:"🎯 Guía de Decisión:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-green-300 mb-2",children:"Usar signal() cuando:"}),e.jsxs("ul",{className:"space-y-1 text-gray-300",children:[e.jsx("li",{children:"✓ Solo 1 thread puede proceder"}),e.jsx("li",{children:"✓ Condición única y clara"}),e.jsx("li",{children:"✓ Performance es crítica"}),e.jsx("li",{children:"✓ Producer-Consumer simple"}),e.jsx("li",{children:"✓ FIFO ordering importante"})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-orange-300 mb-2",children:"Usar broadcast() cuando:"}),e.jsxs("ul",{className:"space-y-1 text-gray-300",children:[e.jsx("li",{children:"✓ Múltiples threads deben proceder"}),e.jsx("li",{children:"✓ Múltiples condiciones en mismo CV"}),e.jsx("li",{children:"✓ State change global"}),e.jsx("li",{children:"✓ Barrier o sync point"}),e.jsx("li",{children:"✓ Shutdown/cleanup"})]})]})]})]})]})}),e.jsx(ue,{value:"timeout",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-red-900/20 to-slate-800/20 p-6 rounded-lg border border-red-700/50",children:[e.jsxs("h3",{className:"text-2xl font-bold text-red-300 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl",children:"⏱️"}),"Solución 5: Timeout en Esperas"]}),e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("p",{className:"text-gray-300 mb-4",children:"Usar timeouts en operaciones de espera previene deadlocks y permite detección temprana de problemas. Si un wakeup se pierde, el timeout permite al thread recuperarse en lugar de bloquearse indefinidamente."})}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-red-600/30 mb-6",children:[e.jsx("h4",{className:"font-semibold text-red-300 mb-3",children:"Conceptos Clave:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"pthread_cond_timedwait():"})," Wait con deadline absoluto"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"sem_timedwait():"})," Semaphore wait con timeout"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ETIMEDOUT:"})," Error code cuando expira timeout"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Absolute Time:"})," Timeouts usan tiempo absoluto, no relativo"]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-red-300 mb-3",children:"Timeout Básico con Condition Variables:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-cyan-400 overflow-x-auto",children:`#include <time.h>
#include <errno.h>

struct TimeoutState {
    pthread_mutex_t mutex;
    pthread_cond_t  cond_var;
    bool            condition_met;
    int             data;
};

// Función helper: Calcular timeout absoluto
void set_timeout(struct timespec* ts, int seconds) {
    // Obtener tiempo actual
    clock_gettime(CLOCK_REALTIME, ts);
    
    // Agregar offset
    ts->tv_sec += seconds;
}

// Alternativa con milisegundos
void set_timeout_ms(struct timespec* ts, int milliseconds) {
    clock_gettime(CLOCK_REALTIME, ts);
    
    ts->tv_sec += milliseconds / 1000;
    ts->tv_nsec += (milliseconds % 1000) * 1000000;
    
    // Normalizar si nsec >= 1 segundo
    if (ts->tv_nsec >= 1000000000) {
        ts->tv_sec++;
        ts->tv_nsec -= 1000000000;
    }
}

// Wait con timeout
int wait_with_timeout(TimeoutState* state, int timeout_seconds) {
    struct timespec timeout;
    set_timeout(&timeout, timeout_seconds);
    
    pthread_mutex_lock(&state->mutex);
    
    int result = 0;
    
    while (!state->condition_met && result == 0) {
        // timedwait retorna 0 si despierta por signal
        // retorna ETIMEDOUT si expira timeout
        result = pthread_cond_timedwait(
            &state->cond_var,
            &state->mutex,
            &timeout
        );
    }
    
    if (result == ETIMEDOUT) {
        printf("Timeout: Condición no cumplida en %d segundos\\n", 
               timeout_seconds);
        pthread_mutex_unlock(&state->mutex);
        return -1;
    }
    
    // Condición cumplida
    printf("Condición cumplida: data=%d\\n", state->data);
    
    pthread_mutex_unlock(&state->mutex);
    return 0;
}

// Ejemplo con retry logic
int wait_with_retry(TimeoutState* state, int retries, int timeout_sec) {
    for (int i = 0; i < retries; i++) {
        printf("Intento %d/%d\\n", i + 1, retries);
        
        if (wait_with_timeout(state, timeout_sec) == 0) {
            return 0;  // Éxito
        }
        
        printf("Timeout, reintentando...\\n");
    }
    
    printf("Error: Fallaron todos los intentos\\n");
    return -1;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-red-300 mb-3",children:"Timeout con Semáforos:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-green-400 overflow-x-auto",children:`#include <semaphore.h>

struct SemaphoreTimeout {
    sem_t sem;
    int   resource_available;
};

// Adquirir recurso con timeout
int acquire_with_timeout(SemaphoreTimeout* st, int timeout_sec) {
    struct timespec ts;
    set_timeout(&ts, timeout_sec);
    
    int result = sem_timedwait(&st->sem, &ts);
    
    if (result == -1) {
        if (errno == ETIMEDOUT) {
            printf("Timeout: Recurso no disponible\\n");
            return -1;
        } else if (errno == EINTR) {
            printf("Interrupted: Reintentando...\\n");
            return acquire_with_timeout(st, timeout_sec);
        } else {
            perror("sem_timedwait");
            return -1;
        }
    }
    
    printf("Recurso adquirido\\n");
    return 0;
}

// Patrón try-acquire
bool try_acquire(SemaphoreTimeout* st) {
    struct timespec ts;
    clock_gettime(CLOCK_REALTIME, &ts);
    // Timeout inmediato (solo verificar disponibilidad)
    
    return (sem_timedwait(&st->sem, &ts) == 0);
}

// Pool de recursos con timeout
#define POOL_SIZE 5

struct ResourcePool {
    sem_t available[POOL_SIZE];
    int   resource_data[POOL_SIZE];
};

int acquire_any_resource(ResourcePool* pool, int timeout_sec) {
    struct timespec deadline;
    set_timeout(&deadline, timeout_sec);
    
    // Intentar adquirir cualquier recurso
    while (true) {
        for (int i = 0; i < POOL_SIZE; i++) {
            struct timespec now;
            clock_gettime(CLOCK_REALTIME, &now);
            
            // Verificar si excedimos deadline
            if (now.tv_sec > deadline.tv_sec ||
                (now.tv_sec == deadline.tv_sec && 
                 now.tv_nsec >= deadline.tv_nsec)) {
                printf("Timeout: Ningún recurso disponible\\n");
                return -1;
            }
            
            // Try-acquire (timeout corto)
            struct timespec short_timeout = now;
            short_timeout.tv_nsec += 10000000;  // 10ms
            if (short_timeout.tv_nsec >= 1000000000) {
                short_timeout.tv_sec++;
                short_timeout.tv_nsec -= 1000000000;
            }
            
            if (sem_timedwait(&pool->available[i], &short_timeout) == 0) {
                printf("Adquirido recurso %d\\n", i);
                return i;
            }
        }
        
        usleep(1000);  // 1ms entre rondas
    }
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-red-300 mb-3",children:"Request-Response con Timeout:"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-yellow-400 overflow-x-auto",children:`struct Request {
    int             id;
    void*           data;
    pthread_mutex_t mutex;
    pthread_cond_t  response_ready;
    bool            completed;
    void*           response;
    int             error_code;
};

void init_request(Request* req, int id, void* data) {
    req->id = id;
    req->data = data;
    pthread_mutex_init(&req->mutex, NULL);
    pthread_cond_init(&req->response_ready, NULL);
    req->completed = false;
    req->response = NULL;
    req->error_code = 0;
}

// Cliente: Envía request y espera response con timeout
void* send_request_with_timeout(Request* req, int timeout_sec) {
    struct timespec deadline;
    set_timeout(&deadline, timeout_sec);
    
    // Enviar request (simulated)
    printf("Request %d: Enviando...\\n", req->id);
    
    pthread_mutex_lock(&req->mutex);
    
    int result = 0;
    
    // Esperar respuesta
    while (!req->completed && result == 0) {
        result = pthread_cond_timedwait(
            &req->response_ready,
            &req->mutex,
            &deadline
        );
    }
    
    if (result == ETIMEDOUT) {
        printf("Request %d: TIMEOUT\\n", req->id);
        req->error_code = ETIMEDOUT;
        pthread_mutex_unlock(&req->mutex);
        return NULL;
    }
    
    void* response = req->response;
    int error = req->error_code;
    
    pthread_mutex_unlock(&req->mutex);
    
    if (error) {
        printf("Request %d: Error %d\\n", req->id, error);
        return NULL;
    }
    
    printf("Request %d: Response recibida\\n", req->id);
    return response;
}

// Servidor: Procesa request y envía response
void complete_request(Request* req, void* response, int error_code) {
    pthread_mutex_lock(&req->mutex);
    
    req->response = response;
    req->error_code = error_code;
    req->completed = true;
    
    pthread_cond_signal(&req->response_ready);
    
    pthread_mutex_unlock(&req->mutex);
}

// Patrón con múltiples requests paralelos
struct MultiRequest {
    Request requests[10];
    int     num_requests;
    pthread_mutex_t mutex;
    pthread_cond_t  any_completed;
    int     completed_count;
};

// Esperar primera respuesta (race)
int wait_for_first_response(MultiRequest* mr, int timeout_sec) {
    struct timespec deadline;
    set_timeout(&deadline, timeout_sec);
    
    pthread_mutex_lock(&mr->mutex);
    
    int result = 0;
    
    while (mr->completed_count == 0 && result == 0) {
        result = pthread_cond_timedwait(
            &mr->any_completed,
            &mr->mutex,
            &deadline
        );
    }
    
    if (result == ETIMEDOUT) {
        printf("Timeout: Ninguna request completó\\n");
        pthread_mutex_unlock(&mr->mutex);
        return -1;
    }
    
    // Buscar primera completada
    for (int i = 0; i < mr->num_requests; i++) {
        if (mr->requests[i].completed) {
            pthread_mutex_unlock(&mr->mutex);
            return i;
        }
    }
    
    pthread_mutex_unlock(&mr->mutex);
    return -1;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-red-300 mb-3",children:"Heartbeat Pattern (Watchdog):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-purple-400 overflow-x-auto",children:`struct Heartbeat {
    pthread_mutex_t mutex;
    pthread_cond_t  pulse;
    time_t          last_heartbeat;
    bool            alive;
};

void init_heartbeat(Heartbeat* hb) {
    pthread_mutex_init(&hb->mutex, NULL);
    pthread_cond_init(&hb->pulse, NULL);
    hb->last_heartbeat = time(NULL);
    hb->alive = true;
}

// Worker envía heartbeats periódicos
void* worker_with_heartbeat(void* arg) {
    Heartbeat* hb = (Heartbeat*)arg;
    
    while (true) {
        pthread_mutex_lock(&hb->mutex);
        
        if (!hb->alive) {
            pthread_mutex_unlock(&hb->mutex);
            break;
        }
        
        // Actualizar heartbeat
        hb->last_heartbeat = time(NULL);
        pthread_cond_signal(&hb->pulse);
        
        pthread_mutex_unlock(&hb->mutex);
        
        // Hacer trabajo
        sleep(1);
    }
    
    return NULL;
}

// Watchdog verifica heartbeats con timeout
void* watchdog(void* arg) {
    Heartbeat* hb = (Heartbeat*)arg;
    const int TIMEOUT_SEC = 5;
    
    while (true) {
        struct timespec deadline;
        set_timeout(&deadline, TIMEOUT_SEC);
        
        pthread_mutex_lock(&hb->mutex);
        
        time_t last = hb->last_heartbeat;
        
        int result = pthread_cond_timedwait(
            &hb->pulse,
            &hb->mutex,
            &deadline
        );
        
        if (result == ETIMEDOUT) {
            time_t now = time(NULL);
            time_t elapsed = now - last;
            
            printf("WATCHDOG: No heartbeat en %ld segundos!\\n", elapsed);
            
            if (elapsed > TIMEOUT_SEC * 2) {
                printf("WATCHDOG: Worker muerto, iniciando recovery\\n");
                hb->alive = false;
                pthread_mutex_unlock(&hb->mutex);
                break;
            }
        }
        
        pthread_mutex_unlock(&hb->mutex);
    }
    
    return NULL;
}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-red-300 mb-3",children:"Adaptive Timeout (Exponential Backoff):"}),e.jsx("div",{className:"bg-slate-950 p-4 rounded-lg border border-slate-600",children:e.jsx("pre",{className:"text-sm text-orange-400 overflow-x-auto",children:`struct AdaptiveTimeout {
    pthread_mutex_t mutex;
    pthread_cond_t  cond_var;
    bool            ready;
    int             current_timeout;
    int             min_timeout;
    int             max_timeout;
};

void init_adaptive_timeout(AdaptiveTimeout* at) {
    pthread_mutex_init(&at->mutex, NULL);
    pthread_cond_init(&at->cond_var, NULL);
    at->ready = false;
    at->current_timeout = 1;     // Start: 1 segundo
    at->min_timeout = 1;
    at->max_timeout = 32;        // Max: 32 segundos
}

int wait_adaptive(AdaptiveTimeout* at) {
    pthread_mutex_lock(&at->mutex);
    
    int attempts = 0;
    
    while (!at->ready) {
        struct timespec deadline;
        set_timeout(&deadline, at->current_timeout);
        
        printf("Attempt %d: Waiting %d seconds...\\n", 
               ++attempts, at->current_timeout);
        
        int result = pthread_cond_timedwait(
            &at->cond_var,
            &at->mutex,
            &deadline
        );
        
        if (result == ETIMEDOUT) {
            // Exponential backoff
            at->current_timeout *= 2;
            if (at->current_timeout > at->max_timeout) {
                at->current_timeout = at->max_timeout;
            }
            
            printf("Timeout, backoff to %d seconds\\n", 
                   at->current_timeout);
        }
    }
    
    // Éxito - reset timeout
    at->current_timeout = at->min_timeout;
    
    pthread_mutex_unlock(&at->mutex);
    return 0;
}

// Jitter para evitar thundering herd
int wait_adaptive_with_jitter(AdaptiveTimeout* at) {
    pthread_mutex_lock(&at->mutex);
    
    while (!at->ready) {
        // Base timeout + random jitter
        int base = at->current_timeout;
        int jitter = rand() % (base / 2);  // 0-50% jitter
        int timeout = base + jitter;
        
        struct timespec deadline;
        set_timeout(&deadline, timeout);
        
        int result = pthread_cond_timedwait(
            &at->cond_var,
            &at->mutex,
            &deadline
        );
        
        if (result == ETIMEDOUT) {
            at->current_timeout = 
                (at->current_timeout * 3) / 2;  // 1.5x backoff
            if (at->current_timeout > at->max_timeout) {
                at->current_timeout = at->max_timeout;
            }
        }
    }
    
    at->current_timeout = at->min_timeout;
    pthread_mutex_unlock(&at->mutex);
    return 0;
}`})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-900/20 p-4 rounded-lg border border-green-600/30",children:[e.jsx("h4",{className:"font-semibold text-green-300 mb-3",children:"✅ Ventajas de Timeouts:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsx("li",{children:"• Previene deadlocks indefinidos"}),e.jsx("li",{children:"• Permite detección de problemas"}),e.jsx("li",{children:"• Facilita recovery automático"}),e.jsx("li",{children:"• Debugging más fácil"}),e.jsx("li",{children:"• SLA/QoS enforcement"}),e.jsx("li",{children:"• Graceful degradation"})]})]}),e.jsxs("div",{className:"bg-yellow-900/20 p-4 rounded-lg border border-yellow-600/30",children:[e.jsx("h4",{className:"font-semibold text-yellow-300 mb-3",children:"⚠️ Consideraciones:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsx("li",{children:"• Elegir timeout apropiado"}),e.jsx("li",{children:"• Timeouts muy cortos → false positives"}),e.jsx("li",{children:"• Timeouts muy largos → detección lenta"}),e.jsx("li",{children:"• Overhead de clock_gettime()"}),e.jsx("li",{children:"• Necesita lógica de retry/recovery"}),e.jsx("li",{children:"• Adaptive timeouts para variabilidad"})]})]})]}),e.jsxs("div",{className:"bg-blue-900/20 p-4 rounded-lg border border-blue-600/30",children:[e.jsx("h4",{className:"font-semibold text-blue-300 mb-3",children:"📋 Best Practices para Timeouts:"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"1."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Usar timeouts absolutos"})," - clock_gettime(CLOCK_REALTIME) antes del loop"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"2."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Manejar ETIMEDOUT explícitamente"})," - Distinguir de otros errores"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"3."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Logging de timeouts"})," - Ayuda diagnóstico de problemas"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"4."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Retry logic con backoff"})," - Evita busy-wait excesivo"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"5."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Configurar timeouts"})," - No hardcodear, usar config o env vars"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"6."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Métricas de timeout"})," - Track tasa de timeouts para tuning"]})]})]})]})]})})]})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsx(Da,{type:"single",defaultValue:"demos",collapsible:!0,className:"space-y-4",children:e.jsxs(sa,{value:"demos",className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700",children:[e.jsx(ra,{className:"px-6 py-4 hover:bg-slate-700/30 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(vn,{className:"size-6 text-pink-400"}),e.jsx("span",{className:"text-2xl font-semibold text-white",children:"Demostraciones Interactivas"})]})}),e.jsx(na,{className:"px-6 pb-6",children:e.jsxs(ia,{defaultValue:"demo-cv",className:"w-full",children:[e.jsxs(Qt,{className:"grid w-full grid-cols-5 bg-slate-900/50 p-1 rounded-lg mb-6",children:[e.jsx(le,{value:"demo-cv",className:"data-[state=active]:bg-pink-600",children:"Condition Var"}),e.jsx(le,{value:"demo-sem",className:"data-[state=active]:bg-pink-600",children:"Semáforo"}),e.jsx(le,{value:"demo-state",className:"data-[state=active]:bg-pink-600",children:"State Track"}),e.jsx(le,{value:"demo-broadcast",className:"data-[state=active]:bg-pink-600",children:"Broadcast"}),e.jsx(le,{value:"demo-timeout",className:"data-[state=active]:bg-pink-600",children:"Timeout"})]}),e.jsx(ue,{value:"demo-cv",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/20 to-slate-800/20 p-6 rounded-lg border border-blue-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-300 mb-4",children:"Demo: Condition Variables (Mutex + CV)"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>o(!s),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${s?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:Ct,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-1 block",children:["Velocidad: ",n,"ms"]}),e.jsx(dt,{value:[n],onValueChange:([U])=>l(U),min:300,max:1500,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-blue-500/50",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"Thread Waiter"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`p-3 rounded-lg border-2 ${g==="checking"?"border-yellow-500 bg-yellow-900/30":g==="waiting"?"border-orange-500 bg-orange-900/30":g==="processing"?"border-green-500 bg-green-900/30":"border-gray-500 bg-gray-900/30"}`,children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:"Estado:"}),e.jsxs("div",{className:"text-lg",children:[g==="checking"&&"🔍 Verificando",g==="waiting"&&"⏸️ Esperando",g==="processing"&&"⚙️ Procesando",g==="done"&&"✅ Completado"]})]}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Mutex:"}),e.jsx("div",{className:`text-sm font-mono ${g==="waiting"?"text-red-400":"text-green-400"}`,children:g==="waiting"?"Released":"Locked"})]}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Condición:"}),e.jsx("div",{className:`text-sm font-mono ${h?"text-green-400":"text-red-400"}`,children:h?"true ✓":"false ✗"})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-green-500/50",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3",children:"Thread Signaler"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`p-3 rounded-lg border-2 ${v==="idle"?"border-gray-500 bg-gray-900/30":v==="preparing"?"border-yellow-500 bg-yellow-900/30":v==="signaling"?"border-green-500 bg-green-900/30":"border-blue-500 bg-blue-900/30"}`,children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:"Estado:"}),e.jsxs("div",{className:"text-lg",children:[v==="idle"&&"💤 Inactivo",v==="preparing"&&"🔧 Preparando",v==="signaling"&&"📡 Señalizando",v==="done"&&"✅ Completado"]})]}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Acción:"}),e.jsxs("div",{className:"text-sm",children:[v==="preparing"&&"Adquiriendo mutex...",v==="signaling"&&"pthread_cond_signal()",v==="done"&&"Mutex liberado",v==="idle"&&"Esperando..."]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:"Eventos"}),e.jsx("div",{ref:_t,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:N.map((U,Dt)=>e.jsx("div",{className:`p-2 rounded ${U.type==="error"?"bg-red-900/30 text-red-300":U.type==="warning"?"bg-yellow-900/30 text-yellow-300":U.type==="success"?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"}`,children:U.message},Dt))})]})]})}),e.jsx(ue,{value:"demo-sem",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/20 to-slate-800/20 p-6 rounded-lg border border-purple-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-300 mb-4",children:"Demo: Semáforos (Contador Persistente)"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>w(!_),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${_?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:_?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:ve,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-1 block",children:["Velocidad: ",C,"ms"]}),e.jsx(dt,{value:[C],onValueChange:([U])=>E(U),min:300,max:1500,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-purple-500/50",children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-3",children:"Semáforo"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-purple-900/30 p-4 rounded-lg border-2 border-purple-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-300 mb-2",children:"Contador"}),e.jsx("div",{className:`text-5xl font-bold ${V===0?"text-red-400":"text-green-400"}`,children:V}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:V===0?"Bloqueado":"Disponible"})]})}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Persistencia:"}),e.jsx("div",{className:"text-sm text-green-400",children:"✓ Contador preserva señales"})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-blue-500/50",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"Estados"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`p-3 rounded-lg border-2 ${oe==="waiting"?"border-orange-500 bg-orange-900/30":oe==="acquired"?"border-blue-500 bg-blue-900/30":oe==="processing"?"border-green-500 bg-green-900/30":"border-gray-500 bg-gray-900/30"}`,children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:"Waiter:"}),e.jsxs("div",{className:"text-lg",children:[oe==="waiting"&&"⏸️ sem_wait()",oe==="acquired"&&"🔓 Adquirido",oe==="processing"&&"⚙️ Procesando",oe==="done"&&"✅ Completado"]})]}),e.jsxs("div",{className:`p-3 rounded-lg border-2 ${T==="idle"?"border-gray-500 bg-gray-900/30":T==="posting"?"border-green-500 bg-green-900/30":"border-blue-500 bg-blue-900/30"}`,children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:"Signaler:"}),e.jsxs("div",{className:"text-lg",children:[T==="idle"&&"💤 Inactivo",T==="posting"&&"📡 sem_post()",T==="done"&&"✅ Completado"]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:"Eventos"}),e.jsx("div",{ref:St,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:J.map((U,Dt)=>e.jsx("div",{className:`p-2 rounded ${U.type==="error"?"bg-red-900/30 text-red-300":U.type==="warning"?"bg-yellow-900/30 text-yellow-300":U.type==="success"?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"}`,children:U.message},Dt))})]})]})}),e.jsx(ue,{value:"demo-state",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-green-900/20 to-slate-800/20 p-6 rounded-lg border border-green-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-green-300 mb-4",children:"Demo: State Tracking (Estado Persistente)"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>Ee(!ne),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${ne?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:ne?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:gt,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-1 block",children:["Velocidad: ",Ce,"ms"]}),e.jsx(dt,{value:[Ce],onValueChange:([U])=>Le(U),min:300,max:1500,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-green-500/50",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3",children:"Estado Compartido"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`p-4 rounded-lg border-2 ${F?"border-green-500 bg-green-900/30":"border-red-500 bg-red-900/30"}`,children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"event_occurred:"}),e.jsx("div",{className:`text-3xl font-bold ${F?"text-green-400":"text-red-400"}`,children:F?"true ✓":"false ✗"})]}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Data:"}),e.jsx("div",{className:"text-2xl font-mono text-blue-400",children:ze})]}),e.jsx("div",{className:"bg-blue-900/30 p-2 rounded border border-blue-600/50",children:e.jsx("div",{className:"text-xs text-blue-300",children:"💾 Estado persiste independientemente del timing"})})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-yellow-500/50",children:[e.jsx("h4",{className:"font-bold text-yellow-300 mb-3",children:"Timeline (Signaler primero)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`p-3 rounded-lg border-2 ${k==="marking"||k==="done"?"border-green-500 bg-green-900/30":"border-gray-500 bg-gray-900/30"}`,children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:"1️⃣ Signaler:"}),e.jsxs("div",{className:"text-sm",children:[k==="idle"&&"Esperando...",k==="marking"&&"Marcando estado ✓",k==="done"&&"Completado ✓"]})]}),e.jsxs("div",{className:`p-3 rounded-lg border-2 ${$==="checking"||$==="processing"||$==="done"?"border-blue-500 bg-blue-900/30":"border-gray-500 bg-gray-900/30"}`,children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:"2️⃣ Waiter:"}),e.jsxs("div",{className:"text-sm",children:[$==="checking"&&"Verificando estado...",$==="waiting"&&"Esperando...",$==="processing"&&"Estado ya true - sin espera!",$==="done"&&"Completado ✓"]})]}),$==="processing"&&e.jsx("div",{className:"bg-green-900/30 p-2 rounded border border-green-600/50",children:e.jsx("div",{className:"text-xs text-green-300",children:"✅ Waiter ve evento ya ocurrido - no espera!"})})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:"Eventos"}),e.jsx("div",{ref:tt,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:M.map((U,Dt)=>e.jsx("div",{className:`p-2 rounded ${U.type==="error"?"bg-red-900/30 text-red-300":U.type==="warning"?"bg-yellow-900/30 text-yellow-300":U.type==="success"?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"}`,children:U.message},Dt))})]})]})}),e.jsx(ue,{value:"demo-broadcast",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-orange-900/20 to-slate-800/20 p-6 rounded-lg border border-orange-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-orange-300 mb-4",children:"Demo: Broadcast (Múltiples Waiters)"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>G(!q),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${q?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:q?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:$e,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-1 block",children:["Velocidad: ",be,"ms"]}),e.jsx(dt,{value:[be],onValueChange:([U])=>Ne(U),min:300,max:1500,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-orange-500/50 mb-4",children:[e.jsx("h4",{className:"font-bold text-orange-300 mb-3",children:"3 Threads Esperando"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:ae.map(U=>e.jsx("div",{className:`p-4 rounded-lg border-2 ${U.state==="waiting"?"border-yellow-500 bg-yellow-900/30":U.state==="awakened"?"border-green-500 bg-green-900/30":"border-blue-500 bg-blue-900/30"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Thread ",U.id]}),e.jsxs("div",{className:"text-3xl mb-2",children:[U.state==="waiting"&&"⏸️",U.state==="awakened"&&"👁️",U.state==="done"&&"✅"]}),e.jsxs("div",{className:"text-xs",children:[U.state==="waiting"&&"Esperando...",U.state==="awakened"&&"Despertado!",U.state==="done"&&"Completado"]})]})},U.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-green-500/50",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3",children:"Signaler"}),e.jsx("div",{className:`p-4 rounded-lg border-2 ${jt==="idle"?"border-gray-500 bg-gray-900/30":jt==="broadcasting"?"border-green-500 bg-green-900/30":"border-blue-500 bg-blue-900/30"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl mb-2",children:[jt==="idle"&&"💤",jt==="broadcasting"&&"📢",jt==="done"&&"✅"]}),e.jsxs("div",{className:"text-sm",children:[jt==="idle"&&"Inactivo",jt==="broadcasting"&&"Broadcasting...",jt==="done"&&"Completado"]})]})})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-purple-500/50",children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-3",children:"Condición"}),e.jsx("div",{className:`p-4 rounded-lg border-2 ${je?"border-green-500 bg-green-900/30":"border-red-500 bg-red-900/30"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-4xl font-bold ${je?"text-green-400":"text-red-400"}`,children:je?"true":"false"}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:je?"Condición cumplida":"Esperando condición"})]})})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:"Eventos"}),e.jsx("div",{ref:Ye,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:Me.map((U,Dt)=>e.jsx("div",{className:`p-2 rounded ${U.type==="error"?"bg-red-900/30 text-red-300":U.type==="warning"?"bg-yellow-900/30 text-yellow-300":U.type==="success"?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"}`,children:U.message},Dt))})]})]})}),e.jsx(ue,{value:"demo-timeout",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-red-900/20 to-slate-800/20 p-6 rounded-lg border border-red-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-red-300 mb-4",children:"Demo: Timeout (Prevención de Deadlock)"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>qe(!Ge),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${Ge?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:Ge?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:B,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-1 block",children:["Velocidad: ",Se,"ms"]}),e.jsx(dt,{value:[Se],onValueChange:([U])=>Xe(U),min:300,max:1500,step:100,className:"w-full"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"signal-arrives",checked:re,onChange:U=>Ve(U.target.checked),className:"w-4 h-4",disabled:Ge}),e.jsx("label",{htmlFor:"signal-arrives",className:"text-sm text-gray-300",children:"Señal llega a tiempo"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-red-500/50",children:[e.jsx("h4",{className:"font-bold text-red-300 mb-3",children:"Contador de Timeout"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:`p-6 rounded-lg border-2 ${et>2?"border-green-500 bg-green-900/30":et>0?"border-yellow-500 bg-yellow-900/30":"border-red-500 bg-red-900/30"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-300 mb-2",children:"Tiempo Restante"}),e.jsxs("div",{className:`text-6xl font-bold ${et>2?"text-green-400":et>0?"text-yellow-400":"text-red-400"}`,children:[et,"s"]})]})}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Configuración:"}),e.jsx("div",{className:"text-sm",children:"Timeout: 5 segundos"})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-blue-500/50",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"Estado del Waiter"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:`p-4 rounded-lg border-2 ${Ue==="waiting"?"border-yellow-500 bg-yellow-900/30":Ue==="timeout"?"border-red-500 bg-red-900/30":Ue==="success"?"border-green-500 bg-green-900/30":"border-blue-500 bg-blue-900/30"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-4xl mb-2",children:[Ue==="waiting"&&"⏳",Ue==="timeout"&&"⏱️",Ue==="success"&&"✅",Ue==="done"&&"🏁"]}),e.jsxs("div",{className:"text-lg font-semibold",children:[Ue==="waiting"&&"Esperando...",Ue==="timeout"&&"TIMEOUT!",Ue==="success"&&"Éxito",Ue==="done"&&"Finalizado"]})]})}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Condición:"}),e.jsx("div",{className:`text-sm font-mono ${Ot?"text-green-400":"text-red-400"}`,children:Ot?"true ✓":"false ✗"})]}),Ue==="timeout"&&e.jsx("div",{className:"bg-red-900/30 p-2 rounded border border-red-600/50",children:e.jsx("div",{className:"text-xs text-red-300",children:"⚠️ Timeout evitó deadlock indefinido"})}),Ue==="success"&&e.jsx("div",{className:"bg-green-900/30 p-2 rounded border border-green-600/50",children:e.jsx("div",{className:"text-xs text-green-300",children:"✅ Señal recibida dentro del timeout"})})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:"Eventos"}),e.jsx("div",{ref:ft,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:ce.map((U,Dt)=>e.jsx("div",{className:`p-2 rounded ${U.type==="error"?"bg-red-900/30 text-red-300":U.type==="warning"?"bg-yellow-900/30 text-yellow-300":U.type==="success"?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"}`,children:U.message},Dt))})]})]})})]})})]})})})]})}const ZR=Sa("/ActividadesSeminarioSO/actividad11/lost-wakeup")({component:QR});function JR(){const[s,o]=c.useState([{id:1,x:100,y:200,targetX:400,targetY:200,color:"bg-blue-500",state:"moving",priority:0,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]},{id:2,x:400,y:200,targetX:100,targetY:200,color:"bg-red-500",state:"moving",priority:0,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]}]),[n,l]=c.useState(!1),[d,m]=c.useState(0),[h,x]=c.useState([300]),[g,b]=c.useState(["Simulación de Randomización iniciada."]),v=c.useRef(null),[f,N]=c.useState([{id:1,x:100,y:200,targetX:400,targetY:200,color:"bg-purple-500",state:"moving",priority:10,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]},{id:2,x:400,y:200,targetX:100,targetY:200,color:"bg-pink-500",state:"moving",priority:5,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]}]),[j,_]=c.useState(!1),[w,C]=c.useState(0),[E,z]=c.useState([300]),[P,V]=c.useState(["Simulación con Prioridades iniciada."]),Z=c.useRef(null),[oe,O]=c.useState([{id:1,x:100,y:200,targetX:400,targetY:200,color:"bg-orange-500",state:"moving",priority:0,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]},{id:2,x:400,y:200,targetX:100,targetY:200,color:"bg-yellow-500",state:"moving",priority:0,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]}]),[T,ge]=c.useState(!1),[J,W]=c.useState(0),[ne,Ee]=c.useState([300]),[Ce,Le]=c.useState(["Simulación de Backoff Exponencial iniciada."]),I=c.useRef(null),[Q]=c.useState(["Simulación con Detección de Patrones iniciada."]),F=c.useRef(null),[de]=c.useState(["Simulación con Coordinador Centralizado iniciada."]),ze=c.useRef(null);return c.useEffect(()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)},[g]),c.useEffect(()=>{Z.current&&(Z.current.scrollTop=Z.current.scrollHeight)},[P]),c.useEffect(()=>{I.current&&(I.current.scrollTop=I.current.scrollHeight)},[Ce]),c.useEffect(()=>{F.current&&(F.current.scrollTop=F.current.scrollHeight)},[Q]),c.useEffect(()=>{ze.current&&(ze.current.scrollTop=ze.current.scrollHeight)},[de]),c.useEffect(()=>{if(!n)return;const A=setInterval(()=>{m($=>$+h[0]),o($=>{const se=$[0],k=$[1];if(Math.abs(se.x-250)<30&&Math.abs(k.x-250)<30&&se.state==="moving"&&k.state==="moving"){const M=Math.random()*500+100,D=Math.random()*500+100;return b(q=>[...q,"⚠️ Colisión detectada en x=250",`🎲 A1 espera ${M.toFixed(0)}ms, A2 espera ${D.toFixed(0)}ms`]),$.map(q=>({...q,state:"waiting",backoffDelay:q.id===1?M:D}))}return $.map(M=>{if(M.state==="waiting"){const G=M.backoffDelay-h[0];return G<=0?(b(be=>[...be,`✅ A${M.id} reinicia movimiento`]),{...M,state:"moving",backoffDelay:0}):{...M,backoffDelay:G}}const D=M.targetX>M.x?1:-1,q=M.x+D*10;return Math.abs(q-M.targetX)<20?(b(G=>[...G,`🎯 A${M.id} llegó a su destino!`]),{...M,x:M.targetX,state:"success"}):{...M,x:q}})})},h[0]);return()=>clearInterval(A)},[n,h]),c.useEffect(()=>{if(!j)return;const A=setInterval(()=>{C($=>$+E[0]),N($=>{const se=$[0],k=$[1];if(Math.abs(se.x-250)<30&&Math.abs(k.x-250)<30&&se.state==="moving"&&k.state==="moving"){const M=se.priority>k.priority?se:k,D=M.id===se.id?k:se;return V(q=>[...q,"⚠️ Colisión detectada",`🎯 A${M.id} (prioridad ${M.priority}) tiene paso`,`⏸️ A${D.id} (prioridad ${D.priority}) cede`]),$.map(q=>({...q,state:q.id===M.id?"moving":"blocked"}))}return $.map(M=>{if(M.state==="blocked"){const G=$.find(be=>be.id!==M.id);return G&&Math.abs(G.x-250)>50?(V(be=>[...be,`✅ A${M.id} reinicia movimiento`]),{...M,state:"moving"}):M}if(M.state!=="moving")return M;const D=M.targetX>M.x?1:-1,q=M.x+D*10;return Math.abs(q-M.targetX)<20?(V(G=>[...G,`🎯 A${M.id} llegó a su destino!`]),{...M,x:M.targetX,state:"success"}):{...M,x:q}})})},E[0]);return()=>clearInterval(A)},[j,E]),c.useEffect(()=>{if(!T)return;const A=setInterval(()=>{W($=>$+ne[0]),O($=>{const se=$[0],k=$[1];return Math.abs(se.x-250)<30&&Math.abs(k.x-250)<30&&se.state==="moving"&&k.state==="moving"?$.map(M=>{const D=M.retryCount+1,q=Math.min(10*Math.pow(2,M.retryCount),2e3);return Le(G=>[...G,`⚠️ Colisión - A${M.id} intento #${D}`,`⏱️ Delay exponencial: ${q}ms (2^${M.retryCount} * 10)`]),{...M,state:"waiting",retryCount:D,backoffDelay:q}}):$.map(M=>{if(M.state==="waiting"){const G=M.backoffDelay-ne[0];return G<=0?(Le(be=>[...be,`✅ A${M.id} reinicia (delay completado)`]),{...M,state:"moving",backoffDelay:0}):{...M,backoffDelay:G}}if(M.state!=="moving")return M;const D=M.targetX>M.x?1:-1,q=M.x+D*10;return Math.abs(q-M.targetX)<20?(Le(G=>[...G,`🎯 A${M.id} llegó después de ${M.retryCount} reintentos!`]),{...M,x:M.targetX,state:"success"}):{...M,x:q}})})},ne[0]);return()=>clearInterval(A)},[T,ne]),e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(yn,{className:"size-12 text-yellow-500"}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"🔄 Livelock"})]}),e.jsxs("p",{className:"text-lg text-gray-300 leading-relaxed",children:["El ",e.jsx("span",{className:"font-bold text-yellow-400",children:"Livelock"})," ocurre cuando dos o más procesos cambian continuamente su estado en respuesta a los cambios de otros procesos, sin realizar ningún progreso útil. A diferencia del deadlock donde los procesos están bloqueados, en livelock los procesos están activos pero atrapados en un ciclo de respuestas mutuas."]}),e.jsx("div",{className:"mt-4 p-4 bg-yellow-900/30 border border-yellow-700/50 rounded-lg",children:e.jsxs("p",{className:"text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Analogía:"})," Es como dos personas intentando pasar por un pasillo estrecho y ambas se mueven simultáneamente en la misma dirección para evitar al otro, repitiendo este movimiento indefinidamente sin que ninguno logre pasar."]})})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs(Da,{type:"multiple",defaultValue:["soluciones","demostracion"],className:"space-y-4",children:[e.jsxs(sa,{value:"soluciones",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Soluciones (Pseudocódigo)"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"randomizacion",className:"px-6 pb-6",children:[e.jsxs(Qt,{className:"grid grid-cols-5 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"randomizacion",children:"🎲 Randomización"}),e.jsx(le,{value:"prioridades",children:"🎯 Prioridades"}),e.jsx(le,{value:"backoff",children:"⏱️ Backoff Exponencial"}),e.jsx(le,{value:"patrones",children:"🔍 Detección de Patrones"}),e.jsx(le,{value:"coordinacion",children:"🎛️ Coordinación Centralizada"})]}),e.jsx(ue,{value:"randomizacion",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-blue-400 mb-4",children:"🎲 Randomización"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Introduce retardos aleatorios antes de reintentar, rompiendo la sincronización entre procesos."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`function intentarAccion() {
  INTENTOS = 0
  MAX_INTENTOS = 10
  
  mientras INTENTOS < MAX_INTENTOS:
    si puedeRealizarAccion():
      realizarAccion()
      retornar EXITO
    
    // Retardo aleatorio para romper sincronización
    DELAY = random(MIN_DELAY, MAX_DELAY)
    esperar(DELAY)
    
    INTENTOS++
  
  retornar FALLO
}

// Ejemplo: Dos procesos compitiendo por recursos
Proceso P1:
  mientras verdadero:
    si intentarAccion():
      continuar
    esperar(random(100, 500)) // ms aleatorios
    
Proceso P2:
  mientras verdadero:
    si intentarAccion():
      continuar
    esperar(random(100, 500)) // ms aleatorios`})}),e.jsx("div",{className:"mt-4 p-3 bg-blue-900/30 border border-blue-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Simple de implementar, efectivo para romper patrones de sincronización. ",e.jsx("span",{className:"font-bold",children:"Desventaja:"})," No garantiza tiempo de respuesta predecible."]})})]})}),e.jsx(ue,{value:"prioridades",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-400 mb-4",children:"🎯 Prioridades"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Asigna prioridades a los procesos para establecer un orden de ejecución determinístico."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`estructura Proceso {
  id: entero
  prioridad: entero
  timestamp: tiempo
}

función resolverConflicto(P1, P2) {
  // Resolver por prioridad
  si P1.prioridad > P2.prioridad:
    P1.continuar()
    P2.retroceder()
    retornar P1
  sino si P1.prioridad < P2.prioridad:
    P2.continuar()
    P1.retroceder()
    retornar P2
  sino:
    // Prioridades iguales: usar timestamp
    si P1.timestamp < P2.timestamp:
      retornar P1
    sino:
      retornar P2
}

// Ejemplo: Acceso a recurso compartido
función accederRecurso(proceso) {
  mientras verdadero:
    si recurso.intentarBloquear(proceso):
      // Recurso adquirido
      usarRecurso()
      recurso.liberar()
      retornar
    sino:
      // Conflicto detectado
      competidor = recurso.obtenerCompetidor()
      ganador = resolverConflicto(proceso, competidor)
      
      si ganador != proceso:
        // Ceder y esperar
        esperar(TIEMPO_BASE * (competidor.prioridad - proceso.prioridad))
}`})}),e.jsx("div",{className:"mt-4 p-3 bg-purple-900/30 border border-purple-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-purple-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Garantiza progreso para procesos de alta prioridad. ",e.jsx("span",{className:"font-bold",children:"Desventaja:"})," Puede causar starvation en procesos de baja prioridad."]})})]})}),e.jsx(ue,{value:"backoff",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-orange-400 mb-4",children:"⏱️ Backoff Exponencial"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Incrementa exponencialmente el tiempo de espera después de cada fallo, reduciendo la contención."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`función backoffExponencial() {
  INTENTOS = 0
  MAX_INTENTOS = 10
  DELAY_BASE = 10 // milisegundos
  MAX_DELAY = 5000
  
  mientras INTENTOS < MAX_INTENTOS:
    si intentarAccion():
      retornar EXITO
    
    // Calcular delay exponencial: 2^n * base
    DELAY = min(DELAY_BASE * (2 ** INTENTOS), MAX_DELAY)
    
    // Opcional: añadir jitter aleatorio
    JITTER = random(0, DELAY * 0.1)
    DELAY_TOTAL = DELAY + JITTER
    
    esperar(DELAY_TOTAL)
    INTENTOS++
  
  retornar FALLO
}

// Secuencia de delays:
// Intento 1: 10ms
// Intento 2: 20ms
// Intento 3: 40ms
// Intento 4: 80ms
// Intento 5: 160ms
// Intento 6: 320ms
// Intento 7: 640ms
// Intento 8: 1280ms
// Intento 9: 2560ms
// Intento 10: 5000ms (MAX_DELAY)

función accederConBackoff(recurso) {
  intentos = 0
  
  mientras intentos < MAX_INTENTOS:
    bloqueo = recurso.intentarBloquear()
    
    si bloqueo.exitoso:
      usarRecurso()
      recurso.liberar()
      retornar EXITO
    
    delay = calcularBackoff(intentos)
    esperar(delay)
    intentos++
  
  retornar TIMEOUT
}`})}),e.jsx("div",{className:"mt-4 p-3 bg-orange-900/30 border border-orange-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-orange-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Reduce contención progresivamente, usado en protocolos de red (Ethernet). ",e.jsx("span",{className:"font-bold",children:"Desventaja:"})," Aumenta latencia con muchos reintentos."]})})]})}),e.jsx(ue,{value:"patrones",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-cyan-400 mb-4",children:"🔍 Detección de Patrones"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Monitorea el comportamiento de los procesos para detectar ciclos de livelock y tomar medidas correctivas."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`estructura EstadoProceso {
  id: entero
  estados: Cola[Estado]
  ultimoCambio: tiempo
  contadorCambios: entero
}

función detectarLivelock(proceso) {
  VENTANA_TIEMPO = 1000 // 1 segundo
  UMBRAL_CAMBIOS = 10
  LONGITUD_PATRON = 5
  
  // Contar cambios de estado recientes
  cambiosRecientes = contarCambios(
    proceso,
    tiempo_actual - VENTANA_TIEMPO
  )
  
  si cambiosRecientes > UMBRAL_CAMBIOS:
    // Detectar patrón repetitivo
    patron = extraerPatron(proceso.estados, LONGITUD_PATRON)
    
    si esPatronRepetitivo(patron):
      retornar LIVELOCK_DETECTADO
  
  retornar OK
}

función manejarLivelock(proceso) {
  // Acciones correctivas
  
  opción 1: Forzar espera prolongada
    proceso.forzarEspera(random(500, 2000))
  
  opción 2: Cambiar estrategia
    proceso.cambiarEstrategia(ESTRATEGIA_ALTERNATIVA)
  
  opción 3: Escalar prioridad temporalmente
    proceso.incrementarPrioridad(BOOST_TEMPORAL)
    
  opción 4: Notificar coordinador
    coordinador.resolverConflicto(proceso)
}

// Monitor continuo
función monitorearSistema() {
  mientras verdadero:
    para cada proceso en procesos_activos:
      estado = detectarLivelock(proceso)
      
      si estado == LIVELOCK_DETECTADO:
        log("Livelock detectado en proceso", proceso.id)
        manejarLivelock(proceso)
        metricas.registrarLivelock(proceso)
    
    esperar(INTERVALO_MONITOREO)
}`})}),e.jsx("div",{className:"mt-4 p-3 bg-cyan-900/30 border border-cyan-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-cyan-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Detecta y corrige problemas automáticamente.",e.jsx("span",{className:"font-bold",children:"Desventaja:"})," Overhead de monitoreo, puede tener falsos positivos."]})})]})}),e.jsx(ue,{value:"coordinacion",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-pink-400 mb-4",children:"🎛️ Coordinación Centralizada"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Un coordinador central arbitra el acceso a recursos, eliminando las decisiones descentralizadas que causan livelock."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`estructura Coordinador {
  cola_solicitudes: ColaPrioridad[Solicitud]
  recursos_disponibles: Conjunto[Recurso]
  asignaciones: Mapa[Proceso, Recurso]
  mutex: Lock
}

función Coordinador.solicitarRecurso(proceso, recurso) {
  mutex.bloquear()
  
  solicitud = nuevaSolicitud(proceso, recurso, tiempo_actual)
  cola_solicitudes.insertar(solicitud)
  
  // Procesar solicitudes pendientes
  procesarSolicitudes()
  
  mutex.liberar()
  
  // Esperar asignación
  mientras no asignaciones.contiene(proceso):
    esperar(POLLING_INTERVAL)
  
  retornar asignaciones[proceso]
}

función Coordinador.procesarSolicitudes() {
  // Ordenar por prioridad y timestamp
  cola_solicitudes.ordenar()
  
  mientras no cola_solicitudes.vacia():
    solicitud = cola_solicitudes.primero()
    
    si recursos_disponibles.contiene(solicitud.recurso):
      // Asignar recurso
      recursos_disponibles.remover(solicitud.recurso)
      asignaciones[solicitud.proceso] = solicitud.recurso
      cola_solicitudes.remover(solicitud)
      
      log("Recurso", solicitud.recurso, "asignado a", solicitud.proceso)
    sino:
      // No disponible, esperar
      break
}

función Coordinador.liberarRecurso(proceso) {
  mutex.bloquear()
  
  recurso = asignaciones[proceso]
  asignaciones.remover(proceso)
  recursos_disponibles.añadir(recurso)
  
  log("Recurso", recurso, "liberado por", proceso)
  
  // Reintentar asignaciones pendientes
  procesarSolicitudes()
  
  mutex.liberar()
}

// Uso desde proceso
función Proceso.ejecutar() {
  recurso = coordinador.solicitarRecurso(self, RECURSO_NECESARIO)
  
  // Usar recurso
  trabajarCon(recurso)
  
  coordinador.liberarRecurso(self)
}`})}),e.jsx("div",{className:"mt-4 p-3 bg-pink-900/30 border border-pink-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-pink-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Elimina completamente el livelock, control total sobre asignaciones. ",e.jsx("span",{className:"font-bold",children:"Desventaja:"})," Punto único de fallo, posible cuello de botella."]})})]})})]})})]}),e.jsxs(sa,{value:"demostracion",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(La,{className:"size-5"}),e.jsx("span",{children:"Demostraciones Interactivas"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"demo-random",className:"px-6 pb-6",children:[e.jsxs(Qt,{className:"grid grid-cols-5 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"demo-random",children:"🎲 Randomización"}),e.jsx(le,{value:"demo-priority",children:"🎯 Prioridades"}),e.jsx(le,{value:"demo-backoff",children:"⏱️ Backoff"}),e.jsx(le,{value:"demo-pattern",children:"🔍 Patrones"}),e.jsx(le,{value:"demo-coord",children:"🎛️ Coordinación"})]}),e.jsx(ue,{value:"demo-random",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Demostración: Randomización 🎲"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("button",{onClick:()=>l(!n),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium flex items-center gap-2",children:[n?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),n?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{l(!1),m(0),o([{id:1,x:100,y:200,targetX:400,targetY:200,color:"bg-blue-500",state:"moving",priority:0,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]},{id:2,x:400,y:200,targetX:100,targetY:200,color:"bg-red-500",state:"moving",priority:0,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]}]),b(["Simulación de Randomización reiniciada."])},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:h,onValueChange:x,min:100,max:500,step:50,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[h[0],"ms"]})]}),e.jsxs("div",{className:"ml-auto text-gray-400",children:["Tiempo: ",d,"ms"]})]})}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-4",children:"Pasillo Estrecho 🚶‍♂️🚶‍♀️"}),e.jsxs("div",{className:"relative h-64 bg-gray-800 rounded-lg border-2 border-gray-600 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-16 bg-gray-700 border-b-2 border-yellow-600"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-gray-700 border-t-2 border-yellow-600"}),e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-1 h-full bg-red-500/20"}),e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 text-xs text-red-400",children:"ZONA DE COLISIÓN"}),s.map(A=>e.jsxs("div",{className:"absolute transition-all duration-300",style:{left:`${A.x}px`,top:`${A.y-20}px`},children:[e.jsxs("div",{className:`w-10 h-10 rounded-full ${A.color} flex items-center justify-center font-bold text-white shadow-lg ${A.state==="waiting"?"animate-pulse":""}`,children:["A",A.id]}),e.jsxs("div",{className:"text-xs text-center mt-1 text-white",children:[A.state==="waiting"&&`⏳ ${A.backoffDelay.toFixed(0)}ms`,A.state==="success"&&"✅",A.state==="moving"&&"→"]})]},A.id)),e.jsx("div",{className:"absolute left-[400px] top-[180px] text-2xl",children:"🎯"}),e.jsx("div",{className:"absolute left-[100px] top-[180px] text-2xl",children:"🎯"})]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-2",children:"Eventos"}),e.jsx("div",{ref:v,className:"bg-black rounded p-3 font-mono text-xs text-green-400 h-48 overflow-y-auto",children:g.map((A,$)=>e.jsx("div",{children:A},$))})]})]})}),e.jsx(ue,{value:"demo-priority",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Demostración: Sistema de Prioridades 🎯"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("button",{onClick:()=>_(!j),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg font-medium flex items-center gap-2",children:[j?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),j?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{_(!1),C(0),N([{id:1,x:100,y:200,targetX:400,targetY:200,color:"bg-purple-500",state:"moving",priority:10,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]},{id:2,x:400,y:200,targetX:100,targetY:200,color:"bg-pink-500",state:"moving",priority:5,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]}]),V(["Simulación con Prioridades reiniciada."])},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:E,onValueChange:z,min:100,max:500,step:50,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[E[0],"ms"]})]}),e.jsxs("div",{className:"ml-auto text-gray-400",children:["Tiempo: ",w,"ms"]})]})}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-3",children:"Prioridades de Agentes"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:f.map(A=>e.jsxs("div",{className:"bg-gray-800 rounded p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded ${A.color}`}),e.jsxs("span",{className:"font-bold",children:["Agente ",A.id]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Prioridad:"}),e.jsx("span",{className:"font-mono font-bold text-white",children:A.priority}),A.state==="blocked"&&e.jsx("span",{className:"text-xs bg-red-600 px-2 py-1 rounded",children:"🛑 BLOQUEADO"}),A.state==="moving"&&e.jsx("span",{className:"text-xs bg-green-600 px-2 py-1 rounded",children:"▶ AVANZANDO"})]})]},A.id))})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-4",children:"Pasillo con Prioridades"}),e.jsxs("div",{className:"relative h-64 bg-gray-800 rounded-lg border-2 border-gray-600 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-16 bg-gray-700 border-b-2 border-purple-600"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-gray-700 border-t-2 border-purple-600"}),e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-1 h-full bg-purple-500/20"}),f.map(A=>e.jsxs("div",{className:"absolute transition-all duration-300",style:{left:`${A.x}px`,top:`${A.y-20}px`},children:[e.jsxs("div",{className:`w-10 h-10 rounded-full ${A.color} flex items-center justify-center font-bold text-white shadow-lg relative ${A.state==="blocked"?"opacity-50":""}`,children:["A",A.id,e.jsxs("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-xs bg-gray-900 px-2 py-1 rounded whitespace-nowrap",children:["P: ",A.priority]})]}),e.jsxs("div",{className:"text-xs text-center mt-1 text-white",children:[A.state==="blocked"&&"🛑",A.state==="success"&&"✅",A.state==="moving"&&"→"]})]},A.id)),e.jsx("div",{className:"absolute left-[400px] top-[180px] text-2xl",children:"🎯"}),e.jsx("div",{className:"absolute left-[100px] top-[180px] text-2xl",children:"🎯"})]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-2",children:"Eventos de Resolución"}),e.jsx("div",{ref:Z,className:"bg-black rounded p-3 font-mono text-xs text-green-400 h-48 overflow-y-auto",children:P.map((A,$)=>e.jsx("div",{children:A},$))})]})]})}),e.jsx(ue,{value:"demo-backoff",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Demostración: Backoff Exponencial ⏱️"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("button",{onClick:()=>ge(!T),className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 rounded-lg font-medium flex items-center gap-2",children:[T?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),T?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{ge(!1),W(0),O([{id:1,x:100,y:200,targetX:400,targetY:200,color:"bg-orange-500",state:"moving",priority:0,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]},{id:2,x:400,y:200,targetX:100,targetY:200,color:"bg-yellow-500",state:"moving",priority:0,retryCount:0,backoffDelay:0,lastMoveTime:0,stateHistory:[]}]),Le(["Simulación de Backoff Exponencial reiniciada."])},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Velocidad:"}),e.jsx(dt,{value:ne,onValueChange:Ee,min:100,max:500,step:50,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[ne[0],"ms"]})]}),e.jsxs("div",{className:"ml-auto text-gray-400",children:["Tiempo: ",J,"ms"]})]})}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-3",children:"Estadísticas de Backoff"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:oe.map(A=>e.jsxs("div",{className:"bg-gray-800 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`w-4 h-4 rounded ${A.color}`}),e.jsxs("span",{className:"font-bold",children:["Agente ",A.id]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Reintentos:"}),e.jsx("span",{className:"font-mono text-white",children:A.retryCount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Delay actual:"}),e.jsxs("span",{className:"font-mono text-yellow-400",children:[A.backoffDelay.toFixed(0),"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Fórmula:"}),e.jsxs("span",{className:"font-mono text-orange-400",children:["2^",A.retryCount," × 10"]})]})]})]},A.id))})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-4",children:"Pasillo con Backoff Exponencial"}),e.jsxs("div",{className:"relative h-64 bg-gray-800 rounded-lg border-2 border-gray-600 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-16 bg-gray-700 border-b-2 border-orange-600"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-gray-700 border-t-2 border-orange-600"}),e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-1 h-full bg-orange-500/20"}),oe.map(A=>e.jsxs("div",{className:"absolute transition-all duration-300",style:{left:`${A.x}px`,top:`${A.y-20}px`},children:[e.jsxs("div",{className:`w-10 h-10 rounded-full ${A.color} flex items-center justify-center font-bold text-white shadow-lg ${A.state==="waiting"?"animate-pulse scale-110":""}`,children:["A",A.id]}),e.jsxs("div",{className:"text-xs text-center mt-1 text-white",children:[A.state==="waiting"&&`⏳ ${A.backoffDelay.toFixed(0)}ms`,A.state==="success"&&"✅",A.state==="moving"&&"→"]}),A.retryCount>0&&e.jsxs("div",{className:"text-xs text-center text-orange-400",children:["Intento #",A.retryCount]})]},A.id)),e.jsx("div",{className:"absolute left-[400px] top-[180px] text-2xl",children:"🎯"}),e.jsx("div",{className:"absolute left-[100px] top-[180px] text-2xl",children:"🎯"})]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h4",{className:"font-bold text-white mb-2",children:"Eventos de Backoff"}),e.jsx("div",{ref:I,className:"bg-black rounded p-3 font-mono text-xs text-green-400 h-48 overflow-y-auto",children:Ce.map((A,$)=>e.jsx("div",{children:A},$))})]})]})}),e.jsx(ue,{value:"demo-pattern",className:"mt-6",children:e.jsxs("div",{className:"p-6 text-center text-gray-400",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🚧"}),e.jsx("p",{className:"text-lg",children:"Demo de Detección de Patrones en desarrollo..."})]})}),e.jsx(ue,{value:"demo-coord",className:"mt-6",children:e.jsxs("div",{className:"p-6 text-center text-gray-400",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🚧"}),e.jsx("p",{className:"text-lg",children:"Demo de Coordinación Centralizada en desarrollo..."})]})})]})})]})]})})]})}const e2=Sa("/ActividadesSeminarioSO/actividad11/livelock")({component:JR});function t2(){const[s,o]=c.useState([]),[n,l]=c.useState(0),[d,m]=c.useState(0),[h,x]=c.useState(!1),[g,b]=c.useState(500),[v,f]=c.useState([]),N=c.useRef(null),[j,_]=c.useState([]),[w,C]=c.useState(0),[E,z]=c.useState(!1),[P,V]=c.useState(500),[Z,oe]=c.useState([]),O=c.useRef(null),[T,ge]=c.useState([]),[J,W]=c.useState(0),[ne,Ee]=c.useState(!1),[Ce,Le]=c.useState(500),[I,Q]=c.useState([]),F=c.useRef(null),[de,ze]=c.useState([]),[A,$]=c.useState([]),[se,k]=c.useState(!1),[K,M]=c.useState(500),[D,q]=c.useState([]),G=c.useRef(null),[be,Ne]=c.useState([]),[R,ke]=c.useState([1]),[je,ee]=c.useState(1),[ae,rt]=c.useState(!1),[jt,xe]=c.useState(500),[Me,De]=c.useState([]),Ge=c.useRef(null),[qe,Se]=c.useState([]),[Xe,We]=c.useState(!1),[xt,Ot]=c.useState(null),[It,Ue]=c.useState(!1),[At,et]=c.useState(500),[L,re]=c.useState([]),Ve=c.useRef(null),[ce,Te]=c.useState([]),[_t,St]=c.useState([{id:1,data:"Data v1",timestamp:0}]),[tt,Ye]=c.useState(!1),[ft,Ct]=c.useState(500),[ve,gt]=c.useState([]),$e=c.useRef(null);c.useEffect(()=>{N.current&&(N.current.scrollTop=N.current.scrollHeight)},[v]),c.useEffect(()=>{O.current&&(O.current.scrollTop=O.current.scrollHeight)},[Z]),c.useEffect(()=>{F.current&&(F.current.scrollTop=F.current.scrollHeight)},[I]),c.useEffect(()=>{G.current&&(G.current.scrollTop=G.current.scrollHeight)},[D]),c.useEffect(()=>{Ge.current&&(Ge.current.scrollTop=Ge.current.scrollHeight)},[Me]),c.useEffect(()=>{Ve.current&&(Ve.current.scrollTop=Ve.current.scrollHeight)},[L]),c.useEffect(()=>{$e.current&&($e.current.scrollTop=$e.current.scrollHeight)},[ve]),c.useEffect(()=>{if(!h)return;const X=setInterval(()=>{o(Oe=>{const st=[...Oe];let Rt=n,Qe=d;for(let He=0;He<st.length;He++){const mt=st[He];mt.state==="waiting"?(mt.waitTime++,mt.type==="reader"&&Qe===0?(mt.state="reading",Rt++,f(Jt=>[...Jt,`🔵 Lector ${mt.id} inicia lectura (${Rt} lectores activos)`])):mt.type==="writer"&&Rt===0&&Qe===0&&(mt.state="writing",Qe++,f(Jt=>[...Jt,`🔴 Escritor ${mt.id} inicia escritura (acceso exclusivo)`]))):mt.state==="reading"?Math.random()<.3&&(mt.state="completed",Rt--,f(Jt=>[...Jt,`✅ Lector ${mt.id} completado (${Rt} lectores activos)`])):mt.state==="writing"&&Math.random()<.2&&(mt.state="completed",Qe--,f(Jt=>[...Jt,`✅ Escritor ${mt.id} completado`]))}return l(Rt),m(Qe),st.filter(He=>He.state!=="completed")})},g);return()=>clearInterval(X)},[h,g,n,d]),c.useEffect(()=>{if(!E)return;const X=setInterval(()=>{_(Oe=>{const st=[...Oe];let Rt=w;for(let Qe=0;Qe<st.length;Qe++){const He=st[Qe];He.state==="waiting"?(He.waitTime++,He.type==="reader"&&(Rt>0||st.every(mt=>mt.type==="reader"||mt.state!=="waiting"))?(He.state="reading",Rt++,oe(mt=>[...mt,`📖 Lector ${He.id} inicia (${Rt} concurrentes)`])):He.type==="writer"&&Rt===0&&!st.some(mt=>mt.type==="reader"&&mt.state==="reading")?(He.state="writing",oe(mt=>[...mt,`✍️ Escritor ${He.id} inicia (esperó ${He.waitTime} ciclos)`])):He.type==="writer"&&He.waitTime>5&&oe(mt=>[...mt,`⚠️ Escritor ${He.id} STARVATION (${He.waitTime} ciclos esperando)`])):He.state==="reading"?Math.random()<.4&&(He.state="completed",Rt--,oe(mt=>[...mt,`✅ Lector ${He.id} termina`])):He.state==="writing"&&Math.random()<.3&&(He.state="completed",oe(mt=>[...mt,`✅ Escritor ${He.id} termina`]))}return C(Rt),st.filter(Qe=>Qe.state!=="completed")})},P);return()=>clearInterval(X)},[E,P,w]),c.useEffect(()=>{if(!ne)return;const X=setInterval(()=>{ge(Oe=>{const st=[...Oe],Rt=st.filter(Qe=>Qe.type==="writer"&&Qe.state==="waiting").length;for(let Qe=0;Qe<st.length;Qe++){const He=st[Qe];if(He.state==="waiting"){He.waitTime++;const mt=st.some(pa=>pa.type==="writer"&&pa.state==="writing"),Jt=st.some(pa=>pa.type==="reader"&&pa.state==="reading");He.type==="writer"&&!mt&&!Jt?(He.state="writing",Q(pa=>[...pa,`✍️ Escritor ${He.id} inicia escritura`])):He.type==="reader"&&Rt===0&&!mt?(He.state="reading",Q(pa=>[...pa,`📖 Lector ${He.id} inicia lectura`])):He.type==="reader"&&Rt>0&&He.waitTime>4&&Q(pa=>[...pa,`⚠️ Lector ${He.id} BLOQUEADO por ${Rt} escritores (${He.waitTime} ciclos)`])}else He.state==="reading"?Math.random()<.4&&(He.state="completed",Q(mt=>[...mt,`✅ Lector ${He.id} completado`])):He.state==="writing"&&Math.random()<.3&&(He.state="completed",Q(mt=>[...mt,`✅ Escritor ${He.id} completado`]))}return W(Rt),st.filter(Qe=>Qe.state!=="completed")})},Ce);return()=>clearInterval(X)},[ne,Ce]),c.useEffect(()=>{if(!se)return;const X=setInterval(()=>{ze(Oe=>{const st=[...Oe],Rt=[...A];for(const Qe of st)Qe.state==="waiting"&&!Rt.some(He=>He.id===Qe.id)&&(Rt.push(Qe),q(He=>[...He,`📥 Thread ${Qe.id} (${Qe.type}) entra a cola FIFO (pos: ${Rt.length})`]));if(Rt.length>0){const Qe=Rt[0],He=st.findIndex(mt=>mt.id===Qe.id);if(He!==-1){const mt=st[He];st.some(pa=>pa.state==="reading"||pa.state==="writing")||(mt.state=mt.type==="reader"?"reading":"writing",Rt.shift(),q(pa=>[...pa,`▶️ ${mt.type==="reader"?"Lector":"Escritor"} ${mt.id} obtiene acceso (FIFO)`]))}}for(let Qe=0;Qe<st.length;Qe++){const He=st[Qe];(He.state==="reading"||He.state==="writing")&&Math.random()<.35&&(He.state="completed",q(mt=>[...mt,`✅ ${He.type==="reader"?"Lector":"Escritor"} ${He.id} completado`]))}return $(Rt),st.filter(Qe=>Qe.state!=="completed")})},K);return()=>clearInterval(X)},[se,K,A]),c.useEffect(()=>{if(!ae)return;const X=setInterval(()=>{Ne(Oe=>{const st=[...Oe];for(let Rt=0;Rt<st.length;Rt++){const Qe=st[Rt];if(Qe.state==="waiting"){if(Qe.type==="reader")Qe.state="reading",Qe.version=je,De(He=>[...He,`📖 Lector ${Qe.id} accede a versión ${Qe.version} (lock-free)`]);else if(Qe.type==="writer"&&st.filter(mt=>mt.type==="writer"&&mt.state==="writing").length===0){Qe.state="writing";const mt=je+1;ke(Jt=>[...Jt,mt]),ee(mt),De(Jt=>[...Jt,`✍️ Escritor ${Qe.id} crea copia → versión ${mt}`])}}else Qe.state==="reading"?Math.random()<.4&&(Qe.state="completed",De(He=>[...He,`✅ Lector ${Qe.id} termina (leyó v${Qe.version})`])):Qe.state==="writing"&&Math.random()<.25&&(Qe.state="completed",De(He=>[...He,`✅ Escritor ${Qe.id} completa escritura, puntero actualizado`]))}return st.filter(Rt=>Rt.state!=="completed")})},jt);return()=>clearInterval(X)},[ae,jt,je]),c.useEffect(()=>{if(!It)return;const X=setInterval(()=>{Se(Oe=>{const st=[...Oe];for(let Rt=0;Rt<st.length;Rt++){const Qe=st[Rt];Qe.state==="waiting"?Qe.type==="reader"?(Qe.state="reading",re(He=>[...He,`📖 Lector ${Qe.id} inicia (ultra-rápido, sin locks)`])):Qe.type==="writer"&&!Xe&&(Qe.state="writing",Ot(1),We(!0),re(He=>[...He,`✍️ Escritor ${Qe.id} crea nueva versión, inicia grace period`])):Qe.state==="reading"?Math.random()<.5&&(Qe.state="completed",re(He=>[...He,`✅ Lector ${Qe.id} termina`])):Qe.state==="writing"&&st.filter(mt=>mt.state==="reading").length===0&&Xe&&(Qe.state="completed",We(!1),Ot(null),re(mt=>[...mt,`✅ Escritor ${Qe.id} completa, grace period terminado, memoria liberada`]))}return st.filter(Rt=>Rt.state!=="completed")})},At);return()=>clearInterval(X)},[It,At,Xe]),c.useEffect(()=>{if(!tt)return;const X=setInterval(()=>{Te(Oe=>{const st=[...Oe];for(let Rt=0;Rt<st.length;Rt++){const Qe=st[Rt];if(Qe.state==="waiting"){if(Qe.type==="reader"){Qe.state="reading",Qe.timestamp=Date.now();const He=_t[_t.length-1];gt(mt=>[...mt,`📖 Lector ${Qe.id} lee snapshot v${He.id} (ts: ${Qe.timestamp})`])}else if(Qe.type==="writer"){Qe.state="writing";const He=_t.length+1,mt={id:He,data:`Data v${He}`,timestamp:Date.now()};St(Jt=>[...Jt,mt]),gt(Jt=>[...Jt,`✍️ Escritor ${Qe.id} crea versión ${He}`])}}else Qe.state==="reading"?Math.random()<.4&&(Qe.state="completed",gt(He=>[...He,`✅ Lector ${Qe.id} completado (snapshot consistente)`])):Qe.state==="writing"&&Math.random()<.3&&(Qe.state="completed",gt(He=>[...He,`✅ Escritor ${Qe.id} commit exitoso`]))}return st.filter(Rt=>Rt.state!=="completed")})},ft);return()=>clearInterval(X)},[tt,ft,_t]);const B=()=>{o([]),l(0),m(0),f([]),x(!1)},U=X=>{const Oe={id:Date.now(),type:X,state:"waiting",waitTime:0};o(st=>[...st,Oe]),f(st=>[...st,`➕ ${X==="reader"?"Lector":"Escritor"} ${Oe.id} agregado`])},Dt=()=>{_([]),C(0),oe([]),z(!1)},Ke=X=>{const Oe={id:Date.now(),type:X,state:"waiting",waitTime:0};_(st=>[...st,Oe]),oe(st=>[...st,`➕ ${X==="reader"?"Lector":"Escritor"} ${Oe.id} agregado`])},fe=()=>{ge([]),W(0),Q([]),Ee(!1)},$t=X=>{const Oe={id:Date.now(),type:X,state:"waiting",waitTime:0};ge(st=>[...st,Oe]),Q(st=>[...st,`➕ ${X==="reader"?"Lector":"Escritor"} ${Oe.id} agregado`])},Zt=()=>{ze([]),$([]),q([]),k(!1)},pt=X=>{const Oe={id:Date.now(),type:X,state:"waiting",waitTime:0,timestamp:Date.now()};ze(st=>[...st,Oe]),q(st=>[...st,`➕ ${X==="reader"?"Lector":"Escritor"} ${Oe.id} agregado`])},zt=()=>{Ne([]),ke([1]),ee(1),De([]),rt(!1)},lt=X=>{const Oe={id:Date.now(),type:X,state:"waiting",waitTime:0};Ne(st=>[...st,Oe]),De(st=>[...st,`➕ ${X==="reader"?"Lector":"Escritor"} ${Oe.id} agregado`])},Be=()=>{Se([]),We(!1),Ot(null),re([]),Ue(!1)},Ie=X=>{const Oe={id:Date.now(),type:X,state:"waiting",waitTime:0};Se(st=>[...st,Oe]),re(st=>[...st,`➕ ${X==="reader"?"Lector":"Escritor"} ${Oe.id} agregado`])},Je=()=>{Te([]),St([{id:1,data:"Data v1",timestamp:0}]),gt([]),Ye(!1)},ot=X=>{const Oe={id:Date.now(),type:X,state:"waiting",waitTime:0};Te(st=>[...st,Oe]),gt(st=>[...st,`➕ ${X==="reader"?"Lector":"Escritor"} ${Oe.id} agregado`])};return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(La,{className:"size-12 text-blue-500"}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"📖✍️ Problema de Lectura/Escritura"})]}),e.jsxs("p",{className:"text-lg text-gray-300 leading-relaxed",children:["El ",e.jsx("span",{className:"font-bold text-blue-400",children:"Problema de Lectura/Escritura"})," (Readers-Writers) surge cuando múltiples procesos necesitan acceder a un recurso compartido, donde algunos solo leen y otros escriben. Los lectores pueden acceder concurrentemente, pero los escritores requieren acceso exclusivo para mantener la consistencia de los datos."]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-900/30 border border-blue-700/50 rounded-lg",children:e.jsxs("p",{className:"text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Desafío:"})," Maximizar la concurrencia de lectores sin sacrificar la integridad de los datos, evitando starvation de escritores y garantizando políticas de acceso justas."]})})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs(Da,{type:"multiple",defaultValue:["soluciones","demostracion"],className:"space-y-4",children:[e.jsxs(sa,{value:"soluciones",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Soluciones (Pseudocódigo)"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"rwlock",className:"px-6 pb-6",children:[e.jsxs(Qt,{className:"grid grid-cols-7 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"rwlock",children:"🔐 RWLock"}),e.jsx(le,{value:"readers-pref",children:"📖 Readers-Pref"}),e.jsx(le,{value:"writers-pref",children:"✍️ Writers-Pref"}),e.jsx(le,{value:"fair",children:"⚖️ Fair Policy"}),e.jsx(le,{value:"cow",children:"📋 Copy-on-Write"}),e.jsx(le,{value:"rcu",children:"🔄 RCU"}),e.jsx(le,{value:"mvcc",children:"📚 MVCC"})]}),e.jsx(ue,{value:"rwlock",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-blue-400 mb-4",children:"🔐 Read-Write Locks (RWLock)"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Permite múltiples lectores concurrentes pero escritores exclusivos. Es la solución básica al problema de lectura/escritura."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`estructura RWLock {
  readers: entero = 0
  writers: entero = 0
  mutex: Lock
  okToRead: ConditionVariable
  okToWrite: ConditionVariable
}

función RWLock.readLock() {
  mutex.lock()
  
  // Esperar si hay escritores activos
  mientras writers > 0:
    okToRead.wait(mutex)
  
  readers++
  mutex.unlock()
}

función RWLock.readUnlock() {
  mutex.lock()
  readers--
  
  // Notificar si no hay más lectores
  si readers == 0:
    okToWrite.signal()
  
  mutex.unlock()
}

función RWLock.writeLock() {
  mutex.lock()
  
  // Esperar si hay lectores o escritores activos
  mientras readers > 0 O writers > 0:
    okToWrite.wait(mutex)
  
  writers++
  mutex.unlock()
}

función RWLock.writeUnlock() {
  mutex.lock()
  writers--
  
  // Notificar a todos
  okToRead.broadcast()
  okToWrite.signal()
  
  mutex.unlock()
}

// Uso
función lector() {
  rwlock.readLock()
  // Leer datos
  leerDatos()
  rwlock.readUnlock()
}

función escritor() {
  rwlock.writeLock()
  // Escribir datos
  escribirDatos()
  rwlock.writeUnlock()
}`})}),e.jsx("div",{className:"mt-4 p-3 bg-blue-900/30 border border-blue-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Maximiza concurrencia de lectores.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Puede causar starvation de escritores."]})})]})}),e.jsx(ue,{value:"readers-pref",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-green-400 mb-4",children:"📖 Readers-Preference"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Prioriza lectores sobre escritores. Los nuevos lectores pueden entrar mientras hay otros lectores activos, incluso si hay escritores esperando."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`estructura ReadersPreference {
  readCount: entero = 0
  writeCount: entero = 0
  readerMutex: Lock
  resourceMutex: Lock
}

función leer() {
  // Primer lector bloquea recurso
  readerMutex.lock()
  readCount++
  
  si readCount == 1:
    resourceMutex.lock()  // Primer lector bloquea escritores
  
  readerMutex.unlock()
  
  // SECCIÓN CRÍTICA - LECTURA
  leerDatos()
  
  // Último lector libera recurso
  readerMutex.lock()
  readCount--
  
  si readCount == 0:
    resourceMutex.unlock()  // Último lector permite escritores
  
  readerMutex.unlock()
}

función escribir() {
  resourceMutex.lock()
  
  // SECCIÓN CRÍTICA - ESCRITURA
  escribirDatos()
  
  resourceMutex.unlock()
}

// Problema: Starvation de escritores
// Si lectores llegan continuamente, escritores nunca ejecutan

// Ejemplo de uso
Proceso Lector:
  mientras verdadero:
    leer()
    // Procesar datos leídos
    esperar(random(10, 100))

Proceso Escritor:
  mientras verdadero:
    escribir()
    // Generar nuevos datos
    esperar(random(100, 500))`})}),e.jsx("div",{className:"mt-4 p-3 bg-green-900/30 border border-green-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-green-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Máxima throughput de lectura, simple.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Starvation severa de escritores."]})})]})}),e.jsx(ue,{value:"writers-pref",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-400 mb-4",children:"✍️ Writers-Preference"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Prioriza escritores sobre lectores. Cuando un escritor está esperando, no se permiten nuevos lectores hasta que el escritor complete."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`estructura WritersPreference {
  readCount: entero = 0
  writeCount: entero = 0
  waitingWriters: entero = 0
  
  mutex1: Lock  // Protege contadores
  mutex2: Lock  // Controla entrada de lectores
  mutex3: Lock  // Recurso principal
  
  okToRead: ConditionVariable
  okToWrite: ConditionVariable
}

función leer() {
  mutex2.lock()  // Bloquea si hay escritores esperando
  mutex1.lock()
  
  readCount++
  si readCount == 1:
    mutex3.lock()
  
  mutex1.unlock()
  mutex2.unlock()
  
  // LECTURA
  leerDatos()
  
  mutex1.lock()
  readCount--
  
  si readCount == 0:
    mutex3.unlock()
  
  mutex1.unlock()
}

función escribir() {
  mutex1.lock()
  waitingWriters++
  
  si waitingWriters == 1:
    mutex2.lock()  // Bloquea nuevos lectores
  
  mutex1.unlock()
  
  mutex3.lock()  // Obtener recurso
  
  // ESCRITURA
  escribirDatos()
  
  mutex3.unlock()
  
  mutex1.lock()
  waitingWriters--
  
  si waitingWriters == 0:
    mutex2.unlock()  // Permitir lectores
  
  mutex1.unlock()
}

// Ventaja: Evita starvation de escritores
// Desventaja: Puede causar starvation de lectores

función monitoreoPrioridad() {
  imprimir("Escritores esperando:", waitingWriters)
  imprimir("Lectores activos:", readCount)
  
  si waitingWriters > 0:
    imprimir("⚠️ NUEVOS LECTORES BLOQUEADOS")
}`})}),e.jsx("div",{className:"mt-4 p-3 bg-purple-900/30 border border-purple-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-purple-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Garantiza progreso de escritores.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Puede causar starvation de lectores."]})})]})}),e.jsx(ue,{value:"fair",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-400 mb-4",children:"⚖️ Fair Policy"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Garantiza que ni lectores ni escritores sufran starvation mediante una cola FIFO. Los procesos obtienen acceso en el orden en que llegan."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`estructura FairRWLock {
  readCount: entero = 0
  writeCount: entero = 0
  
  turnstile: Semaphore(1)  // FIFO fairness
  resourceMutex: Lock
  readerMutex: Lock
}

función leer() {
  // Pasar por turnstile (orden FIFO)
  turnstile.wait()
  
  readerMutex.lock()
  readCount++
  
  si readCount == 1:
    resourceMutex.lock()
  
  readerMutex.unlock()
  turnstile.signal()  // Liberar turnstile rápidamente
  
  // LECTURA
  leerDatos()
  
  readerMutex.lock()
  readCount--
  
  si readCount == 0:
    resourceMutex.unlock()
  
  readerMutex.unlock()
}

función escribir() {
  // Pasar por turnstile (orden FIFO)
  turnstile.wait()
  resourceMutex.lock()
  turnstile.signal()
  
  // ESCRITURA
  escribirDatos()
  
  resourceMutex.unlock()
}

// Política justa con timestamps
estructura FairQueue {
  cola: ColaPrioridad[Solicitud]
  
  estructura Solicitud {
    tipo: LECTOR | ESCRITOR
    proceso: Proceso
    timestamp: tiempo
  }
}

función FairQueue.solicitar(tipo) {
  solicitud = Solicitud(tipo, proceso_actual, tiempo_actual)
  cola.insertar(solicitud)
  
  // Esperar turno
  mientras cola.primero() != solicitud:
    esperar()
  
  // Obtener acceso
  si solicitud.tipo == ESCRITOR:
    esperarLectoresActivos()
  
  ejecutarAcceso()
  cola.remover(solicitud)
  notificar_siguiente()
}`})}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-900/30 border border-yellow-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," No hay starvation, orden FIFO justo.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Menos concurrencia que readers-preference."]})})]})}),e.jsx(ue,{value:"cow",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-cyan-400 mb-4",children:"📋 Copy-on-Write (CoW)"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Los lectores acceden a datos sin bloqueos. Los escritores crean una copia, la modifican, y luego actualizan el puntero atómicamente."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`estructura CoWData {
  datos: puntero a Dato
  writeMutex: Lock
}

función leer() {
  // Lectura sin bloqueos - lock-free
  datosActuales = cargar_atomico(datos)
  
  // Leer de manera segura
  resultado = datosActuales.leer()
  
  retornar resultado
}

función escribir(nuevosValores) {
  writeMutex.lock()
  
  // 1. Obtener datos actuales
  datosViejos = cargar_atomico(datos)
  
  // 2. Crear copia completa
  datosNuevos = clonar(datosViejos)
  
  // 3. Modificar la copia
  datosNuevos.aplicarCambios(nuevosValores)
  
  // 4. Actualizar puntero atómicamente
  almacenar_atomico(datos, datosNuevos)
  
  // 5. Esperar que todos los lectores terminen con datos viejos
  // (usando contadores de referencias o grace period)
  esperarLectores(datosViejos)
  
  // 6. Liberar memoria antigua
  liberar(datosViejos)
  
  writeMutex.unlock()
}

// Implementación con contadores de referencias
estructura CoWConRefCount {
  datos: puntero a Dato
  refCount: AtomicInteger
}

función leerConRefCount() {
  loop:
    datosActuales = cargar_atomico(datos)
    refCount = datosActuales.refCount
    
    // Incrementar refcount atómicamente
    si compare_and_swap(datosActuales.refCount, refCount, refCount + 1):
      break
  
  // Leer datos
  resultado = datosActuales.leer()
  
  // Decrementar refcount
  decrementar_atomico(datosActuales.refCount)
  
  retornar resultado
}

función escribirConRefCount(nuevosValores) {
  writeMutex.lock()
  
  datosViejos = cargar_atomico(datos)
  datosNuevos = clonar(datosViejos)
  datosNuevos.refCount = 0
  datosNuevos.aplicarCambios(nuevosValores)
  
  almacenar_atomico(datos, datosNuevos)
  
  // Esperar a que refCount llegue a 0
  mientras datosViejos.refCount > 0:
    esperar_breve()
  
  liberar(datosViejos)
  writeMutex.unlock()
}`})}),e.jsx("div",{className:"mt-4 p-3 bg-cyan-900/30 border border-cyan-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-cyan-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Lectores lock-free, máxima concurrencia.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Overhead de memoria, escrituras costosas."]})})]})}),e.jsx(ue,{value:"rcu",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-pink-400 mb-4",children:"🔄 RCU (Read-Copy-Update)"}),e.jsx("p",{className:"text-gray-300 mb-4",children:'Similar a CoW pero optimizado para el kernel de Linux. Usa "grace periods" para garantizar que todos los lectores terminaron antes de liberar memoria.'}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`estructura RCU {
  datos: puntero atómico a Dato
  gracePeriodQueue: Cola[Dato]
}

función rcu_read_lock() {
  // Deshabilitar preempción (en kernel)
  deshabilitar_preempcion()
  // No requiere mutex real - muy rápido
}

función rcu_read_unlock() {
  // Rehabilitar preempción
  habilitar_preempcion()
}

función rcu_dereference(puntero) {
  // Leer puntero con barreras de memoria
  retornar READ_ONCE(puntero)
}

// Lector RCU
función leer() {
  rcu_read_lock()
  
  datosActuales = rcu_dereference(datos)
  resultado = datosActuales.leer()
  
  rcu_read_unlock()
  
  retornar resultado
}

// Escritor RCU
función actualizar(nuevosValores) {
  // 1. Crear nueva versión
  datosNuevos = alocar(Dato)
  datosViejos = datos
  
  // 2. Copiar y modificar
  copiar(datosViejos, datosNuevos)
  datosNuevos.aplicarCambios(nuevosValores)
  
  // 3. Publicar nueva versión (atómico)
  rcu_assign_pointer(datos, datosNuevos)
  
  // 4. Esperar grace period
  synchronize_rcu()
  
  // 5. Liberar versión antigua
  liberar(datosViejos)
}

función synchronize_rcu() {
  // Esperar a que todos los CPUs pasen por quiescent state
  // (punto donde no hay lectores RCU activos)
  
  para cada cpu en sistema:
    mientras cpu.enSeccionRCU():
      esperar()
}

// Implementación de call_rcu (asíncrono)
función call_rcu(punteroViejo, callback) {
  // Encolar para liberación posterior
  gracePeriodQueue.agregar(punteroViejo, callback)
  
  // Ejecutar callbacks cuando grace period expire
  si grace_period_expirado():
    para cada elemento en gracePeriodQueue:
      elemento.callback()
      gracePeriodQueue.remover(elemento)
}

// Uso avanzado con call_rcu
función actualizarAsync(nuevosValores) {
  datosNuevos = crear_y_modificar(nuevosValores)
  datosViejos = datos
  
  rcu_assign_pointer(datos, datosNuevos)
  
  // Liberar asincrónicamente después de grace period
  call_rcu(datosViejos, liberar_memoria)
}`})}),e.jsx("div",{className:"mt-4 p-3 bg-pink-900/30 border border-pink-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-pink-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Lectores ultra-rápidos, escalable.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Complejo, específico para kernels/sistemas."]})})]})}),e.jsx(ue,{value:"mvcc",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-orange-400 mb-4",children:"📚 MVCC (Multi-Version Concurrency Control)"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Mantiene múltiples versiones de los datos con timestamps. Cada transacción ve una snapshot consistente. Usado en bases de datos (PostgreSQL, Oracle)."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`estructura VersionedData {
  versiones: Lista[Version]
  currentVersion: AtomicInteger = 0
  mutex: Lock
}

estructura Version {
  datos: Dato
  timestamp: entero
  transaccionCreadora: entero
  transaccionBorradora: entero = INFINITO
  valida: booleano = verdadero
}

función iniciarTransaccion() {
  transaccion = nueva Transaccion()
  transaccion.timestamp = obtenerTimestampActual()
  transaccion.snapshot = currentVersion
  
  retornar transaccion
}

función leer(transaccion, clave) {
  // Buscar versión visible para esta transacción
  versionVisible = null
  
  para cada version en versiones:
    si version.timestamp <= transaccion.snapshot:
      si version.transaccionBorradora > transaccion.snapshot:
        versionVisible = version
        break
  
  retornar versionVisible.datos
}

función escribir(transaccion, clave, valor) {
  mutex.lock()
  
  // Crear nueva versión
  nuevaVersion = Version()
  nuevaVersion.datos = valor
  nuevaVersion.timestamp = incrementar_atomico(currentVersion)
  nuevaVersion.transaccionCreadora = transaccion.id
  
  // Añadir a lista de versiones
  versiones.agregar(nuevaVersion)
  
  mutex.unlock()
}

función commit(transaccion) {
  // Validar que no hay conflictos
  si tieneConflictos(transaccion):
    abort(transaccion)
    retornar FALLO
  
  // Hacer visibles todas las escrituras
  para cada escritura en transaccion.escrituras:
    escritura.version.valida = verdadero
  
  retornar EXITO
}

función abort(transaccion) {
  // Marcar versiones como inválidas
  para cada escritura en transaccion.escrituras:
    escritura.version.transaccionBorradora = transaccion.timestamp
    escritura.version.valida = falso
}

// Garbage Collection de versiones antiguas
función limpiarVersionesAntiguas() {
  timestampMinimo = obtenerTimestampTransaccionActiva()
  
  para cada version en versiones:
    si version.transaccionBorradora < timestampMinimo:
      // Ninguna transacción activa puede ver esta versión
      versiones.remover(version)
      liberar(version.datos)
}

// Implementación simplificada estilo PostgreSQL
estructura MVCCPostgreSQL {
  tuplas: Mapa[Clave, Lista[Tupla]]
}

estructura Tupla {
  datos: Dato
  xmin: TransactionId  // Transacción que creó
  xmax: TransactionId  // Transacción que borró (0 si activa)
  commandId: entero
}

función tuplaVisible(tupla, snapshot) {
  // Visible si:
  // 1. Creada por transacción commited antes del snapshot
  // 2. No borrada, o borrada después del snapshot
  
  si tupla.xmin > snapshot.xmax:
    retornar falso  // Creada después
  
  si tupla.xmin en snapshot.activasEnCurso:
    retornar falso  // Creada por transacción aún activa
  
  si tupla.xmax == 0:
    retornar verdadero  // No borrada
  
  si tupla.xmax > snapshot.xmax:
    retornar verdadero  // Borrada después
  
  si tupla.xmax en snapshot.activasEnCurso:
    retornar verdadero  // Borrada por transacción aún activa
  
  retornar falso  // Borrada antes del snapshot
}`})}),e.jsx("div",{className:"mt-4 p-3 bg-orange-900/30 border border-orange-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-orange-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Lectores no bloquean escritores, snapshots consistentes.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Overhead de versiones, garbage collection complejo."]})})]})})]})})]}),e.jsxs(sa,{value:"demostracion",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(La,{className:"size-5"}),e.jsx("span",{children:"Demostraciones Interactivas"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"rwlock",className:"px-6 pb-6",children:[e.jsxs(Qt,{className:"grid grid-cols-7 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"rwlock",children:"🔐 RWLock"}),e.jsx(le,{value:"readers-pref",children:"📖 Readers-Pref"}),e.jsx(le,{value:"writers-pref",children:"✍️ Writers-Pref"}),e.jsx(le,{value:"fair",children:"⚖️ Fair"}),e.jsx(le,{value:"cow",children:"📋 CoW"}),e.jsx(le,{value:"rcu",children:"🔄 RCU"}),e.jsx(le,{value:"mvcc",children:"📚 MVCC"})]}),e.jsx(ue,{value:"rwlock",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-400 mb-4",children:"🔐 Read-Write Locks (RWLock)"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6 border border-gray-600",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>x(!h),className:`px-4 py-2 rounded flex items-center gap-2 font-semibold transition-colors ${h?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:h?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:B,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded flex items-center gap-2 font-semibold transition-colors",children:[e.jsx(it,{className:"size-4"})," Reset"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>U("reader"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded font-semibold transition-colors",children:"+ Lector"}),e.jsx("button",{onClick:()=>U("writer"),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded font-semibold transition-colors",children:"+ Escritor"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-2 block",children:["Velocidad: ",g,"ms"]}),e.jsx(dt,{value:[g],onValueChange:X=>b(X[0]),min:100,max:1e3,step:50,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"📊 Estado del Lock"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Lectores activos:"}),e.jsx("span",{className:"font-bold text-blue-400",children:n})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Escritores activos:"}),e.jsx("span",{className:"font-bold text-purple-400",children:d})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"En espera:"}),e.jsx("span",{className:"font-bold text-yellow-400",children:s.filter(X=>X.state==="waiting").length})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3",children:"🧵 Threads Activos"}),e.jsx("div",{className:"space-y-2 max-h-24 overflow-y-auto",children:s.map(X=>e.jsxs("div",{className:`flex items-center gap-2 text-sm p-2 rounded ${X.state==="reading"?"bg-blue-900/50":X.state==="writing"?"bg-purple-900/50":"bg-gray-700/50"}`,children:[e.jsx("span",{className:X.type==="reader"?"text-blue-400":"text-purple-400",children:X.type==="reader"?"📖":"✍️"}),e.jsxs("span",{className:"flex-1",children:[X.type," ",X.id.toString().slice(-4)]}),e.jsx("span",{className:`text-xs ${X.state==="reading"?"text-blue-300":X.state==="writing"?"text-purple-300":"text-yellow-300"}`,children:X.state})]},X.id))})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-gray-300 mb-3",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:N,className:"bg-black rounded p-3 font-mono text-sm text-green-400 h-48 overflow-y-auto",children:v.map((X,Oe)=>e.jsx("div",{className:"mb-1",children:X},Oe))})]})]})}),e.jsx(ue,{value:"readers-pref",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-green-400 mb-4",children:"📖 Readers-Preference"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6 border border-gray-600",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>z(!E),className:`px-4 py-2 rounded flex items-center gap-2 font-semibold transition-colors ${E?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:E?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:Dt,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded flex items-center gap-2 font-semibold transition-colors",children:[e.jsx(it,{className:"size-4"})," Reset"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>Ke("reader"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded font-semibold transition-colors",children:"+ Lector"}),e.jsx("button",{onClick:()=>Ke("writer"),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded font-semibold transition-colors",children:"+ Escritor"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-2 block",children:["Velocidad: ",P,"ms"]}),e.jsx(dt,{value:[P],onValueChange:X=>V(X[0]),min:100,max:1e3,step:50,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3",children:"📊 Estado"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Lectores concurrentes:"}),e.jsx("span",{className:"font-bold text-green-400",children:w})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Escritores esperando:"}),e.jsx("span",{className:"font-bold text-red-400",children:j.filter(X=>X.type==="writer"&&X.state==="waiting").length})]})]}),j.some(X=>X.type==="writer"&&X.waitTime>5)&&e.jsx("div",{className:"mt-3 p-2 bg-red-900/30 border border-red-700/50 rounded",children:e.jsx("p",{className:"text-red-300 text-sm",children:"⚠️ STARVATION DETECTADA"})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"🧵 Threads"}),e.jsx("div",{className:"space-y-2 max-h-24 overflow-y-auto",children:j.map(X=>e.jsxs("div",{className:`flex items-center gap-2 text-sm p-2 rounded ${X.state==="reading"?"bg-blue-900/50":X.state==="writing"?"bg-purple-900/50":X.waitTime>5?"bg-red-900/50":"bg-gray-700/50"}`,children:[e.jsx("span",{children:X.type==="reader"?"📖":"✍️"}),e.jsxs("span",{className:"flex-1",children:[X.type," ",X.id.toString().slice(-4)]}),X.state==="waiting"&&e.jsxs("span",{className:"text-xs text-yellow-300",children:["⏳ ",X.waitTime]})]},X.id))})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-gray-300 mb-3",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:O,className:"bg-black rounded p-3 font-mono text-sm text-green-400 h-48 overflow-y-auto",children:Z.map((X,Oe)=>e.jsx("div",{className:"mb-1",children:X},Oe))})]})]})}),e.jsx(ue,{value:"writers-pref",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-400 mb-4",children:"✍️ Writers-Preference"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6 border border-gray-600",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>Ee(!ne),className:`px-4 py-2 rounded flex items-center gap-2 font-semibold transition-colors ${ne?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:ne?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:fe,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded flex items-center gap-2 font-semibold transition-colors",children:[e.jsx(it,{className:"size-4"})," Reset"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>$t("reader"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded font-semibold transition-colors",children:"+ Lector"}),e.jsx("button",{onClick:()=>$t("writer"),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded font-semibold transition-colors",children:"+ Escritor"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-2 block",children:["Velocidad: ",Ce,"ms"]}),e.jsx(dt,{value:[Ce],onValueChange:X=>Le(X[0]),min:100,max:1e3,step:50,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-3",children:"📊 Estado"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Escritores esperando:"}),e.jsx("span",{className:"font-bold text-purple-400",children:J})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Lectores bloqueados:"}),e.jsx("span",{className:"font-bold text-red-400",children:T.filter(X=>X.type==="reader"&&X.state==="waiting").length})]})]}),J>0&&e.jsx("div",{className:"mt-3 p-2 bg-purple-900/30 border border-purple-700/50 rounded",children:e.jsx("p",{className:"text-purple-300 text-sm",children:"🔒 Nuevos lectores bloqueados"})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"🧵 Threads"}),e.jsx("div",{className:"space-y-2 max-h-24 overflow-y-auto",children:T.map(X=>e.jsxs("div",{className:`flex items-center gap-2 text-sm p-2 rounded ${X.state==="reading"?"bg-blue-900/50":X.state==="writing"?"bg-purple-900/50":"bg-gray-700/50"}`,children:[e.jsx("span",{children:X.type==="reader"?"📖":"✍️"}),e.jsxs("span",{className:"flex-1",children:[X.type," ",X.id.toString().slice(-4)]}),X.state==="waiting"&&X.waitTime>4&&e.jsxs("span",{className:"text-xs text-red-300",children:["⚠️ ",X.waitTime]})]},X.id))})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-gray-300 mb-3",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:F,className:"bg-black rounded p-3 font-mono text-sm text-green-400 h-48 overflow-y-auto",children:I.map((X,Oe)=>e.jsx("div",{className:"mb-1",children:X},Oe))})]})]})}),e.jsx(ue,{value:"fair",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-4",children:"⚖️ Fair Policy (FIFO)"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6 border border-gray-600",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>k(!se),className:`px-4 py-2 rounded flex items-center gap-2 font-semibold transition-colors ${se?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:se?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:Zt,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded flex items-center gap-2 font-semibold transition-colors",children:[e.jsx(it,{className:"size-4"})," Reset"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>pt("reader"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded font-semibold transition-colors",children:"+ Lector"}),e.jsx("button",{onClick:()=>pt("writer"),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded font-semibold transition-colors",children:"+ Escritor"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-2 block",children:["Velocidad: ",K,"ms"]}),e.jsx(dt,{value:[K],onValueChange:X=>M(X[0]),min:100,max:1e3,step:50,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-yellow-300 mb-3",children:"📋 Cola FIFO"}),e.jsxs("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:[A.map((X,Oe)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm p-2 rounded bg-gray-700",children:[e.jsxs("span",{className:"text-yellow-400 font-bold",children:[Oe+1,"."]}),e.jsx("span",{children:X.type==="reader"?"📖":"✍️"}),e.jsxs("span",{className:"flex-1",children:[X.type," ",X.id.toString().slice(-4)]}),Oe===0&&e.jsx("span",{className:"text-xs text-green-300 animate-pulse",children:"▶️ Siguiente"})]},X.id)),A.length===0&&e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"Cola vacía"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3",children:"🧵 Threads Activos"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:de.filter(X=>X.state!=="waiting").map(X=>e.jsxs("div",{className:`flex items-center gap-2 text-sm p-2 rounded ${X.state==="reading"?"bg-blue-900/50":X.state==="writing"?"bg-purple-900/50":"bg-gray-700/50"}`,children:[e.jsx("span",{children:X.type==="reader"?"📖":"✍️"}),e.jsxs("span",{className:"flex-1",children:[X.type," ",X.id.toString().slice(-4)]}),e.jsx("span",{className:"text-xs text-green-300",children:X.state})]},X.id))})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-gray-300 mb-3",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:G,className:"bg-black rounded p-3 font-mono text-sm text-green-400 h-48 overflow-y-auto",children:D.map((X,Oe)=>e.jsx("div",{className:"mb-1",children:X},Oe))})]})]})}),e.jsx(ue,{value:"cow",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-cyan-400 mb-4",children:"📋 Copy-on-Write (CoW)"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6 border border-gray-600",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>rt(!ae),className:`px-4 py-2 rounded flex items-center gap-2 font-semibold transition-colors ${ae?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:ae?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:zt,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded flex items-center gap-2 font-semibold transition-colors",children:[e.jsx(it,{className:"size-4"})," Reset"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>lt("reader"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded font-semibold transition-colors",children:"+ Lector"}),e.jsx("button",{onClick:()=>lt("writer"),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded font-semibold transition-colors",children:"+ Escritor"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-2 block",children:["Velocidad: ",jt,"ms"]}),e.jsx(dt,{value:[jt],onValueChange:X=>xe(X[0]),min:100,max:1e3,step:50,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-cyan-300 mb-3",children:"📦 Versiones"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Versión actual:"}),e.jsxs("span",{className:"font-bold text-cyan-400",children:["v",je]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total versiones:"}),e.jsx("span",{className:"font-bold text-blue-400",children:R.length})]}),e.jsx("div",{className:"mt-3 p-2 bg-cyan-900/30 border border-cyan-700/50 rounded",children:e.jsx("p",{className:"text-cyan-200 text-sm",children:"🔓 Lectores lock-free"})})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-1",children:R.map(X=>e.jsxs("span",{className:`px-2 py-1 rounded text-xs ${X===je?"bg-cyan-600":"bg-gray-600"}`,children:["v",X]},X))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"🧵 Threads"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:be.map(X=>e.jsxs("div",{className:`flex items-center gap-2 text-sm p-2 rounded ${X.state==="reading"?"bg-blue-900/50":X.state==="writing"?"bg-purple-900/50":"bg-gray-700/50"}`,children:[e.jsx("span",{children:X.type==="reader"?"📖":"✍️"}),e.jsxs("span",{className:"flex-1",children:[X.type," ",X.id.toString().slice(-4)]}),X.version&&e.jsxs("span",{className:"text-xs text-cyan-300",children:["v",X.version]})]},X.id))})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-gray-300 mb-3",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:Ge,className:"bg-black rounded p-3 font-mono text-sm text-green-400 h-48 overflow-y-auto",children:Me.map((X,Oe)=>e.jsx("div",{className:"mb-1",children:X},Oe))})]})]})}),e.jsx(ue,{value:"rcu",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-pink-400 mb-4",children:"🔄 RCU (Read-Copy-Update)"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6 border border-gray-600",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>Ue(!It),className:`px-4 py-2 rounded flex items-center gap-2 font-semibold transition-colors ${It?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:It?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:Be,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded flex items-center gap-2 font-semibold transition-colors",children:[e.jsx(it,{className:"size-4"})," Reset"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>Ie("reader"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded font-semibold transition-colors",children:"+ Lector"}),e.jsx("button",{onClick:()=>Ie("writer"),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded font-semibold transition-colors",children:"+ Escritor"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-2 block",children:["Velocidad: ",At,"ms"]}),e.jsx(dt,{value:[At],onValueChange:X=>et(X[0]),min:100,max:1e3,step:50,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-pink-300 mb-3",children:"⏳ Grace Period"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:`p-3 rounded ${Xe?"bg-yellow-900/50 border border-yellow-700/50":"bg-green-900/50 border border-green-700/50"}`,children:e.jsx("p",{className:"font-bold text-center",children:Xe?"🟡 En Grace Period":"🟢 Inactivo"})}),xt&&e.jsx("div",{className:"p-2 bg-red-900/30 border border-red-700/50 rounded",children:e.jsxs("p",{className:"text-red-200 text-sm",children:["♻️ Versión ",xt," esperando liberación"]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Lectores activos:"}),e.jsx("span",{className:"font-bold text-blue-400",children:qe.filter(X=>X.state==="reading").length})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"🧵 Threads"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:qe.map(X=>e.jsxs("div",{className:`flex items-center gap-2 text-sm p-2 rounded ${X.state==="reading"?"bg-blue-900/50":X.state==="writing"?"bg-purple-900/50":"bg-gray-700/50"}`,children:[e.jsx("span",{children:X.type==="reader"?"📖":"✍️"}),e.jsxs("span",{className:"flex-1",children:[X.type," ",X.id.toString().slice(-4)]}),e.jsx("span",{className:"text-xs text-green-300",children:X.state})]},X.id))})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-gray-300 mb-3",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:Ve,className:"bg-black rounded p-3 font-mono text-sm text-green-400 h-48 overflow-y-auto",children:L.map((X,Oe)=>e.jsx("div",{className:"mb-1",children:X},Oe))})]})]})}),e.jsx(ue,{value:"mvcc",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-orange-400 mb-4",children:"📚 MVCC (Multi-Version Concurrency Control)"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6 border border-gray-600",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>Ye(!tt),className:`px-4 py-2 rounded flex items-center gap-2 font-semibold transition-colors ${tt?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:tt?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:Je,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded flex items-center gap-2 font-semibold transition-colors",children:[e.jsx(it,{className:"size-4"})," Reset"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>ot("reader"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded font-semibold transition-colors",children:"+ Lector"}),e.jsx("button",{onClick:()=>ot("writer"),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded font-semibold transition-colors",children:"+ Escritor"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-2 block",children:["Velocidad: ",ft,"ms"]}),e.jsx(dt,{value:[ft],onValueChange:X=>Ct(X[0]),min:100,max:1e3,step:50,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-orange-300 mb-3",children:"📚 Timeline de Versiones"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:_t.map((X,Oe)=>e.jsxs("div",{className:`p-2 rounded ${Oe===_t.length-1?"bg-orange-900/50 border border-orange-700/50":"bg-gray-700"}`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-bold text-orange-400",children:["v",X.id]}),e.jsxs("span",{className:"text-xs text-gray-400",children:["ts: ",X.timestamp]})]}),e.jsx("p",{className:"text-sm text-gray-300",children:X.data})]},X.id))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"🧵 Transacciones"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:ce.map(X=>e.jsxs("div",{className:`flex items-center gap-2 text-sm p-2 rounded ${X.state==="reading"?"bg-blue-900/50":X.state==="writing"?"bg-purple-900/50":"bg-gray-700/50"}`,children:[e.jsx("span",{children:X.type==="reader"?"📖":"✍️"}),e.jsxs("span",{className:"flex-1",children:[X.type," ",X.id.toString().slice(-4)]}),e.jsx("span",{className:"text-xs text-green-300",children:X.state})]},X.id))})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"font-bold text-gray-300 mb-3",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:$e,className:"bg-black rounded p-3 font-mono text-sm text-green-400 h-48 overflow-y-auto",children:ve.map((X,Oe)=>e.jsx("div",{className:"mb-1",children:X},Oe))})]})]})})]})})]})]})})]})}const a2=Sa("/ActividadesSeminarioSO/actividad11/lectura-escritura")({component:t2});function s2(){const[s,o]=c.useState(!1),[n,l]=c.useState(500),[d,m]=c.useState(0),[h,x]=c.useState([{id:0,value:0,thread:0,padded:!1,cacheLine:0},{id:1,value:0,thread:1,padded:!1,cacheLine:0},{id:2,value:0,thread:0,padded:!0,cacheLine:0},{id:3,value:0,thread:1,padded:!0,cacheLine:1}]),[g,b]=c.useState({withoutPadding:0,withPadding:0}),[v,f]=c.useState([]),[N,j]=c.useState(!1),[_,w]=c.useState(500),[C,E]=c.useState(0),[z,P]=c.useState({unaligned:0,aligned:0}),[V,Z]=c.useState([]),[oe,O]=c.useState(!1),[T,ge]=c.useState(500),[J,W]=c.useState(0),[ne,Ee]=c.useState([{id:0,localSum:0,writes:0,useLocal:!1},{id:1,localSum:0,writes:0,useLocal:!1},{id:2,localSum:0,writes:0,useLocal:!0},{id:3,localSum:0,writes:0,useLocal:!0}]),[Ce,Le]=c.useState({shared:0,threadLocal:0}),[I,Q]=c.useState(0),[F,de]=c.useState([]),[ze,A]=c.useState(!1),[$,se]=c.useState(500),[k,K]=c.useState(0),[M,D]=c.useState({badLayout:0,goodLayout:0}),[q,G]=c.useState([]),[be,Ne]=c.useState(!1),[R,ke]=c.useState(500),[je,ee]=c.useState(0),[ae,rt]=c.useState([{name:"Array of Structs (AoS)",layout:"aos",cacheHits:0,cacheMisses:0},{name:"Struct of Arrays (SoA)",layout:"soa",cacheHits:0,cacheMisses:0}]),[jt,xe]=c.useState([]),Me=c.useRef(null),De=c.useRef(null),Ge=c.useRef(null),qe=c.useRef(null),Se=c.useRef(null);c.useEffect(()=>{Me.current?.scrollTo({top:Me.current.scrollHeight,behavior:"smooth"})},[v]),c.useEffect(()=>{De.current?.scrollTo({top:De.current.scrollHeight,behavior:"smooth"})},[V]),c.useEffect(()=>{Ge.current?.scrollTo({top:Ge.current.scrollHeight,behavior:"smooth"})},[F]),c.useEffect(()=>{qe.current?.scrollTo({top:qe.current.scrollHeight,behavior:"smooth"})},[q]),c.useEffect(()=>{Se.current?.scrollTo({top:Se.current.scrollHeight,behavior:"smooth"})},[jt]),c.useEffect(()=>{if(!s)return;const Ue=setTimeout(()=>{m(At=>{const et=(At+1)%10;return et===0?f(L=>[...L,{time:Date.now(),message:"🔄 Iniciando simulación de Cache Line Padding",type:"info"}]):et===1?(f(L=>[...L,{time:Date.now(),message:"❌ SIN PADDING: Thread 0 escribe counter[0]",type:"warning"}]),x(L=>L.map(re=>re.id===0?{...re,value:re.value+1}:re))):et===2?(f(L=>[...L,{time:Date.now(),message:"🚨 Thread 1 escribe counter[1] → INVALIDA cache de Thread 0 (misma línea)",type:"error"}]),x(L=>L.map(re=>re.id===1?{...re,value:re.value+1}:re)),b(L=>({...L,withoutPadding:L.withoutPadding+1}))):et===3?(f(L=>[...L,{time:Date.now(),message:"⚠️ Thread 0 lee counter[0] → CACHE MISS (false sharing)",type:"warning"}]),b(L=>({...L,withoutPadding:L.withoutPadding+1}))):et===4?f(L=>[...L,{time:Date.now(),message:"---",type:"info"}]):et===5?(f(L=>[...L,{time:Date.now(),message:"✅ CON PADDING: Thread 0 escribe counter[2] (línea 0)",type:"info"}]),x(L=>L.map(re=>re.id===2?{...re,value:re.value+1}:re))):et===6?(f(L=>[...L,{time:Date.now(),message:"✅ Thread 1 escribe counter[3] (línea 1) → NO invalida cache de Thread 0",type:"success"}]),x(L=>L.map(re=>re.id===3?{...re,value:re.value+1}:re))):et===7?f(L=>[...L,{time:Date.now(),message:"✅ Thread 0 lee counter[2] → CACHE HIT (líneas separadas)",type:"success"}]):et===8?f(L=>[...L,{time:Date.now(),message:`📊 Invalidaciones: Sin padding=${g.withoutPadding}, Con padding=${g.withPadding}`,type:"info"}]):et===9&&f(L=>[...L,{time:Date.now(),message:"✅ Padding elimina false sharing colocando datos en diferentes cache lines",type:"success"}]),et})},n);return()=>clearTimeout(Ue)},[s,d,n,g]),c.useEffect(()=>{if(!N)return;const Ue=setTimeout(()=>{E(At=>{const et=(At+1)%8;return et===0?Z(L=>[...L,{time:Date.now(),message:"🔄 Iniciando simulación de Alignment Directives",type:"info"}]):et===1?Z(L=>[...L,{time:Date.now(),message:"❌ UNALIGNED: Struct en offset 0 (size=12 bytes)",type:"warning"}]):et===2?(Z(L=>[...L,{time:Date.now(),message:"❌ Struct en offset 12 → CRUZA línea de cache (12-24)",type:"error"}]),P(L=>({...L,unaligned:L.unaligned+1}))):et===3?(Z(L=>[...L,{time:Date.now(),message:"⚠️ Acceso requiere 2 lecturas de cache (cache line crossing)",type:"warning"}]),P(L=>({...L,unaligned:L.unaligned+1}))):et===4?Z(L=>[...L,{time:Date.now(),message:"---",type:"info"}]):et===5?Z(L=>[...L,{time:Date.now(),message:"✅ ALIGNED: Struct en offset 0 (aligned to 64 bytes)",type:"success"}]):et===6?Z(L=>[...L,{time:Date.now(),message:"✅ Struct en offset 64 → En cache line separada",type:"success"}]):et===7&&Z(L=>[...L,{time:Date.now(),message:`✅ Alignment elimina crossings: Unaligned=${z.unaligned}, Aligned=${z.aligned}`,type:"success"}]),et})},_);return()=>clearTimeout(Ue)},[N,C,_,z]),c.useEffect(()=>{if(!oe)return;const Ue=setTimeout(()=>{W(At=>{const et=(At+1)%12;if(et===0)de(L=>[...L,{time:Date.now(),message:"🔄 Iniciando Thread-Local Accumulators",type:"info"}]);else if(et===1)de(L=>[...L,{time:Date.now(),message:"❌ SHARED COUNTER: Thread 0 incrementa global",type:"warning"}]),Ee(L=>L.map(re=>re.id===0?{...re,writes:re.writes+1}:re)),Le(L=>({...L,shared:L.shared+1})),Q(L=>L+1);else if(et===2)de(L=>[...L,{time:Date.now(),message:"🚨 Thread 1 incrementa global → CONTENCIÓN (false sharing)",type:"error"}]),Ee(L=>L.map(re=>re.id===1?{...re,writes:re.writes+1}:re)),Le(L=>({...L,shared:L.shared+1})),Q(L=>L+1);else if(et===3)de(L=>[...L,{time:Date.now(),message:"⚠️ Ambos threads escriben mismo contador → alta contención",type:"warning"}]),Q(L=>L+1);else if(et===4)de(L=>[...L,{time:Date.now(),message:"---",type:"info"}]);else if(et===5)de(L=>[...L,{time:Date.now(),message:"✅ THREAD-LOCAL: Thread 2 incrementa LOCAL accumulator",type:"success"}]),Ee(L=>L.map(re=>re.id===2?{...re,localSum:re.localSum+1,writes:re.writes+1}:re));else if(et===6)de(L=>[...L,{time:Date.now(),message:"✅ Thread 3 incrementa SU local accumulator (sin contención)",type:"success"}]),Ee(L=>L.map(re=>re.id===3?{...re,localSum:re.localSum+1,writes:re.writes+1}:re));else if(et===7)de(L=>[...L,{time:Date.now(),message:"✅ Threads 2 y 3 trabajan en PARALELO sin interferencia",type:"success"}]),Ee(L=>L.map(re=>re.id===2||re.id===3?{...re,localSum:re.localSum+1,writes:re.writes+1}:re));else if(et===8)de(L=>[...L,{time:Date.now(),message:"Thread 2 finaliza: local_sum = "+(ne[2]?.localSum||0),type:"info"}]);else if(et===9)de(L=>[...L,{time:Date.now(),message:"Thread 3 finaliza: local_sum = "+(ne[3]?.localSum||0),type:"info"}]);else if(et===10){const L=(ne[2]?.localSum||0)+(ne[3]?.localSum||0);Le(re=>({...re,threadLocal:L})),de(re=>[...re,{time:Date.now(),message:`✅ Merge final: global = ${L} (1 sola escritura compartida)`,type:"success"}])}else et===11&&de(L=>[...L,{time:Date.now(),message:`📊 Contentiones: Shared=${I}, Thread-local=0`,type:"success"}]);return et})},T);return()=>clearTimeout(Ue)},[oe,J,T,I,ne]),c.useEffect(()=>{if(!ze)return;const Ue=setTimeout(()=>{K(At=>{const et=(At+1)%8;return et===0?G(L=>[...L,{time:Date.now(),message:"🔄 Iniciando Structure Reorganization",type:"info"}]):et===1?G(L=>[...L,{time:Date.now(),message:"❌ BAD LAYOUT: [readFreq | writeFreq1 | writeFreq2 | readOnly]",type:"warning"}]):et===2?(G(L=>[...L,{time:Date.now(),message:"🚨 Thread A lee 'readFreq', Thread B escribe 'writeFreq1'",type:"error"}]),D(L=>({...L,badLayout:L.badLayout+1}))):et===3?(G(L=>[...L,{time:Date.now(),message:"⚠️ FALSE SHARING: Datos read-frequently mezclados con write-frequently",type:"warning"}]),D(L=>({...L,badLayout:L.badLayout+1}))):et===4?G(L=>[...L,{time:Date.now(),message:"---",type:"info"}]):et===5?G(L=>[...L,{time:Date.now(),message:"✅ GOOD LAYOUT: [readFreq | readOnly] [writeFreq1 | writeFreq2]",type:"success"}]):et===6?(G(L=>[...L,{time:Date.now(),message:"✅ Thread A lee 'readFreq', Thread B escribe 'writeFreq1' → Sin interferencia",type:"success"}]),D(L=>({...L,goodLayout:L.goodLayout+1}))):et===7&&G(L=>[...L,{time:Date.now(),message:`✅ Reorganización agrupa campos por patrón de acceso: Bad=${M.badLayout} invalidaciones, Good=${M.goodLayout}`,type:"success"}]),et})},$);return()=>clearTimeout(Ue)},[ze,k,$,M]),c.useEffect(()=>{if(!be)return;const Ue=setTimeout(()=>{ee(At=>{const et=(At+1)%10;if(et===0)xe(L=>[...L,{time:Date.now(),message:"🔄 Iniciando Cache-Aware Data Structures (AoS vs SoA)",type:"info"}]);else if(et===1)xe(L=>[...L,{time:Date.now(),message:"❌ AoS: Acceso a campo 'x' de 4 elementos",type:"warning"}]);else if(et===2)xe(L=>[...L,{time:Date.now(),message:"⚠️ Elementos dispersos en memoria → múltiples cache misses",type:"warning"}]),rt(L=>L.map(re=>re.layout==="aos"?{...re,cacheMisses:re.cacheMisses+3}:re));else if(et===3)xe(L=>[...L,{time:Date.now(),message:"AoS carga structs completos (desperdicia ancho de banda)",type:"info"}]),rt(L=>L.map(re=>re.layout==="aos"?{...re,cacheHits:re.cacheHits+1}:re));else if(et===4)xe(L=>[...L,{time:Date.now(),message:"---",type:"info"}]);else if(et===5)xe(L=>[...L,{time:Date.now(),message:"✅ SoA: Acceso a array 'x[]' de 4 elementos",type:"success"}]);else if(et===6)xe(L=>[...L,{time:Date.now(),message:"✅ Elementos contiguos en memoria → 1 cache line",type:"success"}]),rt(L=>L.map(re=>re.layout==="soa"?{...re,cacheHits:re.cacheHits+4}:re));else if(et===7)xe(L=>[...L,{time:Date.now(),message:"✅ SoA carga SOLO datos necesarios (eficiente)",type:"success"}]);else if(et===8){const L=ae[0]?.cacheMisses||0,re=ae[1]?.cacheMisses||0;xe(Ve=>[...Ve,{time:Date.now(),message:`📊 Cache Misses: AoS=${L}, SoA=${re}`,type:"info"}])}else et===9&&xe(L=>[...L,{time:Date.now(),message:"✅ SoA mejora localidad espacial para accesos columnares",type:"success"}]);return et})},R);return()=>clearTimeout(Ue)},[be,je,R,ae]);const Xe=()=>{o(!1),m(0),x([{id:0,value:0,thread:0,padded:!1,cacheLine:0},{id:1,value:0,thread:1,padded:!1,cacheLine:0},{id:2,value:0,thread:0,padded:!0,cacheLine:0},{id:3,value:0,thread:1,padded:!0,cacheLine:1}]),b({withoutPadding:0,withPadding:0}),f([])},We=()=>{j(!1),E(0),P({unaligned:0,aligned:0}),Z([])},xt=()=>{O(!1),W(0),Ee([{id:0,localSum:0,writes:0,useLocal:!1},{id:1,localSum:0,writes:0,useLocal:!1},{id:2,localSum:0,writes:0,useLocal:!0},{id:3,localSum:0,writes:0,useLocal:!0}]),Le({shared:0,threadLocal:0}),Q(0),de([])},Ot=()=>{A(!1),K(0),D({badLayout:0,goodLayout:0}),G([])},It=()=>{Ne(!1),ee(0),rt([{name:"Array of Structs (AoS)",layout:"aos",cacheHits:0,cacheMisses:0},{name:"Struct of Arrays (SoA)",layout:"soa",cacheHits:0,cacheMisses:0}]),xe([])};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(La,{className:"size-8 text-amber-400"}),e.jsx("h1",{className:"text-4xl font-bold",children:"False Sharing — Soluciones"})]}),e.jsx("p",{className:"text-lg text-gray-300 leading-relaxed",children:"Técnicas para prevenir false sharing: padding de cache lines, directivas de alineación, acumuladores thread-local, reorganización de estructuras y estructuras de datos cache-aware."})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsx(Da,{type:"single",defaultValue:"pseudocodigos",collapsible:!0,className:"space-y-4",children:e.jsxs(sa,{value:"pseudocodigos",className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700",children:[e.jsx(ra,{className:"px-6 py-4 hover:bg-slate-700/30 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(oa,{className:"size-6 text-blue-400"}),e.jsx("span",{className:"text-2xl font-semibold",children:"Pseudocódigos de Soluciones"})]})}),e.jsx(na,{className:"px-6 pb-6",children:e.jsxs(ia,{defaultValue:"padding",className:"w-full",children:[e.jsxs(Qt,{className:"grid w-full grid-cols-5 bg-slate-900/50 p-1 rounded-lg mb-6",children:[e.jsx(le,{value:"padding",className:"data-[state=active]:bg-blue-600",children:"Cache Line Padding"}),e.jsx(le,{value:"alignment",className:"data-[state=active]:bg-blue-600",children:"Alignment Directives"}),e.jsx(le,{value:"threadlocal",className:"data-[state=active]:bg-blue-600",children:"Thread-Local"}),e.jsx(le,{value:"reorganization",className:"data-[state=active]:bg-blue-600",children:"Structure Reorg"}),e.jsx(le,{value:"cacheaware",className:"data-[state=active]:bg-blue-600",children:"Cache-Aware DS"})]}),e.jsxs(ue,{value:"padding",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/30 to-slate-800/30 p-6 rounded-lg border border-blue-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-300 mb-3",children:"🔲 Solución 1: Cache Line Padding"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Agrega bytes de relleno (padding) entre variables para forzar que cada una ocupe una cache line completa (típicamente 64 bytes). Esto previene que threads diferentes invaliden mutuamente sus caches al escribir variables que estarían en la misma línea."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Separa datos en diferentes cache lines"}),e.jsx("li",{children:"• Tamaño típico de cache line: 64 bytes"}),e.jsx("li",{children:"• Usa padding para alinear a 64 bytes"}),e.jsx("li",{children:"• Elimina false sharing entre threads"}),e.jsx("li",{children:"• Trade-off: usa más memoria"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Cache Line Padding"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Tamaño típico de cache line en arquitecturas modernas
constante CACHE_LINE_SIZE = 64  // bytes

// SIN PADDING (problema de false sharing)
estructura CounterArraySinPadding {
    counter: arreglo[NUM_THREADS] de entero
    // Todos los counters en memoria contigua
    // Múltiples counters en la misma cache line
}

función usar_sin_padding() {
    counters: CounterArraySinPadding
    
    función worker_thread(id: entero) {
        para i = 1 hasta 1000000 hacer
            counters.counter[id]++  // FALSE SHARING!
            // Escrituras de diferentes threads invalidan
            // mutuamente sus caches
        fin para
    }
    
    // Threads 0 y 1 comparten cache line
    // Cada escritura invalida la cache del otro
}

// CON PADDING (solución)
estructura PaddedCounter {
    value: entero
    padding: arreglo[CACHE_LINE_SIZE - sizeof(entero)] de byte
    // Padding garantiza que cada counter ocupe 64 bytes
}

estructura CounterArrayConPadding {
    counters: arreglo[NUM_THREADS] de PaddedCounter
    // Cada counter en su propia cache line
}

función usar_con_padding() {
    counters: CounterArrayConPadding
    
    función worker_thread(id: entero) {
        para i = 1 hasta 1000000 hacer
            counters.counters[id].value++  // Sin false sharing
            // Cada thread escribe en su propia cache line
        fin para
    }
    
    // Threads 0 y 1 tienen cache lines separadas
    // Sin invalidaciones mutuas
}

// Macro/Helper para crear variables padded
macro CACHE_ALIGNED(tipo, nombre)
    alignas(CACHE_LINE_SIZE) tipo nombre

// Ejemplo de uso
función ejemplo_cache_aligned() {
    CACHE_ALIGNED(entero, counter_thread_0)
    CACHE_ALIGNED(entero, counter_thread_1)
    
    // counter_thread_0 y counter_thread_1 están en
    // cache lines diferentes
}

// Padding explícito en C/C++
estructura PaddedData {
    data: entero
    char padding[CACHE_LINE_SIZE - sizeof(entero)]
} __attribute__((aligned(CACHE_LINE_SIZE)))

// Array de estructuras padded
función crear_array_padded(size: entero) -> arreglo de PaddedCounter {
    // Cada elemento ocupa 64 bytes
    arr: arreglo[size] de PaddedCounter
    
    // Verificar alineación
    para i = 0 hasta size - 1 hacer
        address = dirección_de(arr[i])
        assert(address % CACHE_LINE_SIZE == 0)
    fin para
    
    return arr
}

// Cálculo de padding necesario
función calcular_padding(size: entero) -> entero {
    si size >= CACHE_LINE_SIZE entonces
        return 0  // Ya es suficientemente grande
    fin si
    
    return CACHE_LINE_SIZE - (size % CACHE_LINE_SIZE)
}

// Estructura con múltiples campos padded
estructura MultiFieldPadded {
    // Campo 1
    field1: entero
    padding1: arreglo[60] de byte  // 4 + 60 = 64
    
    // Campo 2
    field2: entero
    padding2: arreglo[60] de byte  // 4 + 60 = 64
    
    // Cada campo en su propia cache line
}

// Template genérico para padding
template<T>
estructura Padded {
    value: T
    padding: arreglo[CACHE_LINE_SIZE - sizeof(T)] de byte
}

función usar_template_padded() {
    counter1: Padded<entero>
    counter2: Padded<entero>
    
    counter1.value++
    counter2.value++  // Sin false sharing
}

// Padding para diferentes tamaños de cache line
función detectar_cache_line_size() -> entero {
    // En runtime, detectar usando CPUID u otro método
    // Valor por defecto: 64 bytes
    return 64
}

función crear_estructura_adaptativa() {
    cache_size = detectar_cache_line_size()
    
    estructura AdaptivePadded {
        value: entero
        padding: arreglo[cache_size - sizeof(entero)] de byte
    }
}

// False sharing con arrays 2D
función ejemplo_array_2d_sin_padding() {
    // Problema: filas adyacentes comparten cache lines
    matrix: arreglo[NUM_THREADS][COLS] de entero
    
    función worker(thread_id: entero) {
        para j = 0 hasta COLS - 1 hacer
            matrix[thread_id][j]++  // Posible false sharing
        fin para
    }
}

función ejemplo_array_2d_con_padding() {
    // Solución: añadir padding entre filas
    PADDED_COLS = COLS + (CACHE_LINE_SIZE / sizeof(entero))
    matrix: arreglo[NUM_THREADS][PADDED_COLS] de entero
    
    función worker(thread_id: entero) {
        para j = 0 hasta COLS - 1 hacer
            matrix[thread_id][j]++  // Sin false sharing
        fin para
    }
}

// Verificar false sharing en runtime
función detectar_false_sharing() {
    inicio = timestamp()
    
    // Test sin padding
    counters_sin: arreglo[NUM_THREADS] de entero
    para cada thread hacer
        incrementar_contador(counters_sin[thread_id])
    fin para
    
    tiempo_sin = timestamp() - inicio
    
    // Test con padding
    counters_con: arreglo[NUM_THREADS] de PaddedCounter
    para cada thread hacer
        incrementar_contador(counters_con[thread_id].value)
    fin para
    
    tiempo_con = timestamp() - inicio
    
    mejora = (tiempo_sin - tiempo_con) / tiempo_sin * 100
    
    imprimir("Sin padding: " + tiempo_sin + "ms")
    imprimir("Con padding: " + tiempo_con + "ms")
    imprimir("Mejora: " + mejora + "%")
}

// Padding en lenguajes de alto nivel
// Java
clase PaddedCounterJava {
    long p0, p1, p2, p3, p4, p5, p6  // 56 bytes padding
    volatile long value                 // 8 bytes
    long p8, p9, p10, p11, p12, p13, p14  // 56 bytes padding
}

// Rust
#[repr(align(64))]
estructura PaddedCounterRust {
    value: AtomicU64
}

// Consideraciones de memoria
función calcular_overhead_memoria(num_elements: entero, size_elemento: entero) -> flotante {
    sin_padding = num_elements * size_elemento
    con_padding = num_elements * CACHE_LINE_SIZE
    
    overhead = (con_padding - sin_padding) / sin_padding * 100
    
    imprimir("Memoria sin padding: " + sin_padding + " bytes")
    imprimir("Memoria con padding: " + con_padding + " bytes")
    imprimir("Overhead: " + overhead + "%")
    
    return overhead
}

// Ejemplo completo: contador de eventos multi-thread
estructura EventCounters {
    counters: arreglo[MAX_EVENT_TYPES] de PaddedCounter
}

función inicializar_counters() -> EventCounters {
    ec: EventCounters
    
    para i = 0 hasta MAX_EVENT_TYPES - 1 hacer
        ec.counters[i].value = 0
    fin para
    
    return ec
}

función registrar_evento(ec: EventCounters, tipo: entero, thread_id: entero) {
    // Cada tipo de evento en cache line separada
    ec.counters[tipo].value++
    
    // Sin false sharing entre tipos de eventos
}

// Best practices
función mejores_practicas_padding() {
    // 1. Identificar variables compartidas frecuentemente escritas
    // 2. Medir impacto de false sharing primero
    // 3. Aplicar padding solo donde sea necesario
    // 4. Considerar trade-off memoria vs rendimiento
    // 5. Verificar alineación en runtime
    // 6. Documentar uso de padding en código
}`})})]})]}),e.jsxs(ue,{value:"alignment",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/30 to-slate-800/30 p-6 rounded-lg border border-purple-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-300 mb-3",children:"📐 Solución 2: Alignment Directives"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Utiliza directivas del compilador para alinear estructuras a los límites de cache line. Esto garantiza que las estructuras no crucen boundaries de cache lines, mejorando el rendimiento y reduciendo cache line splits."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Alinea datos a boundaries de cache line"}),e.jsx("li",{children:"• Previene cache line splits"}),e.jsx("li",{children:"• Usa atributos del compilador (alignas, __attribute__)"}),e.jsx("li",{children:"• Mejora acceso a memoria"}),e.jsx("li",{children:"• Reduce accesos a múltiples cache lines"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Alignment Directives"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Constantes de alineación
constante CACHE_LINE_SIZE = 64
constante WORD_SIZE = sizeof(puntero)

// SIN ALINEACIÓN (problema de cache line crossing)
estructura DataSinAlinear {
    field1: entero      // offset 0, size 4
    field2: double      // offset 4, size 8
    field3: entero      // offset 12, size 4
    // Total: 16 bytes, puede cruzar cache line
}

función problema_sin_alinear() {
    // Si data está en offset 56:
    // field1: bytes 56-59 (línea 0)
    // field2: bytes 60-67 (cruza a línea 1!)
    // field3: bytes 68-71 (línea 1)
    
    data: DataSinAlinear en offset 56
    
    // Acceso a field2 requiere 2 lecturas de cache
    valor = data.field2  // CACHE LINE SPLIT
}

// CON ALINEACIÓN (solución)
alinear_a(CACHE_LINE_SIZE)
estructura DataAlineada {
    field1: entero
    field2: double
    field3: entero
    // Estructura completa alineada a 64 bytes
}

función solucion_con_alinear() {
    // data siempre empieza en múltiplo de 64
    // Nunca cruza cache line boundary
    
    data: DataAlineada  // offset 0, 64, 128, etc.
    
    // Acceso a field2 en 1 sola lectura
    valor = data.field2  // CACHE HIT
}

// Directivas de alineación en diferentes lenguajes

// C11/C++11
_Alignas(CACHE_LINE_SIZE)
estructura AlignedStructC {
    data: entero
}

// C++11 también
alignas(CACHE_LINE_SIZE)
estructura AlignedStructCpp {
    data: entero
}

// GCC/Clang attribute
estructura AlignedStructGCC {
    data: entero
} __attribute__((aligned(CACHE_LINE_SIZE)))

// MSVC
__declspec(align(CACHE_LINE_SIZE))
estructura AlignedStructMSVC {
    data: entero
}

// Verificar alineación en compilación
static_assert(alignof(AlignedStructC) == CACHE_LINE_SIZE,
              "Estructura no está correctamente alineada")

// Verificar alineación en runtime
función verificar_alineacion(ptr: puntero) -> booleano {
    address = convertir_a_entero(ptr)
    
    si address % CACHE_LINE_SIZE == 0 entonces
        return verdadero
    sino
        return falso
    fin si
}

// Alineación dinámica en heap
función allocar_alineado(size: entero) -> puntero {
    // Asegurar que memoria heap esté alineada
    ptr = aligned_alloc(CACHE_LINE_SIZE, size)
    
    assert(verificar_alineacion(ptr))
    
    return ptr
}

// Alineación de arrays
alinear_a(CACHE_LINE_SIZE)
estructura ArrayAlineado {
    datos: arreglo[100] de entero
}

función usar_array_alineado() {
    arr: ArrayAlineado
    
    // Primer elemento alineado a 64 bytes
    assert(verificar_alineacion(&arr.datos[0]))
}

// Alineación de campos individuales
estructura CamposAlineados {
    alinear_a(CACHE_LINE_SIZE) campo1: entero
    alinear_a(CACHE_LINE_SIZE) campo2: double
    alinear_a(CACHE_LINE_SIZE) campo3: entero
    // Cada campo en cache line separada
}

función calcular_offset_alineado(offset_actual: entero, alineacion: entero) -> entero {
    // Redondear hacia arriba al siguiente múltiplo
    si offset_actual % alineacion == 0 entonces
        return offset_actual
    fin si
    
    return ((offset_actual / alineacion) + 1) * alineacion
}

// Ejemplo: struct con múltiples campos
estructura MultiCampo {
    char c           // offset 0, size 1
    // padding: 7 bytes
    long l           // offset 8, size 8 (alineado a 8)
    int i            // offset 16, size 4
    // padding: 4 bytes (para alinear struct a 8)
    // Total: 24 bytes
}

// Forzar alineación a cache line
alinear_a(CACHE_LINE_SIZE)
estructura MultiCampoAlineado {
    char c
    long l
    int i
    // padding hasta 64 bytes
}

// Alineación para SIMD
alinear_a(16)  // SSE requiere alineación de 16 bytes
estructura DatosSIMD {
    datos: arreglo[4] de flotante
}

alinear_a(32)  // AVX requiere alineación de 32 bytes
estructura DatosAVX {
    datos: arreglo[8] de flotante
}

// Alineación condicional según arquitectura
#si ARQUITECTURA == X86_64 entonces
    constante ALINEACION_OPTIMA = 64
#sino_si ARQUITECTURA == ARM entonces
    constante ALINEACION_OPTIMA = 128
#sino
    constante ALINEACION_OPTIMA = 32
#fin si

alinear_a(ALINEACION_OPTIMA)
estructura DatosArquitectura {
    data: entero
}

// Alineación de stack
función funcion_con_stack_alineado() {
    // Forzar alineación de variables locales
    alinear_a(CACHE_LINE_SIZE) buffer: arreglo[256] de byte
    
    assert(verificar_alineacion(&buffer))
}

// Macro para facilitar uso
macro CACHE_ALIGNED_TYPE(tipo)
    alignas(CACHE_LINE_SIZE) tipo

// Uso
tipo AlignedInt = CACHE_ALIGNED_TYPE(entero)
tipo AlignedDouble = CACHE_ALIGNED_TYPE(double)

// Pool de objetos alineados
estructura PoolAlineado<T> {
    alinear_a(CACHE_LINE_SIZE) objetos: arreglo[MAX_OBJETOS] de T
}

función crear_pool<T>() -> PoolAlineado<T> {
    pool: PoolAlineado<T>
    
    // Verificar que cada objeto está alineado
    para i = 0 hasta MAX_OBJETOS - 1 hacer
        assert(verificar_alineacion(&pool.objetos[i]))
    fin para
    
    return pool
}

// Alineación para DMA
// Hardware DMA puede requerir alineación específica
alinear_a(4096)  // Alineación de página
estructura BufferDMA {
    datos: arreglo[4096] de byte
}

función preparar_buffer_dma() -> BufferDMA* {
    buffer = allocar_alineado(sizeof(BufferDMA))
    
    // Verificar alineación de página
    assert((convertir_a_entero(buffer) % 4096) == 0)
    
    return buffer
}

// Detección de alineación en compilación
template<typename T>
función verificar_alineacion_tipo() {
    imprimir("Tipo: " + nombre_de_tipo(T))
    imprimir("Tamaño: " + sizeof(T))
    imprimir("Alineación: " + alignof(T))
    imprimir("Alineado a cache line: " + 
             (alignof(T) == CACHE_LINE_SIZE))
}

// Análisis de layout de estructura
función analizar_layout() {
    imprimir("DataSinAlinear:")
    imprimir("  field1 offset: " + offsetof(DataSinAlinear, field1))
    imprimir("  field2 offset: " + offsetof(DataSinAlinear, field2))
    imprimir("  field3 offset: " + offsetof(DataSinAlinear, field3))
    imprimir("  Tamaño total: " + sizeof(DataSinAlinear))
    
    imprimir("DataAlineada:")
    imprimir("  field1 offset: " + offsetof(DataAlineada, field1))
    imprimir("  field2 offset: " + offsetof(DataAlineada, field2))
    imprimir("  field3 offset: " + offsetof(DataAlineada, field3))
    imprimir("  Tamaño total: " + sizeof(DataAlineada))
}

// Benchmark de alineación
función benchmark_alineacion() {
    iteraciones = 10000000
    
    // Test sin alineación
    data_sin: arreglo[100] de DataSinAlinear
    inicio = timestamp()
    
    para i = 1 hasta iteraciones hacer
        suma = 0
        para j = 0 hasta 99 hacer
            suma += data_sin[j].field2
        fin para
    fin para
    
    tiempo_sin = timestamp() - inicio
    
    // Test con alineación
    data_con: arreglo[100] de DataAlineada
    inicio = timestamp()
    
    para i = 1 hasta iteraciones hacer
        suma = 0
        para j = 0 hasta 99 hacer
            suma += data_con[j].field2
        fin para
    fin para
    
    tiempo_con = timestamp() - inicio
    
    imprimir("Sin alineación: " + tiempo_sin + "ms")
    imprimir("Con alineación: " + tiempo_con + "ms")
    imprimir("Mejora: " + ((tiempo_sin - tiempo_con) / tiempo_sin * 100) + "%")
}

// Consideraciones de portable
función obtener_alineacion_cache_line() -> entero {
    // Diferentes arquitecturas tienen diferentes tamaños
    // x86/x64: típicamente 64 bytes
    // ARM: puede ser 32, 64 o 128 bytes
    // PowerPC: típicamente 128 bytes
    
    #si ARQUITECTURA_CONOCIDA entonces
        return CACHE_LINE_SIZE_CONOCIDO
    #sino
        // Valor conservador
        return 64
    #fin si
}

// Union para forzar alineación
union AlineacionForzada {
    data: tipo_a_alinear
    padding: arreglo[CACHE_LINE_SIZE] de byte
}

// Best practices
función mejores_practicas_alineacion() {
    // 1. Usar alignas/alignof estándar cuando sea posible
    // 2. Verificar alineación con static_assert
    // 3. Considerar requisitos de diferentes plataformas
    // 4. Documentar por qué se usa alineación específica
    // 5. Medir impacto real en rendimiento
    // 6. Considerar trade-off memoria vs rendimiento
}`})})]})]}),e.jsxs(ue,{value:"threadlocal",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-900/30 to-slate-800/30 p-6 rounded-lg border border-green-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-green-300 mb-3",children:"🧵 Solución 3: Thread-Local Accumulators"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Cada thread mantiene su propio acumulador local para operaciones de reducción. Al finalizar, se combinan todos los acumuladores locales en un resultado global. Esto elimina la contención y false sharing durante la acumulación."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Cada thread tiene acumulador privado"}),e.jsx("li",{children:"• Sin contención durante acumulación"}),e.jsx("li",{children:"• Merge final de resultados"}),e.jsx("li",{children:"• Ideal para operaciones de reducción"}),e.jsx("li",{children:"• Excelente escalabilidad"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Thread-Local Accumulators"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// PROBLEMA: Contador compartido (false sharing)
variable global counter_compartido: entero = 0
variable global lock: Mutex

función worker_compartido(id: entero, iteraciones: entero) {
    para i = 1 hasta iteraciones hacer
        adquirir(lock)
        counter_compartido++  // CONTENCIÓN!
        liberar(lock)
    fin para
    // Alto overhead de sincronización
}

función ejecutar_compartido(num_threads: entero) {
    threads: arreglo[num_threads] de Thread
    
    para i = 0 hasta num_threads - 1 hacer
        threads[i] = crear_thread(worker_compartido, i, 1000000)
    fin para
    
    para i = 0 hasta num_threads - 1 hacer
        esperar(threads[i])
    fin para
    
    imprimir("Resultado: " + counter_compartido)
}

// SOLUCIÓN 1: Array de contadores thread-local
estructura PaddedCounter {
    value: entero
    padding: arreglo[60] de byte  // Padding a 64 bytes
}

variable global counters_locales: arreglo[MAX_THREADS] de PaddedCounter

función worker_thread_local(id: entero, iteraciones: entero) {
    // Cada thread escribe SOLO en su contador
    para i = 1 hasta iteraciones hacer
        counters_locales[id].value++  // Sin lock, sin contención
    fin para
}

función ejecutar_thread_local(num_threads: entero) -> entero {
    threads: arreglo[num_threads] de Thread
    
    // Inicializar contadores
    para i = 0 hasta num_threads - 1 hacer
        counters_locales[i].value = 0
    fin para
    
    // Ejecutar threads
    para i = 0 hasta num_threads - 1 hacer
        threads[i] = crear_thread(worker_thread_local, i, 1000000)
    fin para
    
    para i = 0 hasta num_threads - 1 hacer
        esperar(threads[i])
    fin para
    
    // Merge final (1 sola vez, sin contención)
    total = 0
    para i = 0 hasta num_threads - 1 hacer
        total += counters_locales[i].value
    fin para
    
    return total
}

// SOLUCIÓN 2: Thread-Local Storage (TLS)
thread_local variable counter_tls: entero

función worker_tls(iteraciones: entero) {
    // Cada thread tiene su propia copia de counter_tls
    counter_tls = 0
    
    para i = 1 hasta iteraciones hacer
        counter_tls++  // Variable privada del thread
    fin para
}

función ejecutar_tls(num_threads: entero) -> entero {
    threads: arreglo[num_threads] de Thread
    resultados: arreglo[num_threads] de entero
    
    para i = 0 hasta num_threads - 1 hacer
        threads[i] = crear_thread(worker_tls, 1000000)
    fin para
    
    para i = 0 hasta num_threads - 1 hacer
        esperar(threads[i])
        // Obtener resultado de TLS de cada thread
        resultados[i] = obtener_tls_de_thread(threads[i], counter_tls)
    fin para
    
    // Combinar resultados
    total = 0
    para i = 0 hasta num_threads - 1 hacer
        total += resultados[i]
    fin para
    
    return total
}

// SOLUCIÓN 3: Acumuladores para operaciones complejas
estructura Acumulador {
    sum: double
    count: entero
    min: double
    max: double
    padding: arreglo[32] de byte  // Padding
}

variable global acumuladores: arreglo[MAX_THREADS] de Acumulador

función procesar_datos_local(id: entero, datos: arreglo de double) {
    // Inicializar acumulador local
    local_acc: Acumulador
    local_acc.sum = 0
    local_acc.count = 0
    local_acc.min = INFINITO
    local_acc.max = -INFINITO
    
    // Procesar datos sin contención
    para cada valor en datos hacer
        local_acc.sum += valor
        local_acc.count++
        
        si valor < local_acc.min entonces
            local_acc.min = valor
        fin si
        
        si valor > local_acc.max entonces
            local_acc.max = valor
        fin si
    fin para
    
    // Guardar resultado local
    acumuladores[id] = local_acc
}

función merge_acumuladores(num_threads: entero) -> Acumulador {
    resultado: Acumulador
    resultado.sum = 0
    resultado.count = 0
    resultado.min = INFINITO
    resultado.max = -INFINITO
    
    // Combinar acumuladores locales
    para i = 0 hasta num_threads - 1 hacer
        resultado.sum += acumuladores[i].sum
        resultado.count += acumuladores[i].count
        
        si acumuladores[i].min < resultado.min entonces
            resultado.min = acumuladores[i].min
        fin si
        
        si acumuladores[i].max > resultado.max entonces
            resultado.max = acumuladores[i].max
        fin si
    fin para
    
    return resultado
}

// SOLUCIÓN 4: Reduction pattern
función parallel_sum(datos: arreglo de entero, num_threads: entero) -> entero {
    // Dividir datos entre threads
    chunk_size = tamaño(datos) / num_threads
    
    // Acumuladores locales
    sumas_locales: arreglo[num_threads] de entero
    
    función worker_sum(id: entero) {
        inicio = id * chunk_size
        fin = min((id + 1) * chunk_size, tamaño(datos))
        
        suma_local = 0
        para i = inicio hasta fin - 1 hacer
            suma_local += datos[i]
        fin para
        
        sumas_locales[id] = suma_local
    }
    
    // Ejecutar workers
    threads: arreglo[num_threads] de Thread
    para i = 0 hasta num_threads - 1 hacer
        threads[i] = crear_thread(worker_sum, i)
    fin para
    
    para i = 0 hasta num_threads - 1 hacer
        esperar(threads[i])
    fin para
    
    // Reduction final
    suma_total = 0
    para i = 0 hasta num_threads - 1 hacer
        suma_total += sumas_locales[i]
    fin para
    
    return suma_total
}

// Template genérico para reduction
template<T, Op>
función parallel_reduce(datos: arreglo de T, 
                        operacion: Op,
                        valor_inicial: T,
                        num_threads: entero) -> T {
    
    resultados: arreglo[num_threads] de T
    chunk_size = tamaño(datos) / num_threads
    
    función worker_reduce(id: entero) {
        inicio = id * chunk_size
        fin = min((id + 1) * chunk_size, tamaño(datos))
        
        resultado_local = valor_inicial
        para i = inicio hasta fin - 1 hacer
            resultado_local = operacion(resultado_local, datos[i])
        fin para
        
        resultados[id] = resultado_local
    }
    
    // Ejecutar workers
    threads: arreglo[num_threads] de Thread
    para i = 0 hasta num_threads - 1 hacer
        threads[i] = crear_thread(worker_reduce, i)
    fin para
    
    para i = 0 hasta num_threads - 1 hacer
        esperar(threads[i])
    fin para
    
    // Combinar resultados
    resultado_final = valor_inicial
    para i = 0 hasta num_threads - 1 hacer
        resultado_final = operacion(resultado_final, resultados[i])
    fin para
    
    return resultado_final
}

// Uso de parallel_reduce
función ejemplos_reduce() {
    datos: arreglo[1000000] de entero
    
    // Sum
    suma = parallel_reduce(datos, 
                          lambda (a, b) -> a + b,
                          0, 
                          8)
    
    // Max
    maximo = parallel_reduce(datos,
                            lambda (a, b) -> max(a, b),
                            -INFINITO,
                            8)
    
    // Producto
    producto = parallel_reduce(datos,
                              lambda (a, b) -> a * b,
                              1,
                              8)
}

// Thread-local con cleanup automático
clase ThreadLocalAccumulator<T> {
    thread_local acumulador: T
    global lista_acumuladores: Lista<T*>
    global lock: Mutex
    
    función get() -> T* {
        si acumulador no inicializado entonces
            acumulador = crear_nuevo()
            
            adquirir(lock)
            lista_acumuladores.agregar(&acumulador)
            liberar(lock)
        fin si
        
        return &acumulador
    }
    
    función merge_all() -> T {
        resultado = valor_inicial()
        
        adquirir(lock)
        para cada acc en lista_acumuladores hacer
            resultado = combinar(resultado, *acc)
        fin para
        liberar(lock)
        
        return resultado
    }
}

// Uso de ThreadLocalAccumulator
función ejemplo_thread_local_accumulator() {
    accumulator: ThreadLocalAccumulator<entero>
    
    función worker() {
        local_sum = accumulator.get()
        
        para i = 1 hasta 1000000 hacer
            *local_sum += 1
        fin para
    }
    
    // Ejecutar workers
    threads: arreglo[8] de Thread
    para i = 0 hasta 7 hacer
        threads[i] = crear_thread(worker)
    fin para
    
    para i = 0 hasta 7 hacer
        esperar(threads[i])
    fin para
    
    // Obtener resultado final
    total = accumulator.merge_all()
    imprimir("Total: " + total)
}

// Benchmark
función benchmark_acumuladores() {
    iteraciones = 10000000
    num_threads = 8
    
    // Método 1: Compartido con lock
    inicio = timestamp()
    ejecutar_compartido(num_threads)
    tiempo_compartido = timestamp() - inicio
    
    // Método 2: Thread-local
    inicio = timestamp()
    ejecutar_thread_local(num_threads)
    tiempo_local = timestamp() - inicio
    
    imprimir("Compartido (con lock): " + tiempo_compartido + "ms")
    imprimir("Thread-local: " + tiempo_local + "ms")
    imprimir("Speedup: " + (tiempo_compartido / tiempo_local) + "x")
}

// Best practices
función mejores_practicas_thread_local() {
    // 1. Usar para operaciones de reducción/agregación
    // 2. Minimizar overhead de merge final
    // 3. Considerar número de threads vs overhead
    // 4. Usar padding para evitar false sharing
    // 5. Cleanup adecuado de recursos thread-local
}`})})]})]}),e.jsxs(ue,{value:"reorganization",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-orange-900/30 to-slate-800/30 p-6 rounded-lg border border-orange-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-orange-300 mb-3",children:"🔄 Solución 4: Structure Reorganization"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Reorganiza los campos de las estructuras agrupando aquellos con patrones de acceso similares. Separa campos read-only de read-write, y campos accedidos por diferentes threads para minimizar false sharing."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Agrupa campos por patrón de acceso"}),e.jsx("li",{children:"• Separa read-only de read-write"}),e.jsx("li",{children:"• Minimiza cache line sharing"}),e.jsx("li",{children:"• Mejora localidad de datos"}),e.jsx("li",{children:"• Sin overhead de runtime"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Structure Reorganization"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// PROBLEMA: Mala organización de estructura
estructura MalaOrganizacion {
    // Campos mezclados sin considerar patrones de acceso
    read_only_config: entero        // Leído frecuentemente
    write_counter1: entero          // Escrito por Thread 1
    read_only_name: cadena          // Leído frecuentemente
    write_counter2: entero          // Escrito por Thread 2
    shared_state: entero            // Leído/escrito por todos
    write_timestamp: entero         // Escrito por Thread 1
    read_only_id: entero            // Leído frecuentemente
    // FALSE SHARING: campos write mezclados con read-only
}

función problema_mala_organizacion() {
    data: MalaOrganizacion
    
    // Thread 1 lee read_only_config
    thread1_lee(data.read_only_config)
    
    // Thread 2 escribe write_counter2
    // → Invalida cache de Thread 1!
    thread2_escribe(data.write_counter2)
}

// SOLUCIÓN: Reorganización por patrón de acceso
estructura BuenaOrganizacion {
    // Grupo 1: Campos read-only (cache line 0)
    read_only_config: entero
    read_only_name: cadena
    read_only_id: entero
    padding1: arreglo[40] de byte  // Padding a 64 bytes
    
    // Grupo 2: Campos escritos por Thread 1 (cache line 1)
    write_counter1: entero
    write_timestamp: entero
    padding2: arreglo[52] de byte  // Padding a 64 bytes
    
    // Grupo 3: Campos escritos por Thread 2 (cache line 2)
    write_counter2: entero
    padding3: arreglo[60] de byte  // Padding a 64 bytes
    
    // Grupo 4: Estado compartido (cache line 3)
    shared_state: entero
    shared_lock: Mutex
    padding4: arreglo[44] de byte  // Padding a 64 bytes
}

función solucion_buena_organizacion() {
    data: BuenaOrganizacion
    
    // Thread 1 lee read_only_config
    thread1_lee(data.read_only_config)
    
    // Thread 2 escribe write_counter2
    // → NO invalida cache de Thread 1 (cache lines diferentes)
    thread2_escribe(data.write_counter2)
}

// Análisis de patrones de acceso
estructura PatronAcceso {
    nombre_campo: cadena
    lecturas: entero
    escrituras: entero
    threads_lectores: conjunto de entero
    threads_escritores: conjunto de entero
    frecuencia: double
}

función analizar_patrones(estructura: TipoEstructura) -> arreglo de PatronAcceso {
    patrones: Lista de PatronAcceso
    
    para cada campo en estructura hacer
        patron: PatronAcceso
        patron.nombre_campo = campo.nombre
        patron.lecturas = contar_lecturas(campo)
        patron.escrituras = contar_escrituras(campo)
        patron.threads_lectores = identificar_lectores(campo)
        patron.threads_escritores = identificar_escritores(campo)
        patron.frecuencia = calcular_frecuencia_acceso(campo)
        
        patrones.agregar(patron)
    fin para
    
    return patrones
}

función clasificar_campo(patron: PatronAcceso) -> cadena {
    si patron.escrituras == 0 entonces
        return "READ_ONLY"
    sino_si patron.lecturas > patron.escrituras * 10 entonces
        return "READ_MOSTLY"
    sino_si tamaño(patron.threads_escritores) == 1 entonces
        return "SINGLE_WRITER"
    sino
        return "SHARED_WRITE"
    fin si
}

función reorganizar_estructura(patrones: arreglo de PatronAcceso) -> EstructuraOptimizada {
    // Agrupar por clasificación
    read_only: Lista de Campo
    read_mostly: Lista de Campo
    single_writers: Mapa de entero a Lista de Campo  // thread_id -> campos
    shared: Lista de Campo
    
    para cada patron en patrones hacer
        clasificacion = clasificar_campo(patron)
        
        si clasificacion == "READ_ONLY" entonces
            read_only.agregar(patron.nombre_campo)
        sino_si clasificacion == "READ_MOSTLY" entonces
            read_mostly.agregar(patron.nombre_campo)
        sino_si clasificacion == "SINGLE_WRITER" entonces
            writer_id = patron.threads_escritores.primero()
            single_writers[writer_id].agregar(patron.nombre_campo)
        sino
            shared.agregar(patron.nombre_campo)
        fin si
    fin para
    
    // Construir estructura reorganizada
    estructura_nueva: EstructuraOptimizada
    
    // Cache line 0: Read-only
    para cada campo en read_only hacer
        estructura_nueva.agregar(campo)
    fin para
    estructura_nueva.agregar_padding(CACHE_LINE_SIZE)
    
    // Cache lines siguientes: Read-mostly
    para cada campo en read_mostly hacer
        estructura_nueva.agregar(campo)
    fin para
    estructura_nueva.agregar_padding(CACHE_LINE_SIZE)
    
    // Cache lines para cada writer
    para cada (thread_id, campos) en single_writers hacer
        para cada campo en campos hacer
            estructura_nueva.agregar(campo)
        fin para
        estructura_nueva.agregar_padding(CACHE_LINE_SIZE)
    fin para
    
    // Última cache line: Shared
    para cada campo en shared hacer
        estructura_nueva.agregar(campo)
    fin para
    estructura_nueva.agregar_padding(CACHE_LINE_SIZE)
    
    return estructura_nueva
}

// Ejemplo: Estructura de red (network packet)
// ANTES (mala organización)
estructura NetworkPacketBad {
    header_length: entero      // Read-only
    packet_counter: entero     // Write (por procesador)
    protocol_type: entero      // Read-only
    checksum: entero          // Write (por procesador)
    source_ip: entero         // Read-only
    processing_time: entero   // Write (por procesador)
    dest_ip: entero          // Read-only
    // False sharing entre read-only y write
}

// DESPUÉS (buena organización)
estructura NetworkPacketGood {
    // Grupo 1: Header read-only (64 bytes)
    header_length: entero
    protocol_type: entero
    source_ip: entero
    dest_ip: entero
    // ... otros campos read-only
    padding1: arreglo[36] de byte
    
    // Grupo 2: Metadata de procesamiento (64 bytes)
    packet_counter: entero
    checksum: entero
    processing_time: entero
    // ... otros campos de procesamiento
    padding2: arreglo[52] de byte
}

// Ejemplo: Contador de estadísticas multi-thread
// ANTES
estructura StatsBad {
    total_requests: AtomicInt      // Todos los threads
    success_count: AtomicInt       // Thread 1
    error_count: AtomicInt         // Thread 2
    timeout_count: AtomicInt       // Thread 3
    // Todos en misma cache line → false sharing
}

// DESPUÉS
estructura StatsGood {
    // Cada contador en cache line separada
    alinear_a(64) total_requests: AtomicInt
    padding1: arreglo[60] de byte
    
    alinear_a(64) success_count: AtomicInt
    padding2: arreglo[60] de byte
    
    alinear_a(64) error_count: AtomicInt
    padding3: arreglo[60] de byte
    
    alinear_a(64) timeout_count: AtomicInt
    padding4: arreglo[60] de byte
}

// Alternativa: Array de structs separados
estructura PerThreadStats {
    success_count: AtomicInt
    error_count: AtomicInt
    timeout_count: AtomicInt
    padding: arreglo[52] de byte
}

estructura StatsArray {
    per_thread: arreglo[MAX_THREADS] de PerThreadStats
    total: AtomicInt
}

// Reorganización para hot/cold data
estructura DataHotCold {
    // HOT: Datos accedidos frecuentemente (cache line 0)
    hot_counter: entero
    hot_timestamp: entero
    hot_flags: entero
    padding1: arreglo[52] de byte
    
    // COLD: Datos accedidos raramente (cache lines siguientes)
    config_string: cadena
    debug_info: cadena
    creation_time: entero
    // No necesita padding
}

// Reorganización para secuencia de acceso
estructura SequentialAccess {
    // Campos accedidos en secuencia (juntos en cache line)
    step1_input: entero
    step1_output: entero
    step2_input: entero
    step2_output: entero
    // Aprovecha prefetching de CPU
}

// Tool para detectar oportunidades de reorganización
función detectar_oportunidades_reorganizacion(estructura: Tipo) {
    patrones = analizar_patrones(estructura)
    problemas: Lista de cadena
    
    // Detectar campos read-only mezclados con write
    para i = 0 hasta tamaño(patrones) - 2 hacer
        si clasificar_campo(patrones[i]) == "READ_ONLY" y
           clasificar_campo(patrones[i+1]) == "SINGLE_WRITER" entonces
            problemas.agregar("Campos read-only y write adyacentes: " +
                            patrones[i].nombre_campo + ", " +
                            patrones[i+1].nombre_campo)
        fin si
    fin para
    
    // Detectar campos escritos por diferentes threads adyacentes
    para i = 0 hasta tamaño(patrones) - 2 hacer
        si tamaño(interseccion(patrones[i].threads_escritores,
                              patrones[i+1].threads_escritores)) == 0 entonces
            problemas.agregar("Campos escritos por threads diferentes adyacentes: " +
                            patrones[i].nombre_campo + ", " +
                            patrones[i+1].nombre_campo)
        fin si
    fin para
    
    return problemas
}

// Benchmark antes/después de reorganización
función benchmark_reorganizacion() {
    // Crear instancias
    bad: MalaOrganizacion
    good: BuenaOrganizacion
    
    // Test con mala organización
    inicio = timestamp()
    parallel_access_bad(bad, NUM_THREADS)
    tiempo_bad = timestamp() - inicio
    
    // Test con buena organización
    inicio = timestamp()
    parallel_access_good(good, NUM_THREADS)
    tiempo_good = timestamp() - inicio
    
    imprimir("Mala organización: " + tiempo_bad + "ms")
    imprimir("Buena organización: " + tiempo_good + "ms")
    imprimir("Mejora: " + ((tiempo_bad - tiempo_good) / tiempo_bad * 100) + "%")
}

// Best practices
función mejores_practicas_reorganizacion() {
    // 1. Perfilar acceso real antes de reorganizar
    // 2. Agrupar campos por patrón de acceso
    // 3. Separar read-only de read-write
    // 4. Considerar secuencia de acceso
    // 5. Usar padding entre grupos de diferentes threads
    // 6. Balancear organización lógica vs rendimiento
    // 7. Documentar decisiones de organización
}`})})]})]}),e.jsxs(ue,{value:"cacheaware",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-red-900/30 to-slate-800/30 p-6 rounded-lg border border-red-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-red-300 mb-3",children:"💾 Solución 5: Cache-Aware Data Structures"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Diseña estructuras de datos considerando la jerarquía de cache desde el inicio. Utiliza layouts como Structure of Arrays (SoA) en lugar de Array of Structures (AoS) cuando se accede a campos específicos, mejorando la localidad espacial."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Diseño considerando cache desde inicio"}),e.jsx("li",{children:"• SoA vs AoS según patrón de acceso"}),e.jsx("li",{children:"• Mejora localidad espacial"}),e.jsx("li",{children:"• Reduce cache misses"}),e.jsx("li",{children:"• Aprovecha prefetching de hardware"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Cache-Aware Data Structures"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// PATRÓN 1: Array of Structures (AoS) vs Structure of Arrays (SoA)

// AoS: Estructura tradicional
estructura Particula {
    x: flotante
    y: flotante
    z: flotante
    vx: flotante
    vy: flotante
    vz: flotante
}

variable particulas_aos: arreglo[N] de Particula

función actualizar_posiciones_aos() {
    // Acceso a campo x de todas las partículas
    para i = 0 hasta N - 1 hacer
        particulas_aos[i].x += particulas_aos[i].vx
        // Carga struct completo (24 bytes)
        // Solo usa x (4 bytes) → desperdicio
    fin para
}

// SoA: Estructura optimizada para cache
estructura ParticlesSystem {
    x: arreglo[N] de flotante
    y: arreglo[N] de flotante
    z: arreglo[N] de flotante
    vx: arreglo[N] de flotante
    vy: arreglo[N] de flotante
    vz: arreglo[N] de flotante
}

variable particulas_soa: ParticlesSystem

función actualizar_posiciones_soa() {
    // Acceso contiguo a x[]
    para i = 0 hasta N - 1 hacer
        particulas_soa.x[i] += particulas_soa.vx[i]
        // Carga solo arrays de x y vx
        // Mejor localidad espacial
        // Prefetching más efectivo
    fin para
}

// Comparación de cache behavior
función analizar_cache_behavior() {
    cache_line_size = 64  // bytes
    float_size = 4        // bytes
    
    // AoS
    elementos_por_linea_aos = cache_line_size / sizeof(Particula)
    // 64 / 24 = 2.6 → ~2 partículas por cache line
    
    // SoA
    elementos_por_linea_soa = cache_line_size / float_size
    // 64 / 4 = 16 flotantes por cache line
    
    imprimir("AoS: " + elementos_por_linea_aos + " partículas/línea")
    imprimir("SoA: " + elementos_por_linea_soa + " elementos/línea")
    imprimir("SoA es " + (elementos_por_linea_soa / elementos_por_linea_aos) + "x más eficiente")
}

// Híbrido: AoSoA (Array of Structures of Arrays)
constante SOA_BLOCK_SIZE = 16  // Múltiplo de cache line

estructura ParticleBlock {
    x: arreglo[SOA_BLOCK_SIZE] de flotante
    y: arreglo[SOA_BLOCK_SIZE] de flotante
    z: arreglo[SOA_BLOCK_SIZE] de flotante
    vx: arreglo[SOA_BLOCK_SIZE] de flotante
    vy: arreglo[SOA_BLOCK_SIZE] de flotante
    vz: arreglo[SOA_BLOCK_SIZE] de flotante
}

variable particulas_aosoa: arreglo[N / SOA_BLOCK_SIZE] de ParticleBlock

función actualizar_posiciones_aosoa() {
    num_bloques = N / SOA_BLOCK_SIZE
    
    para bloque = 0 hasta num_bloques - 1 hacer
        // Procesar bloque completo (buena localidad)
        para i = 0 hasta SOA_BLOCK_SIZE - 1 hacer
            particulas_aosoa[bloque].x[i] += particulas_aosoa[bloque].vx[i]
        fin para
    fin para
}

// PATRÓN 2: Cache-Oblivious Data Structures

// B-Tree tradicional (malo para cache)
estructura NodoBTreeMalo {
    keys: arreglo[B] de entero
    children: arreglo[B+1] de puntero a NodoBTreeMalo
    // Nodos dispersos en memoria → cache misses
}

// B+ Tree cache-aware
constante NODO_SIZE = 64  // Tamaño de cache line

estructura NodoBPlusTree {
    keys: arreglo[(NODO_SIZE - 8) / 4] de entero  // Llenar cache line
    next: puntero a NodoBPlusTree
    // Nodo cabe exactamente en 1 cache line
}

// Cache-Oblivious B-Tree (van Emde Boas layout)
función veb_layout(arbol: BTree, inicio: entero, fin: entero, salida: arreglo) {
    si fin - inicio <= 1 entonces
        salida.agregar(arbol[inicio])
        return
    fin si
    
    medio = (inicio + fin) / 2
    
    // Recursivamente dividir en mitades
    veb_layout(arbol, inicio, medio, salida)
    salida.agregar(arbol[medio])
    veb_layout(arbol, medio + 1, fin, salida)
    
    // Layout optimiza acceso en todos los niveles de cache
}

// PATRÓN 3: Hash Table cache-friendly

// Hash Table tradicional (malo)
estructura HashNodeMalo {
    key: entero
    value: entero
    next: puntero a HashNodeMalo
    // Listas encadenadas → malas para cache
}

// Open Addressing cache-friendly
estructura HashTableCacheFriendly {
    // Todos los datos en array contiguo
    entries: arreglo[SIZE] de struct {
        key: entero
        value: entero
        occupied: booleano
        padding: arreglo[3] de byte
    }
}

función buscar_cache_friendly(table: HashTableCacheFriendly, key: entero) -> entero {
    hash = hash_function(key)
    indice = hash % SIZE
    
    // Linear probing aprovecha prefetching
    mientras table.entries[indice].occupied hacer
        si table.entries[indice].key == key entonces
            return table.entries[indice].value
        fin si
        indice = (indice + 1) % SIZE
    fin mientras
    
    return NOT_FOUND
}

// PATRÓN 4: Blocked Algorithms

// Multiplicación de matrices naive (malo para cache)
función matrix_mult_naive(A: matriz[N][N], B: matriz[N][N]) -> matriz[N][N] {
    C: matriz[N][N]
    
    para i = 0 hasta N - 1 hacer
        para j = 0 hasta N - 1 hacer
            suma = 0
            para k = 0 hasta N - 1 hacer
                suma += A[i][k] * B[k][j]
                // B accedido por columnas → cache misses
            fin para
            C[i][j] = suma
        fin para
    fin para
    
    return C
}

// Blocked matrix multiplication (cache-aware)
constante BLOCK_SIZE = 64  // Ajustar a tamaño de cache L1

función matrix_mult_blocked(A: matriz[N][N], B: matriz[N][N]) -> matriz[N][N] {
    C: matriz[N][N] = 0
    
    // Dividir en bloques que caben en cache
    para ii = 0 hasta N - 1 step BLOCK_SIZE hacer
        para jj = 0 hasta N - 1 step BLOCK_SIZE hacer
            para kk = 0 hasta N - 1 step BLOCK_SIZE hacer
                
                // Procesar bloque
                para i = ii hasta min(ii + BLOCK_SIZE, N) - 1 hacer
                    para j = jj hasta min(jj + BLOCK_SIZE, N) - 1 hacer
                        suma = C[i][j]
                        para k = kk hasta min(kk + BLOCK_SIZE, N) - 1 hacer
                            suma += A[i][k] * B[k][j]
                        fin para
                        C[i][j] = suma
                    fin para
                fin para
                
            fin para
        fin para
    fin para
    
    return C
}

// PATRÓN 5: Spatial Data Structures

// Quadtree cache-aware
estructura QuadtreeNode {
    // Almacenar nodos hijos inline (no punteros)
    children: arreglo[4] de QuadtreeNode
    // Nodos contiguos → mejor localidad
    
    data: arreglo[MAX_ITEMS_PER_NODE] de Item
    num_items: entero
}

// Z-order curve (Morton code) para ordenamiento espacial
función morton_encode(x: entero, y: entero) -> entero {
    // Intercalar bits de x e y
    código = 0
    
    para i = 0 hasta 15 hacer
        código |= ((x & (1 << i)) << i) | ((y & (1 << i)) << (i + 1))
    fin para
    
    return código
}

función ordenar_puntos_espacialmente(puntos: arreglo de Punto) {
    // Ordenar por Morton code
    para cada p en puntos hacer
        p.morton = morton_encode(p.x, p.y)
    fin para
    
    ordenar(puntos, lambda (a, b) -> a.morton < b.morton)
    
    // Puntos cercanos espacialmente → cercanos en memoria
}

// PATRÓN 6: Prefetch-Friendly Linked Lists

// Lista enlazada tradicional (malo)
estructura NodoListaMalo {
    data: entero
    next: puntero a NodoListaMalo
    // Nodos dispersos → no se puede prefetch
}

// Array-based linked list (cache-friendly)
estructura ListaArrayBased {
    data: arreglo[SIZE] de entero
    next: arreglo[SIZE] de entero  // Índices en lugar de punteros
    head: entero
}

función iterar_lista_array(lista: ListaArrayBased) {
    actual = lista.head
    
    mientras actual != -1 hacer
        procesar(lista.data[actual])
        
        // Prefetch siguiente nodo
        siguiente = lista.next[actual]
        si siguiente != -1 entonces
            __builtin_prefetch(&lista.data[siguiente])
        fin si
        
        actual = siguiente
    fin mientras
}

// PATRÓN 7: Cache-Partitioning Data Structures

// Estructura con hot/cold separation
estructura CachePartitionedStruct {
    // Hot data (cache line 0)
    alinear_a(64) hot_counter: AtomicInt
    hot_timestamp: entero
    hot_flags: entero
    padding1: arreglo[52] de byte
    
    // Warm data (cache line 1)
    alinear_a(64) warm_config: entero
    warm_stats: arreglo[14] de entero
    padding2: arreglo[4] de byte
    
    // Cold data (no padding necesario)
    cold_debug_info: cadena
    cold_creation_time: entero
}

// Benchmark AoS vs SoA
función benchmark_aos_vs_soa(N: entero) {
    // Setup AoS
    aos: arreglo[N] de Particula
    para i = 0 hasta N - 1 hacer
        aos[i] = inicializar_particula()
    fin para
    
    // Setup SoA
    soa: ParticlesSystem
    para i = 0 hasta N - 1 hacer
        soa.x[i] = valor_inicial_x()
        soa.vx[i] = valor_inicial_vx()
    fin para
    
    iteraciones = 1000
    
    // Benchmark AoS
    inicio = timestamp()
    para iter = 1 hasta iteraciones hacer
        para i = 0 hasta N - 1 hacer
            aos[i].x += aos[i].vx
        fin para
    fin para
    tiempo_aos = timestamp() - inicio
    
    // Benchmark SoA
    inicio = timestamp()
    para iter = 1 hasta iteraciones hacer
        para i = 0 hasta N - 1 hacer
            soa.x[i] += soa.vx[i]
        fin para
    fin para
    tiempo_soa = timestamp() - inicio
    
    imprimir("AoS: " + tiempo_aos + "ms")
    imprimir("SoA: " + tiempo_soa + "ms")
    imprimir("Speedup SoA: " + (tiempo_aos / tiempo_soa) + "x")
}

// Herramienta para elegir layout
función elegir_layout(patrón_acceso: cadena) -> cadena {
    si patrón_acceso == "TODOS_LOS_CAMPOS" entonces
        return "AoS"  // Acceso a struct completo
    sino_si patrón_acceso == "CAMPOS_INDIVIDUALES" entonces
        return "SoA"  // Acceso por columnas
    sino_si patrón_acceso == "MIXTO" entonces
        return "AoSoA"  // Híbrido
    fin si
}

// Best practices
función mejores_practicas_cache_aware() {
    // 1. Perfilar patrones de acceso reales
    // 2. Considerar tamaño de cache (L1, L2, L3)
    // 3. Usar SoA para acceso columnar
    // 4. Usar AoS para acceso a objetos completos
    // 5. Considerar AoSoA como híbrido
    // 6. Implementar blocked algorithms para grandes datasets
    // 7. Medir impacto con performance counters
    // 8. Balancear complejidad vs beneficio
}`})})]})]})]})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsx(Da,{type:"single",defaultValue:"demos",collapsible:!0,className:"space-y-4",children:e.jsxs(sa,{value:"demos",className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700",children:[e.jsx(ra,{className:"px-6 py-4 hover:bg-slate-700/30 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(vn,{className:"size-6 text-emerald-400"}),e.jsx("span",{className:"text-2xl font-semibold",children:"Demostraciones Interactivas"})]})}),e.jsx(na,{className:"px-6 pb-6",children:e.jsxs(ia,{defaultValue:"demo-padding",className:"w-full",children:[e.jsxs(Qt,{className:"grid w-full grid-cols-5 bg-slate-900/50 p-1 rounded-lg mb-6",children:[e.jsx(le,{value:"demo-padding",className:"data-[state=active]:bg-emerald-600",children:"Cache Line Padding"}),e.jsx(le,{value:"demo-alignment",className:"data-[state=active]:bg-emerald-600",children:"Alignment"}),e.jsx(le,{value:"demo-accumulator",className:"data-[state=active]:bg-emerald-600",children:"Thread-Local"}),e.jsx(le,{value:"demo-structure",className:"data-[state=active]:bg-emerald-600",children:"Structure Reorg"}),e.jsx(le,{value:"demo-cacheaware",className:"data-[state=active]:bg-emerald-600",children:"Cache-Aware DS"})]}),e.jsx(ue,{value:"demo-padding",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/20 to-slate-800/20 p-6 rounded-lg border border-blue-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-300 mb-4",children:"Demo: Cache Line Padding (Sin Padding vs Con Padding)"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>o(!s),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${s?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:Xe,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-1 block",children:["Velocidad: ",n,"ms"]}),e.jsx(dt,{value:[n],onValueChange:([Ue])=>l(Ue),min:100,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-red-500/50",children:[e.jsx("h4",{className:"font-bold text-red-300 mb-3 flex items-center gap-2",children:"❌ Sin Padding (False Sharing)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-slate-800 p-3 rounded border-2 border-red-500",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Cache Line 0 (64 bytes)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:`p-2 rounded text-center text-sm ${h[0].value>0?"bg-orange-600":"bg-slate-700"}`,children:[e.jsx("div",{className:"font-mono",children:"counter[0]"}),e.jsx("div",{className:"text-xs",children:"Thread 0"}),e.jsx("div",{className:"font-bold",children:h[0].value})]}),e.jsxs("div",{className:`p-2 rounded text-center text-sm ${h[1].value>0?"bg-orange-600":"bg-slate-700"}`,children:[e.jsx("div",{className:"font-mono",children:"counter[1]"}),e.jsx("div",{className:"text-xs",children:"Thread 1"}),e.jsx("div",{className:"font-bold",children:h[1].value})]})]})]}),e.jsxs("div",{className:"text-sm text-red-300 flex items-center gap-2",children:[e.jsx("span",{children:"🚨"}),e.jsxs("span",{children:["Invalidaciones: ",g.withoutPadding]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-green-500/50",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3 flex items-center gap-2",children:"✅ Con Padding (Sin False Sharing)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-slate-800 p-3 rounded border-2 border-green-500",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Cache Line 0 (64 bytes)"}),e.jsxs("div",{className:`p-2 rounded text-center text-sm ${h[2].value>0?"bg-green-600":"bg-slate-700"}`,children:[e.jsx("div",{className:"font-mono",children:"counter[2]"}),e.jsx("div",{className:"text-xs",children:"Thread 0"}),e.jsx("div",{className:"font-bold",children:h[2].value})]})]}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded border-2 border-green-500",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Cache Line 1 (64 bytes)"}),e.jsxs("div",{className:`p-2 rounded text-center text-sm ${h[3].value>0?"bg-green-600":"bg-slate-700"}`,children:[e.jsx("div",{className:"font-mono",children:"counter[3]"}),e.jsx("div",{className:"text-xs",children:"Thread 1"}),e.jsx("div",{className:"font-bold",children:h[3].value})]})]}),e.jsxs("div",{className:"text-sm text-green-300 flex items-center gap-2",children:[e.jsx("span",{children:"✅"}),e.jsxs("span",{children:["Invalidaciones: ",g.withPadding]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:"Eventos"}),e.jsx("div",{ref:Me,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:v.map((Ue,At)=>e.jsx("div",{className:`p-2 rounded ${Ue.type==="error"?"bg-red-900/30 text-red-300":Ue.type==="warning"?"bg-yellow-900/30 text-yellow-300":Ue.type==="success"?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"}`,children:Ue.message},At))})]})]})}),e.jsx(ue,{value:"demo-alignment",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/20 to-slate-800/20 p-6 rounded-lg border border-purple-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-300 mb-4",children:"Demo: Alignment Directives (Cache Line Crossing)"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>j(!N),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${N?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:N?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:We,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-1 block",children:["Velocidad: ",_,"ms"]}),e.jsx(dt,{value:[_],onValueChange:([Ue])=>w(Ue),min:100,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-red-500/50",children:[e.jsx("h4",{className:"font-bold text-red-300 mb-3 flex items-center gap-2",children:"❌ Unaligned (Cache Line Crossing)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative bg-slate-800 p-3 rounded border-2 border-red-500 h-24",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Cache Line Boundary (64 bytes)"}),e.jsxs("div",{className:"absolute top-8 left-2 w-1/3 h-12 bg-orange-600 rounded opacity-70 border-2 border-orange-400",children:[e.jsx("div",{className:"text-xs p-1",children:"Struct 1"}),e.jsx("div",{className:"text-xs px-1",children:"0-12"})]}),e.jsxs("div",{className:"absolute top-8 left-1/3 w-1/3 h-12 bg-red-600 rounded opacity-70 border-2 border-red-400",children:[e.jsx("div",{className:"text-xs p-1",children:"Struct 2"}),e.jsx("div",{className:"text-xs px-1",children:"12-24"}),e.jsx("div",{className:"text-[10px] px-1",children:"CRUZA!"})]}),e.jsx("div",{className:"absolute top-14 left-0 w-full h-px bg-yellow-500"}),e.jsx("div",{className:"absolute top-14 right-2 text-xs text-yellow-400",children:"64 bytes"})]}),e.jsxs("div",{className:"text-sm text-red-300 flex items-center gap-2",children:[e.jsx("span",{children:"🚨"}),e.jsxs("span",{children:["Cache Line Crossings: ",z.unaligned]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-green-500/50",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3 flex items-center gap-2",children:"✅ Aligned (No Crossing)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-slate-800 p-3 rounded border-2 border-green-500 mb-2",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Cache Line 0"}),e.jsxs("div",{className:"bg-green-600 rounded p-2 text-sm",children:[e.jsx("div",{className:"font-mono",children:"Struct 1 (aligned)"}),e.jsx("div",{className:"text-xs",children:"offset: 0"})]})]}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded border-2 border-green-500",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Cache Line 1"}),e.jsxs("div",{className:"bg-green-600 rounded p-2 text-sm",children:[e.jsx("div",{className:"font-mono",children:"Struct 2 (aligned)"}),e.jsx("div",{className:"text-xs",children:"offset: 64"})]})]}),e.jsxs("div",{className:"text-sm text-green-300 flex items-center gap-2",children:[e.jsx("span",{children:"✅"}),e.jsxs("span",{children:["Cache Line Crossings: ",z.aligned]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:"Eventos"}),e.jsx("div",{ref:De,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:V.map((Ue,At)=>e.jsx("div",{className:`p-2 rounded ${Ue.type==="error"?"bg-red-900/30 text-red-300":Ue.type==="warning"?"bg-yellow-900/30 text-yellow-300":Ue.type==="success"?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"}`,children:Ue.message},At))})]})]})}),e.jsx(ue,{value:"demo-accumulator",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-green-900/20 to-slate-800/20 p-6 rounded-lg border border-green-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-green-300 mb-4",children:"Demo: Thread-Local Accumulators (Shared vs Local)"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>O(!oe),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${oe?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:oe?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:xt,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-1 block",children:["Velocidad: ",T,"ms"]}),e.jsx(dt,{value:[T],onValueChange:([Ue])=>ge(Ue),min:100,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-red-500/50",children:[e.jsx("h4",{className:"font-bold text-red-300 mb-3 flex items-center gap-2",children:"❌ Shared Counter (Contención)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-red-900/30 p-3 rounded border-2 border-red-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-300",children:"Global Counter"}),e.jsx("div",{className:"text-3xl font-bold text-red-300",children:Ce.shared})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ne.slice(0,2).map(Ue=>e.jsxs("div",{className:"bg-slate-800 p-2 rounded text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["Thread ",Ue.id]}),e.jsxs("div",{className:"text-sm font-mono",children:["Writes: ",Ue.writes]})]},Ue.id))}),e.jsxs("div",{className:"text-sm text-red-300 flex items-center gap-2",children:[e.jsx("span",{children:"🚨"}),e.jsxs("span",{children:["Contentiones: ",I]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-green-500/50",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3 flex items-center gap-2",children:"✅ Thread-Local (Sin Contención)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ne.slice(2,4).map(Ue=>e.jsxs("div",{className:"bg-green-900/30 p-3 rounded border-2 border-green-500",children:[e.jsxs("div",{className:"text-xs text-gray-400 text-center",children:["Thread ",Ue.id]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-300",children:"Local Sum"}),e.jsx("div",{className:"text-2xl font-bold text-green-300",children:Ue.localSum})]}),e.jsxs("div",{className:"text-xs text-center mt-1",children:["Writes: ",Ue.writes]})]},Ue.id))}),e.jsx("div",{className:"bg-green-900/30 p-3 rounded border-2 border-green-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-300",children:"Global (after merge)"}),e.jsx("div",{className:"text-3xl font-bold text-green-300",children:Ce.threadLocal})]})}),e.jsxs("div",{className:"text-sm text-green-300 flex items-center gap-2",children:[e.jsx("span",{children:"✅"}),e.jsx("span",{children:"Contentiones: 0"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:"Eventos"}),e.jsx("div",{ref:Ge,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:F.map((Ue,At)=>e.jsx("div",{className:`p-2 rounded ${Ue.type==="error"?"bg-red-900/30 text-red-300":Ue.type==="warning"?"bg-yellow-900/30 text-yellow-300":Ue.type==="success"?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"}`,children:Ue.message},At))})]})]})}),e.jsx(ue,{value:"demo-structure",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-orange-900/20 to-slate-800/20 p-6 rounded-lg border border-orange-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-orange-300 mb-4",children:"Demo: Structure Reorganization (Field Layout)"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>A(!ze),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${ze?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:ze?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:Ot,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-1 block",children:["Velocidad: ",$,"ms"]}),e.jsx(dt,{value:[$],onValueChange:([Ue])=>se(Ue),min:100,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-red-500/50",children:[e.jsx("h4",{className:"font-bold text-red-300 mb-3 flex items-center gap-2",children:"❌ Bad Layout (Mixed Access)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-slate-800 p-3 rounded border-2 border-red-500",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Structure Fields:"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"bg-blue-600 p-2 rounded text-xs",children:"readFreq (read-only)"}),e.jsx("div",{className:"bg-orange-600 p-2 rounded text-xs",children:"writeFreq1 (write Thread A)"}),e.jsx("div",{className:"bg-orange-600 p-2 rounded text-xs",children:"writeFreq2 (write Thread B)"}),e.jsx("div",{className:"bg-blue-600 p-2 rounded text-xs",children:"readOnly (read-only)"})]})]}),e.jsxs("div",{className:"text-sm text-red-300 flex items-center gap-2",children:[e.jsx("span",{children:"🚨"}),e.jsxs("span",{children:["Invalidaciones: ",M.badLayout]})]}),e.jsx("div",{className:"text-xs text-red-400",children:"Read/Write mezclados → False sharing"})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-green-500/50",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3 flex items-center gap-2",children:"✅ Good Layout (Grouped Access)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-slate-800 p-3 rounded border-2 border-green-500 mb-2",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Cache Line 0 (Read-only):"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"bg-blue-600 p-2 rounded text-xs",children:"readFreq"}),e.jsx("div",{className:"bg-blue-600 p-2 rounded text-xs",children:"readOnly"})]})]}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded border-2 border-green-500",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Cache Line 1 (Write):"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"bg-orange-600 p-2 rounded text-xs",children:"writeFreq1"}),e.jsx("div",{className:"bg-orange-600 p-2 rounded text-xs",children:"writeFreq2"})]})]}),e.jsxs("div",{className:"text-sm text-green-300 flex items-center gap-2",children:[e.jsx("span",{children:"✅"}),e.jsxs("span",{children:["Invalidaciones: ",M.goodLayout]})]}),e.jsx("div",{className:"text-xs text-green-400",children:"Agrupados por patrón de acceso"})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:"Eventos"}),e.jsx("div",{ref:qe,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:q.map((Ue,At)=>e.jsx("div",{className:`p-2 rounded ${Ue.type==="error"?"bg-red-900/30 text-red-300":Ue.type==="warning"?"bg-yellow-900/30 text-yellow-300":Ue.type==="success"?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"}`,children:Ue.message},At))})]})]})}),e.jsx(ue,{value:"demo-cacheaware",className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-red-900/20 to-slate-800/20 p-6 rounded-lg border border-red-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-red-300 mb-4",children:"Demo: Cache-Aware DS (AoS vs SoA)"}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>Ne(!be),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${be?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:be?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:It,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm text-gray-300 mb-1 block",children:["Velocidad: ",R,"ms"]}),e.jsx(dt,{value:[R],onValueChange:([Ue])=>ke(Ue),min:100,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-orange-500/50",children:[e.jsx("h4",{className:"font-bold text-orange-300 mb-3 flex items-center gap-2",children:"Array of Structs (AoS)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-slate-800 p-3 rounded border-2 border-orange-500",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Memory Layout:"}),e.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[e.jsx("div",{className:"bg-orange-600 p-1 rounded text-[10px] text-center",children:"x y z"}),e.jsx("div",{className:"bg-orange-600 p-1 rounded text-[10px] text-center",children:"x y z"}),e.jsx("div",{className:"bg-orange-600 p-1 rounded text-[10px] text-center",children:"x y z"}),e.jsx("div",{className:"bg-orange-600 p-1 rounded text-[10px] text-center",children:"x y z"})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:"Acceso a 'x': carga structs completos"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"bg-green-900/30 p-2 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Cache Hits"}),e.jsx("div",{className:"font-bold text-green-300",children:ae[0]?.cacheHits||0})]}),e.jsxs("div",{className:"bg-red-900/30 p-2 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Cache Misses"}),e.jsx("div",{className:"font-bold text-red-300",children:ae[0]?.cacheMisses||0})]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-green-500/50",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3 flex items-center gap-2",children:"✅ Struct of Arrays (SoA)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-slate-800 p-3 rounded border-2 border-green-500",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Memory Layout:"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"bg-green-600 p-2 rounded text-xs",children:"x[]: x x x x (contiguos)"}),e.jsx("div",{className:"bg-blue-600 p-2 rounded text-xs",children:"y[]: y y y y"}),e.jsx("div",{className:"bg-purple-600 p-2 rounded text-xs",children:"z[]: z z z z"})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:"Acceso a 'x': carga solo x[]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"bg-green-900/30 p-2 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Cache Hits"}),e.jsx("div",{className:"font-bold text-green-300",children:ae[1]?.cacheHits||0})]}),e.jsxs("div",{className:"bg-red-900/30 p-2 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Cache Misses"}),e.jsx("div",{className:"font-bold text-red-300",children:ae[1]?.cacheMisses||0})]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:"Eventos"}),e.jsx("div",{ref:Se,className:"space-y-1 max-h-48 overflow-y-auto font-mono text-xs",children:jt.map((Ue,At)=>e.jsx("div",{className:`p-2 rounded ${Ue.type==="error"?"bg-red-900/30 text-red-300":Ue.type==="warning"?"bg-yellow-900/30 text-yellow-300":Ue.type==="success"?"bg-green-900/30 text-green-300":"bg-blue-900/30 text-blue-300"}`,children:Ue.message},At))})]})]})})]})})]})})})]})}const r2=Sa("/ActividadesSeminarioSO/actividad11/false-sharing")({component:s2});function n2(){const[s,o]=c.useState([]),[n,l]=c.useState(!1),[d,m]=c.useState(500),[h,x]=c.useState(0),[g,b]=c.useState(["Event Queue iniciado"]),v=c.useRef(null),[f,N]=c.useState(0),[j,_]=c.useState(0),[w,C]=c.useState(!1),[E,z]=c.useState(500),[P,V]=c.useState(["Event Ordering iniciado"]),Z=c.useRef(null),[oe,O]=c.useState(0),[T,ge]=c.useState(0),[J,W]=c.useState(!1),[ne,Ee]=c.useState(500),[Ce,Le]=c.useState(["Non-blocking Handlers iniciado"]),I=c.useRef(null),[Q,F]=c.useState([{id:1,status:"idle"},{id:2,status:"idle"},{id:3,status:"idle"},{id:4,status:"idle"}]),[de,ze]=c.useState([]),[A,$]=c.useState(0),[se,k]=c.useState(!1),[K,M]=c.useState(500),[D,q]=c.useState(["Worker Threads iniciado"]),G=c.useRef(null),[be,Ne]=c.useState(1e3),[R,ke]=c.useState(0),[je,ee]=c.useState([]),[ae,rt]=c.useState(!1),[jt,xe]=c.useState(500),[Me,De]=c.useState(["Event Sourcing: Balance=$1000"]),Ge=c.useRef(null),[qe,Se]=c.useState(0),[Xe,We]=c.useState(0),[xt,Ot]=c.useState(!1),[It,Ue]=c.useState(500),[At,et]=c.useState(["Reactive Programming iniciado"]),L=c.useRef(null),[re,Ve]=c.useState("IDLE"),[ce,Te]=c.useState(!1),[_t,St]=c.useState(500),[tt,Ye]=c.useState(["State Machine: IDLE"]),ft=c.useRef(null),[Ct,ve]=c.useState(0),[gt,$e]=c.useState(0),[B,U]=c.useState([]),[Dt,Ke]=c.useState(0),[fe,$t]=c.useState(!1),[Zt,pt]=c.useState(500),[zt,lt]=c.useState(["Backpressure: Buffer capacity 10"]),Be=c.useRef(null);return c.useEffect(()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)},[g]),c.useEffect(()=>{Z.current&&(Z.current.scrollTop=Z.current.scrollHeight)},[P]),c.useEffect(()=>{I.current&&(I.current.scrollTop=I.current.scrollHeight)},[Ce]),c.useEffect(()=>{G.current&&(G.current.scrollTop=G.current.scrollHeight)},[D]),c.useEffect(()=>{Ge.current&&(Ge.current.scrollTop=Ge.current.scrollHeight)},[Me]),c.useEffect(()=>{L.current&&(L.current.scrollTop=L.current.scrollHeight)},[At]),c.useEffect(()=>{ft.current&&(ft.current.scrollTop=ft.current.scrollHeight)},[tt]),c.useEffect(()=>{Be.current&&(Be.current.scrollTop=Be.current.scrollHeight)},[zt]),c.useEffect(()=>{if(!n)return;const Ie=setInterval(()=>{if(Math.random()<.6&&s.length<12){const Je={id:Date.now(),type:["click","input","submit"][Math.floor(Math.random()*3)],status:"pending"};o(ot=>[...ot,Je]),b(ot=>[...ot.slice(-9),`📥 ${Je.type} encolado`])}o(Je=>{if(Je.length===0)return Je;const[ot,...X]=Je;return x(Oe=>Oe+1),b(Oe=>[...Oe.slice(-9),`✅ ${ot.type} procesado (FIFO)`]),X})},d);return()=>clearInterval(Ie)},[n,d,s.length]),c.useEffect(()=>{if(!w)return;const Ie=setInterval(()=>{const Je=f,ot=Math.random()<.9?Je:Je+Math.floor(Math.random()*3)+1;ot===Je?(N(X=>X+1),V(X=>[...X.slice(-9),`✅ Evento #${ot} en orden`])):(_(X=>X+1),V(X=>[...X.slice(-9),`❌ Violación: esperado #${Je}, recibido #${ot}`]))},E);return()=>clearInterval(Ie)},[w,E,f]),c.useEffect(()=>{if(!J)return;const Ie=setInterval(()=>{const Je=["http","db","file"][Math.floor(Math.random()*3)];O(ot=>ot+1),Le(ot=>[...ot.slice(-9),`🚀 Handler ${Je} ejecutando`]),setTimeout(()=>{O(ot=>ot-1),ge(ot=>ot+1),Le(ot=>[...ot.slice(-9),`✅ Handler ${Je} completado`])},Math.random()*ne*2)},ne/2);return()=>clearInterval(Ie)},[J,ne]),c.useEffect(()=>{if(!se)return;const Ie=setInterval(()=>{if(Math.random()<.5&&de.length<10){const ot={id:Date.now(),type:["compute","io"][Math.floor(Math.random()*2)],status:"pending"};ze(X=>[...X,ot]),q(X=>[...X.slice(-9),`📋 Tarea ${ot.type} encolada`])}const Je=Q.findIndex(ot=>ot.status==="idle");Je!==-1&&de.length>0&&ze(ot=>{const[,...X]=ot;return F(Oe=>Oe.map((st,Rt)=>Rt===Je?{...st,status:"working"}:st)),q(Oe=>[...Oe.slice(-9),`⚙️ Worker ${Je+1} procesando`]),setTimeout(()=>{F(Oe=>Oe.map((st,Rt)=>Rt===Je?{...st,status:"idle"}:st)),$(Oe=>Oe+1),q(Oe=>[...Oe.slice(-9),`✅ Worker ${Je+1} completó`])},K),X})},K/2);return()=>clearInterval(Ie)},[se,K,Q,de.length]),c.useEffect(()=>{if(!ae)return;const Ie=setInterval(()=>{const Je=["deposit","withdraw","buy"],ot=Je[Math.floor(Math.random()*Je.length)];if(ot==="deposit"){const X=Math.floor(Math.random()*200)+50;Ne(Oe=>Oe+X),ee(Oe=>[...Oe.slice(-5),{id:Date.now(),type:"DEPOSIT",status:"completed",data:X}]),De(Oe=>[...Oe.slice(-9),`💰 DEPOSIT $${X}`])}else if(ot==="withdraw"&&be>=100){const X=Math.floor(Math.random()*100)+50;Ne(Oe=>Oe-X),ee(Oe=>[...Oe.slice(-5),{id:Date.now(),type:"WITHDRAW",status:"completed",data:X}]),De(Oe=>[...Oe.slice(-9),`💸 WITHDRAW $${X}`])}else if(ot==="buy"&&be>=50){const X=Math.floor(Math.random()*50)+20;Ne(Oe=>Oe-X),ke(Oe=>Oe+1),ee(Oe=>[...Oe.slice(-5),{id:Date.now(),type:"BUY",status:"completed",data:X}]),De(Oe=>[...Oe.slice(-9),`🛒 BUY $${X}`])}},jt);return()=>clearInterval(Ie)},[ae,jt,be]),c.useEffect(()=>{if(!xt)return;const Ie=setInterval(()=>{const Je=Math.floor(Math.random()*100);Je>50?(Se(ot=>ot+1),We(ot=>ot+1),et(ot=>[...ot.slice(-9),`🔹 ${Je} → Filter ✅ → Map (*2) = ${Je*2}`])):et(ot=>[...ot.slice(-9),`🔸 ${Je} → Filter ❌`])},It);return()=>clearInterval(Ie)},[xt,It]),c.useEffect(()=>{if(!ce)return;const Ie=setInterval(()=>{const ot={IDLE:[{event:"start",next:"RUNNING"}],RUNNING:[{event:"pause",next:"PAUSED"},{event:"complete",next:"COMPLETED"}],PAUSED:[{event:"resume",next:"RUNNING"}],COMPLETED:[{event:"reset",next:"IDLE"}]}[re]||[];if(ot.length>0){const X=ot[Math.floor(Math.random()*ot.length)];Ve(X.next),Ye(Oe=>[...Oe.slice(-9),`🔄 ${re} --[${X.event}]--> ${X.next}`])}},_t);return()=>clearInterval(Ie)},[ce,_t,re]),c.useEffect(()=>{if(!fe)return;const Ie=setInterval(()=>{const ot=Math.floor(Math.random()*100);ve(X=>X+1),U(X=>X.length<10?(lt(Oe=>[...Oe.slice(-9),`📤 Producer: ${ot} → Buffer (${X.length+1}/10)`]),[...X,ot]):(Ke(Oe=>Oe+1),lt(Oe=>[...Oe.slice(-9),`❌ Buffer lleno! Dato ${ot} descartado`]),X))},Zt/3),Je=setInterval(()=>{U(ot=>{if(ot.length>0){const[X,...Oe]=ot;return $e(st=>st+1),lt(st=>[...st.slice(-9),`📥 Consumer: ${X} procesado → Buffer (${Oe.length}/10)`]),Oe}return ot})},Zt);return()=>{clearInterval(Ie),clearInterval(Je)}},[fe,Zt,B.length]),e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(fp,{className:"size-12 text-yellow-500"}),e.jsx("h1",{className:"text-4xl font-bold",children:"⚡ Programación Basada en Eventos"})]}),e.jsx("p",{className:"text-lg text-gray-300",children:"Paradigma donde el flujo del programa está determinado por eventos. Fundamental para aplicaciones asíncronas, UI, servidores de alta concurrencia y arquitecturas reactivas."}),e.jsx("div",{className:"mt-4 p-4 bg-yellow-900/30 border border-yellow-700/50 rounded-lg",children:e.jsxs("p",{className:"text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Ventajas:"})," Desacoplamiento, escalabilidad, responsividad.",e.jsx("span",{className:"font-bold ml-4",children:"Desafíos:"})," Event ordering, backpressure, debugging."]})})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs(Da,{type:"multiple",defaultValue:["pseudocodigos"],className:"space-y-4",children:[e.jsxs(sa,{value:"pseudocodigos",className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(ra,{className:"text-xl font-bold px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Pseudocódigos de las Soluciones"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"ps-queue",className:"px-6 pb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Qt,{className:"grid grid-cols-4 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"ps-queue",children:"📥 Queue"}),e.jsx(le,{value:"ps-order",children:"🔢 Ordering"}),e.jsx(le,{value:"ps-handler",children:"⚡ Handlers"}),e.jsx(le,{value:"ps-worker",children:"👷 Workers"})]}),e.jsxs(Qt,{className:"grid grid-cols-4 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"ps-sourcing",children:"📜 Sourcing"}),e.jsx(le,{value:"ps-reactive",children:"🔄 Reactive"}),e.jsx(le,{value:"ps-sm",children:"🤖 State"}),e.jsx(le,{value:"ps-bp",children:"🌊 Backpressure"})]})]}),e.jsx(ue,{value:"ps-queue",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-blue-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-400 mb-4",children:"📥 Event Queue Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"1. Cola FIFO Básica"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura EventQueue {
  cola: Queue<Event>
  mutex: Lock
  condVar: ConditionVariable
}

función enqueue(evento: Event) {
  mutex.lock()
  cola.push(evento)
  condVar.signal()  // Notificar que hay eventos
  mutex.unlock()
}

función dequeue() -> Event {
  mutex.lock()
  mientras cola.isEmpty():
    condVar.wait(mutex)  // Esperar eventos
  evento = cola.pop()
  mutex.unlock()
  retornar evento
}

función processEvents() {
  mientras true:
    evento = dequeue()
    handleEvent(evento)
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"2. Cola con Prioridades"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura PriorityEventQueue {
  colas: Array<Queue<Event>>  // Una cola por prioridad
  mutex: Lock
  maxPriority: entero = 5
}

función enqueue(evento: Event, prioridad: entero) {
  mutex.lock()
  si prioridad < 1 o prioridad > maxPriority:
    prioridad = maxPriority
  colas[prioridad].push(evento)
  mutex.unlock()
}

función dequeue() -> Event {
  mutex.lock()
  // Buscar desde mayor prioridad (1) a menor (5)
  para prioridad en 1 hasta maxPriority:
    si no colas[prioridad].isEmpty():
      evento = colas[prioridad].pop()
      mutex.unlock()
      retornar evento
  mutex.unlock()
  retornar null
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"3. Event Loop Pattern"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura EventLoop {
  running: booleano
  queue: EventQueue
  handlers: Map<TipoEvento, Handler>
}

función start() {
  running = true
  mientras running:
    evento = queue.dequeue()
    
    si evento != null:
      handler = handlers.get(evento.type)
      si handler != null:
        intentar:
          handler.execute(evento)
        capturar error:
          logError(error)
          evento.status = 'failed'
}

función registerHandler(tipo: TipoEvento, handler: Handler) {
  handlers.set(tipo, handler)
}

función stop() {
  running = false
}`})]}),e.jsx("div",{className:"p-4 bg-blue-900/30 border border-blue-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," UI event handling, message brokers (RabbitMQ, Kafka), task queues (Celery, Bull), command pattern, pub/sub systems."]})})]})]})}),e.jsx(ue,{value:"ps-order",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-green-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-green-400 mb-4",children:"🔢 Event Ordering Guarantees"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"1. Números de Secuencia"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura SequencedEvent {
  evento: Event
  secuencia: entero
  fuente: ID
}

estructura Sequencer {
  siguienteSecuencia: AtomicInteger = 0
  buffer: Map<entero, SequencedEvent>  // Out-of-order buffer
  esperado: entero = 0
}

función assignSequence(evento: Event) -> SequencedEvent {
  seq = siguienteSecuencia.incrementAndGet()
  retornar SequencedEvent(evento, seq, nodeId)
}

función processInOrder(seqEvento: SequencedEvent) {
  buffer[seqEvento.secuencia] = seqEvento
  
  mientras buffer.contains(esperado):
    evento = buffer.remove(esperado)
    handleEvent(evento.evento)
    esperado++
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"2. Vector Clocks (Causal Ordering)"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura VectorClock {
  vector: Array<entero>  // Un contador por nodo
  nodeId: entero
}

función increment() {
  vector[nodeId]++
}

función update(other: VectorClock) {
  para i en 0 hasta vector.length:
    vector[i] = max(vector[i], other.vector[i])
  vector[nodeId]++
}

función happensBefore(vc1: VectorClock, vc2: VectorClock) -> booleano {
  menorIgual = true
  estrictamenteMenor = false
  
  para i en 0 hasta vc1.vector.length:
    si vc1.vector[i] > vc2.vector[i]:
      menorIgual = false
      break
    si vc1.vector[i] < vc2.vector[i]:
      estrictamenteMenor = true
  
  retornar menorIgual Y estrictamenteMenor
}

función sendEvent(evento: Event) {
  increment()
  evento.vectorClock = copiar(vector)
  enviar(evento)
}

función receiveEvent(evento: Event) {
  update(evento.vectorClock)
  procesarSiEsSeguro(evento)
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"3. Lamport Timestamps"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura LamportClock {
  timestamp: AtomicInteger = 0
  nodeId: entero
}

función tick() -> entero {
  retornar timestamp.incrementAndGet()
}

función update(recibido: entero) {
  mientras true:
    actual = timestamp.get()
    nuevo = max(actual, recibido) + 1
    si timestamp.compareAndSet(actual, nuevo):
      break
  retornar nuevo
}

función compare(t1: (timestamp, nodeId), t2: (timestamp, nodeId)) -> entero {
  si t1.timestamp < t2.timestamp:
    retornar -1
  sino si t1.timestamp > t2.timestamp:
    retornar 1
  sino:  // Desempate por nodeId
    retornar t1.nodeId - t2.nodeId
}`})]}),e.jsx("div",{className:"p-4 bg-green-900/30 border border-green-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," Event sourcing, distributed databases (Cassandra), replication systems, causal consistency, blockchain, distributed tracing."]})})]})]})}),e.jsx(ue,{value:"ps-handler",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-purple-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-400 mb-4",children:"⚡ Non-blocking Event Handlers"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"1. Async/Await Pattern"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Patrón moderno con async/await
función async handleEventAsync(evento: Event) {
  intentar:
    evento.status = 'processing'
    
    // Operaciones no bloqueantes
    resultado = await operacionIO(evento.data)
    datos = await procesarDatos(resultado)
    await guardarResultado(datos)
    
    evento.status = 'completed'
  capturar error:
    evento.status = 'failed'
    logError(error)
    throw error
}

función async processEventsWithConcurrency(eventos: Array<Event>) {
  // Procesar múltiples eventos concurrentemente
  promesas = eventos.map(e => handleEventAsync(e))
  
  // Esperar todos con manejo de errores
  resultados = await Promise.allSettled(promesas)
  
  para resultado en resultados:
    si resultado.status == 'rejected':
      logError(resultado.reason)
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"2. Callback Pattern"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`función handleEventWithCallback(evento: Event, callback: Function) {
  // Iniciar operación asíncrona
  operacionAsync(evento.data, función(error, resultado) {
    si error:
      evento.status = 'failed'
      callback(error, null)
    sino:
      evento.status = 'completed'
      callback(null, resultado)
  })
  
  // Retornar inmediatamente sin bloquear
  retornar  // Handler no bloqueante
}

función processWithCallbacks(eventos: Array<Event>) {
  contador = AtomicInteger(eventos.length)
  resultados = []
  
  para evento en eventos:
    handleEventWithCallback(evento, función(error, resultado) {
      si error:
        logError(error)
      sino:
        resultados.push(resultado)
      
      si contador.decrementAndGet() == 0:
        onTodosCompletados(resultados)
    })
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"3. Promise Pattern"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`función handleEventWithPromise(evento: Event) -> Promise<Result> {
  retornar new Promise(función(resolve, reject) {
    intentar:
      evento.status = 'processing'
      
      // Operación asíncrona
      operacionAsync(evento.data)
        .then(función(resultado) {
          evento.status = 'completed'
          resolve(resultado)
        })
        .catch(función(error) {
          evento.status = 'failed'
          reject(error)
        })
    capturar error:
      reject(error)
  })
}

función processWithPromiseChain(eventos: Array<Event>) {
  // Procesar secuencialmente con promises
  promesa = Promise.resolve()
  
  para evento en eventos:
    promesa = promesa.then(función() {
      retornar handleEventWithPromise(evento)
    })
  
  retornar promesa
}`})]}),e.jsx("div",{className:"p-4 bg-purple-900/30 border border-purple-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-purple-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," Node.js event loop, web APIs (fetch), database queries, file I/O, network requests, microservices communication."]})})]})]})}),e.jsx(ue,{value:"ps-worker",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-yellow-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-4",children:"👷 Worker Threads para Eventos"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"Thread Pool Pattern"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura WorkerPool {
  workers: Array<Worker>
  taskQueue: BlockingQueue<Event>
  running: booleano
}

función iniciar(numWorkers: entero) {
  running = true
  para i en 1 hasta numWorkers:
    worker = new Worker(i, taskQueue)
    workers.push(worker)
    worker.start()
}

función submitEvent(evento: Event) {
  taskQueue.put(evento)
}

clase Worker extends Thread {
  id: entero
  queue: BlockingQueue<Event>
  
  función run() {
    mientras running:
      evento = queue.take()  // Bloquea hasta que haya trabajo
      procesarEvento(evento)
}`})]}),e.jsx("div",{className:"p-4 bg-yellow-900/30 border border-yellow-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Uso:"})," Processing pools, parallel event handling"]})})]})]})}),e.jsx(ue,{value:"ps-sourcing",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-cyan-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-cyan-400 mb-4",children:"📜 Event Sourcing"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-cyan-300 mb-3",children:"Event Store Pattern"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura EventStore {
  events: List<Event>
  snapshots: Map<ID, Snapshot>
}

función appendEvent(evento: Event) {
  evento.timestamp = now()
  evento.version = events.size() + 1
  events.append(evento)
  
  si evento.version % 100 == 0:
    crearSnapshot(evento.aggregateId)
}

función rebuild(aggregateId: ID) -> Estado {
  snapshot = snapshots.get(aggregateId)
  estado = snapshot != null ? snapshot.estado : estadoInicial()
  
  desde = snapshot != null ? snapshot.version : 0
  para evento en events desde desde:
    estado = aplicarEvento(estado, evento)
  
  retornar estado
}`})]}),e.jsx("div",{className:"p-4 bg-cyan-900/30 border border-cyan-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-cyan-200",children:[e.jsx("span",{className:"font-bold",children:"Uso:"})," CQRS, audit logs, time travel debugging"]})})]})]})}),e.jsx(ue,{value:"ps-reactive",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-pink-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-pink-400 mb-4",children:"🔄 Reactive Programming"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-pink-300 mb-3",children:"Observable Pattern"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`clase Observable<T> {
  observers: List<Observer<T>>
  
  función subscribe(observer: Observer<T>) {
    observers.add(observer)
    retornar función unsubscribe() {
      observers.remove(observer)
    }
  }
  
  función emit(valor: T) {
    para observer en observers:
      observer.onNext(valor)
  }
  
  función map<R>(transform: Function<T, R>) -> Observable<R> {
    retornar new Observable(función(observer) {
      this.subscribe(función(valor) {
        observer.onNext(transform(valor))
      })
    })
  }
  
  función filter(predicate: Function<T, boolean>) -> Observable<T> {
    retornar new Observable(función(observer) {
      this.subscribe(función(valor) {
        si predicate(valor):
          observer.onNext(valor)
      })
    })
  }
}`})]}),e.jsx("div",{className:"p-4 bg-pink-900/30 border border-pink-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-pink-200",children:[e.jsx("span",{className:"font-bold",children:"Uso:"})," RxJS, data streams, reactive UI"]})})]})]})}),e.jsx(ue,{value:"ps-sm",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-orange-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-orange-400 mb-4",children:"🤖 State Machine"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-orange-300 mb-3",children:"FSM Pattern"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura StateMachine {
  estadoActual: Estado
  transiciones: Map<(Estado, Evento), Estado>
  acciones: Map<(Estado, Evento), Action>
}

función handleEvent(evento: Evento) {
  clave = (estadoActual, evento.tipo)
  
  si transiciones.contains(clave):
    nuevoEstado = transiciones.get(clave)
    
    // Ejecutar acción si existe
    si acciones.contains(clave):
      accion = acciones.get(clave)
      accion.execute(evento)
    
    // Transición
    onExit(estadoActual, evento)
    estadoActual = nuevoEstado
    onEnter(nuevoEstado, evento)
  sino:
    logWarning("Transición inválida: " + clave)
}`})]}),e.jsx("div",{className:"p-4 bg-orange-900/30 border border-orange-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-orange-200",children:[e.jsx("span",{className:"font-bold",children:"Uso:"})," Workflow engines, UI states, protocols"]})})]})]})}),e.jsx(ue,{value:"ps-bp",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-teal-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-teal-400 mb-4",children:"🌊 Backpressure Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-teal-300 mb-3",children:"Backpressure Strategies"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura BackpressureBuffer<T> {
  buffer: BoundedQueue<T>
  strategy: Strategy  // DROP, BLOCK, ERROR
}

función produce(item: T) {
  cuando strategy:
    DROP:
      si no buffer.offer(item):
        logDrop(item)  // Descartar silenciosamente
    
    BLOCK:
      buffer.put(item)  // Bloquear hasta que haya espacio
    
    ERROR:
      si no buffer.offer(item):
        throw BufferOverflowException()
}

función consume() -> T {
  retornar buffer.take()
}

// Patrón Reactive Streams
interfaz Publisher<T> {
  función subscribe(subscriber: Subscriber<T>)
}

interfaz Subscriber<T> {
  función onSubscribe(subscription: Subscription)
  función onNext(item: T)
  función onError(error: Error)
  función onComplete()
}

interfaz Subscription {
  función request(n: long)  // Pull-based backpressure
  función cancel()
}`})]}),e.jsx("div",{className:"p-4 bg-teal-900/30 border border-teal-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-teal-200",children:[e.jsx("span",{className:"font-bold",children:"Uso:"})," Reactive Streams, flow control, rate limiting"]})})]})]})})]})})]}),e.jsxs(sa,{value:"demos",className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(ra,{className:"text-xl font-bold px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(La,{className:"size-5"}),e.jsx("span",{children:"Demostraciones Interactivas"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"queue",className:"px-6 pb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Qt,{className:"grid grid-cols-4 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"queue",children:"📥 Queue"}),e.jsx(le,{value:"order",children:"🔢 Ordering"}),e.jsx(le,{value:"handler",children:"⚡ Handlers"}),e.jsx(le,{value:"worker",children:"👷 Workers"})]}),e.jsxs(Qt,{className:"grid grid-cols-4 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"sourcing",children:"📜 Sourcing"}),e.jsx(le,{value:"reactive",children:"🔄 Reactive"}),e.jsx(le,{value:"sm",children:"🤖 State"}),e.jsx(le,{value:"bp",children:"🌊 Backpressure"})]})]}),e.jsx(ue,{value:"queue",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-blue-400",children:"Event Queue Management"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>l(!n),className:`px-4 py-2 rounded flex items-center gap-2 ${n?"bg-red-600":"bg-blue-600"}`,children:[n?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),n?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{l(!1),o([]),x(0),b(["Event Queue reiniciado"])},className:"px-4 py-2 bg-gray-700 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",d,"ms"]}),e.jsx(dt,{value:[d],onValueChange:([Ie])=>m(Ie),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Cola FIFO"}),e.jsx("div",{className:"bg-gray-800 rounded p-4 h-64 overflow-y-auto",children:s.length===0?e.jsx("div",{className:"text-center text-gray-500",children:"Cola vacía"}):s.map((Ie,Je)=>e.jsxs("div",{className:`p-2 mb-2 rounded border-2 ${Je===0?"bg-blue-900/50 border-blue-500":"bg-gray-700 border-gray-600"}`,children:[Je===0?"🔵":"⚪"," ",Ie.type]},Ie.id))}),e.jsxs("div",{className:"mt-3 text-center text-blue-400 font-bold",children:["En cola: ",s.length]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Estadísticas"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Procesados"}),e.jsx("div",{className:"text-2xl font-bold text-green-400",children:h})]}),e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"En Cola"}),e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:s.length})]}),e.jsxs("div",{className:"p-4 bg-blue-900/30 border border-blue-700/50 rounded text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"📥"}),e.jsx("div",{className:"text-xs text-blue-300",children:"Orden FIFO Garantizado"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log"}),e.jsx("div",{ref:v,className:"bg-black rounded p-3 h-40 overflow-y-auto font-mono text-xs text-blue-400",children:g.map((Ie,Je)=>e.jsx("div",{children:Ie},Je))})]})]})}),e.jsx(ue,{value:"order",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-green-400",children:"Event Ordering Guarantees"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>C(!w),className:`px-4 py-2 rounded flex items-center gap-2 ${w?"bg-red-600":"bg-green-600"}`,children:[w?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),w?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{C(!1),N(0),_(0),V(["Event Ordering reiniciado"])},className:"px-4 py-2 bg-gray-700 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",E,"ms"]}),e.jsx(dt,{value:[E],onValueChange:([Ie])=>z(Ie),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Secuencia Actual"}),e.jsxs("div",{className:"text-3xl font-bold text-green-400",children:["#",f]})]}),e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Violaciones"}),e.jsx("div",{className:"text-3xl font-bold text-red-400",children:j})]})]}),e.jsxs("div",{className:"p-6 bg-green-900/30 border border-green-700/50 rounded text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"🔢"}),e.jsxs("div",{className:"text-xl font-bold text-green-300",children:["Tasa de éxito: ",f>0?Math.round((1-j/(f+j))*100):100,"%"]}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:"Vector clocks, Lamport timestamps"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log"}),e.jsx("div",{ref:Z,className:"bg-black rounded p-3 h-40 overflow-y-auto font-mono text-xs text-green-400",children:P.map((Ie,Je)=>e.jsx("div",{children:Ie},Je))})]})]})}),e.jsx(ue,{value:"handler",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-400",children:"Non-blocking Handlers"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>W(!J),className:`px-4 py-2 rounded flex items-center gap-2 ${J?"bg-red-600":"bg-purple-600"}`,children:[J?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),J?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{W(!1),O(0),ge(0),Le(["Handlers reiniciado"])},className:"px-4 py-2 bg-gray-700 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",ne,"ms"]}),e.jsx(dt,{value:[ne],onValueChange:([Ie])=>Ee(Ie),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Handlers Activos"}),e.jsx("div",{className:"text-3xl font-bold text-purple-400",children:oe})]}),e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Completados"}),e.jsx("div",{className:"text-3xl font-bold text-green-400",children:T})]})]}),e.jsxs("div",{className:"p-6 bg-purple-900/30 border border-purple-700/50 rounded text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"⚡"}),e.jsx("div",{className:"text-lg font-bold text-purple-300",children:"Procesamiento Asíncrono"}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:"Callbacks, Promises, Async/Await"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log"}),e.jsx("div",{ref:I,className:"bg-black rounded p-3 h-40 overflow-y-auto font-mono text-xs text-purple-400",children:Ce.map((Ie,Je)=>e.jsx("div",{children:Ie},Je))})]})]})}),e.jsx(ue,{value:"worker",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-400",children:"Worker Threads"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>k(!se),className:`px-4 py-2 rounded flex items-center gap-2 ${se?"bg-red-600":"bg-yellow-600"}`,children:[se?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),se?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{k(!1),F(Ie=>Ie.map(Je=>({...Je,status:"idle"}))),ze([]),$(0),q(["Workers reiniciado"])},className:"px-4 py-2 bg-gray-700 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",K,"ms"]}),e.jsx(dt,{value:[K],onValueChange:([Ie])=>M(Ie),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Workers (4)"}),e.jsx("div",{className:"space-y-2",children:Q.map(Ie=>e.jsx("div",{className:`p-3 rounded border-2 ${Ie.status==="working"?"bg-yellow-900/50 border-yellow-500":"bg-gray-700 border-gray-600"}`,children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["👷 Worker ",Ie.id]}),e.jsx("span",{className:Ie.status==="working"?"text-yellow-400":"text-gray-400",children:Ie.status==="working"?"⚙️ Trabajando":"💤 Idle"})]})},Ie.id))}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx("span",{className:"text-gray-400",children:"Cola:"})," ",e.jsx("span",{className:"font-bold text-yellow-400",children:de.length})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Completadas"}),e.jsx("div",{className:"text-3xl font-bold text-green-400",children:A})]}),e.jsxs("div",{className:"p-6 bg-yellow-900/30 border border-yellow-700/50 rounded text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"👷"}),e.jsx("div",{className:"text-lg font-bold text-yellow-300",children:"Thread Pool"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log"}),e.jsx("div",{ref:G,className:"bg-black rounded p-3 h-40 overflow-y-auto font-mono text-xs text-yellow-400",children:D.map((Ie,Je)=>e.jsx("div",{children:Ie},Je))})]})]})}),e.jsx(ue,{value:"sourcing",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-cyan-400",children:"Event Sourcing"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>rt(!ae),className:`px-4 py-2 rounded flex items-center gap-2 ${ae?"bg-red-600":"bg-cyan-600"}`,children:[ae?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),ae?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{rt(!1),Ne(1e3),ke(0),ee([]),De(["Event Sourcing reiniciado"])},className:"px-4 py-2 bg-gray-700 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",jt,"ms"]}),e.jsx(dt,{value:[jt],onValueChange:([Ie])=>xe(Ie),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Estado"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Balance"}),e.jsxs("div",{className:"text-3xl font-bold text-green-400",children:["$",be]})]}),e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Items"}),e.jsx("div",{className:"text-3xl font-bold text-cyan-400",children:R})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Eventos"}),e.jsx("div",{className:"bg-gray-800 rounded p-4 h-48 overflow-y-auto",children:je.length===0?e.jsx("div",{className:"text-center text-gray-500",children:"Sin eventos"}):je.map(Ie=>e.jsx("div",{className:"p-2 mb-2 rounded bg-cyan-900/30 border border-cyan-700/50",children:e.jsxs("span",{className:"text-sm",children:[Ie.type==="DEPOSIT"?"💰":Ie.type==="WITHDRAW"?"💸":"🛒"," ",Ie.type," $",Ie.data]})},Ie.id))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log"}),e.jsx("div",{ref:Ge,className:"bg-black rounded p-3 h-40 overflow-y-auto font-mono text-xs text-cyan-400",children:Me.map((Ie,Je)=>e.jsx("div",{children:Ie},Je))})]})]})}),e.jsx(ue,{value:"reactive",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-pink-400",children:"Reactive Programming"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>Ot(!xt),className:`px-4 py-2 rounded flex items-center gap-2 ${xt?"bg-red-600":"bg-pink-600"}`,children:[xt?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),xt?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{Ot(!1),Se(0),We(0),et(["Reactive reiniciado"])},className:"px-4 py-2 bg-gray-700 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",It,"ms"]}),e.jsx(dt,{value:[It],onValueChange:([Ie])=>Ue(Ie),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Filtrados (>50)"}),e.jsx("div",{className:"text-3xl font-bold text-pink-400",children:qe})]}),e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Mapeados (*2)"}),e.jsx("div",{className:"text-3xl font-bold text-purple-400",children:Xe})]})]}),e.jsxs("div",{className:"p-6 bg-pink-900/30 border border-pink-700/50 rounded text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"🔄"}),e.jsx("div",{className:"text-lg font-bold text-pink-300",children:"Reactive Streams"}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:"Observables, filter, map"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log"}),e.jsx("div",{ref:L,className:"bg-black rounded p-3 h-40 overflow-y-auto font-mono text-xs text-pink-400",children:At.map((Ie,Je)=>e.jsx("div",{children:Ie},Je))})]})]})}),e.jsx(ue,{value:"sm",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-orange-400",children:"State Machine"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>Te(!ce),className:`px-4 py-2 rounded flex items-center gap-2 ${ce?"bg-red-600":"bg-orange-600"}`,children:[ce?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),ce?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{Te(!1),Ve("IDLE"),Ye(["State Machine: IDLE"])},className:"px-4 py-2 bg-gray-700 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",_t,"ms"]}),e.jsx(dt,{value:[_t],onValueChange:([Ie])=>St(Ie),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"p-8 bg-gray-800 rounded text-center",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Estado Actual"}),e.jsx("div",{className:"text-5xl font-bold text-orange-400 mb-4",children:re}),e.jsxs("div",{className:"text-xs text-gray-400",children:[re==="IDLE"&&"💤 En espera",re==="RUNNING"&&"🏃 Ejecutando",re==="PAUSED"&&"⏸️ Pausado",re==="COMPLETED"&&"✅ Completado"]})]}),e.jsxs("div",{className:"p-6 bg-orange-900/30 border border-orange-700/50 rounded",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Transiciones"}),e.jsxs("div",{className:"text-xs text-gray-300 space-y-2",children:[e.jsx("div",{children:"IDLE → [start] → RUNNING"}),e.jsx("div",{children:"RUNNING → [pause] → PAUSED"}),e.jsx("div",{children:"RUNNING → [complete] → COMPLETED"}),e.jsx("div",{children:"PAUSED → [resume] → RUNNING"}),e.jsx("div",{children:"COMPLETED → [reset] → IDLE"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log"}),e.jsx("div",{ref:ft,className:"bg-black rounded p-3 h-40 overflow-y-auto font-mono text-xs text-orange-400",children:tt.map((Ie,Je)=>e.jsx("div",{children:Ie},Je))})]})]})}),e.jsx(ue,{value:"bp",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-teal-400",children:"Backpressure Management"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>$t(!fe),className:`px-4 py-2 rounded flex items-center gap-2 ${fe?"bg-red-600":"bg-teal-600"}`,children:[fe?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),fe?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:()=>{$t(!1),ve(0),$e(0),U([]),Ke(0),lt(["Backpressure reiniciado"])},className:"px-4 py-2 bg-gray-700 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",Zt,"ms"]}),e.jsx(dt,{value:[Zt],onValueChange:([Ie])=>pt(Ie),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Métricas"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Producidos"}),e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:Ct})]}),e.jsxs("div",{className:"p-4 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Consumidos"}),e.jsx("div",{className:"text-3xl font-bold text-green-400",children:gt})]}),e.jsxs("div",{className:"p-4 bg-red-900/30 border border-red-700/50 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Descartados"}),e.jsx("div",{className:"text-3xl font-bold text-red-400",children:Dt})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Buffer (10)"}),e.jsxs("div",{className:"bg-gray-800 rounded p-4 h-64",children:[e.jsx("div",{className:"grid grid-cols-10 gap-1 h-full",children:[...Array(10)].map((Ie,Je)=>e.jsx("div",{className:`rounded ${Je<B.length?"bg-teal-500":"bg-gray-700"}`},Je))}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsxs("span",{className:"text-teal-400 font-bold",children:[B.length,"/10"]}),B.length>=10&&e.jsx("span",{className:"ml-3 text-red-400",children:"⚠️ LLENO"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log"}),e.jsx("div",{ref:Be,className:"bg-black rounded p-3 h-40 overflow-y-auto font-mono text-xs text-teal-400",children:zt.map((Ie,Je)=>e.jsx("div",{children:Ie},Je))})]})]})})]})})]})]})})]})}const o2=Sa("/ActividadesSeminarioSO/actividad11/eventos")({component:n2});function i2(){return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto px-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"text-5xl",children:"🔒"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Deadlock"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Interbloqueo / Abrazo Mortal"})]})]})})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"bg-white text-gray-900 rounded-lg p-8 mb-8 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(La,{className:"size-6 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Descripción del Problema"})]}),e.jsxs("p",{className:"text-gray-700 leading-relaxed mb-4",children:["Un ",e.jsx("strong",{className:"text-red-600",children:"deadlock"})," (interbloqueo) ocurre cuando un conjunto de procesos está esperando por recursos que están siendo retenidos por otros procesos del mismo conjunto. Ningún proceso puede continuar porque cada uno está esperando que otro libere un recurso."]}),e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded mt-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(yn,{className:"size-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-red-900 mb-2",children:"Condiciones de Coffman"}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"Para que ocurra un deadlock, deben cumplirse simultáneamente estas 4 condiciones:"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 ml-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"1. Exclusión Mutua:"})," Al menos un recurso debe estar en modo no compartible"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"2. Hold and Wait:"})," Un proceso retiene al menos un recurso y espera por otro"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"3. No Preemption:"})," Los recursos no pueden ser arrebatados, solo liberados voluntariamente"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"4. Espera Circular:"})," Existe una cadena circular de procesos esperando recursos"]})]})]})]})}),e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"💡 Estrategias:"})," Para prevenir deadlocks podemos romper una o más de las condiciones de Coffman, detectar y recuperarnos del deadlock, o simplemente ignorarlo (algoritmo del avestruz)."]})})]}),e.jsxs(Da,{type:"multiple",defaultValue:["soluciones","demostracion"],className:"space-y-4",children:[e.jsxs(sa,{value:"soluciones",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Soluciones"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"ordenar",className:"w-full",children:[e.jsxs(Qt,{className:"w-full justify-start flex-wrap h-auto gap-2 bg-gray-900 p-2",children:[e.jsx(le,{value:"ordenar",children:"Ordenar Recursos"}),e.jsx(le,{value:"todos",children:"Adquirir Todos"}),e.jsx(le,{value:"timeout",children:"Timeouts"}),e.jsx(le,{value:"banquero",children:"Algoritmo del Banquero"}),e.jsx(le,{value:"grafo",children:"Análisis de Grafos"}),e.jsx(le,{value:"ciclos",children:"Detectar Ciclos"}),e.jsx(le,{value:"abortar",children:"Abortar Procesos"}),e.jsx(le,{value:"rollback",children:"Rollback"})]}),e.jsx(ue,{value:"ordenar",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Ordenar la Adquisición de Recursos"}),e.jsx("p",{className:"text-gray-300",children:"Establece un orden global para adquirir recursos. Todos los procesos deben solicitar recursos en el mismo orden, rompiendo la condición de espera circular."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Orden Global de Recursos

// Definir orden de recursos (IDs únicos)
RECURSOS:
    R1 = 1  // Base de datos
    R2 = 2  // Archivo de log
    R3 = 3  // Buffer de red
    R4 = 4  // Impresora

PROCEDIMIENTO adquirir_recursos_ordenados(ids_recursos[]):
    // IMPORTANTE: Ordenar IDs antes de adquirir
    ids_ordenados = ORDENAR(ids_recursos)
    recursos_adquiridos = []
    
    PARA CADA id EN ids_ordenados:
        recurso = ADQUIRIR_LOCK(id)
        AGREGAR(recursos_adquiridos, recurso)
    FIN PARA
    
    RETORNAR recursos_adquiridos
FIN PROCEDIMIENTO

PROCEDIMIENTO liberar_recursos(recursos[]):
    // Liberar en orden inverso (opcional pero recomendado)
    PARA CADA recurso EN REVERSA(recursos):
        LIBERAR_LOCK(recurso)
    FIN PARA
FIN PROCEDIMIENTO

// Ejemplo: Dos procesos que necesitan mismos recursos
PROCEDIMIENTO proceso_A():
    // Necesita R2 y R4, pero los ordena primero
    recursos = adquirir_recursos_ordenados([R4, R2])  // Se ordena a [R2, R4]
    
    // Sección crítica
    USAR(recursos)
    
    liberar_recursos(recursos)
FIN PROCEDIMIENTO

PROCEDIMIENTO proceso_B():
    // También necesita R2 y R4
    recursos = adquirir_recursos_ordenados([R2, R4])  // Ya ordenados
    
    // Sección crítica
    USAR(recursos)
    
    liberar_recursos(recursos)
FIN PROCEDIMIENTO

// Sin ordenamiento: posible deadlock
// A adquiere R4, B adquiere R2
// A espera R2, B espera R4 -> DEADLOCK

// Con ordenamiento: sin deadlock
// Ambos intentan R2 primero, uno espera, no hay ciclo`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Prevención garantizada, simple de implementar, sin overhead en runtime.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Requiere conocer todos los recursos por adelantado, puede reducir concurrencia."]})})]})}),e.jsx(ue,{value:"todos",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Adquirir Todos los Recursos de Una Vez"}),e.jsx("p",{className:"text-gray-300",children:'Un proceso debe adquirir todos los recursos que necesita de forma atómica antes de comenzar, o no adquirir ninguno. Rompe la condición de "hold and wait".'}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Adquisición Atómica

COMPARTIDO lock_global = NuevoMutex()

PROCEDIMIENTO adquirir_todos_o_ninguno(recursos_requeridos[]):
    recursos_obtenidos = []
    exito = FALSO
    
    // Usar lock global para hacer la adquisición atómica
    lock_global.adquirir()
    
    INTENTAR:
        // Intentar adquirir todos
        PARA CADA recurso EN recursos_requeridos:
            SI recurso.esta_disponible():
                recurso.adquirir()
                AGREGAR(recursos_obtenidos, recurso)
            SINO:
                // Si alguno no está disponible, abortar
                IR_A liberar_y_fallar
            FIN SI
        FIN PARA
        
        exito = VERDADERO
        
    liberar_y_fallar:
        SI NO exito:
            // Liberar todo lo adquirido
            PARA CADA recurso EN recursos_obtenidos:
                recurso.liberar()
            FIN PARA
            recursos_obtenidos = []
        FIN SI
        
    FINALMENTE:
        lock_global.liberar()
    FIN INTENTAR
    
    RETORNAR recursos_obtenidos
FIN PROCEDIMIENTO

PROCEDIMIENTO proceso_con_retry():
    recursos_necesarios = [R1, R2, R3]
    recursos = []
    
    // Reintentar hasta obtener todos
    MIENTRAS VERDADERO:
        recursos = adquirir_todos_o_ninguno(recursos_necesarios)
        
        SI recursos.tamaño() > 0:
            SALIR  // Éxito, tenemos todos los recursos
        SINO:
            DORMIR(tiempo_aleatorio())  // Esperar antes de reintentar
        FIN SI
    FIN MIENTRAS
    
    // Usar recursos
    TRABAJAR_CON(recursos)
    
    // Liberar todos
    PARA CADA recurso EN recursos:
        recurso.liberar()
    FIN PARA
FIN PROCEDIMIENTO

// Variante sin lock global (usando banderas)
PROCEDIMIENTO adquirir_no_bloqueante(recursos[]):
    PARA CADA recurso EN recursos:
        SI NO recurso.try_lock():  // Intento no bloqueante
            // Liberar lo ya adquirido
            liberar_adquiridos_hasta_ahora()
            RETORNAR FALSO
        FIN SI
    FIN PARA
    RETORNAR VERDADERO
FIN PROCEDIMIENTO`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Previene deadlock completamente, fácil de razonar.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Puede causar starvation, reduce concurrencia, desperdicio si solo necesita algunos recursos."]})})]})}),e.jsx(ue,{value:"timeout",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Implementar Timeouts"}),e.jsx("p",{className:"text-gray-300",children:"Los procesos intentan adquirir recursos con un tiempo límite. Si expira el timeout, liberan todos los recursos y reintentan, rompiendo el deadlock potencial."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Timeouts para Prevenir Deadlock

CONSTANTE TIMEOUT_MS = 5000  // 5 segundos
CONSTANTE MAX_REINTENTOS = 3

PROCEDIMIENTO adquirir_con_timeout(recurso, timeout_ms):
    tiempo_inicio = TIEMPO_ACTUAL()
    
    MIENTRAS (TIEMPO_ACTUAL() - tiempo_inicio) < timeout_ms:
        SI recurso.try_lock():
            RETORNAR VERDADERO  // Éxito
        FIN SI
        
        DORMIR(10)  // Esperar un poco antes de reintentar
    FIN MIENTRAS
    
    RETORNAR FALSO  // Timeout expiró
FIN PROCEDIMIENTO

PROCEDIMIENTO proceso_con_timeout():
    recursos_adquiridos = []
    recursos_necesarios = [R1, R2, R3]
    intentos = 0
    
    MIENTRAS intentos < MAX_REINTENTOS:
        exito = VERDADERO
        
        // Intentar adquirir cada recurso con timeout
        PARA CADA recurso EN recursos_necesarios:
            SI adquirir_con_timeout(recurso, TIMEOUT_MS):
                AGREGAR(recursos_adquiridos, recurso)
            SINO:
                // Timeout: liberar todo y reintentar
                IMPRIMIR "Timeout al adquirir", recurso.id, "- Reintentando..."
                exito = FALSO
                SALIR_DEL_BUCLE
            FIN SI
        FIN PARA
        
        SI exito:
            // Tenemos todos los recursos
            TRABAJAR()
            
            // Liberar recursos
            PARA CADA recurso EN recursos_adquiridos:
                recurso.liberar()
            FIN PARA
            
            RETORNAR VERDADERO
        SINO:
            // Falló: liberar parciales
            PARA CADA recurso EN recursos_adquiridos:
                recurso.liberar()
            FIN PARA
            recursos_adquiridos = []
            
            // Backoff exponencial
            tiempo_espera = POTENCIA(2, intentos) * 100
            DORMIR(tiempo_espera + ALEATORIO(0, 100))
            
            intentos = intentos + 1
        FIN SI
    FIN MIENTRAS
    
    IMPRIMIR "ERROR: No se pudieron adquirir recursos tras", MAX_REINTENTOS, "intentos"
    RETORNAR FALSO
FIN PROCEDIMIENTO

// Variante con try_lock_for (C++/Java)
PROCEDIMIENTO ejemplo_moderno():
    mutex1 = NuevoMutex()
    mutex2 = NuevoMutex()
    
    SI mutex1.try_lock_for(2.segundos()):
        SI mutex2.try_lock_for(2.segundos()):
            // Ambos adquiridos
            TRABAJAR()
            mutex2.unlock()
        SINO:
            IMPRIMIR "Timeout en mutex2"
        FIN SI
        mutex1.unlock()
    SINO:
        IMPRIMIR "Timeout en mutex1"
    FIN SI
FIN PROCEDIMIENTO`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Flexible, permite recuperación automática, útil en sistemas distribuidos.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," No garantiza prevención, overhead de reinicios, difícil elegir timeout correcto."]})})]})}),e.jsx(ue,{value:"banquero",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Algoritmo del Banquero (Dijkstra)"}),e.jsx("p",{className:"text-gray-300",children:"Verifica que cada asignación de recursos deje al sistema en un estado seguro. Un estado es seguro si existe al menos una secuencia de ejecución donde todos los procesos pueden terminar."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Algoritmo del Banquero

ESTRUCTURA EstadoSistema:
    disponible[]        // Recursos disponibles
    maximo[][]          // Máximo que necesita cada proceso
    asignacion[][]      // Recursos ya asignados
    necesidad[][]       // Recursos que aún necesita (maximo - asignacion)
FIN ESTRUCTURA

FUNCION es_estado_seguro(estado):
    trabajo = COPIAR(estado.disponible)
    terminado[] = [FALSO, FALSO, ..., FALSO]  // Para cada proceso
    secuencia_segura = []
    
    // Intentar encontrar secuencia donde todos terminan
    REPETIR:
        encontro_proceso = FALSO
        
        PARA i = 0 HASTA num_procesos - 1:
            SI NO terminado[i]:
                // Verificar si puede ejecutar con recursos disponibles
                puede_ejecutar = VERDADERO
                
                PARA j = 0 HASTA num_recursos - 1:
                    SI estado.necesidad[i][j] > trabajo[j]:
                        puede_ejecutar = FALSO
                        SALIR
                    FIN SI
                FIN PARA
                
                SI puede_ejecutar:
                    // Simular que el proceso termina y libera recursos
                    PARA j = 0 HASTA num_recursos - 1:
                        trabajo[j] = trabajo[j] + estado.asignacion[i][j]
                    FIN PARA
                    
                    terminado[i] = VERDADERO
                    AGREGAR(secuencia_segura, i)
                    encontro_proceso = VERDADERO
                FIN SI
            FIN SI
        FIN PARA
        
    HASTA QUE NO encontro_proceso O TODOS(terminado)
    
    SI TODOS(terminado):
        IMPRIMIR "Estado seguro. Secuencia:", secuencia_segura
        RETORNAR VERDADERO
    SINO:
        IMPRIMIR "Estado INSEGURO - posible deadlock"
        RETORNAR FALSO
    FIN SI
FIN FUNCION

FUNCION solicitar_recursos(proceso_id, solicitud[]):
    // 1. Verificar que no exceda necesidad
    PARA i = 0 HASTA num_recursos - 1:
        SI solicitud[i] > estado.necesidad[proceso_id][i]:
            ERROR "Proceso excede su máximo declarado"
        FIN SI
    FIN PARA
    
    // 2. Verificar disponibilidad
    PARA i = 0 HASTA num_recursos - 1:
        SI solicitud[i] > estado.disponible[i]:
            RETORNAR FALSO  // Esperar
        FIN SI
    FIN PARA
    
    // 3. Simular asignación
    estado_temporal = COPIAR(estado)
    PARA i = 0 HASTA num_recursos - 1:
        estado_temporal.disponible[i] -= solicitud[i]
        estado_temporal.asignacion[proceso_id][i] += solicitud[i]
        estado_temporal.necesidad[proceso_id][i] -= solicitud[i]
    FIN PARA
    
    // 4. Verificar si es seguro
    SI es_estado_seguro(estado_temporal):
        // Aplicar cambios reales
        estado = estado_temporal
        IMPRIMIR "Solicitud concedida - Estado seguro"
        RETORNAR VERDADERO
    SINO:
        IMPRIMIR "Solicitud rechazada - Estado inseguro"
        RETORNAR FALSO  // Proceso debe esperar
    FIN SI
FIN FUNCION

// Ejemplo de uso
INICIALIZAR:
    procesos = 5
    recursos = 3
    
    disponible = [10, 5, 7]
    
    maximo = [
        [7, 5, 3],   // P0
        [3, 2, 2],   // P1
        [9, 0, 2],   // P2
        [2, 2, 2],   // P3
        [4, 3, 3]    // P4
    ]
    
    asignacion = [
        [0, 1, 0],
        [2, 0, 0],
        [3, 0, 2],
        [2, 1, 1],
        [0, 0, 2]
    ]

VERIFICAR es_estado_seguro(estado_inicial)`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Garantiza prevención, permite alta utilización de recursos.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Requiere conocer máximo por adelantado, overhead computacional O(n²m), poco práctico en sistemas dinámicos."]})})]})}),e.jsx(ue,{value:"grafo",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Análisis de Grafos de Asignación de Recursos"}),e.jsx("p",{className:"text-gray-300",children:"Representa el sistema como un grafo dirigido donde los procesos y recursos son nodos. Las aristas representan asignaciones (recurso→proceso) y solicitudes (proceso→recurso)."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Grafo de Asignación de Recursos (RAG)

ESTRUCTURA Nodo:
    id: entero
    tipo: "PROCESO" | "RECURSO"
    instancias: entero  // Para recursos (cuántas instancias tiene)
FIN ESTRUCTURA

ESTRUCTURA Arista:
    desde: Nodo
    hacia: Nodo
    tipo: "SOLICITUD" | "ASIGNACION"
FIN ESTRUCTURA

ESTRUCTURA GrafoRAG:
    nodos: Lista<Nodo>
    aristas: Lista<Arista>
FIN ESTRUCTURA

// Agregar arista de solicitud: Proceso → Recurso
PROCEDIMIENTO solicitar(grafo, proceso, recurso):
    arista = NuevaArista(proceso, recurso, "SOLICITUD")
    AGREGAR(grafo.aristas, arista)
    
    // Verificar si causa ciclo
    SI detectar_ciclo(grafo):
        IMPRIMIR "⚠️ Advertencia: Ciclo detectado - posible deadlock"
    FIN SI
FIN PROCEDIMIENTO

// Agregar arista de asignación: Recurso → Proceso
PROCEDIMIENTO asignar(grafo, recurso, proceso):
    // Eliminar solicitud correspondiente
    ELIMINAR_ARISTA(proceso, recurso, "SOLICITUD")
    
    // Agregar asignación
    arista = NuevaArista(recurso, proceso, "ASIGNACION")
    AGREGAR(grafo.aristas, arista)
FIN PROCEDIMIENTO

// Liberar recurso
PROCEDIMIENTO liberar(grafo, proceso, recurso):
    ELIMINAR_ARISTA(recurso, proceso, "ASIGNACION")
FIN PROCEDIMIENTO

// Detectar ciclos usando DFS
FUNCION detectar_ciclo(grafo):
    visitado = {}
    en_pila = {}
    
    PARA CADA nodo EN grafo.nodos:
        visitado[nodo] = FALSO
        en_pila[nodo] = FALSO
    FIN PARA
    
    PARA CADA nodo EN grafo.nodos:
        SI dfs_tiene_ciclo(nodo, grafo, visitado, en_pila):
            RETORNAR VERDADERO
        FIN SI
    FIN PARA
    
    RETORNAR FALSO
FIN FUNCION

FUNCION dfs_tiene_ciclo(nodo, grafo, visitado, en_pila):
    visitado[nodo] = VERDADERO
    en_pila[nodo] = VERDADERO
    
    // Obtener vecinos (aristas salientes)
    PARA CADA arista EN grafo.aristas:
        SI arista.desde == nodo:
            vecino = arista.hacia
            
            SI NO visitado[vecino]:
                SI dfs_tiene_ciclo(vecino, grafo, visitado, en_pila):
                    RETORNAR VERDADERO
                FIN SI
            SINO SI en_pila[vecino]:
                // Encontramos un ciclo
                RETORNAR VERDADERO
            FIN SI
        FIN SI
    FIN PARA
    
    en_pila[nodo] = FALSO
    RETORNAR FALSO
FIN FUNCION

// Análisis para recursos de una sola instancia
FUNCION deadlock_en_recurso_unico(grafo):
    // Si hay ciclo, hay deadlock (recursos de 1 instancia)
    SI detectar_ciclo(grafo):
        ciclo = encontrar_ciclo(grafo)
        IMPRIMIR "DEADLOCK detectado en ciclo:", ciclo
        RETORNAR VERDADERO
    FIN SI
    RETORNAR FALSO
FIN FUNCION

// Análisis para recursos de múltiples instancias
FUNCION deadlock_en_recurso_multiple(grafo):
    // Ciclo es condición necesaria pero no suficiente
    // Usar reducción de grafo
    
    procesos_sin_espera = encontrar_procesos_que_pueden_terminar(grafo)
    
    MIENTRAS procesos_sin_espera NO_ESTA_VACIO:
        proceso = SACAR(procesos_sin_espera)
        
        // Simular que el proceso termina y libera recursos
        liberar_todos_recursos(proceso, grafo)
        
        // Ver si ahora otros procesos pueden continuar
        nuevos = encontrar_procesos_que_pueden_terminar(grafo)
        AGREGAR_TODOS(procesos_sin_espera, nuevos)
    FIN MIENTRAS
    
    // Si quedan procesos, hay deadlock
    SI grafo_tiene_aristas():
        IMPRIMIR "DEADLOCK: Procesos bloqueados restantes"
        RETORNAR VERDADERO
    FIN SI
    
    RETORNAR FALSO
FIN FUNCION

// Ejemplo de uso
grafo = NuevoGrafoRAG()

// Crear nodos
P1 = NuevoNodo(1, "PROCESO")
P2 = NuevoNodo(2, "PROCESO")
R1 = NuevoNodo(1, "RECURSO", instancias=1)
R2 = NuevoNodo(2, "RECURSO", instancias=1)

// Escenario de deadlock
asignar(grafo, R1, P1)      // P1 tiene R1
solicitar(grafo, P1, R2)    // P1 quiere R2
asignar(grafo, R2, P2)      // P2 tiene R2
solicitar(grafo, P2, R1)    // P2 quiere R1

// Detectar
SI deadlock_en_recurso_unico(grafo):
    IMPRIMIR "Ciclo: P1 → R2 → P2 → R1 → P1"
FIN SI`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Visualización clara, detección precisa, útil para debugging.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Overhead de mantener grafo, O(n) para detectar ciclos, solo detecta, no previene."]})})]})}),e.jsx(ue,{value:"ciclos",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Detectar Ciclos en Grafo de Espera"}),e.jsx("p",{className:"text-gray-300",children:"Algoritmo más ligero que mantiene solo las relaciones de espera entre procesos (wait-for graph). Ejecuta periódicamente para detectar deadlocks."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Wait-For Graph (Grafo de Espera)

// Estructura simplificada: solo procesos (no recursos)
ESTRUCTURA GrafoEspera:
    // Matriz de adyacencia: espera[i][j] = VERDADERO si Pi espera por Pj
    espera: matriz_booleana[n][n]
    procesos: conjunto_de_procesos
FIN ESTRUCTURA

// Agregar relación de espera
PROCEDIMIENTO proceso_espera_a(grafo, pi, pj):
    grafo.espera[pi][pj] = VERDADERO
    IMPRIMIR "P", pi, "ahora espera a P", pj
FIN PROCEDIMIENTO

// Eliminar relación (cuando recurso se libera)
PROCEDIMIENTO proceso_deja_esperar(grafo, pi, pj):
    grafo.espera[pi][pj] = FALSO
FIN PROCEDIMIENTO

// Detección de ciclos usando DFS
FUNCION detectar_ciclo_dfs(grafo):
    n = grafo.procesos.tamaño()
    visitado = ARREGLO_FALSO(n)
    en_camino = ARREGLO_FALSO(n)
    ciclo_encontrado = []
    
    PARA i = 0 HASTA n-1:
        SI NO visitado[i]:
            SI dfs_ciclo(i, grafo, visitado, en_camino, ciclo_encontrado):
                RETORNAR ciclo_encontrado
            FIN SI
        FIN SI
    FIN PARA
    
    RETORNAR []  // Sin ciclo
FIN FUNCION

FUNCION dfs_ciclo(nodo, grafo, visitado, en_camino, ruta):
    visitado[nodo] = VERDADERO
    en_camino[nodo] = VERDADERO
    AGREGAR(ruta, nodo)
    
    // Explorar vecinos (procesos que espera este)
    PARA vecino = 0 HASTA grafo.procesos.tamaño() - 1:
        SI grafo.espera[nodo][vecino]:  // Hay arista
            SI NO visitado[vecino]:
                SI dfs_ciclo(vecino, grafo, visitado, en_camino, ruta):
                    RETORNAR VERDADERO
                FIN SI
            SINO SI en_camino[vecino]:
                // Ciclo detectado
                AGREGAR(ruta, vecino)  // Completar el ciclo
                RETORNAR VERDADERO
            FIN SI
        FIN SI
    FIN PARA
    
    en_camino[nodo] = FALSO
    ELIMINAR_ULTIMO(ruta)
    RETORNAR FALSO
FIN FUNCION

// Detección usando algoritmo de Floyd (más eficiente para grafos densos)
FUNCION detectar_ciclo_floyd(grafo):
    n = grafo.procesos.tamaño()
    alcanzable = COPIAR(grafo.espera)  // Matriz de alcanzabilidad
    
    // Floyd-Warshall modificado
    PARA k = 0 HASTA n-1:
        PARA i = 0 HASTA n-1:
            PARA j = 0 HASTA n-1:
                alcanzable[i][j] = alcanzable[i][j] O 
                                   (alcanzable[i][k] Y alcanzable[k][j])
            FIN PARA
        FIN PARA
    FIN PARA
    
    // Verificar diagonal (si Pi puede alcanzarse a sí mismo, hay ciclo)
    procesos_en_ciclo = []
    PARA i = 0 HASTA n-1:
        SI alcanzable[i][i]:
            AGREGAR(procesos_en_ciclo, i)
        FIN SI
    FIN PARA
    
    SI procesos_en_ciclo NO_ESTA_VACIO:
        IMPRIMIR "Deadlock: Procesos", procesos_en_ciclo, "en ciclo"
        RETORNAR procesos_en_ciclo
    FIN SI
    
    RETORNAR []
FIN FUNCION

// Detector periódico de deadlock
PROCEDIMIENTO detector_periodico(grafo, intervalo_ms):
    MIENTRAS VERDADERO:
        DORMIR(intervalo_ms)
        
        ciclo = detectar_ciclo_dfs(grafo)
        
        SI ciclo NO_ESTA_VACIO:
            IMPRIMIR "🚨 DEADLOCK DETECTADO 🚨"
            IMPRIMIR "Ciclo de espera:", ciclo
            
            // Invocar recuperación
            recuperar_de_deadlock(ciclo)
        SINO:
            IMPRIMIR "✅ Sistema sin deadlock"
        FIN SI
    FIN MIENTRAS
FIN PROCEDIMIENTO

// Construcción del grafo desde asignaciones
PROCEDIMIENTO construir_grafo_espera(asignaciones, solicitudes):
    grafo = NuevoGrafoEspera()
    
    // Para cada proceso que solicita un recurso
    PARA CADA (proceso, recurso) EN solicitudes:
        // Encontrar quién tiene ese recurso
        propietario = asignaciones[recurso]
        
        SI propietario EXISTE:
            // proceso espera a propietario
            proceso_espera_a(grafo, proceso, propietario)
        FIN SI
    FIN PARA
    
    RETORNAR grafo
FIN PROCEDIMIENTO

// Ejemplo de uso
grafo = NuevoGrafoEspera(4)  // 4 procesos

// P0 espera a P1, P1 espera a P2, P2 espera a P0 (ciclo)
proceso_espera_a(grafo, 0, 1)
proceso_espera_a(grafo, 1, 2)
proceso_espera_a(grafo, 2, 0)

ciclo = detectar_ciclo_dfs(grafo)
SI ciclo EXISTE:
    IMPRIMIR "Deadlock en:", ciclo  // [0, 1, 2, 0]
FIN SI`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Más eficiente que RAG completo, O(n²) con Floyd, detección precisa.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Solo detecta (no previene), overhead de ejecución periódica, requiere recuperación manual."]})})]})}),e.jsx(ue,{value:"abortar",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Abortar Procesos"}),e.jsx("p",{className:"text-gray-300",children:"Una vez detectado el deadlock, se abortan uno o más procesos para romper el ciclo. Se usan heurísticas para minimizar el costo de abortar."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Recuperación por Aborto de Procesos

ESTRUCTURA InfoProceso:
    id: entero
    prioridad: entero
    tiempo_ejecucion: entero
    recursos_retenidos: conjunto<Recurso>
    costo_abortar: real  // Cálculo del daño de abortar
FIN ESTRUCTURA

// Estrategia 1: Abortar todos los procesos en deadlock
PROCEDIMIENTO abortar_todos(procesos_en_deadlock):
    IMPRIMIR "🔴 Abortando TODOS los procesos en deadlock"
    
    PARA CADA proceso EN procesos_en_deadlock:
        IMPRIMIR "Abortando proceso", proceso.id
        
        // Liberar recursos
        PARA CADA recurso EN proceso.recursos_retenidos:
            liberar_recurso(recurso)
        FIN PARA
        
        // Terminar proceso
        terminar_proceso(proceso)
        
        // Rollback opcional
        restaurar_checkpoint(proceso)
    FIN PARA
    
    IMPRIMIR "Deadlock resuelto - Todos los procesos abortados"
FIN PROCEDIMIENTO

// Estrategia 2: Abortar de a uno hasta romper el ciclo
PROCEDIMIENTO abortar_minimo(grafo_deadlock):
    IMPRIMIR "🟡 Abortando mínimo necesario de procesos"
    
    MIENTRAS detectar_ciclo(grafo_deadlock):
        // Seleccionar víctima con menor costo
        victima = seleccionar_victima(grafo_deadlock)
        
        IMPRIMIR "Abortando proceso", victima.id, "(costo:", victima.costo_abortar, ")"
        
        // Liberar sus recursos
        PARA CADA recurso EN victima.recursos_retenidos:
            liberar_recurso(recurso)
            
            // Actualizar grafo
            eliminar_aristas_proceso(grafo_deadlock, victima)
        FIN PARA
        
        terminar_proceso(victima)
        
        // Verificar si el deadlock se resolvió
        SI NO detectar_ciclo(grafo_deadlock):
            IMPRIMIR "✅ Deadlock resuelto con", victimas_abortadas, "proceso(s)"
            SALIR
        FIN SI
    FIN MIENTRAS
FIN PROCEDIMIENTO

// Selección de víctima basada en múltiples criterios
FUNCION seleccionar_victima(procesos):
    mejor_victima = NULO
    costo_minimo = INFINITO
    
    PARA CADA proceso EN procesos:
        costo = calcular_costo_abortar(proceso)
        
        SI costo < costo_minimo:
            costo_minimo = costo
            mejor_victima = proceso
        FIN SI
    FIN PARA
    
    RETORNAR mejor_victima
FIN FUNCION

// Cálculo de costo de abortar un proceso
FUNCION calcular_costo_abortar(proceso):
    // Factores a considerar:
    
    // 1. Prioridad (menor prioridad = menor costo)
    costo_prioridad = MAX_PRIORIDAD - proceso.prioridad
    
    // 2. Tiempo de ejecución (menos ejecutado = menor costo)
    costo_tiempo = proceso.tiempo_ejecucion
    
    // 3. Recursos retenidos (menos recursos = menor costo)
    costo_recursos = proceso.recursos_retenidos.tamaño()
    
    // 4. Progreso (menos avanzado = menor costo)
    costo_progreso = proceso.porcentaje_completado
    
    // 5. Número de veces que ya fue víctima (evitar starvation)
    costo_starvation = proceso.veces_abortado * 1000
    
    // Combinación ponderada
    costo_total = (costo_prioridad * 0.3) +
                  (costo_tiempo * 0.2) +
                  (costo_recursos * 0.2) +
                  (costo_progreso * 0.2) +
                  (costo_starvation * 0.1)
    
    RETORNAR costo_total
FIN FUNCION

// Aborto con rollback
PROCEDIMIENTO abortar_con_rollback(proceso):
    IMPRIMIR "Abortando proceso", proceso.id, "con rollback"
    
    // 1. Guardar estado de los recursos antes de liberar
    estado_recursos = guardar_estado_recursos(proceso.recursos_retenidos)
    
    // 2. Liberar recursos
    PARA CADA recurso EN proceso.recursos_retenidos:
        liberar_recurso(recurso)
    FIN PARA
    
    // 3. Restaurar proceso a checkpoint anterior
    SI proceso.tiene_checkpoint():
        proceso.restaurar_checkpoint()
        proceso.estado = "LISTO"  // Volverá a ejecutar
        IMPRIMIR "Proceso restaurado a checkpoint anterior"
    SINO:
        terminar_proceso(proceso)
        IMPRIMIR "Proceso terminado (sin checkpoint)"
    FIN SI
    
    // 4. Incrementar contador de abortos (prevenir starvation)
    proceso.veces_abortado += 1
    
    SI proceso.veces_abortado > LIMITE_ABORTOS:
        IMPRIMIR "⚠️ Proceso", proceso.id, "abortado demasiadas veces"
        proceso.prioridad += 10  // Aumentar prioridad para evitar starvation
    FIN SI
FIN PROCEDIMIENTO

// Manejo de efectos en cascada
PROCEDIMIENTO abortar_con_dependencias(proceso):
    dependientes = encontrar_procesos_dependientes(proceso)
    
    SI dependientes NO_ESTA_VACIO:
        IMPRIMIR "⚠️ Proceso tiene", dependientes.tamaño(), "dependientes"
        
        // Opción 1: Abortar todos
        PARA CADA dep EN dependientes:
            abortar_con_rollback(dep)
        FIN PARA
        
        // Opción 2: Invalidar resultados
        // marcar_datos_invalidos(dependientes)
    FIN SI
    
    abortar_con_rollback(proceso)
FIN PROCEDIMIENTO

// Ejemplo de recuperación
PROCEDIMIENTO ejemplo_recuperacion():
    grafo = detectar_deadlock()
    
    SI grafo.tiene_ciclo:
        procesos_bloqueados = grafo.obtener_procesos_en_ciclo()
        
        // Estrategia seleccionable
        ELEGIR estrategia:
            CASO "MINIMO":
                abortar_minimo(procesos_bloqueados)
            CASO "TODOS":
                abortar_todos(procesos_bloqueados)
            CASO "POR_PRIORIDAD":
                victima = proceso_menor_prioridad(procesos_bloqueados)
                abortar_con_rollback(victima)
        FIN ELEGIR
    FIN SI
FIN PROCEDIMIENTO`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Recuperación rápida, simple de implementar, efectivo para romper deadlocks.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Pérdida de trabajo, posible starvation, efectos en cascada, difícil elegir víctima óptima."]})})]})}),e.jsx(ue,{value:"rollback",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Rollback de Transacciones"}),e.jsx("p",{className:"text-gray-300",children:"En lugar de abortar completamente, se deshacen las operaciones hasta un punto seguro (checkpoint). Común en bases de datos y sistemas transaccionales."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Rollback con Checkpoints

ESTRUCTURA Checkpoint:
    id: entero
    tiempo: marca_temporal
    estado_variables: mapa<string, valor>
    recursos_retenidos: conjunto<Recurso>
    puntero_ejecucion: direccion_memoria
FIN ESTRUCTURA

ESTRUCTURA Transaccion:
    id: entero
    checkpoints: pila<Checkpoint>
    log_operaciones: lista<Operacion>
    estado: "ACTIVA" | "ABORTADA" | "COMPROMETIDA"
FIN ESTRUCTURA

// Crear checkpoint antes de operaciones críticas
PROCEDIMIENTO crear_checkpoint(transaccion):
    checkpoint = NuevoCheckpoint()
    checkpoint.id = generar_id()
    checkpoint.tiempo = TIEMPO_ACTUAL()
    
    // Guardar estado completo
    checkpoint.estado_variables = COPIAR(transaccion.variables)
    checkpoint.recursos_retenidos = COPIAR(transaccion.recursos)
    checkpoint.puntero_ejecucion = OBTENER_PC()
    
    APILAR(transaccion.checkpoints, checkpoint)
    
    IMPRIMIR "💾 Checkpoint", checkpoint.id, "creado para T", transaccion.id
    RETORNAR checkpoint.id
FIN PROCEDIMIENTO

// Rollback a checkpoint específico
PROCEDIMIENTO rollback_a_checkpoint(transaccion, checkpoint_id):
    IMPRIMIR "⏪ Iniciando rollback de T", transaccion.id, "a checkpoint", checkpoint_id
    
    // Deshacer operaciones hasta el checkpoint
    MIENTRAS transaccion.checkpoints NO_ESTA_VACIO:
        cp = DESAPILAR(transaccion.checkpoints)
        
        SI cp.id == checkpoint_id:
            // Restaurar estado
            transaccion.variables = cp.estado_variables
            transaccion.recursos = cp.recursos_retenidos
            SALTAR_A(cp.puntero_ejecucion)
            
            IMPRIMIR "✅ Rollback completado a checkpoint", checkpoint_id
            RETORNAR VERDADERO
        SINO:
            // Liberar recursos del checkpoint descartado
            liberar_recursos(cp.recursos_retenidos)
        FIN SI
    FIN MIENTRAS
    
    IMPRIMIR "❌ Checkpoint no encontrado"
    RETORNAR FALSO
FIN PROCEDIMIENTO

// Rollback completo (abortar transacción)
PROCEDIMIENTO rollback_completo(transaccion):
    IMPRIMIR "🔴 Rollback completo de T", transaccion.id
    
    // Deshacer todas las operaciones en orden inverso
    PARA CADA operacion EN REVERSA(transaccion.log_operaciones):
        deshacer_operacion(operacion)
    FIN PARA
    
    // Liberar todos los recursos
    PARA CADA recurso EN transaccion.recursos:
        liberar_recurso(recurso)
    FIN PARA
    
    // Limpiar checkpoints
    transaccion.checkpoints.limpiar()
    transaccion.log_operaciones.limpiar()
    
    transaccion.estado = "ABORTADA"
    IMPRIMIR "Transacción abortada - Estado inicial restaurado"
FIN PROCEDIMIENTO

// Sistema de log para operaciones
PROCEDIMIENTO log_operacion(transaccion, operacion):
    entrada_log = {
        tipo: operacion.tipo,
        dato_anterior: operacion.valor_viejo,
        dato_nuevo: operacion.valor_nuevo,
        recurso: operacion.recurso,
        timestamp: TIEMPO_ACTUAL()
    }
    
    AGREGAR(transaccion.log_operaciones, entrada_log)
FIN PROCEDIMIENTO

// Deshacer una operación específica
PROCEDIMIENTO deshacer_operacion(log_entrada):
    ELEGIR log_entrada.tipo:
        CASO "ESCRIBIR":
            // Restaurar valor anterior
            escribir(log_entrada.recurso, log_entrada.dato_anterior)
            
        CASO "MODIFICAR":
            restaurar(log_entrada.recurso, log_entrada.dato_anterior)
            
        CASO "INSERTAR":
            // Eliminar lo insertado
            eliminar(log_entrada.recurso, log_entrada.dato_nuevo)
            
        CASO "ELIMINAR":
            // Re-insertar lo eliminado
            insertar(log_entrada.recurso, log_entrada.dato_anterior)
    FIN ELEGIR
FIN PROCEDIMIENTO

// Recuperación de deadlock con rollback selectivo
PROCEDIMIENTO recuperar_deadlock_con_rollback(transacciones_bloqueadas):
    // Seleccionar víctima
    victima = seleccionar_transaccion_victima(transacciones_bloqueadas)
    
    IMPRIMIR "Víctima seleccionada: T", victima.id
    
    // Intentar rollback parcial primero
    SI victima.checkpoints.tamaño() > 0:
        checkpoint_mas_reciente = victima.checkpoints.tope()
        
        // Rollback al checkpoint antes de solicitar recurso conflictivo
        SI rollback_a_checkpoint(victima, checkpoint_mas_reciente.id):
            // Reintentar desde checkpoint
            IMPRIMIR "Reintentando desde checkpoint"
            reanudar_transaccion(victima)
            RETORNAR
        FIN SI
    FIN SI
    
    // Si rollback parcial falla, hacer rollback completo
    IMPRIMIR "Rollback parcial no posible - Abortando transacción completa"
    rollback_completo(victima)
FIN PROCEDIMIENTO

// Selección de víctima para rollback
FUNCION seleccionar_transaccion_victima(transacciones):
    mejor_victima = NULO
    costo_minimo = INFINITO
    
    PARA CADA trans EN transacciones:
        // Factores de costo
        trabajo_realizado = trans.log_operaciones.tamaño()
        tiempo_ejecucion = TIEMPO_ACTUAL() - trans.tiempo_inicio
        num_rollbacks_previos = trans.contador_rollbacks
        
        // Priorizar transacciones con menos trabajo
        costo = trabajo_realizado * 0.4 +
                tiempo_ejecucion * 0.3 +
                num_rollbacks_previos * 0.3
        
        SI costo < costo_minimo:
            costo_minimo = costo
            mejor_victima = trans
        FIN SI
    FIN PARA
    
    mejor_victima.contador_rollbacks += 1
    RETORNAR mejor_victima
FIN FUNCION

// Ejemplo: Transacción bancaria con checkpoints
PROCEDIMIENTO transferencia_bancaria(origen, destino, monto):
    trans = nueva_transaccion()
    
    // Checkpoint inicial
    cp0 = crear_checkpoint(trans)
    
    // Adquirir cuenta origen
    adquirir_lock(origen)
    log_operacion(trans, {tipo: "LOCK", recurso: origen})
    
    // Checkpoint después de primer lock
    cp1 = crear_checkpoint(trans)
    
    // Adquirir cuenta destino (posible deadlock aquí)
    SI NO adquirir_lock_timeout(destino, 5.segundos()):
        IMPRIMIR "Timeout - Posible deadlock"
        rollback_a_checkpoint(trans, cp1)  // Liberar origen
        DORMIR(aleatorio(100, 500))        // Backoff
        REINTENTAR
    FIN SI
    
    // Realizar transferencia
    origen.saldo -= monto
    log_operacion(trans, {tipo: "ESCRIBIR", recurso: origen, 
                         dato_anterior: origen.saldo + monto})
    
    destino.saldo += monto
    log_operacion(trans, {tipo: "ESCRIBIR", recurso: destino,
                         dato_anterior: destino.saldo - monto})
    
    // Commit
    trans.estado = "COMPROMETIDA"
    liberar_lock(origen)
    liberar_lock(destino)
    
    IMPRIMIR "✅ Transferencia completada"
FIN PROCEDIMIENTO`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Preserva trabajo parcial, recuperación flexible, mantiene consistencia, útil en BD.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Overhead de checkpoints, espacio para logs, complejidad de implementación, posible starvation."]})})]})})]})})]}),e.jsxs(sa,{value:"demostracion",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"size-5"}),e.jsx("span",{children:"Demostración Interactiva"})]})}),e.jsx(na,{children:e.jsx(l2,{})})]})]})]})]})}function l2(){const[s,o]=c.useState("sin-solucion"),[n,l]=c.useState(!1),[d,m]=c.useState(!1),[h,x]=c.useState([]),[g,b]=c.useState([]),[v,f]=c.useState([]),[N,j]=c.useState(4),[_,w]=c.useState(4),[C,E]=c.useState([50]),z=c.useRef(!1),P=c.useRef(!1),V=c.useRef(null),Z=c.useRef(null),oe=c.useRef(!0),O=()=>2e3-C[0]*19,T=(k,K="text-green-400")=>{f(M=>[...M,{mensaje:`[${new Date().toLocaleTimeString()}] ${k}`,color:K}])};c.useEffect(()=>{oe.current&&V.current&&V.current.scrollIntoView({behavior:"smooth"})},[v]);const ge=()=>{if(!Z.current)return;const{scrollTop:k,scrollHeight:K,clientHeight:M}=Z.current,D=Math.abs(K-M-k)<10;oe.current=D},J=async()=>{for(;z.current&&!P.current;)await new Promise(k=>setTimeout(k,100))},W=async k=>{await new Promise(K=>setTimeout(K,k)),await J()},ne=async()=>{T("🚀 Iniciando simulación SIN solución - Deadlock circular","text-cyan-400"),T("⚠️ Los procesos adquirirán recursos en orden que causa deadlock","text-yellow-400");for(let k=0;k<N;k++){if(P.current)return;const K=k+1,M=k+1;x(D=>D.map(q=>q.id===K?{...q,estado:"Adquiriendo recurso",color:"bg-green-600",colorText:"text-green-400"}:q)),b(D=>D.map(q=>q.id===M?{...q,disponible:!1,propietario:K}:q)),x(D=>D.map(q=>q.id===K?{...q,recursosRetenidos:[M]}:q)),T(`Proceso ${K}: ✅ Adquirió recurso R${M}`,"text-green-400"),await W(O()*.5)}T("─".repeat(50),"text-gray-600");for(let k=0;k<N;k++){if(P.current)return;const K=k+1,M=(k+1)%N+1;x(D=>D.map(q=>q.id===K?{...q,estado:`Esperando R${M}`,color:"bg-red-600",colorText:"text-red-400",recursosSolicitados:[M]}:q)),T(`Proceso ${K}: 🔒 Solicitando R${M} (ocupado por P${g[M-1]?.propietario})`,"text-red-400"),await W(O()*.3)}T("─".repeat(50),"text-gray-600"),T("🚨 DEADLOCK DETECTADO: Espera circular","text-red-400"),T("P1 espera R2 (tiene P2) → P2 espera R3 (tiene P3) → P3 espera R4 (tiene P4) → P4 espera R1 (tiene P1)","text-red-300"),T("❌ Sistema bloqueado permanentemente","text-red-400")},Ee=async()=>{T("🚀 Iniciando simulación con ORDEN GLOBAL de recursos","text-cyan-400"),T("📋 Regla: Todos los procesos adquieren recursos en orden ascendente","text-blue-400");const k=[[1,2],[2,3],[1,3],[2,4]];for(let K=0;K<Math.min(N,k.length);K++){if(P.current)return;const M=K+1,D=k[K].sort((q,G)=>q-G);x(q=>q.map(G=>G.id===M?{...G,estado:"Ordenando solicitudes",color:"bg-yellow-600",colorText:"text-yellow-400"}:G)),T(`Proceso ${M}: Necesita ${D.map(q=>`R${q}`).join(", ")}`,"text-gray-400"),await W(O()*.3);for(const q of D){for(x(G=>G.map(be=>be.id===M?{...be,estado:`Esperando R${q}`,color:"bg-yellow-600",colorText:"text-yellow-400"}:be));!g[q-1]?.disponible;)if(T(`Proceso ${M}: ⏳ Esperando R${q}...`,"text-yellow-300"),await W(O()*.5),P.current)return;b(G=>G.map(be=>be.id===q?{...be,disponible:!1,propietario:M}:be)),x(G=>G.map(be=>be.id===M?{...be,recursosRetenidos:[...be.recursosRetenidos,q]}:be)),T(`Proceso ${M}: ✅ Adquirió R${q} en orden`,"text-green-400"),await W(O()*.3)}x(q=>q.map(G=>G.id===M?{...G,estado:"Trabajando",color:"bg-blue-600",colorText:"text-blue-400"}:G)),await W(O()*.8);for(const q of D.reverse())b(G=>G.map(be=>be.id===q?{...be,disponible:!0,propietario:null}:be)),T(`Proceso ${M}: 🔓 Liberó R${q}`,"text-cyan-400");x(q=>q.map(G=>G.id===M?{...G,estado:"Terminado",color:"bg-gray-800",colorText:"text-gray-500",recursosRetenidos:[]}:G)),T(`Proceso ${M}: ✅ Terminado sin deadlock`,"text-green-400"),await W(O()*.2)}T("─".repeat(50),"text-gray-600"),T("✅ Todos los procesos completados SIN deadlock","text-green-400"),T("🎯 El orden global evitó la espera circular","text-blue-400")},Ce=async()=>{T("🚀 Iniciando simulación: Adquirir TODOS o NINGUNO","text-cyan-400"),T("📋 Regla: Intento atómico - si falla alguno, libera todo","text-blue-400");const k=[[1,2],[2,3],[1,4],[3,4]];for(let K=0;K<Math.min(N,k.length);K++){if(P.current)return;const M=K+1,D=k[K];let q=0,G=!1;for(;!G&&q<5;){if(q++,x(Ne=>Ne.map(R=>R.id===M?{...R,estado:`Intento ${q}`,color:"bg-yellow-600",colorText:"text-yellow-400"}:R)),T(`Proceso ${M}: 🎯 Intento ${q} - Solicitando ${D.map(Ne=>`R${Ne}`).join(", ")}`,"text-yellow-400"),D.every(Ne=>g[Ne-1]?.disponible)){for(const Ne of D)b(R=>R.map(ke=>ke.id===Ne?{...ke,disponible:!1,propietario:M}:ke));x(Ne=>Ne.map(R=>R.id===M?{...R,recursosRetenidos:D,estado:"Trabajando",color:"bg-green-600",colorText:"text-green-400"}:R)),T(`Proceso ${M}: ✅ Adquirió TODOS los recursos atómicamente`,"text-green-400"),G=!0,await W(O()*1.2);for(const Ne of D)b(R=>R.map(ke=>ke.id===Ne?{...ke,disponible:!0,propietario:null}:ke));x(Ne=>Ne.map(R=>R.id===M?{...R,estado:"Terminado",color:"bg-gray-800",colorText:"text-gray-500",recursosRetenidos:[]}:R)),T(`Proceso ${M}: ✅ Completado y recursos liberados`,"text-cyan-400")}else T(`Proceso ${M}: ❌ No todos disponibles - Abortando intento`,"text-red-400"),await W(O()*.5);await W(O()*.3)}}T("─".repeat(50),"text-gray-600"),T("✅ Simulación completada - No hubo deadlock","text-green-400"),T("🎯 La adquisición atómica evitó hold-and-wait","text-blue-400")},Le=async()=>{T("🚀 Iniciando simulación con TIMEOUTS","text-cyan-400"),T("⏱️ Timeout: 2 segundos por recurso","text-blue-400");for(let k=0;k<Math.min(N,3);k++){if(P.current)return;const K=k+1,M=k+1,D=(k+1)%_+1;for(x(be=>be.map(Ne=>Ne.id===K?{...Ne,estado:`Adquiriendo R${M}`,color:"bg-green-600",colorText:"text-green-400"}:Ne));!g[M-1]?.disponible;)if(await W(100),P.current)return;b(be=>be.map(Ne=>Ne.id===M?{...Ne,disponible:!1,propietario:K}:Ne)),x(be=>be.map(Ne=>Ne.id===K?{...Ne,recursosRetenidos:[M]}:Ne)),T(`Proceso ${K}: ✅ Adquirió R${M}`,"text-green-400"),await W(O()*.3),x(be=>be.map(Ne=>Ne.id===K?{...Ne,estado:`Timeout en R${D}`,color:"bg-yellow-600",colorText:"text-yellow-400"}:Ne));let q=0;const G=3;for(;!g[D-1]?.disponible&&q<G;)T(`Proceso ${K}: ⏱️ Esperando R${D}... (${q+1}/${G})`,"text-yellow-300"),await W(O()*.4),q++;q>=G?(T(`Proceso ${K}: ⏰ TIMEOUT - Liberando R${M} y reintentando`,"text-red-400"),b(be=>be.map(Ne=>Ne.id===M?{...Ne,disponible:!0,propietario:null}:Ne)),x(be=>be.map(Ne=>Ne.id===K?{...Ne,recursosRetenidos:[],estado:"Reintentando",color:"bg-orange-600",colorText:"text-orange-400"}:Ne)),await W(O()*.8)):(b(be=>be.map(Ne=>Ne.id===D?{...Ne,disponible:!1,propietario:K}:Ne)),x(be=>be.map(Ne=>Ne.id===K?{...Ne,recursosRetenidos:[M,D],estado:"Trabajando",color:"bg-blue-600",colorText:"text-blue-400"}:Ne)),T(`Proceso ${K}: ✅ Adquirió ambos recursos`,"text-green-400"),await W(O()),b(be=>be.map(Ne=>Ne.id===M||Ne.id===D?{...Ne,disponible:!0,propietario:null}:Ne)),x(be=>be.map(Ne=>Ne.id===K?{...Ne,estado:"Terminado",color:"bg-gray-800",colorText:"text-gray-500",recursosRetenidos:[]}:Ne)),T(`Proceso ${K}: ✅ Terminado`,"text-cyan-400")),await W(O()*.2)}T("─".repeat(50),"text-gray-600"),T("✅ Timeouts evitaron deadlock permanente","text-green-400")},I=async()=>{T("🚀 Iniciando simulación: Algoritmo del BANQUERO","text-cyan-400"),T("🏦 Verificando estado seguro antes de cada asignación","text-blue-400");const k=[2,2,2],K=[[3,2,1],[2,3,2],[2,2,3]],M=[[0,0,0],[0,0,0],[0,0,0]];T(`Recursos disponibles: [${k.join(", ")}]`,"text-gray-400");for(let D=0;D<3;D++){if(P.current)return;const q=D+1,G=K[D];x(Ne=>Ne.map(R=>R.id===q?{...R,estado:"Solicitando recursos",color:"bg-yellow-600",colorText:"text-yellow-400"}:R)),T(`Proceso ${q}: Solicita [${G.join(", ")}]`,"text-yellow-400"),await W(O()*.5),G.every((Ne,R)=>Ne<=k[R])?(T(`Proceso ${q}: ✅ Estado SEGURO - Asignación aprobada`,"text-green-400"),x(Ne=>Ne.map(R=>R.id===q?{...R,estado:"Ejecutando",color:"bg-green-600",colorText:"text-green-400"}:R)),G.forEach((Ne,R)=>{k[R]-=Ne,M[D][R]=Ne}),T(`Recursos disponibles ahora: [${k.join(", ")}]`,"text-gray-400"),await W(O()),G.forEach((Ne,R)=>{k[R]+=Ne}),x(Ne=>Ne.map(R=>R.id===q?{...R,estado:"Terminado",color:"bg-gray-800",colorText:"text-gray-500"}:R)),T(`Proceso ${q}: ✅ Completado - Recursos liberados`,"text-cyan-400")):(T(`Proceso ${q}: ⚠️ Estado INSEGURO - Solicitud RECHAZADA`,"text-red-400"),x(Ne=>Ne.map(R=>R.id===q?{...R,estado:"Esperando",color:"bg-orange-600",colorText:"text-orange-400"}:R))),await W(O()*.3)}T("─".repeat(50),"text-gray-600"),T("✅ El banquero garantizó estado seguro - Sin deadlock","text-green-400")},Q=async()=>{T("🚀 Iniciando simulación: DETECCIÓN DE CICLOS","text-cyan-400"),T("🔍 Monitoreando grafo de espera en tiempo real","text-blue-400");const k=[{proceso:1,recurso:1},{proceso:2,recurso:2},{proceso:3,recurso:3}];for(const{proceso:M,recurso:D}of k)b(q=>q.map(G=>G.id===D?{...G,disponible:!1,propietario:M}:G)),x(q=>q.map(G=>G.id===M?{...G,recursosRetenidos:[D]}:G)),T(`Proceso ${M}: Tiene R${D}`,"text-green-400"),await W(O()*.3);T("─".repeat(50),"text-gray-600"),T("🔄 Creando dependencias circulares...","text-yellow-400");const K=[{proceso:1,recurso:2},{proceso:2,recurso:3},{proceso:3,recurso:1}];for(const{proceso:M,recurso:D}of K){x(G=>G.map(be=>be.id===M?{...be,estado:`Esperando R${D}`,color:"bg-red-600",colorText:"text-red-400",recursosSolicitados:[D]}:be));const q=g[D-1]?.propietario;T(`Proceso ${M}: 🔒 Espera R${D} (lo tiene P${q})`,"text-red-400"),await W(O()*.4)}T("─".repeat(50),"text-gray-600"),T("🔍 Ejecutando detector de ciclos DFS...","text-yellow-400"),await W(O()*.8),T("🚨 CICLO DETECTADO:","text-red-400"),T("P1 → R2 (P2) → P2 → R3 (P3) → P3 → R1 (P1) → [CICLO]","text-red-300"),T("💡 Acción: Abortar P1 para romper el ciclo","text-yellow-400"),await W(O()),b(M=>M.map(D=>D.id===1?{...D,disponible:!0,propietario:null}:D)),x(M=>M.map(D=>D.id===1?{...D,estado:"Abortado",color:"bg-gray-800",colorText:"text-gray-500",recursosRetenidos:[],recursosSolicitados:[]}:D)),T("Proceso 1: ❌ ABORTADO - R1 liberado","text-orange-400"),await W(O()*.5),T("─".repeat(50),"text-gray-600"),T("✅ Ciclo roto - P3 puede continuar","text-green-400")},F=async()=>{switch(P.current=!1,z.current=!1,l(!0),m(!1),f([]),se(),await W(300),s){case"sin-solucion":await ne();break;case"ordenar":await Ee();break;case"todos":await Ce();break;case"timeout":await Le();break;case"banquero":await I();break;case"ciclos":await Q();break;case"abortar":await Q();break;case"rollback":T("🚧 Demostración de Rollback en construcción","text-yellow-400");break}P.current||T("🏁 Simulación completada","text-cyan-400"),l(!1),m(!1)},de=()=>{z.current=!z.current,m(!d),z.current?T("⏸️ Simulación pausada","text-yellow-400"):T("▶️ Simulación reanudada","text-green-400")},ze=()=>{P.current=!0,z.current=!1,l(!1),m(!1),f([]),se()},A=k=>{const K=Math.max(3,Math.min(6,N+k));j(K)},$=k=>{const K=Math.max(3,Math.min(6,_+k));w(K)},se=c.useCallback(()=>{const k=Array.from({length:N},(M,D)=>({id:D+1,estado:"Iniciando",color:"bg-blue-600",colorText:"text-blue-400",recursosRetenidos:[],recursosSolicitados:[]}));x(k);const K=Array.from({length:_},(M,D)=>({id:D+1,nombre:`R${D+1}`,disponible:!0,propietario:null}));b(K)},[N,_]);return c.useEffect(()=>{se()},[se]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"⚙️ Configuración de la Simulación"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Número de Procesos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>A(-1),disabled:n||N<=3,className:"p-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed rounded",children:e.jsx(go,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:N}),e.jsx("div",{className:"text-xs text-gray-400",children:"Min: 3, Max: 6"})]}),e.jsx("button",{onClick:()=>A(1),disabled:n||N>=6,className:"p-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed rounded",children:e.jsx(dr,{className:"size-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Velocidad de Simulación"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(dt,{value:C,onValueChange:E,max:100,step:1,disabled:n,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[e.jsx("span",{children:"Lenta"}),e.jsxs("span",{className:"font-bold text-white",children:[C[0],"%"]}),e.jsx("span",{children:"Rápida"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Número de Recursos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>$(-1),disabled:n||_<=3,className:"p-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed rounded",children:e.jsx(go,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:_}),e.jsx("div",{className:"text-xs text-gray-400",children:"Min: 3, Max: 6"})]}),e.jsx("button",{onClick:()=>$(1),disabled:n||_>=6,className:"p-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed rounded",children:e.jsx(dr,{className:"size-4"})})]})]})]})]}),e.jsxs(ia,{value:s,onValueChange:o,className:"w-full",children:[e.jsxs(Qt,{className:"w-full justify-start flex-wrap h-auto gap-2 bg-gray-900 p-2",children:[e.jsx(le,{value:"sin-solucion",children:"❌ Sin Solución"}),e.jsx(le,{value:"ordenar",children:"🔢 Ordenar"}),e.jsx(le,{value:"todos",children:"⚛️ Todos/Ninguno"}),e.jsx(le,{value:"timeout",children:"⏱️ Timeout"}),e.jsx(le,{value:"banquero",children:"🏦 Banquero"}),e.jsx(le,{value:"ciclos",children:"🔍 Ciclos"}),e.jsx(le,{value:"abortar",children:"🔴 Abortar"}),e.jsx(le,{value:"rollback",children:"⏪ Rollback"})]}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:F,disabled:n&&!d,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:[e.jsx(nt,{className:"size-5"}),n&&d?"Continuar Demostración":"Ejecutar Demostración"]}),n&&e.jsxs("button",{onClick:de,className:"flex items-center gap-2 bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:[e.jsx(ct,{className:"size-5"}),d?"Reanudar":"Pausar"]}),e.jsxs("button",{onClick:ze,disabled:!n&&v.length===0,className:"flex items-center gap-2 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-800 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:[e.jsx(it,{className:"size-5"}),"Reiniciar"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Estado de Procesos"}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:h.map(k=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`size-3 rounded-full ${k.color} animate-pulse flex-shrink-0`}),e.jsxs("span",{className:"text-white font-mono text-sm w-16",children:["P",k.id,":"]}),e.jsx("span",{className:`${k.colorText} text-sm`,children:k.estado})]}),k.recursosRetenidos.length>0&&e.jsxs("div",{className:"ml-10 text-xs text-gray-400",children:["Tiene: ",k.recursosRetenidos.map(K=>`R${K}`).join(", ")]}),k.recursosSolicitados.length>0&&e.jsxs("div",{className:"ml-10 text-xs text-yellow-400",children:["Solicita: ",k.recursosSolicitados.map(K=>`R${K}`).join(", ")]})]},k.id))})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Estado de Recursos"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:g.map(k=>e.jsxs("div",{className:`p-3 rounded border ${k.disponible?"bg-green-900/30 border-green-700":"bg-red-900/30 border-red-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-mono font-bold text-white",children:k.nombre}),e.jsx("div",{className:`size-3 rounded-full ${k.disponible?"bg-green-500":"bg-red-500"}`})]}),e.jsx("div",{className:"text-xs mt-1 text-gray-400",children:k.disponible?"Libre":`P${k.propietario}`})]},k.id))})]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Logs de Ejecución"}),e.jsx("div",{ref:Z,onScroll:ge,className:"bg-black rounded p-4 h-[500px] overflow-y-auto font-mono text-sm",children:v.length===0?e.jsx("div",{className:"text-gray-500 text-center mt-8",children:'Selecciona un algoritmo y presiona "Ejecutar"'}):e.jsxs(e.Fragment,{children:[v.map((k,K)=>e.jsx("div",{className:`${k.color} mb-1`,children:k.mensaje},K)),e.jsx("div",{ref:V})]})})]})]}),e.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-6",children:[e.jsxs("h4",{className:"font-bold text-blue-200 mb-2",children:[s==="sin-solucion"&&"❌ Deadlock Clásico",s==="ordenar"&&"🔢 Orden Global de Recursos",s==="todos"&&"⚛️ Adquisición Atómica",s==="timeout"&&"⏱️ Timeouts con Reintentos",s==="banquero"&&"🏦 Algoritmo del Banquero",s==="ciclos"&&"🔍 Detección de Ciclos",s==="abortar"&&"🔴 Abortar Procesos",s==="rollback"&&"⏪ Rollback de Transacciones"]}),e.jsxs("p",{className:"text-sm text-blue-100",children:[s==="sin-solucion"&&"Los procesos adquieren recursos sin orden, creando una espera circular (P1→P2→P3→P4→P1). Las 4 condiciones de Coffman se cumplen, resultando en deadlock permanente.",s==="ordenar"&&"Todos los procesos adquieren recursos en orden numérico ascendente. Esto rompe la condición de espera circular, garantizando que no puede formarse un ciclo de dependencias.",s==="todos"&&"Los procesos intentan adquirir TODOS los recursos necesarios de forma atómica. Si alguno no está disponible, no adquieren ninguno. Rompe la condición de hold-and-wait.",s==="timeout"&&"Los procesos esperan por recursos con un tiempo límite. Si expira el timeout, liberan los recursos que tienen y reintentan después. Evita deadlocks permanentes mediante recuperación automática.",s==="banquero"&&"Antes de cada asignación, el sistema verifica que quedará en un estado seguro (existe una secuencia donde todos los procesos pueden terminar). Solo asigna si es seguro.",s==="ciclos"&&"El sistema monitorea el grafo de espera en tiempo real. Cuando detecta un ciclo usando DFS, identifica el deadlock y toma acción correctiva (ej: abortar un proceso del ciclo).",s==="abortar"&&'Cuando se detecta deadlock, se selecciona una "víctima" (proceso con menor costo) y se aborta para romper el ciclo. Los recursos liberados permiten que los demás procesos continúen.',s==="rollback"&&"En lugar de abortar completamente, los procesos pueden retroceder a un checkpoint previo, liberando recursos parcialmente. Útil en sistemas transaccionales para minimizar pérdida de trabajo."]})]})]})]})]})}const c2=Sa("/ActividadesSeminarioSO/actividad11/deadlock")({component:i2});function d2(){const[s,o]=c.useState(!1),[n,l]=c.useState(500),[d,m]=c.useState(0),[h,x]=c.useState([{id:1,state:"waiting",priority:5,type:"spinlock"},{id:2,state:"waiting",priority:3,type:"spinlock"},{id:3,state:"waiting",priority:8,type:"mutex"},{id:4,state:"waiting",priority:2,type:"mutex"}]),[g,b]=c.useState({spinlock:0,mutex:0}),[v,f]=c.useState([]),[N,j]=c.useState(!1),[_,w]=c.useState(500),[C,E]=c.useState(0),[z,P]=c.useState([{id:1,name:"Low",priority:10,effectivePriority:10,state:"waiting",hasLock:!1},{id:2,name:"Medium",priority:50,effectivePriority:50,state:"waiting",hasLock:!1},{id:3,name:"High",priority:100,effectivePriority:100,state:"waiting",hasLock:!1}]),[V,Z]=c.useState(!1),[oe,O]=c.useState(!1),[T,ge]=c.useState([]),[J,W]=c.useState(!1),[ne,Ee]=c.useState(500),[Ce,Le]=c.useState(0),[I,Q]=c.useState([{id:1,name:"Thread A",state:"ready",hasLock:!1,preemptDisabled:!1,criticalSection:!1},{id:2,name:"Thread B",state:"ready",hasLock:!1,preemptDisabled:!1,criticalSection:!1}]),[F,de]=c.useState(!0),[ze,A]=c.useState(0),[$,se]=c.useState([]),[k,K]=c.useState(!1),[M,D]=c.useState(500),[q,G]=c.useState(0),[be,Ne]=c.useState([]),[R,ke]=c.useState([{id:1,operation:"push",value:10,state:"ready",casAttempts:0},{id:2,operation:"pop",value:null,state:"ready",casAttempts:0},{id:3,operation:"push",value:20,state:"ready",casAttempts:0}]),[je,ee]=c.useState(0),[ae,rt]=c.useState([]),[jt,xe]=c.useState(!1),[Me,De]=c.useState(500),[Ge,qe]=c.useState(0),[Se,Xe]=c.useState([{id:1,state:"ready",spinning:!1,blocked:!1,spinCount:0},{id:2,state:"ready",spinning:!1,blocked:!1,spinCount:0},{id:3,state:"ready",spinning:!1,blocked:!1,spinCount:0}]),[We,xt]=c.useState(null),[Ot,It]=c.useState(!1),[Ue,At]=c.useState({successful:0,failed:0}),[et,L]=c.useState([]),re=c.useRef(null),Ve=c.useRef(null),ce=c.useRef(null),Te=c.useRef(null),_t=c.useRef(null);c.useEffect(()=>{re.current?.scrollTo({top:re.current.scrollHeight,behavior:"smooth"})},[v]),c.useEffect(()=>{Ve.current?.scrollTo({top:Ve.current.scrollHeight,behavior:"smooth"})},[T]),c.useEffect(()=>{ce.current?.scrollTo({top:ce.current.scrollHeight,behavior:"smooth"})},[$]),c.useEffect(()=>{Te.current?.scrollTo({top:Te.current.scrollHeight,behavior:"smooth"})},[ae]),c.useEffect(()=>{_t.current?.scrollTo({top:_t.current.scrollHeight,behavior:"smooth"})},[et]),c.useEffect(()=>{if(!s)return;const ve=setTimeout(()=>{m(gt=>{const $e=(gt+1)%12;return $e===0?f(B=>[...B,{time:Date.now(),message:"🔄 Reiniciando simulación",type:"info"}]):$e===1?(f(B=>[...B,{time:Date.now(),message:"Thread 1 (spinlock, P=5) intenta adquirir lock",type:"info"}]),x(B=>B.map(U=>U.id===1?{...U,state:"spinning"}:U)),b({spinlock:100,mutex:0})):$e===2?(f(B=>[...B,{time:Date.now(),message:"✅ Thread 1 adquirió lock, ejecutando sección crítica",type:"success"}]),x(B=>B.map(U=>U.id===1?{...U,state:"running"}:U))):$e===3?(f(B=>[...B,{time:Date.now(),message:"⚠️ Thread 2 (spinlock, P=3) hace SPINNING (consume CPU)",type:"warning"}]),x(B=>B.map(U=>U.id===2?{...U,state:"spinning"}:U)),b({spinlock:200,mutex:0})):$e===4?(f(B=>[...B,{time:Date.now(),message:"Thread 3 (mutex, P=8) se BLOQUEA (no consume CPU)",type:"info"}]),x(B=>B.map(U=>U.id===3?{...U,state:"blocked"}:U)),b({spinlock:200,mutex:0})):$e===5?f(B=>[...B,{time:Date.now(),message:"🔄 Thread 2 sigue haciendo SPINNING (desperdicio de CPU)",type:"warning"}]):$e===6?(f(B=>[...B,{time:Date.now(),message:"Thread 1 libera lock",type:"info"}]),x(B=>B.map(U=>U.id===1?{...U,state:"finished"}:U))):$e===7?(f(B=>[...B,{time:Date.now(),message:"✅ Thread 2 adquiere lock INMEDIATAMENTE (ventaja del spinning)",type:"success"}]),x(B=>B.map(U=>U.id===2?{...U,state:"running"}:U)),b({spinlock:100,mutex:0})):$e===8?f(B=>[...B,{time:Date.now(),message:"Thread 2 ejecutando sección crítica",type:"info"}]):$e===9?(f(B=>[...B,{time:Date.now(),message:"Thread 2 libera lock",type:"info"}]),x(B=>B.map(U=>U.id===2?{...U,state:"finished"}:U))):$e===10?(f(B=>[...B,{time:Date.now(),message:"Thread 3 (mutex) despierta y adquiere lock",type:"success"}]),x(B=>B.map(U=>U.id===3?{...U,state:"running"}:U)),b({spinlock:0,mutex:0})):$e===11&&(f(B=>[...B,{time:Date.now(),message:"✅ Comparación: Spinlock = baja latencia, alto CPU | Mutex = alta latencia, bajo CPU",type:"success"}]),x(B=>B.map(U=>U.id===3?{...U,state:"finished"}:U)),b({spinlock:0,mutex:0})),$e})},n);return()=>clearTimeout(ve)},[s,d,n]),c.useEffect(()=>{if(!N)return;const ve=setTimeout(()=>{E(gt=>{const $e=(gt+1)%10;return $e===0?(ge(B=>[...B,{time:Date.now(),message:"🔄 Reiniciando simulación de Priority Inheritance",type:"info"}]),Z(!1),O(!1)):$e===1?(ge(B=>[...B,{time:Date.now(),message:"Thread Low (P=10) adquiere lock",type:"info"}]),P(B=>B.map(U=>U.id===1?{...U,state:"running",hasLock:!0}:U))):$e===2?(ge(B=>[...B,{time:Date.now(),message:"Thread Medium (P=50) ejecuta trabajo (no necesita lock)",type:"info"}]),P(B=>B.map(U=>U.id===2?{...U,state:"running"}:U))):$e===3?(ge(B=>[...B,{time:Date.now(),message:"⚠️ Thread High (P=100) intenta adquirir lock → BLOQUEADO",type:"warning"}]),P(B=>B.map(U=>U.id===3?{...U,state:"blocked"}:U)),Z(!0)):$e===4?ge(B=>[...B,{time:Date.now(),message:"🚨 INVERSIÓN DE PRIORIDAD: Medium (P=50) ejecuta, High (P=100) espera!",type:"error"}]):$e===5?(ge(B=>[...B,{time:Date.now(),message:"✅ PRIORITY INHERITANCE: Low hereda prioridad 100 de High",type:"success"}]),P(B=>B.map(U=>U.id===1?{...U,effectivePriority:100}:U)),O(!0)):$e===6?(ge(B=>[...B,{time:Date.now(),message:"Thread Low (P efectiva=100) desaloja a Medium",type:"info"}]),P(B=>B.map(U=>U.id===2?{...U,state:"ready"}:U))):$e===7?(ge(B=>[...B,{time:Date.now(),message:"Thread Low completa sección crítica y libera lock",type:"info"}]),P(B=>B.map(U=>U.id===1?{...U,state:"finished",hasLock:!1,effectivePriority:10}:U)),O(!1)):$e===8?(ge(B=>[...B,{time:Date.now(),message:"✅ Thread High adquiere lock y ejecuta",type:"success"}]),P(B=>B.map(U=>U.id===3?{...U,state:"running",hasLock:!0}:U)),Z(!1)):$e===9&&(ge(B=>[...B,{time:Date.now(),message:"✅ Priority Inheritance previno convoying prolongado",type:"success"}]),P(B=>B.map(U=>U.id===3?{...U,state:"finished",hasLock:!1}:U))),$e})},_);return()=>clearTimeout(ve)},[N,C,_]),c.useEffect(()=>{if(!J)return;const ve=setTimeout(()=>{Le(gt=>{const $e=(gt+1)%10;return $e===0?(se(B=>[...B,{time:Date.now(),message:"🔄 Reiniciando simulación de Preemption Control",type:"info"}]),A(0)):$e===1?(se(B=>[...B,{time:Date.now(),message:"Thread A adquiere lock y DESHABILITA preemption",type:"info"}]),Q(B=>B.map(U=>U.id===1?{...U,state:"running",hasLock:!0,preemptDisabled:!0,criticalSection:!0}:U)),de(!1)):$e===2?se(B=>[...B,{time:Date.now(),message:"Thread A en sección crítica (preemption disabled)",type:"info"}]):$e===3?se(B=>[...B,{time:Date.now(),message:"⏰ Timer interrupt: intento de preemption BLOQUEADO",type:"warning"}]):$e===4?se(B=>[...B,{time:Date.now(),message:"✅ Thread A NO es desalojado (previene convoying)",type:"success"}]):$e===5?(se(B=>[...B,{time:Date.now(),message:"Thread A completa sección crítica y libera lock",type:"info"}]),Q(B=>B.map(U=>U.id===1?{...U,criticalSection:!1,hasLock:!1}:U))):$e===6?(se(B=>[...B,{time:Date.now(),message:"Thread A REACTIVA preemption",type:"info"}]),Q(B=>B.map(U=>U.id===1?{...U,preemptDisabled:!1}:U)),de(!0)):$e===7?(se(B=>[...B,{time:Date.now(),message:"🔄 Context switch a Thread B",type:"info"}]),Q(B=>B.map(U=>U.id===1?{...U,state:"ready"}:U.id===2?{...U,state:"running"}:U)),A(B=>B+1)):$e===8?se(B=>[...B,{time:Date.now(),message:"Thread B ejecuta su trabajo",type:"info"}]):$e===9&&(se(B=>[...B,{time:Date.now(),message:"✅ Preemption control redujo context switches durante locks",type:"success"}]),Q(B=>B.map(U=>U.id===2?{...U,state:"finished"}:U))),$e})},ne);return()=>clearTimeout(ve)},[J,Ce,ne]),c.useEffect(()=>{if(!k)return;const ve=setTimeout(()=>{G(gt=>{const $e=(gt+1)%12;return $e===0?(rt(B=>[...B,{time:Date.now(),message:"🔄 Reiniciando simulación Lock-Free",type:"info"}]),Ne([]),ee(0)):$e===1?(rt(B=>[...B,{time:Date.now(),message:"Thread 1 intenta PUSH(10)",type:"info"}]),ke(B=>B.map(U=>U.id===1?{...U,state:"executing"}:U))):$e===2?(rt(B=>[...B,{time:Date.now(),message:"Thread 1: CAS exitoso, 10 agregado al stack",type:"success"}]),Ne([10]),ee(B=>B+1),ke(B=>B.map(U=>U.id===1?{...U,state:"finished",casAttempts:1}:U))):$e===3?(rt(B=>[...B,{time:Date.now(),message:"Thread 2 intenta POP, Thread 3 intenta PUSH(20) SIMULTÁNEAMENTE",type:"warning"}]),ke(B=>B.map(U=>U.id===2||U.id===3?{...U,state:"executing"}:U))):$e===4?(rt(B=>[...B,{time:Date.now(),message:"Thread 3: CAS exitoso, 20 agregado (Thread 2 falló CAS)",type:"success"}]),Ne([20,10]),ee(B=>B+1),ke(B=>B.map(U=>U.id===3?{...U,casAttempts:1}:U.id===2?{...U,casAttempts:1}:U))):$e===5?rt(B=>[...B,{time:Date.now(),message:"Thread 2 REINTENTA POP con nuevo top",type:"info"}]):$e===6?(rt(B=>[...B,{time:Date.now(),message:"Thread 2: CAS exitoso, POP(20) del stack",type:"success"}]),Ne([10]),ee(B=>B+1),ke(B=>B.map(U=>U.id===2?{...U,state:"finished",value:20,casAttempts:2}:U.id===3?{...U,state:"finished"}:U))):$e===7?rt(B=>[...B,{time:Date.now(),message:"✅ Stack final: [10]",type:"info"}]):$e===8?rt(B=>[...B,{time:Date.now(),message:"📊 Total CAS: "+(je+1)+" (sin locks, sin bloqueos)",type:"success"}]):$e===9?rt(B=>[...B,{time:Date.now(),message:"✅ Ventajas: No convoying, no priority inversion",type:"success"}]):$e===10?rt(B=>[...B,{time:Date.now(),message:"⚠️ Desventajas: CAS puede fallar y reintentar (Thread 2: 2 intentos)",type:"warning"}]):$e===11&&rt(B=>[...B,{time:Date.now(),message:"Lock-free elimina completamente el convoying",type:"success"}]),$e})},M);return()=>clearTimeout(ve)},[k,q,M,je]),c.useEffect(()=>{if(!jt)return;const ve=setTimeout(()=>{qe(gt=>{const $e=(gt+1)%14;if($e===0)L(B=>[...B,{time:Date.now(),message:"🔄 Reiniciando Adaptive Spinning",type:"info"}]),At({successful:0,failed:0});else if($e===1)L(B=>[...B,{time:Date.now(),message:"Thread 1 adquiere lock",type:"info"}]),Xe(B=>B.map(U=>U.id===1?{...U,state:"running"}:U)),xt(1),It(!0);else if($e===2)L(B=>[...B,{time:Date.now(),message:"Thread 2 intenta adquirir lock...",type:"info"}]);else if($e===3)L(B=>[...B,{time:Date.now(),message:"🔍 Heurística: Owner (T1) EJECUTÁNDOSE → Decisión: SPIN",type:"warning"}]),Xe(B=>B.map(U=>U.id===2?{...U,spinning:!0,spinCount:1}:U));else if($e===4)L(B=>[...B,{time:Date.now(),message:"Thread 2 hace SPINNING (esperando lock)...",type:"info"}]),Xe(B=>B.map(U=>U.id===2?{...U,spinCount:U.spinCount+1}:U));else if($e===5)L(B=>[...B,{time:Date.now(),message:"Thread 1 libera lock",type:"info"}]),Xe(B=>B.map(U=>U.id===1?{...U,state:"finished"}:U)),xt(null),It(!1);else if($e===6)L(B=>[...B,{time:Date.now(),message:"✅ Thread 2 adquiere lock INMEDIATAMENTE (spinning exitoso)",type:"success"}]),Xe(B=>B.map(U=>U.id===2?{...U,state:"running",spinning:!1}:U)),xt(2),It(!0),At(B=>({...B,successful:B.successful+1}));else if($e===7)L(B=>[...B,{time:Date.now(),message:"Thread 3 intenta adquirir lock...",type:"info"}]),It(!1);else if($e===8)L(B=>[...B,{time:Date.now(),message:"🔍 Heurística: Owner (T2) NO ejecutándose → Decisión: BLOCK",type:"warning"}]),Xe(B=>B.map(U=>U.id===3?{...U,blocked:!0}:U));else if($e===9)L(B=>[...B,{time:Date.now(),message:"Thread 3 se BLOQUEA (ahorra CPU)",type:"info"}]),At(B=>({...B,failed:B.failed+1}));else if($e===10)L(B=>[...B,{time:Date.now(),message:"Thread 2 libera lock",type:"info"}]),Xe(B=>B.map(U=>U.id===2?{...U,state:"finished"}:U)),xt(null);else if($e===11)L(B=>[...B,{time:Date.now(),message:"Thread 3 despierta y adquiere lock",type:"success"}]),Xe(B=>B.map(U=>U.id===3?{...U,state:"running",blocked:!1}:U)),xt(3);else if($e===12)Xe(B=>B.map(U=>U.id===3?{...U,state:"finished"}:U)),xt(null);else if($e===13){const{successful:B,failed:U}=Ue,Dt=B+U,Ke=Dt>0?(B/Dt*100).toFixed(0):0;L(fe=>[...fe,{time:Date.now(),message:`✅ Historial: ${B} exitosos, ${U} fallidos (${Ke}% efectividad)`,type:"success"}])}return $e})},Me);return()=>clearTimeout(ve)},[jt,Ge,Me,Ue]);const St=()=>{o(!1),m(0),x([{id:1,state:"waiting",priority:5,type:"spinlock"},{id:2,state:"waiting",priority:3,type:"spinlock"},{id:3,state:"waiting",priority:8,type:"mutex"},{id:4,state:"waiting",priority:2,type:"mutex"}]),b({spinlock:0,mutex:0}),f([])},tt=()=>{j(!1),E(0),P([{id:1,name:"Low",priority:10,effectivePriority:10,state:"waiting",hasLock:!1},{id:2,name:"Medium",priority:50,effectivePriority:50,state:"waiting",hasLock:!1},{id:3,name:"High",priority:100,effectivePriority:100,state:"waiting",hasLock:!1}]),Z(!1),O(!1),ge([])},Ye=()=>{W(!1),Le(0),Q([{id:1,name:"Thread A",state:"ready",hasLock:!1,preemptDisabled:!1,criticalSection:!1},{id:2,name:"Thread B",state:"ready",hasLock:!1,preemptDisabled:!1,criticalSection:!1}]),de(!0),A(0),se([])},ft=()=>{K(!1),G(0),Ne([]),ke([{id:1,operation:"push",value:10,state:"ready",casAttempts:0},{id:2,operation:"pop",value:null,state:"ready",casAttempts:0},{id:3,operation:"push",value:20,state:"ready",casAttempts:0}]),ee(0),rt([])},Ct=()=>{xe(!1),qe(0),Xe([{id:1,state:"ready",spinning:!1,blocked:!1,spinCount:0},{id:2,state:"ready",spinning:!1,blocked:!1,spinCount:0},{id:3,state:"ready",spinning:!1,blocked:!1,spinCount:0}]),xt(null),It(!1),At({successful:0,failed:0}),L([])};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(La,{className:"size-8 text-amber-400"}),e.jsx("h1",{className:"text-4xl font-bold",children:"Convoying — Pseudocódigos"})]}),e.jsx("p",{className:"text-lg text-gray-300 leading-relaxed",children:"Colección de pseudocódigos para las técnicas que previenen el problema de convoying (convoy effect): spinlocks, priority boosting y control de preemption. El convoying ocurre cuando threads de alta prioridad esperan por threads de baja prioridad que mantienen locks."})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsx(Da,{type:"single",defaultValue:"pseudocodigos",collapsible:!0,className:"space-y-4",children:e.jsxs(sa,{value:"pseudocodigos",className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700",children:[e.jsx(ra,{className:"px-6 py-4 hover:bg-slate-700/30 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(oa,{className:"size-6 text-blue-400"}),e.jsx("span",{className:"text-2xl font-semibold",children:"Pseudocódigos de Soluciones"})]})}),e.jsx(na,{className:"px-6 pb-6",children:e.jsxs(ia,{defaultValue:"spinlocks",className:"w-full",children:[e.jsxs(Qt,{className:"grid w-full grid-cols-5 bg-slate-900/50 p-1 rounded-lg mb-6",children:[e.jsx(le,{value:"spinlocks",className:"data-[state=active]:bg-blue-600",children:"Spinlocks"}),e.jsx(le,{value:"priority",className:"data-[state=active]:bg-blue-600",children:"Priority Boosting"}),e.jsx(le,{value:"preemption",className:"data-[state=active]:bg-blue-600",children:"Preemption Control"}),e.jsx(le,{value:"lockfree",className:"data-[state=active]:bg-blue-600",children:"Lock-Free"}),e.jsx(le,{value:"adaptive",className:"data-[state=active]:bg-blue-600",children:"Adaptive Spinning"})]}),e.jsxs(ue,{value:"spinlocks",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/30 to-slate-800/30 p-6 rounded-lg border border-blue-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-300 mb-3",children:"🔄 Solución 1: Spinlocks"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Los spinlocks utilizan busy-waiting (espera activa) en lugar de bloquear el thread. Cuando un thread intenta adquirir un lock ocupado, sigue ejecutándose en un loop verificando el estado del lock. Esto evita el overhead de context switches y es eficiente para períodos de espera cortos."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Busy-waiting sin context switches"}),e.jsx("li",{children:"• Ideal para secciones críticas cortas"}),e.jsx("li",{children:"• Usa operaciones atómicas (CAS)"}),e.jsx("li",{children:"• Evita overhead del scheduler"}),e.jsx("li",{children:"• Puede causar uso excesivo de CPU"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Spinlocks"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Spinlock básico con Test-and-Set
estructura Spinlock {
    locked: booleano atómico
}

función crear_spinlock() -> Spinlock {
    lock: Spinlock
    lock.locked = falso
    return lock
}

// Adquirir spinlock (busy-wait)
función spin_lock(lock: Spinlock) {
    mientras test_and_set(&lock.locked, verdadero) hacer
        // Busy-wait: consumir CPU hasta que el lock esté libre
        // El thread NO se bloquea ni cede el CPU
    fin mientras
    
    // Lock adquirido
    memory_barrier()  // Garantizar orden de memoria
}

// Liberar spinlock
función spin_unlock(lock: Spinlock) {
    memory_barrier()  // Garantizar que todas las escrituras sean visibles
    atomic_store(&lock.locked, falso)
}

// Test-and-Set atómico
función test_and_set(addr: puntero a booleano, nuevo_valor: booleano) -> booleano {
    // Operación atómica
    old_value = *addr
    *addr = nuevo_valor
    return old_value
}

// Spinlock mejorado con Compare-and-Swap
función spin_lock_cas(lock: Spinlock) {
    esperado = falso
    
    mientras no compare_and_swap(&lock.locked, esperado, verdadero) hacer
        esperado = falso  // Resetear para siguiente intento
        // Busy-wait
    fin mientras
    
    memory_barrier()
}

// Spinlock con exponential backoff (reduce contención)
función spin_lock_backoff(lock: Spinlock) {
    delay = DELAY_INICIAL  // ej. 10 ciclos
    max_delay = DELAY_MAXIMO  // ej. 1000 ciclos
    
    mientras test_and_set(&lock.locked, verdadero) hacer
        // Esperar con backoff exponencial
        busy_wait(delay)
        delay = min(delay * 2, max_delay)
    fin mientras
    
    memory_barrier()
}

// Spinlock con yield (híbrido)
función spin_lock_yield(lock: Spinlock) {
    intentos = 0
    max_spins = 100
    
    mientras test_and_set(&lock.locked, verdadero) hacer
        intentos++
        
        si intentos >= max_spins entonces
            // Demasiados intentos, ceder CPU
            thread_yield()
            intentos = 0
        fin si
    fin mientras
    
    memory_barrier()
}

// Test-and-Test-and-Set (reducir tráfico de bus)
función spin_lock_ttas(lock: Spinlock) {
    mientras verdadero hacer
        // Primera fase: solo leer (no escribe en el bus)
        mientras atomic_load(&lock.locked) == verdadero hacer
            cpu_relax()  // Hint al CPU (ej. PAUSE en x86)
        fin mientras
        
        // Segunda fase: intentar adquirir
        si no test_and_set(&lock.locked, verdadero) entonces
            break  // Lock adquirido
        fin si
    fin mientras
    
    memory_barrier()
}

// Ticket spinlock (garantiza fairness FIFO)
estructura TicketSpinlock {
    ticket_actual: entero atómico
    ticket_servido: entero atómico
}

función ticket_lock(lock: TicketSpinlock) {
    // Obtener ticket
    mi_ticket = atomic_fetch_add(&lock.ticket_actual, 1)
    
    // Esperar turno
    mientras atomic_load(&lock.ticket_servido) != mi_ticket hacer
        cpu_relax()
    fin mientras
    
    memory_barrier()
}

función ticket_unlock(lock: TicketSpinlock) {
    memory_barrier()
    atomic_fetch_add(&lock.ticket_servido, 1)
}

// MCS Lock (queue-based, mejor escalabilidad)
estructura MCS_Node {
    next: puntero a MCS_Node atómico
    locked: booleano atómico
}

estructura MCS_Lock {
    tail: puntero a MCS_Node atómico
}

función mcs_lock(lock: MCS_Lock, mi_nodo: MCS_Node) {
    mi_nodo.next = NULL
    mi_nodo.locked = verdadero
    
    // Añadirse a la cola
    pred = atomic_swap(&lock.tail, mi_nodo)
    
    si pred != NULL entonces
        // Hay threads esperando
        atomic_store(&pred.next, mi_nodo)
        
        // Esperar hasta que el predecesor nos libere
        mientras atomic_load(&mi_nodo.locked) hacer
            cpu_relax()
        fin mientras
    fin si
    
    memory_barrier()
}

función mcs_unlock(lock: MCS_Lock, mi_nodo: MCS_Node) {
    memory_barrier()
    
    next = atomic_load(&mi_nodo.next)
    
    si next == NULL entonces
        // Posiblemente somos el último
        si compare_and_swap(&lock.tail, mi_nodo, NULL) entonces
            // Éramos el último, terminado
            return
        fin si
        
        // Alguien más se está añadiendo, esperar
        mientras (next = atomic_load(&mi_nodo.next)) == NULL hacer
            cpu_relax()
        fin mientras
    fin si
    
    // Liberar al siguiente
    atomic_store(&next.locked, falso)
}

// Ejemplo: Usar spinlock para sección crítica
función ejemplo_uso_spinlock() {
    lock: Spinlock = crear_spinlock()
    contador_compartido: entero = 0
    
    función worker_thread() {
        para i = 1 hasta 1000 hacer
            spin_lock(lock)
            
            // Sección crítica (DEBE ser corta)
            contador_compartido++
            
            spin_unlock(lock)
        fin para
    }
    
    // Crear threads
    threads: arreglo[4] de Thread
    para i = 0 hasta 3 hacer
        threads[i] = crear_thread(worker_thread)
    fin para
    
    // Esperar
    para cada thread en threads hacer
        thread.join()
    fin para
    
    imprimir("Contador final: " + contador_compartido)
}

// Comparación: Spinlock vs Mutex
función comparar_spinlock_mutex() {
    // SPINLOCK: Mejor para
    // - Secciones críticas MUY cortas (< 100 ciclos)
    // - Cuando el lock rara vez está contendido
    // - Contexto de kernel/interrupt handlers
    // - Sistemas con muchos cores
    
    // MUTEX: Mejor para
    // - Secciones críticas largas
    // - Alta contención del lock
    // - Necesidad de dormir threads
    // - Ahorrar CPU
}

// Adaptive Mutex (híbrido: spin luego block)
función adaptive_mutex_lock(lock: Mutex) {
    intentos_spin = 0
    max_spins = 1000
    
    // Fase 1: Spin
    mientras intentos_spin < max_spins hacer
        si try_lock(lock) entonces
            return  // Lock adquirido
        fin si
        
        intentos_spin++
        cpu_relax()
    fin mientras
    
    // Fase 2: Block (usar mutex tradicional)
    mutex_lock(lock)
}

// Métricas de rendimiento
función medir_spinlock_performance() {
    lock: Spinlock = crear_spinlock()
    threads = 8
    iteraciones = 100000
    
    inicio = timestamp()
    
    función thread_worker() {
        para i = 1 hasta iteraciones hacer
            spin_lock(lock)
            // Trabajo mínimo
            spin_unlock(lock)
        fin para
    }
    
    para i = 1 hasta threads hacer
        crear_thread(thread_worker)
    fin para
    
    wait_all_threads()
    
    fin = timestamp()
    tiempo_total = fin - inicio
    ops_por_segundo = (iteraciones * threads) / tiempo_total
    
    imprimir("Operaciones/seg: " + ops_por_segundo)
    imprimir("Latencia promedio: " + (tiempo_total / (iteraciones * threads)))
}`})})]})]}),e.jsxs(ue,{value:"priority",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/30 to-slate-800/30 p-6 rounded-lg border border-purple-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-300 mb-3",children:"⬆️ Solución 2: Priority Boosting (Priority Inheritance)"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Priority boosting aumenta temporalmente la prioridad de un thread de baja prioridad que mantiene un lock necesitado por un thread de alta prioridad. Esto previene la inversión de prioridad y el convoying, asegurando que el thread con el lock complete rápidamente su sección crítica."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Previene inversión de prioridad"}),e.jsx("li",{children:"• Boost temporal de prioridad"}),e.jsx("li",{children:"• Restaura prioridad al liberar lock"}),e.jsx("li",{children:"• Usado en sistemas de tiempo real"}),e.jsx("li",{children:"• Puede causar cadenas de herencia"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Priority Boosting"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Estructura de thread con prioridad
estructura Thread {
    id: entero
    prioridad_base: entero
    prioridad_efectiva: entero
    locks_mantenidos: Lista<Lock>
    esperando_lock: Lock o NULL
}

// Lock con información de propietario
estructura PriorityInheritanceLock {
    locked: booleano atómico
    owner: Thread o NULL
    wait_queue: Cola<Thread> ordenada por prioridad
    mutex: Mutex
}

// Crear lock con herencia de prioridad
función crear_pi_lock() -> PriorityInheritanceLock {
    lock: PriorityInheritanceLock
    lock.locked = falso
    lock.owner = NULL
    lock.wait_queue = nueva_cola_prioridad()
    return lock
}

// Adquirir lock con priority inheritance
función pi_lock(lock: PriorityInheritanceLock, thread: Thread) {
    lock.mutex.lock()
    
    si no lock.locked entonces
        // Lock disponible
        lock.locked = verdadero
        lock.owner = thread
        thread.locks_mantenidos.append(lock)
        lock.mutex.unlock()
        return
    fin si
    
    // Lock ocupado - aplicar priority inheritance
    owner = lock.owner
    
    si thread.prioridad_efectiva > owner.prioridad_efectiva entonces
        // Thread actual tiene mayor prioridad que el owner
        // Boost la prioridad del owner
        boost_priority(owner, thread.prioridad_efectiva)
    fin si
    
    // Añadir a cola de espera
    thread.esperando_lock = lock
    lock.wait_queue.enqueue(thread)
    
    lock.mutex.unlock()
    
    // Dormir hasta ser despertado
    thread.dormir()
    
    // Al despertar, el lock fue adquirido
    thread.esperando_lock = NULL
}

// Liberar lock con priority inheritance
función pi_unlock(lock: PriorityInheritanceLock, thread: Thread) {
    lock.mutex.lock()
    
    // Remover lock de la lista del thread
    thread.locks_mantenidos.remove(lock)
    
    // Restaurar prioridad del thread
    recalcular_prioridad(thread)
    
    // Despertar siguiente thread en espera
    si no lock.wait_queue.vacia() entonces
        next_thread = lock.wait_queue.dequeue()
        
        // Transferir ownership
        lock.owner = next_thread
        next_thread.locks_mantenidos.append(lock)
        
        lock.mutex.unlock()
        
        // Despertar thread
        next_thread.despertar()
    sino
        // No hay threads esperando
        lock.locked = falso
        lock.owner = NULL
        lock.mutex.unlock()
    fin si
}

// Boost de prioridad (herencia)
función boost_priority(thread: Thread, nueva_prioridad: entero) {
    si nueva_prioridad <= thread.prioridad_efectiva entonces
        return  // No necesita boost
    fin si
    
    old_priority = thread.prioridad_efectiva
    thread.prioridad_efectiva = nueva_prioridad
    
    // Reordenar en cola del scheduler
    scheduler_update_priority(thread, old_priority, nueva_prioridad)
    
    // Propagar boost a threads bloqueantes (cadena de herencia)
    si thread.esperando_lock != NULL entonces
        lock = thread.esperando_lock
        
        si lock.owner != NULL entonces
            // Propagar boost al owner del lock que estamos esperando
            boost_priority(lock.owner, nueva_prioridad)
        fin si
    fin si
}

// Recalcular prioridad después de liberar lock
función recalcular_prioridad(thread: Thread) {
    max_inherited = thread.prioridad_base
    
    // Buscar la máxima prioridad heredada de threads esperando
    para cada lock en thread.locks_mantenidos hacer
        para cada waiter en lock.wait_queue hacer
            si waiter.prioridad_efectiva > max_inherited entonces
                max_inherited = waiter.prioridad_efectiva
            fin si
        fin para
    fin para
    
    si max_inherited != thread.prioridad_efectiva entonces
        old_priority = thread.prioridad_efectiva
        thread.prioridad_efectiva = max_inherited
        scheduler_update_priority(thread, old_priority, max_inherited)
    fin si
}

// Priority Ceiling Protocol (alternativa)
estructura PriorityCeilingLock {
    locked: booleano
    ceiling_priority: entero  // Prioridad máxima de todos los threads que lo usan
    owner: Thread o NULL
    wait_queue: Cola<Thread>
}

función pc_lock(lock: PriorityCeilingLock, thread: Thread) {
    lock.mutex.lock()
    
    // Elevar inmediatamente a ceiling priority
    old_priority = thread.prioridad_efectiva
    thread.prioridad_efectiva = lock.ceiling_priority
    scheduler_update_priority(thread, old_priority, lock.ceiling_priority)
    
    mientras lock.locked hacer
        thread.esperando_lock = lock
        lock.wait_queue.enqueue(thread)
        
        lock.mutex.unlock()
        thread.dormir()
        lock.mutex.lock()
    fin mientras
    
    lock.locked = verdadero
    lock.owner = thread
    thread.esperando_lock = NULL
    
    lock.mutex.unlock()
}

función pc_unlock(lock: PriorityCeilingLock, thread: Thread) {
    lock.mutex.lock()
    
    lock.locked = falso
    lock.owner = NULL
    
    // Restaurar prioridad original
    recalcular_prioridad(thread)
    
    // Despertar siguiente
    si no lock.wait_queue.vacia() entonces
        next = lock.wait_queue.dequeue()
        next.despertar()
    fin si
    
    lock.mutex.unlock()
}

// Ejemplo: Prevenir inversión de prioridad
función ejemplo_priority_inversion() {
    lock: PriorityInheritanceLock = crear_pi_lock()
    recurso_compartido: entero = 0
    
    // Thread de BAJA prioridad
    función low_priority_thread() {
        thread_actual.prioridad_base = 10
        thread_actual.prioridad_efectiva = 10
        
        pi_lock(lock, thread_actual)
        
        imprimir("Low: Lock adquirido (prioridad: " + thread_actual.prioridad_efectiva + ")")
        
        // Trabajo largo
        para i = 1 hasta 1000000 hacer
            recurso_compartido++
        fin para
        
        imprimir("Low: Liberando lock")
        pi_unlock(lock, thread_actual)
    }
    
    // Thread de MEDIA prioridad (no usa el lock)
    función medium_priority_thread() {
        thread_actual.prioridad_base = 50
        thread_actual.prioridad_efectiva = 50
        
        // Trabajo que consume CPU
        para i = 1 hasta 500000 hacer
            // Busy work
        fin para
    }
    
    // Thread de ALTA prioridad
    función high_priority_thread() {
        thread_actual.prioridad_base = 100
        thread_actual.prioridad_efectiva = 100
        
        dormir(100ms)  // Dar tiempo a low priority para adquirir lock
        
        imprimir("High: Intentando adquirir lock")
        pi_lock(lock, thread_actual)
        
        // Con Priority Inheritance:
        // El thread LOW será boosted a prioridad 100
        // Esto previene que MEDIUM lo retrase
        
        imprimir("High: Lock adquirido")
        recurso_compartido += 1000
        
        pi_unlock(lock, thread_actual)
    }
    
    crear_thread(low_priority_thread)
    dormir(10ms)
    crear_thread(medium_priority_thread)
    crear_thread(high_priority_thread)
}

// Cadena de herencia de prioridad
función ejemplo_priority_chain() {
    lock_a: PriorityInheritanceLock = crear_pi_lock()
    lock_b: PriorityInheritanceLock = crear_pi_lock()
    
    // Thread 1 (prioridad 10) mantiene lock_a
    función thread1() {
        prioridad = 10
        pi_lock(lock_a, thread_actual)
        
        // Trabajo largo
        dormir(1000ms)
        
        pi_unlock(lock_a, thread_actual)
    }
    
    // Thread 2 (prioridad 50) mantiene lock_b, espera lock_a
    función thread2() {
        prioridad = 50
        pi_lock(lock_b, thread_actual)
        
        // Thread2 espera lock_a (owned by thread1)
        // Thread1 heredará prioridad 50
        pi_lock(lock_a, thread_actual)
        
        pi_unlock(lock_a, thread_actual)
        pi_unlock(lock_b, thread_actual)
    }
    
    // Thread 3 (prioridad 100) espera lock_b
    función thread3() {
        prioridad = 100
        
        // Thread3 espera lock_b (owned by thread2)
        // Thread2 heredará prioridad 100
        // Thread1 heredará prioridad 100 (cadena)
        pi_lock(lock_b, thread_actual)
        
        pi_unlock(lock_b, thread_actual)
    }
}

// Métricas de inversión de prioridad
función medir_priority_inversion() {
    high_wait_time: entero = 0
    inversions_detected: entero = 0
    
    // Detectar cuándo thread de alta prioridad espera por baja
    si thread_high.esperando_lock != NULL entonces
        owner = thread_high.esperando_lock.owner
        
        si owner.prioridad_base < thread_high.prioridad_base entonces
            inversions_detected++
            
            // Medir tiempo de espera
            high_wait_time = timestamp() - thread_high.wait_start
            
            imprimir("Inversión detectada!")
            imprimir("  High priority: " + thread_high.prioridad_base)
            imprimir("  Low priority: " + owner.prioridad_base)
            imprimir("  Tiempo de espera: " + high_wait_time + "ms")
        fin si
    fin si
}`})})]})]}),e.jsxs(ue,{value:"preemption",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-900/30 to-slate-800/30 p-6 rounded-lg border border-green-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-green-300 mb-3",children:"🛡️ Solución 3: Preemption Control"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"El control de preemption desactiva temporalmente la capacidad del scheduler de interrumpir un thread mientras mantiene un lock. Esto previene el convoying al garantizar que el thread complete su sección crítica sin ser desalojado por el scheduler, reduciendo el tiempo que otros threads deben esperar."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Desactiva preemption temporalmente"}),e.jsx("li",{children:"• Garantiza completar sección crítica"}),e.jsx("li",{children:"• Reduce latencia de locks"}),e.jsx("li",{children:"• Usado en kernels de sistemas operativos"}),e.jsx("li",{children:"• Debe usarse con cuidado (afecta latencia)"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Preemption Control"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Control de preemption a nivel de thread
estructura PreemptionState {
    count: entero  // Contador de desactivaciones anidadas
    interrupts_enabled: booleano
}

// Variable por-thread
thread_local preempt_state: PreemptionState

// Desactivar preemption
función preempt_disable() {
    preempt_state.count++
    
    si preempt_state.count == 1 entonces
        // Primera desactivación - deshabilitar interrupts del scheduler
        preempt_state.interrupts_enabled = scheduler_interrupts_enabled()
        disable_scheduler_interrupts()
    fin si
    
    // Barrera de compilador (prevenir reordenamiento)
    compiler_barrier()
}

// Reactivar preemption
función preempt_enable() {
    compiler_barrier()
    
    preempt_state.count--
    
    si preempt_state.count == 0 entonces
        // Última reactivación
        si preempt_state.interrupts_enabled entonces
            enable_scheduler_interrupts()
        fin si
        
        // Verificar si hay preemption pendiente
        si scheduler_should_preempt() entonces
            scheduler_preempt()
        fin si
    fin si
    
    si preempt_state.count < 0 entonces
        panic("Preemption count underflow!")
    fin si
}

// Lock con preemption disabled
estructura PreemptDisabledLock {
    spinlock: Spinlock
}

función pd_lock(lock: PreemptDisabledLock) {
    // Desactivar preemption ANTES de adquirir spinlock
    preempt_disable()
    
    // Ahora adquirir el spinlock
    spin_lock(&lock.spinlock)
    
    // En este punto:
    // - Tenemos el lock
    // - Preemption está desactivada
    // - No podemos ser desalojados
}

función pd_unlock(lock: PreemptDisabledLock) {
    // Liberar spinlock
    spin_unlock(&lock.spinlock)
    
    // Reactivar preemption (puede causar preemption inmediata)
    preempt_enable()
}

// Read-Copy-Update (RCU) con preemption control
estructura RCU_Section {
    nesting_level: entero
}

thread_local rcu: RCU_Section

función rcu_read_lock() {
    preempt_disable()
    rcu.nesting_level++
}

función rcu_read_unlock() {
    rcu.nesting_level--
    
    si rcu.nesting_level == 0 entonces
        preempt_enable()
    fin si
}

// Sección crítica con preemption disabled
función critical_section_preempt_disabled(callback: función) {
    preempt_disable()
    
    intentar {
        callback()
    } capturar error {
        // Asegurar que preemption se reactive incluso con error
        preempt_enable()
        re_lanzar(error)
    }
    
    preempt_enable()
}

// Per-CPU data con preemption control
estructura PerCPUData {
    cpu_id: entero
    contador: entero
    buffer: arreglo de datos
}

per_cpu_data: arreglo[NUM_CPUS] de PerCPUData

función acceder_percpu_data() -> entero {
    preempt_disable()
    
    cpu = get_current_cpu()
    data = &per_cpu_data[cpu]
    
    // Acceso seguro - no podemos migrar a otro CPU
    data.contador++
    valor = data.contador
    
    preempt_enable()
    
    return valor
}

// Lock-free con preemption control
función incrementar_contador_lockfree() {
    preempt_disable()
    
    cpu = get_current_cpu()
    
    // Incrementar contador per-CPU sin locks
    per_cpu_data[cpu].contador++
    
    preempt_enable()
}

// Spinlock en kernel con IRQ disable
estructura KernelSpinlock {
    locked: booleano atómico
    irq_flags: entero
}

función kernel_spin_lock_irqsave(lock: KernelSpinlock) -> entero {
    // Guardar estado de interrupts y desactivarlos
    flags = save_and_disable_interrupts()
    
    // Desactivar preemption
    preempt_disable()
    
    // Adquirir spinlock
    mientras test_and_set(&lock.locked, verdadero) hacer
        cpu_relax()
    fin mientras
    
    lock.irq_flags = flags
    return flags
}

función kernel_spin_unlock_irqrestore(lock: KernelSpinlock, flags: entero) {
    // Liberar spinlock
    atomic_store(&lock.locked, falso)
    
    // Reactivar preemption
    preempt_enable()
    
    // Restaurar estado de interrupts
    restore_interrupts(flags)
}

// Big Kernel Lock (BKL) - ejemplo histórico
estructura BigKernelLock {
    lock: Spinlock
    owner: Thread o NULL
    depth: entero
}

global bkl: BigKernelLock

función lock_kernel() {
    thread = thread_actual
    
    si bkl.owner == thread entonces
        // Lock recursivo
        bkl.depth++
        return
    fin si
    
    preempt_disable()
    spin_lock(&bkl.lock)
    
    bkl.owner = thread
    bkl.depth = 1
}

función unlock_kernel() {
    thread = thread_actual
    
    si bkl.owner != thread entonces
        panic("Unlock kernel by non-owner!")
    fin si
    
    bkl.depth--
    
    si bkl.depth == 0 entonces
        bkl.owner = NULL
        spin_unlock(&bkl.lock)
        preempt_enable()
    fin si
}

// Secciones críticas cortas sin locks
función atomic_sequence_preempt_disabled() {
    preempt_disable()
    
    // Secuencia de operaciones que deben ser atómicas
    // (no necesariamente thread-safe entre CPUs)
    global_counter++
    global_sum += valor
    
    preempt_enable()
}

// Scheduler: implementación de preempt_disable/enable
función scheduler_interrupts_enabled() -> booleano {
    return (current_cpu_flags & INTERRUPT_FLAG) != 0
}

función disable_scheduler_interrupts() {
    // Deshabilitar timer interrupts
    cli()  // Clear Interrupt Flag (x86)
}

función enable_scheduler_interrupts() {
    // Habilitar timer interrupts
    sti()  // Set Interrupt Flag (x86)
}

función scheduler_should_preempt() -> booleano {
    thread = thread_actual
    
    // Verificar si hay thread de mayor prioridad listo
    si run_queue_has_higher_priority(thread.prioridad) entonces
        return verdadero
    fin si
    
    // Verificar si se agotó el time slice
    si thread.time_slice_expired entonces
        return verdadero
    fin si
    
    return falso
}

función scheduler_preempt() {
    // Guardar contexto del thread actual
    save_context(thread_actual)
    
    // Seleccionar siguiente thread
    next = scheduler_pick_next()
    
    // Cambiar contexto
    context_switch(thread_actual, next)
}

// Ejemplo: Código de kernel con preemption control
función kernel_timer_handler() {
    // Los interrupt handlers ejecutan con preemption disabled
    
    actualizar_jiffies()
    
    // Procesar timers expirados
    para cada timer en timers_expirados hacer
        timer.callback()
    fin para
    
    // Al salir del handler, preemption puede ocurrir
}

// Work queues con preemption control
función queue_work(work: Work) {
    preempt_disable()
    
    cpu = get_current_cpu()
    queue = &per_cpu_work_queues[cpu]
    
    queue.enqueue(work)
    
    preempt_enable()
    
    // Despertar worker thread
    wake_up_worker(cpu)
}

// Métricas de preemption
función medir_preemption_latency() {
    max_disabled_time: entero = 0
    total_disabled_time: entero = 0
    disable_count: entero = 0
    
    función instrumentar_preempt_disable() {
        preempt_state.disable_timestamp = timestamp()
        disable_count++
    }
    
    función instrumentar_preempt_enable() {
        disabled_time = timestamp() - preempt_state.disable_timestamp
        total_disabled_time += disabled_time
        
        si disabled_time > max_disabled_time entonces
            max_disabled_time = disabled_time
        fin si
    }
    
    imprimir("Desactivaciones de preemption: " + disable_count)
    imprimir("Tiempo total disabled: " + total_disabled_time + "μs")
    imprimir("Tiempo máximo disabled: " + max_disabled_time + "μs")
    imprimir("Promedio: " + (total_disabled_time / disable_count) + "μs")
}

// Sistema de tiempo real con preemption control
función rt_task_execute() {
    // Task de tiempo real
    preempt_disable()
    disable_interrupts()
    
    // Código crítico de tiempo real
    // Garantía: no será interrumpido
    ejecutar_control_critico()
    
    enable_interrupts()
    preempt_enable()
}

// Comparación: Con y sin preemption control
función comparar_preemption() {
    // SIN preemption control:
    // - Lock puede ser mantenido mientras el thread es desalojado
    // - Otros threads esperan más tiempo
    // - Causa convoying
    
    función sin_preempt_control() {
        spin_lock(&lock)
        // Si somos desalojados aquí, otros esperan
        trabajo_largo()
        spin_unlock(&lock)
    }
    
    // CON preemption control:
    // - Thread completa sección crítica sin interrupciones
    // - Otros threads esperan menos tiempo
    // - Previene convoying
    
    función con_preempt_control() {
        preempt_disable()
        spin_lock(&lock)
        // No podemos ser desalojados
        trabajo_largo()
        spin_unlock(&lock)
        preempt_enable()
    }
}`})})]})]}),e.jsxs(ue,{value:"lockfree",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-cyan-900/30 to-slate-800/30 p-6 rounded-lg border border-cyan-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-cyan-300 mb-3",children:"🔓 Solución 4: Lock-Free Algorithms"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Los algoritmos lock-free eliminan completamente el uso de locks tradicionales, utilizando operaciones atómicas (CAS, fetch-and-add) para manipular datos compartidos. Esto previene el convoying porque no hay locks que puedan ser mantenidos por threads de baja prioridad, eliminando la posibilidad de inversión de prioridad."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Sin locks tradicionales"}),e.jsx("li",{children:"• Usa operaciones atómicas (CAS)"}),e.jsx("li",{children:"• Garantía de progreso del sistema"}),e.jsx("li",{children:"• Elimina convoying completamente"}),e.jsx("li",{children:"• Alta complejidad de implementación"}),e.jsx("li",{children:"• Problemas: ABA, memory reclamation"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Lock-Free Algorithms"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Lock-Free Stack usando CAS
estructura LockFreeNode<T> {
    data: T
    next: puntero a LockFreeNode<T> atómico
}

estructura LockFreeStack<T> {
    top: puntero a LockFreeNode<T> atómico
}

función crear_lockfree_stack<T>() -> LockFreeStack<T> {
    stack: LockFreeStack<T>
    stack.top = NULL
    return stack
}

// Push lock-free
función lf_push<T>(stack: LockFreeStack<T>, valor: T) {
    nuevo_nodo = allocar<LockFreeNode<T>>()
    nuevo_nodo.data = valor
    
    mientras verdadero hacer
        // Leer top actual
        old_top = atomic_load(&stack.top)
        nuevo_nodo.next = old_top
        
        // Intentar CAS: si top no cambió, actualizar
        si compare_and_swap(&stack.top, old_top, nuevo_nodo) entonces
            return  // Push exitoso
        fin si
        
        // CAS falló, otro thread modificó el stack
        // Reintentar con nuevo valor de top
    fin mientras
}

// Pop lock-free
función lf_pop<T>(stack: LockFreeStack<T>) -> T o NULL {
    mientras verdadero hacer
        old_top = atomic_load(&stack.top)
        
        si old_top == NULL entonces
            return NULL  // Stack vacío
        fin si
        
        next = atomic_load(&old_top.next)
        
        // Intentar CAS: si top no cambió, actualizar
        si compare_and_swap(&stack.top, old_top, next) entonces
            // Pop exitoso
            valor = old_top.data
            liberar(old_top)  // CUIDADO: ABA problem
            return valor
        fin si
        
        // CAS falló, reintentar
    fin mientras
}

// Lock-Free Queue (Michael-Scott Queue)
estructura LockFreeQueue<T> {
    head: puntero a LockFreeNode<T> atómico
    tail: puntero a LockFreeNode<T> atómico
}

función crear_lockfree_queue<T>() -> LockFreeQueue<T> {
    queue: LockFreeQueue<T>
    
    // Nodo dummy inicial
    dummy = allocar<LockFreeNode<T>>()
    dummy.next = NULL
    
    queue.head = dummy
    queue.tail = dummy
    
    return queue
}

// Enqueue lock-free
función lf_enqueue<T>(queue: LockFreeQueue<T>, valor: T) {
    nuevo_nodo = allocar<LockFreeNode<T>>()
    nuevo_nodo.data = valor
    nuevo_nodo.next = NULL
    
    mientras verdadero hacer
        tail = atomic_load(&queue.tail)
        next = atomic_load(&tail.next)
        
        // Verificar que tail no cambió
        si tail == atomic_load(&queue.tail) entonces
            si next == NULL entonces
                // Tail apunta al último nodo
                si compare_and_swap(&tail.next, NULL, nuevo_nodo) entonces
                    // Enqueue exitoso, intentar actualizar tail
                    compare_and_swap(&queue.tail, tail, nuevo_nodo)
                    return
                fin si
            sino
                // Tail está retrasado, ayudar a avanzarlo
                compare_and_swap(&queue.tail, tail, next)
            fin si
        fin si
    fin mientras
}

// Dequeue lock-free
función lf_dequeue<T>(queue: LockFreeQueue<T>) -> T o NULL {
    mientras verdadero hacer
        head = atomic_load(&queue.head)
        tail = atomic_load(&queue.tail)
        next = atomic_load(&head.next)
        
        // Verificar consistencia
        si head == atomic_load(&queue.head) entonces
            si head == tail entonces
                si next == NULL entonces
                    return NULL  // Queue vacía
                fin si
                
                // Tail retrasado, ayudar
                compare_and_swap(&queue.tail, tail, next)
            sino
                // Leer valor antes de CAS
                valor = next.data
                
                si compare_and_swap(&queue.head, head, next) entonces
                    // Dequeue exitoso
                    liberar(head)  // Liberar nodo dummy viejo
                    return valor
                fin si
            fin si
        fin si
    fin mientras
}

// Lock-Free Counter
estructura LockFreeCounter {
    value: entero atómico
}

función lf_increment(counter: LockFreeCounter) -> entero {
    mientras verdadero hacer
        old_value = atomic_load(&counter.value)
        new_value = old_value + 1
        
        si compare_and_swap(&counter.value, old_value, new_value) entonces
            return new_value
        fin si
    fin mientras
}

// Alternativa: usar fetch-and-add (más eficiente)
función lf_increment_faa(counter: LockFreeCounter) -> entero {
    return atomic_fetch_add(&counter.value, 1) + 1
}

// Lock-Free Hash Table (simplified)
estructura LockFreeHashBucket<K, V> {
    key: K
    value: V atómico
    next: puntero a LockFreeHashBucket<K, V> atómico
}

estructura LockFreeHashTable<K, V> {
    buckets: arreglo de (puntero a LockFreeHashBucket<K, V> atómico)
    size: entero
}

función lf_hash_insert<K, V>(table: LockFreeHashTable<K, V>, key: K, value: V) -> booleano {
    hash = hash_function(key) % table.size
    bucket_head = &table.buckets[hash]
    
    nuevo_nodo = allocar<LockFreeHashBucket<K, V>>()
    nuevo_nodo.key = key
    nuevo_nodo.value = value
    
    mientras verdadero hacer
        old_head = atomic_load(bucket_head)
        
        // Verificar si key ya existe
        actual = old_head
        mientras actual != NULL hacer
            si actual.key == key entonces
                // Key existe, actualizar valor
                atomic_store(&actual.value, value)
                liberar(nuevo_nodo)
                return falso  // No insertado, solo actualizado
            fin si
            actual = atomic_load(&actual.next)
        fin mientras
        
        // Insertar al inicio de la lista
        nuevo_nodo.next = old_head
        
        si compare_and_swap(bucket_head, old_head, nuevo_nodo) entonces
            return verdadero  // Insertado exitosamente
        fin si
    fin mientras
}

función lf_hash_lookup<K, V>(table: LockFreeHashTable<K, V>, key: K) -> V o NULL {
    hash = hash_function(key) % table.size
    bucket_head = &table.buckets[hash]
    
    actual = atomic_load(bucket_head)
    
    mientras actual != NULL hacer
        si actual.key == key entonces
            return atomic_load(&actual.value)
        fin si
        actual = atomic_load(&actual.next)
    fin mientras
    
    return NULL  // No encontrado
}

// Lock-Free Reference Counting (para memory reclamation)
estructura LockFreeRefCounted<T> {
    data: T
    ref_count: entero atómico
}

función lf_acquire_ref<T>(obj: LockFreeRefCounted<T>) -> booleano {
    mientras verdadero hacer
        old_count = atomic_load(&obj.ref_count)
        
        si old_count == 0 entonces
            return falso  // Objeto siendo destruido
        fin si
        
        si compare_and_swap(&obj.ref_count, old_count, old_count + 1) entonces
            return verdadero
        fin si
    fin mientras
}

función lf_release_ref<T>(obj: LockFreeRefCounted<T>) {
    old_count = atomic_fetch_sub(&obj.ref_count, 1)
    
    si old_count == 1 entonces
        // Última referencia, liberar objeto
        destruir(obj.data)
        liberar(obj)
    fin si
}

// Hazard Pointers (alternativa para memory reclamation)
constante MAX_HAZARD_POINTERS = 100

estructura HazardPointer {
    pointer: puntero atómico
}

global hazard_pointers: arreglo[MAX_HAZARD_POINTERS] de HazardPointer

función acquire_hazard_pointer<T>(ptr: puntero a T) -> entero {
    // Buscar slot libre
    para i = 0 hasta MAX_HAZARD_POINTERS - 1 hacer
        si atomic_load(&hazard_pointers[i].pointer) == NULL entonces
            atomic_store(&hazard_pointers[i].pointer, ptr)
            return i
        fin si
    fin para
    
    return -1  // No hay slots disponibles
}

función release_hazard_pointer(index: entero) {
    atomic_store(&hazard_pointers[index].pointer, NULL)
}

función is_hazardous<T>(ptr: puntero a T) -> booleano {
    para i = 0 hasta MAX_HAZARD_POINTERS - 1 hacer
        si atomic_load(&hazard_pointers[i].pointer) == ptr entonces
            return verdadero
        fin si
    fin para
    
    return falso
}

// Pop con hazard pointers (evita ABA)
función lf_pop_hazard<T>(stack: LockFreeStack<T>) -> T o NULL {
    mientras verdadero hacer
        old_top = atomic_load(&stack.top)
        
        si old_top == NULL entonces
            return NULL
        fin si
        
        // Proteger con hazard pointer
        hp_index = acquire_hazard_pointer(old_top)
        
        si hp_index == -1 entonces
            continue  // No hay hazard pointers, reintentar
        fin si
        
        // Verificar que top no cambió
        si atomic_load(&stack.top) != old_top entonces
            release_hazard_pointer(hp_index)
            continue  // Top cambió, reintentar
        fin si
        
        next = atomic_load(&old_top.next)
        
        si compare_and_swap(&stack.top, old_top, next) entonces
            // Pop exitoso
            valor = old_top.data
            
            release_hazard_pointer(hp_index)
            
            // Agregar a lista de nodos a liberar
            // Solo liberar cuando NO sea hazardous
            si no is_hazardous(old_top) entonces
                liberar(old_top)
            sino
                defer_free(old_top)
            fin si
            
            return valor
        fin si
        
        release_hazard_pointer(hp_index)
    fin mientras
}

// Lock-Free Skip List (estructura avanzada)
estructura LockFreeSkipNode<T> {
    value: T
    next: arreglo dinámico de (puntero a LockFreeSkipNode<T> atómico)
    top_level: entero
}

función lf_skiplist_insert<T>(skiplist: LockFreeSkipList<T>, value: T) -> booleano {
    // Generar nivel aleatorio
    nivel = random_level()
    
    nuevo_nodo = crear_skip_node(value, nivel)
    
    mientras verdadero hacer
        // Encontrar predecesores
        preds = encontrar_predecesores(skiplist, value)
        
        // Intentar insertar en nivel 0
        next = atomic_load(&preds[0].next[0])
        
        si next != NULL y next.value == value entonces
            return falso  // Valor ya existe
        fin si
        
        nuevo_nodo.next[0] = next
        
        si compare_and_swap(&preds[0].next[0], next, nuevo_nodo) entonces
            // Inserción en nivel 0 exitosa
            
            // Insertar en niveles superiores
            para i = 1 hasta nivel hacer
                mientras verdadero hacer
                    next = atomic_load(&preds[i].next[i])
                    nuevo_nodo.next[i] = next
                    
                    si compare_and_swap(&preds[i].next[i], next, nuevo_nodo) entonces
                        break
                    fin si
                    
                    // Actualizar predecesores si CAS falla
                    preds = encontrar_predecesores(skiplist, value)
                fin mientras
            fin para
            
            return verdadero
        fin si
    fin mientras
}

// Wait-Free vs Lock-Free
// Lock-Free: Al menos un thread hace progreso
// Wait-Free: Todos los threads hacen progreso en tiempo acotado

// Ejemplo wait-free: Counter con fetch-and-add
función wf_increment(counter: entero atómico) -> entero {
    // Una sola operación atómica - wait-free
    return atomic_fetch_add(&counter, 1) + 1
}

// Compare con lock-free usando CAS (puede hacer loop infinito)
función lf_increment_cas(counter: entero atómico) -> entero {
    mientras verdadero hacer  // Puede loop infinitamente
        old = atomic_load(&counter)
        new = old + 1
        
        si compare_and_swap(&counter, old, new) entonces
            return new
        fin si
    fin mientras
}

// Double-CAS (DCAS) - no disponible en hardware común
// Simular con version counters para evitar ABA
estructura VersionedPointer<T> {
    pointer: puntero a T
    version: entero
}

función lf_pop_versioned<T>(stack: LockFreeStack<T>) -> T o NULL {
    // Stack.top ahora es VersionedPointer
    mientras verdadero hacer
        old_top = atomic_load(&stack.top)  // {pointer, version}
        
        si old_top.pointer == NULL entonces
            return NULL
        fin si
        
        next_ptr = atomic_load(&old_top.pointer.next)
        new_top = {next_ptr, old_top.version + 1}
        
        // CAS comparando tanto pointer como version
        si compare_and_swap_128(&stack.top, old_top, new_top) entonces
            valor = old_top.pointer.data
            liberar(old_top.pointer)
            return valor
        fin si
    fin mientras
}

// Lock-Free Work Stealing Queue
estructura LockFreeDeque<T> {
    items: arreglo circular de T
    top: entero atómico      // Owner escribe
    bottom: entero atómico   // Owner escribe, thieves leen
}

función lf_deque_push<T>(deque: LockFreeDeque<T>, item: T) {
    // Solo el owner thread puede hacer push
    b = atomic_load_relaxed(&deque.bottom)
    deque.items[b % SIZE] = item
    
    atomic_store_release(&deque.bottom, b + 1)
}

función lf_deque_pop<T>(deque: LockFreeDeque<T>) -> T o NULL {
    // Solo el owner thread puede hacer pop
    b = atomic_load_relaxed(&deque.bottom) - 1
    atomic_store_relaxed(&deque.bottom, b)
    
    t = atomic_load_acquire(&deque.top)
    
    si b < t entonces
        // Deque vacío
        atomic_store_relaxed(&deque.bottom, t)
        return NULL
    fin si
    
    item = deque.items[b % SIZE]
    
    si b > t entonces
        return item
    fin si
    
    // Último item - competir con thieves
    atomic_store_relaxed(&deque.bottom, t + 1)
    
    si compare_and_swap(&deque.top, t, t + 1) entonces
        return item
    fin si
    
    return NULL  // Thief ganó
}

función lf_deque_steal<T>(deque: LockFreeDeque<T>) -> T o NULL {
    // Thieves pueden hacer steal
    mientras verdadero hacer
        t = atomic_load_acquire(&deque.top)
        b = atomic_load_acquire(&deque.bottom)
        
        si t >= b entonces
            return NULL  // Deque vacío
        fin si
        
        item = deque.items[t % SIZE]
        
        si compare_and_swap(&deque.top, t, t + 1) entonces
            return item
        fin si
        
        // CAS falló, otro thief robó, reintentar
    fin mientras
}

// Ejemplo: Sistema completo lock-free
función ejemplo_sistema_lockfree() {
    queue: LockFreeQueue<Work> = crear_lockfree_queue()
    counter: LockFreeCounter
    counter.value = 0
    
    función producer() {
        para i = 1 hasta 10000 hacer
            work: Work
            work.id = i
            
            lf_enqueue(queue, work)
            lf_increment_faa(counter)
        fin para
    }
    
    función consumer() {
        mientras verdadero hacer
            work = lf_dequeue(queue)
            
            si work != NULL entonces
                procesar(work)
            sino
                break
            fin si
        fin mientras
    }
    
    // Múltiples producers y consumers
    para i = 1 hasta 4 hacer
        crear_thread(producer)
    fin para
    
    para i = 1 hasta 4 hacer
        crear_thread(consumer)
    fin para
}`})})]})]}),e.jsxs(ue,{value:"adaptive",className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-orange-900/30 to-slate-800/30 p-6 rounded-lg border border-orange-700/50",children:[e.jsx("h3",{className:"text-2xl font-bold text-orange-300 mb-3",children:"🔄 Solución 5: Adaptive Spinning"}),e.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Adaptive spinning es una técnica híbrida que decide dinámicamente entre hacer spinning (busy-wait) o bloquear el thread basándose en heurísticas sobre el estado del lock. Si el lock está siendo mantenido por un thread en ejecución, hace spinning. Si el owner está bloqueado, el thread se duerme. Esto previene convoying al evitar esperas innecesarias cuando el lock estará disponible pronto."}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded border border-slate-600",children:[e.jsx("h4",{className:"font-mono text-sm text-emerald-400 mb-2",children:"Características:"}),e.jsxs("ul",{className:"text-gray-300 space-y-1 text-sm",children:[e.jsx("li",{children:"• Decisión dinámica: spin vs block"}),e.jsx("li",{children:"• Monitorea estado del owner thread"}),e.jsx("li",{children:"• Heurísticas basadas en historial"}),e.jsx("li",{children:"• Reduce context switches innecesarios"}),e.jsx("li",{children:"• Balancea latencia y uso de CPU"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur p-6 rounded-lg border border-slate-600",children:[e.jsxs("h4",{className:"text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),"Pseudocódigo: Adaptive Spinning"]}),e.jsx("pre",{className:"bg-slate-950 p-4 rounded-lg overflow-x-auto border border-slate-700",children:e.jsx("code",{className:"text-sm text-gray-100 font-mono",children:`// Estructura de mutex adaptivo
estructura AdaptiveMutex {
    locked: booleano atómico
    owner: Thread o NULL
    wait_queue: Cola<Thread>
    spin_history: SpinHistory
    mutex: Mutex
}

estructura SpinHistory {
    recent_spins: arreglo circular de booleano  // Últimas N decisiones
    successful_spins: entero  // Spins que adquirieron lock
    failed_spins: entero      // Spins que bloquearon
    index: entero
}

constante HISTORY_SIZE = 16
constante MAX_SPIN_ITERATIONS = 1000

// Crear mutex adaptivo
función crear_adaptive_mutex() -> AdaptiveMutex {
    mutex: AdaptiveMutex
    mutex.locked = falso
    mutex.owner = NULL
    mutex.wait_queue = nueva_cola()
    mutex.spin_history.successful_spins = 0
    mutex.spin_history.failed_spins = 0
    mutex.spin_history.index = 0
    return mutex
}

// Adquirir mutex adaptivo
función adaptive_lock(mutex: AdaptiveMutex, thread: Thread) {
    // Primer intento rápido
    si no atomic_swap(&mutex.locked, verdadero) entonces
        mutex.owner = thread
        return  // Lock adquirido inmediatamente
    fin si
    
    // Lock ocupado - decidir: spin o block?
    si should_spin(mutex, thread) entonces
        // Intentar spinning
        si adaptive_spin(mutex, thread) entonces
            // Spinning exitoso, lock adquirido
            registrar_spin_exitoso(mutex)
            return
        fin si
        
        // Spinning falló, caer a bloqueo
        registrar_spin_fallido(mutex)
    fin si
    
    // Bloquear thread
    adaptive_block(mutex, thread)
}

// Decidir si hacer spinning basado en heurísticas
función should_spin(mutex: AdaptiveMutex, thread: Thread) -> booleano {
    owner = atomic_load(&mutex.owner)
    
    si owner == NULL entonces
        return falso  // No hay owner, no hacer spin
    fin si
    
    // Heurística 1: ¿El owner está ejecutándose?
    si no thread_is_running(owner) entonces
        return falso  // Owner no está en CPU, no hacer spin
    fin si
    
    // Heurística 2: ¿Estamos en el mismo CPU?
    si get_cpu(owner) == get_cpu(thread) entonces
        return falso  // Mismo CPU, spinning no ayuda
    fin si
    
    // Heurística 3: ¿El historial sugiere spinning?
    si mutex.spin_history.successful_spins < mutex.spin_history.failed_spins entonces
        // Más fallos que éxitos recientes
        return falso
    fin si
    
    // Heurística 4: ¿Hay muchos threads esperando?
    si queue_length(mutex.wait_queue) > NUM_CPUS entonces
        return falso  // Demasiada contención
    fin si
    
    return verdadero  // Hacer spinning
}

// Spinning adaptivo
función adaptive_spin(mutex: AdaptiveMutex, thread: Thread) -> booleano {
    iterations = 0
    backoff = 1
    
    mientras iterations < MAX_SPIN_ITERATIONS hacer
        // Verificar si lock está disponible
        si no atomic_load(&mutex.locked) entonces
            // Lock parece libre, intentar adquirir
            si no atomic_swap(&mutex.locked, verdadero) entonces
                mutex.owner = thread
                return verdadero  // Lock adquirido
            fin si
        fin si
        
        // Verificar si el owner sigue ejecutándose
        owner = atomic_load(&mutex.owner)
        
        si owner == NULL o no thread_is_running(owner) entonces
            // Owner ya no está ejecutándose, dejar de hacer spin
            return falso
        fin si
        
        // Backoff exponencial
        para i = 1 hasta backoff hacer
            cpu_relax()  // PAUSE instruction
        fin para
        
        backoff = min(backoff * 2, 64)
        iterations++
    fin mientras
    
    return falso  // Spinning agotado
}

// Bloquear thread
función adaptive_block(mutex: AdaptiveMutex, thread: Thread) {
    mutex.mutex.lock()
    
    // Verificar nuevamente (podría haberse liberado)
    si no mutex.locked entonces
        si no atomic_swap(&mutex.locked, verdadero) entonces
            mutex.owner = thread
            mutex.mutex.unlock()
            return
        fin si
    fin si
    
    // Añadir a cola de espera
    mutex.wait_queue.enqueue(thread)
    
    mutex.mutex.unlock()
    
    // Dormir hasta ser despertado
    thread.dormir()
    
    // Al despertar, lock fue adquirido
    mutex.owner = thread
}

// Liberar mutex adaptivo
función adaptive_unlock(mutex: AdaptiveMutex, thread: Thread) {
    mutex.mutex.lock()
    
    mutex.owner = NULL
    atomic_store(&mutex.locked, falso)
    
    // Despertar siguiente thread
    si no mutex.wait_queue.vacia() entonces
        next = mutex.wait_queue.dequeue()
        next.despertar()
    fin si
    
    mutex.mutex.unlock()
}

// Registrar resultado de spinning
función registrar_spin_exitoso(mutex: AdaptiveMutex) {
    hist = &mutex.spin_history
    
    hist.recent_spins[hist.index] = verdadero
    hist.successful_spins++
    hist.index = (hist.index + 1) % HISTORY_SIZE
    
    // Decaer contador de fallos
    hist.failed_spins = hist.failed_spins * 9 / 10
}

función registrar_spin_fallido(mutex: AdaptiveMutex) {
    hist = &mutex.spin_history
    
    hist.recent_spins[hist.index] = falso
    hist.failed_spins++
    hist.index = (hist.index + 1) % HISTORY_SIZE
    
    // Decaer contador de éxitos
    hist.successful_spins = hist.successful_spins * 9 / 10
}

// Verificar si thread está ejecutándose
función thread_is_running(thread: Thread) -> booleano {
    // Verificar estado del thread
    estado = atomic_load(&thread.estado)
    
    si estado == RUNNING entonces
        return verdadero
    fin si
    
    // En algunos sistemas, verificar si está en CPU
    para cada cpu en cpus hacer
        si cpu.current_thread == thread entonces
            return verdadero
        fin si
    fin para
    
    return falso
}

// Adaptive Spinning con Pause Heuristics
función adaptive_spin_pause(mutex: AdaptiveMutex, thread: Thread) -> booleano {
    iterations = 0
    pause_duration = INITIAL_PAUSE
    
    mientras iterations < MAX_SPIN_ITERATIONS hacer
        // Intentar adquirir
        si no atomic_swap(&mutex.locked, verdadero) entonces
            mutex.owner = thread
            return verdadero
        fin si
        
        // Verificar owner
        owner = atomic_load(&mutex.owner)
        
        si owner != NULL entonces
            // Owner existe, ajustar pause basado en su estado
            si thread_is_running(owner) entonces
                // Owner ejecutándose, pause corto
                pause_duration = min_pause
            sino
                // Owner bloqueado, pause largo o detener
                pause_duration = max_pause
                
                si iterations > MAX_SPIN_ITERATIONS / 2 entonces
                    return falso  // Detener spinning
                fin si
            fin si
        fin si
        
        // Ejecutar pause
        para i = 1 hasta pause_duration hacer
            cpu_relax()
        fin para
        
        iterations++
    fin mientras
    
    return falso
}

// Adaptive Mutex con predicción de duración
estructura PredictiveAdaptiveMutex {
    mutex: AdaptiveMutex
    avg_hold_time: entero  // Tiempo promedio de hold
    last_acquire_time: timestamp atómico
}

función predictive_lock(pmutex: PredictiveAdaptiveMutex, thread: Thread) {
    // Primer intento
    si no atomic_swap(&pmutex.mutex.locked, verdadero) entonces
        pmutex.mutex.owner = thread
        pmutex.last_acquire_time = timestamp()
        return
    fin si
    
    // Estimar cuánto tiempo quedará el lock ocupado
    now = timestamp()
    acquire_time = atomic_load(&pmutex.last_acquire_time)
    elapsed = now - acquire_time
    
    estimated_remaining = pmutex.avg_hold_time - elapsed
    
    si estimated_remaining > 0 y estimated_remaining < SPIN_THRESHOLD entonces
        // Lock debería liberarse pronto, hacer spin
        si adaptive_spin(&pmutex.mutex, thread) entonces
            pmutex.last_acquire_time = timestamp()
            return
        fin si
    fin si
    
    // Bloquear
    adaptive_block(&pmutex.mutex, thread)
    pmutex.last_acquire_time = timestamp()
}

función predictive_unlock(pmutex: PredictiveAdaptiveMutex, thread: Thread) {
    now = timestamp()
    acquire_time = atomic_load(&pmutex.last_acquire_time)
    hold_time = now - acquire_time
    
    // Actualizar tiempo promedio de hold (EWMA)
    pmutex.avg_hold_time = (pmutex.avg_hold_time * 7 + hold_time) / 8
    
    adaptive_unlock(&pmutex.mutex, thread)
}

// Adaptive Spinning con feedback del scheduler
estructura SchedulerAdaptiveMutex {
    mutex: AdaptiveMutex
    scheduler_hints: SchedulerHints
}

estructura SchedulerHints {
    load_average: flotante  // Carga del sistema
    context_switch_cost: entero  // Costo estimado de CS
}

función scheduler_adaptive_lock(samutex: SchedulerAdaptiveMutex, thread: Thread) {
    // Primer intento
    si no atomic_swap(&samutex.mutex.locked, verdadero) entonces
        samutex.mutex.owner = thread
        return
    fin si
    
    hints = &samutex.scheduler_hints
    
    // Decidir basado en carga del sistema
    si hints.load_average < NUM_CPUS * 0.7 entonces
        // Sistema no muy cargado, spinning es razonable
        max_spins = MAX_SPIN_ITERATIONS
    sino si hints.load_average < NUM_CPUS * 1.5 entonces
        // Sistema moderadamente cargado, reducir spinning
        max_spins = MAX_SPIN_ITERATIONS / 2
    sino
        // Sistema sobrecargado, ir directo a bloqueo
        max_spins = 0
    fin si
    
    si max_spins > 0 entonces
        si adaptive_spin_limited(&samutex.mutex, thread, max_spins) entonces
            return
        fin si
    fin si
    
    adaptive_block(&samutex.mutex, thread)
}

función adaptive_spin_limited(mutex: AdaptiveMutex, thread: Thread, max: entero) -> booleano {
    para i = 1 hasta max hacer
        si no atomic_load(&mutex.locked) entonces
            si no atomic_swap(&mutex.locked, verdadero) entonces
                mutex.owner = thread
                return verdadero
            fin si
        fin si
        
        cpu_relax()
    fin mientras
    
    return falso
}

// Two-Phase Adaptive Lock
función two_phase_adaptive_lock(mutex: AdaptiveMutex, thread: Thread) {
    // Fase 1: Spinning agresivo corto
    si aggressive_spin(mutex, thread, 100) entonces
        return  // Lock adquirido en fase 1
    fin si
    
    // Fase 2: Verificar si owner sigue ejecutándose
    owner = atomic_load(&mutex.owner)
    
    si owner != NULL y thread_is_running(owner) entonces
        // Fase 2: Spinning conservador
        si conservative_spin(mutex, thread, 1000) entonces
            return  // Lock adquirido en fase 2
        fin si
    fin si
    
    // Fase 3: Bloquear
    adaptive_block(mutex, thread)
}

función aggressive_spin(mutex: AdaptiveMutex, thread: Thread, iterations: entero) -> booleano {
    // Spinning sin pause, máxima velocidad
    para i = 1 hasta iterations hacer
        si no atomic_swap(&mutex.locked, verdadero) entonces
            mutex.owner = thread
            return verdadero
        fin si
    fin para
    
    return falso
}

función conservative_spin(mutex: AdaptiveMutex, thread: Thread, iterations: entero) -> booleano {
    // Spinning con pause y verificaciones
    backoff = 1
    
    para i = 1 hasta iterations hacer
        si no atomic_swap(&mutex.locked, verdadero) entonces
            mutex.owner = thread
            return verdadero
        fin si
        
        // Verificar owner periódicamente
        si i % 50 == 0 entonces
            owner = atomic_load(&mutex.owner)
            
            si owner == NULL o no thread_is_running(owner) entonces
                return falso  // Detener spinning
            fin si
        fin si
        
        para j = 1 hasta backoff hacer
            cpu_relax()
        fin para
        
        backoff = min(backoff + 1, 16)
    fin para
    
    return falso
}

// Ejemplo: Comparación de estrategias
función benchmark_adaptive_strategies() {
    normal_mutex: Mutex
    adaptive_mutex: AdaptiveMutex
    
    // Test 1: Baja contención
    imprimir("=== Baja Contención ===")
    bench_lock(normal_mutex, 4, 1000)
    bench_lock(adaptive_mutex, 4, 1000)
    
    // Test 2: Alta contención
    imprimir("=== Alta Contención ===")
    bench_lock(normal_mutex, 16, 10000)
    bench_lock(adaptive_mutex, 16, 10000)
}

función bench_lock(lock: cualquier, threads: entero, ops: entero) {
    contador = 0
    inicio = timestamp()
    
    función worker() {
        para i = 1 hasta ops hacer
            adquirir(lock)
            contador++
            liberar(lock)
        fin para
    }
    
    para i = 1 hasta threads hacer
        crear_thread(worker)
    fin para
    
    wait_all_threads()
    
    fin = timestamp()
    tiempo = fin - inicio
    throughput = (threads * ops) / tiempo
    
    imprimir("Tiempo: " + tiempo + "ms")
    imprimir("Throughput: " + throughput + " ops/s")
}

// Métricas de adaptive spinning
función medir_adaptive_performance(mutex: AdaptiveMutex) {
    hist = mutex.spin_history
    
    total_decisiones = hist.successful_spins + hist.failed_spins
    
    si total_decisiones > 0 entonces
        tasa_exito = (hist.successful_spins * 100.0) / total_decisiones
        
        imprimir("Decisiones de spinning:")
        imprimir("  Exitosos: " + hist.successful_spins)
        imprimir("  Fallidos: " + hist.failed_spins)
        imprimir("  Tasa de éxito: " + tasa_exito + "%")
    fin si
}`})})]})]})]})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsx(Da,{type:"single",defaultValue:"demos",collapsible:!0,className:"space-y-4",children:e.jsxs(sa,{value:"demos",className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700",children:[e.jsx(ra,{className:"px-6 py-4 hover:bg-slate-700/30 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(vn,{className:"size-6 text-green-400"}),e.jsx("span",{className:"text-2xl font-semibold",children:"Demostraciones Interactivas"})]})}),e.jsx(na,{className:"px-6 pb-6",children:e.jsxs(ia,{defaultValue:"demo-spinlock",className:"w-full",children:[e.jsxs(Qt,{className:"grid w-full grid-cols-5 bg-slate-900/50 p-1 rounded-lg mb-6",children:[e.jsx(le,{value:"demo-spinlock",className:"data-[state=active]:bg-green-600",children:"Spinlock vs Mutex"}),e.jsx(le,{value:"demo-priority",className:"data-[state=active]:bg-green-600",children:"Priority Inheritance"}),e.jsx(le,{value:"demo-preemption",className:"data-[state=active]:bg-green-600",children:"Preemption Control"}),e.jsx(le,{value:"demo-lockfree",className:"data-[state=active]:bg-green-600",children:"Lock-Free Stack"}),e.jsx(le,{value:"demo-adaptive",className:"data-[state=active]:bg-green-600",children:"Adaptive Spinning"})]}),e.jsx(ue,{value:"demo-spinlock",className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/20 to-slate-800/20 p-6 rounded-lg border border-blue-700/30",children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-300 mb-4",children:"🔄 Demo: Spinlock vs Mutex"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Compara spinlocks (busy-wait) con mutexes (bloqueo). Observa el uso de CPU."}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>o(!s),className:`px-6 py-2 rounded-lg font-semibold transition-colors ${s?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"inline size-5 mr-2"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"inline size-5 mr-2"}),"Iniciar"]})}),e.jsxs("button",{onClick:St,className:"px-6 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-semibold transition-colors",children:[e.jsx(it,{className:"inline size-5 mr-2"}),"Resetear"]}),e.jsxs("div",{className:"flex items-center gap-3 ml-auto",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Velocidad:"}),e.jsx(dt,{value:[n],onValueChange:ve=>l(ve[0]),min:100,max:2e3,step:100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400 w-16",children:[n,"ms"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-cyan-400 mb-3",children:"Threads"}),e.jsx("div",{className:"space-y-2",children:h.map(ve=>e.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${ve.state==="running"?"bg-green-900/30 border-green-500":ve.state==="spinning"?"bg-yellow-900/30 border-yellow-500 animate-pulse":ve.state==="blocked"?"bg-red-900/30 border-red-500":ve.state==="finished"?"bg-gray-900/30 border-gray-500":"bg-slate-800/30 border-slate-600"}`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-mono text-sm",children:["T",ve.id," (",ve.type,")"]}),e.jsxs("span",{className:"text-xs bg-slate-700 px-2 py-1 rounded",children:["P=",ve.priority]})]}),e.jsxs("div",{className:"text-xs mt-1 text-gray-400",children:["Estado: ",ve.state,ve.state==="spinning"&&" 🔄 (Consume CPU)"]})]},ve.id))})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-orange-400 mb-3",children:"Uso de CPU"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Spinlocks"}),e.jsxs("span",{className:"text-yellow-400",children:[g.spinlock,"%"]})]}),e.jsx("div",{className:"h-6 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-500 to-orange-500 transition-all duration-300",style:{width:`${Math.min(g.spinlock,100)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Mutexes"}),e.jsxs("span",{className:"text-green-400",children:[g.mutex,"%"]})]}),e.jsx("div",{className:"h-6 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-500 transition-all duration-300",style:{width:`${Math.min(g.mutex,100)}%`}})})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-4 p-2 bg-slate-800/50 rounded",children:["💡 Spinlocks: baja latencia, alto CPU",e.jsx("br",{}),"💡 Mutexes: alta latencia, bajo CPU"]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-purple-400 mb-3",children:"Event Log"}),e.jsx("div",{ref:re,className:"h-48 overflow-y-auto space-y-1 font-mono text-xs",children:v.map((ve,gt)=>e.jsx("div",{className:`p-2 rounded ${ve.type==="success"?"bg-green-900/20 text-green-300":ve.type==="warning"?"bg-yellow-900/20 text-yellow-300":ve.type==="error"?"bg-red-900/20 text-red-300":"bg-slate-800/20 text-gray-300"}`,children:ve.message},gt))})]})]})}),e.jsx(ue,{value:"demo-priority",className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/20 to-slate-800/20 p-6 rounded-lg border border-purple-700/30",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-300 mb-4",children:"⬆️ Demo: Priority Inheritance"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Observa cómo priority inheritance previene inversión de prioridad y convoying."}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>j(!N),className:`px-6 py-2 rounded-lg font-semibold transition-colors ${N?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:N?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"inline size-5 mr-2"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"inline size-5 mr-2"}),"Iniciar"]})}),e.jsxs("button",{onClick:tt,className:"px-6 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-semibold transition-colors",children:[e.jsx(it,{className:"inline size-5 mr-2"}),"Resetear"]}),e.jsxs("div",{className:"flex items-center gap-3 ml-auto",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Velocidad:"}),e.jsx(dt,{value:[_],onValueChange:ve=>w(ve[0]),min:100,max:2e3,step:100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400 w-16",children:[_,"ms"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-cyan-400 mb-3",children:"Threads (Prioridad)"}),e.jsx("div",{className:"space-y-3",children:z.map(ve=>e.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${ve.state==="running"?"bg-green-900/30 border-green-500":ve.state==="blocked"?"bg-red-900/30 border-red-500":ve.state==="finished"?"bg-gray-900/30 border-gray-500":"bg-slate-800/30 border-slate-600"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-bold",children:ve.name}),ve.hasLock&&e.jsx("span",{className:"text-xs bg-yellow-600 px-2 py-1 rounded",children:"🔒 Lock"})]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Base:"}),e.jsx("span",{className:"text-blue-400",children:ve.priority})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Efectiva:"}),e.jsxs("span",{className:`font-bold ${ve.effectivePriority>ve.priority?"text-yellow-400":"text-gray-400"}`,children:[ve.effectivePriority,ve.effectivePriority>ve.priority&&" ⬆️"]})]}),e.jsxs("div",{className:"text-gray-400",children:["Estado: ",ve.state]})]})]},ve.id))})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-orange-400 mb-3",children:"Indicadores"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-all ${V?"bg-red-900/30 border-red-500 animate-pulse":"bg-slate-800/30 border-slate-600"}`,children:[e.jsx("div",{className:"text-sm font-bold mb-1",children:"Inversión de Prioridad"}),e.jsx("div",{className:"text-2xl",children:V?"🚨 DETECTADA":"✅ No"})]}),e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-all ${oe?"bg-yellow-900/30 border-yellow-500":"bg-slate-800/30 border-slate-600"}`,children:[e.jsx("div",{className:"text-sm font-bold mb-1",children:"Priority Boost"}),e.jsx("div",{className:"text-2xl",children:oe?"⬆️ ACTIVO":"➖ Inactivo"})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-4 p-2 bg-slate-800/50 rounded",children:"💡 Priority inheritance eleva temporalmente la prioridad del thread que mantiene un lock necesitado por un thread de alta prioridad."})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-purple-400 mb-3",children:"Event Log"}),e.jsx("div",{ref:Ve,className:"h-48 overflow-y-auto space-y-1 font-mono text-xs",children:T.map((ve,gt)=>e.jsx("div",{className:`p-2 rounded ${ve.type==="success"?"bg-green-900/20 text-green-300":ve.type==="warning"?"bg-yellow-900/20 text-yellow-300":ve.type==="error"?"bg-red-900/20 text-red-300":"bg-slate-800/20 text-gray-300"}`,children:ve.message},gt))})]})]})}),e.jsx(ue,{value:"demo-preemption",className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-br from-green-900/20 to-slate-800/20 p-6 rounded-lg border border-green-700/30",children:[e.jsx("h3",{className:"text-2xl font-bold text-green-300 mb-4",children:"🛡️ Demo: Preemption Control"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Desactivar preemption durante secciones críticas previene context switches innecesarios."}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>W(!J),className:`px-6 py-2 rounded-lg font-semibold transition-colors ${J?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:J?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"inline size-5 mr-2"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"inline size-5 mr-2"}),"Iniciar"]})}),e.jsxs("button",{onClick:Ye,className:"px-6 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-semibold transition-colors",children:[e.jsx(it,{className:"inline size-5 mr-2"}),"Resetear"]}),e.jsxs("div",{className:"flex items-center gap-3 ml-auto",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Velocidad:"}),e.jsx(dt,{value:[ne],onValueChange:ve=>Ee(ve[0]),min:100,max:2e3,step:100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400 w-16",children:[ne,"ms"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-cyan-400 mb-3",children:"Threads"}),e.jsx("div",{className:"space-y-3",children:I.map(ve=>e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-all ${ve.state==="running"?"bg-green-900/30 border-green-500":ve.state==="ready"?"bg-blue-900/30 border-blue-500":"bg-gray-900/30 border-gray-500"}`,children:[e.jsx("div",{className:"font-bold mb-2",children:ve.name}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:["Estado: ",ve.state]}),e.jsxs("div",{children:["Lock: ",ve.hasLock?"🔒 Sí":"❌ No"]}),e.jsxs("div",{children:["Preemption: ",ve.preemptDisabled?"🚫 Disabled":"✅ Enabled"]}),e.jsxs("div",{children:["Sección Crítica: ",ve.criticalSection?"⚠️ Sí":"No"]})]})]},ve.id))})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-orange-400 mb-3",children:"Estado del Sistema"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-all ${F?"bg-green-900/30 border-green-500":"bg-red-900/30 border-red-500"}`,children:[e.jsx("div",{className:"text-sm font-bold mb-1",children:"Preemption Global"}),e.jsx("div",{className:"text-2xl",children:F?"✅ Enabled":"🚫 DISABLED"})]}),e.jsxs("div",{className:"p-4 rounded-lg border-2 bg-slate-800/30 border-slate-600",children:[e.jsx("div",{className:"text-sm font-bold mb-1",children:"Context Switches"}),e.jsx("div",{className:"text-3xl text-cyan-400",children:ze})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-4 p-2 bg-slate-800/50 rounded",children:"💡 Preemption disabled garantiza que el thread complete su sección crítica sin interrupciones, reduciendo el tiempo total que otros threads esperan por el lock."})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-purple-400 mb-3",children:"Event Log"}),e.jsx("div",{ref:ce,className:"h-48 overflow-y-auto space-y-1 font-mono text-xs",children:$.map((ve,gt)=>e.jsx("div",{className:`p-2 rounded ${ve.type==="success"?"bg-green-900/20 text-green-300":ve.type==="warning"?"bg-yellow-900/20 text-yellow-300":ve.type==="error"?"bg-red-900/20 text-red-300":"bg-slate-800/20 text-gray-300"}`,children:ve.message},gt))})]})]})}),e.jsx(ue,{value:"demo-lockfree",className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-br from-cyan-900/20 to-slate-800/20 p-6 rounded-lg border border-cyan-700/30",children:[e.jsx("h3",{className:"text-2xl font-bold text-cyan-300 mb-4",children:"🔓 Demo: Lock-Free Stack"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Operaciones lock-free usando CAS. Sin locks = sin convoying."}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>K(!k),className:`px-6 py-2 rounded-lg font-semibold transition-colors ${k?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:k?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"inline size-5 mr-2"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"inline size-5 mr-2"}),"Iniciar"]})}),e.jsxs("button",{onClick:ft,className:"px-6 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-semibold transition-colors",children:[e.jsx(it,{className:"inline size-5 mr-2"}),"Resetear"]}),e.jsxs("div",{className:"flex items-center gap-3 ml-auto",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Velocidad:"}),e.jsx(dt,{value:[M],onValueChange:ve=>D(ve[0]),min:100,max:2e3,step:100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400 w-16",children:[M,"ms"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-cyan-400 mb-3",children:"Lock-Free Stack"}),e.jsx("div",{className:"space-y-2 mb-4",children:be.length===0?e.jsx("div",{className:"text-gray-500 text-center py-8 border-2 border-dashed border-slate-600 rounded",children:"Stack vacío"}):e.jsx(e.Fragment,{children:[...be].reverse().map((ve,gt)=>e.jsxs("div",{className:"p-3 bg-blue-900/30 border-2 border-blue-500 rounded-lg text-center font-bold text-xl animate-pulse",children:[ve,gt===0&&e.jsx("span",{className:"text-xs ml-2",children:"← TOP"})]},gt))})}),e.jsxs("div",{className:"text-xs text-gray-400 bg-slate-800/50 p-2 rounded",children:["Total CAS operations: ",e.jsx("span",{className:"text-cyan-400 font-bold",children:je})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-orange-400 mb-3",children:"Threads"}),e.jsx("div",{className:"space-y-3",children:R.map(ve=>e.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${ve.state==="executing"?"bg-yellow-900/30 border-yellow-500 animate-pulse":ve.state==="finished"?"bg-green-900/30 border-green-500":"bg-slate-800/30 border-slate-600"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-bold",children:["Thread ",ve.id]}),e.jsx("span",{className:"text-xs bg-slate-700 px-2 py-1 rounded",children:ve.operation.toUpperCase()})]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:["Valor: ",ve.operation==="push"?ve.value:ve.value??"—"]}),e.jsxs("div",{children:["CAS attempts: ",ve.casAttempts]}),e.jsxs("div",{className:"text-gray-400",children:["Estado: ",ve.state]})]})]},ve.id))}),e.jsx("div",{className:"text-xs text-gray-400 mt-4 p-2 bg-slate-800/50 rounded",children:"💡 Los threads pueden fallar CAS y reintentar, pero NUNCA se bloquean esperando un lock."})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-purple-400 mb-3",children:"Event Log"}),e.jsx("div",{ref:Te,className:"h-48 overflow-y-auto space-y-1 font-mono text-xs",children:ae.map((ve,gt)=>e.jsx("div",{className:`p-2 rounded ${ve.type==="success"?"bg-green-900/20 text-green-300":ve.type==="warning"?"bg-yellow-900/20 text-yellow-300":ve.type==="error"?"bg-red-900/20 text-red-300":"bg-slate-800/20 text-gray-300"}`,children:ve.message},gt))})]})]})}),e.jsx(ue,{value:"demo-adaptive",className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-br from-orange-900/20 to-slate-800/20 p-6 rounded-lg border border-orange-700/30",children:[e.jsx("h3",{className:"text-2xl font-bold text-orange-300 mb-4",children:"🔄 Demo: Adaptive Spinning"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Decisión inteligente: spin si owner ejecutándose, block si no."}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>xe(!jt),className:`px-6 py-2 rounded-lg font-semibold transition-colors ${jt?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:jt?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"inline size-5 mr-2"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"inline size-5 mr-2"}),"Iniciar"]})}),e.jsxs("button",{onClick:Ct,className:"px-6 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-semibold transition-colors",children:[e.jsx(it,{className:"inline size-5 mr-2"}),"Resetear"]}),e.jsxs("div",{className:"flex items-center gap-3 ml-auto",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Velocidad:"}),e.jsx(dt,{value:[Me],onValueChange:ve=>De(ve[0]),min:100,max:2e3,step:100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400 w-16",children:[Me,"ms"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-cyan-400 mb-3",children:"Threads"}),e.jsx("div",{className:"space-y-3",children:Se.map(ve=>e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-all ${ve.state==="running"?"bg-green-900/30 border-green-500":ve.spinning?"bg-yellow-900/30 border-yellow-500 animate-pulse":ve.blocked?"bg-red-900/30 border-red-500":ve.state==="finished"?"bg-gray-900/30 border-gray-500":"bg-slate-800/30 border-slate-600"}`,children:[e.jsxs("div",{className:"font-bold mb-2",children:["Thread ",ve.id]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:["Estado: ",ve.state]}),e.jsxs("div",{children:["Spinning: ",ve.spinning?"🔄 Sí":"No"]}),e.jsxs("div",{children:["Blocked: ",ve.blocked?"🚫 Sí":"No"]}),e.jsxs("div",{children:["Spin count: ",ve.spinCount]})]})]},ve.id))})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-orange-400 mb-3",children:"Estado del Owner & Historial"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border-2 bg-slate-800/30 border-slate-600",children:[e.jsx("div",{className:"text-sm font-bold mb-1",children:"Lock Owner"}),e.jsx("div",{className:"text-2xl",children:We?`Thread ${We}`:"Ninguno"})]}),e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-all ${Ot?"bg-green-900/30 border-green-500":"bg-red-900/30 border-red-500"}`,children:[e.jsx("div",{className:"text-sm font-bold mb-1",children:"Owner Estado"}),e.jsx("div",{className:"text-xl",children:Ot?"▶️ RUNNING":"⏸️ Bloqueado"})]}),e.jsxs("div",{className:"p-4 rounded-lg border-2 bg-slate-800/30 border-slate-600",children:[e.jsx("div",{className:"text-sm font-bold mb-2",children:"Historial de Spinning"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Exitosos:"}),e.jsx("span",{className:"text-green-400 font-bold",children:Ue.successful})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Fallidos:"}),e.jsx("span",{className:"text-red-400 font-bold",children:Ue.failed})]}),e.jsxs("div",{className:"flex justify-between border-t border-slate-600 pt-1 mt-1",children:[e.jsx("span",{children:"Efectividad:"}),e.jsxs("span",{className:"text-cyan-400 font-bold",children:[Ue.successful+Ue.failed>0?Math.round(Ue.successful/(Ue.successful+Ue.failed)*100):0,"%"]})]})]})]}),e.jsx("div",{className:"text-xs text-gray-400 p-2 bg-slate-800/50 rounded",children:"💡 Adaptive spinning decide dinámicamente entre spinning y bloqueo basándose en si el owner está ejecutándose."})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[e.jsx("h4",{className:"font-bold text-purple-400 mb-3",children:"Event Log"}),e.jsx("div",{ref:_t,className:"h-48 overflow-y-auto space-y-1 font-mono text-xs",children:et.map((ve,gt)=>e.jsx("div",{className:`p-2 rounded ${ve.type==="success"?"bg-green-900/20 text-green-300":ve.type==="warning"?"bg-yellow-900/20 text-yellow-300":ve.type==="error"?"bg-red-900/20 text-red-300":"bg-slate-800/20 text-gray-300"}`,children:ve.message},gt))})]})]})})]})})]})})})]})}const u2=Sa("/ActividadesSeminarioSO/actividad11/convoying")({component:d2});function m2(){const[s,o]=c.useState([]),[n,l]=c.useState(!1),[d,m]=c.useState(0),[h,x]=c.useState(500),[g,b]=c.useState([]),[v,f]=c.useState(["Simulación Lock-free iniciada. Usando operaciones CAS."]),N=c.useRef(null),[j,_]=c.useState([{id:1,status:"idle",partition:0},{id:2,status:"idle",partition:1},{id:3,status:"idle",partition:2},{id:4,status:"idle",partition:3}]),[w,C]=c.useState(!1),[E,z]=c.useState(0),[P,V]=c.useState(500),[Z,oe]=c.useState(new Map([[0,[]],[1,[]],[2,[]],[3,[]]])),[O,T]=c.useState(["Simulación de Particionamiento iniciada. 4 particiones independientes."]),ge=c.useRef(null),[J,W]=c.useState([{id:1,status:"idle",partition:0},{id:2,status:"idle",partition:1},{id:3,status:"idle",partition:2},{id:4,status:"idle",partition:0}]),[ne,Ee]=c.useState(!1),[Ce,Le]=c.useState(0),[I,Q]=c.useState(500),[F,de]=c.useState([!1,!1,!1,!1]),[ze,A]=c.useState(["Simulación Lock Striping iniciada. 4 stripes con locks independientes."]),$=c.useRef(null),[se,k]=c.useState([{id:1,status:"idle",localValue:0},{id:2,status:"idle",localValue:0},{id:3,status:"idle",localValue:0},{id:4,status:"idle",localValue:0}]),[K,M]=c.useState(!1),[D,q]=c.useState(0),[G,be]=c.useState(500),[Ne,R]=c.useState(0),[ke,je]=c.useState(["Simulación Thread-local iniciada. Cada thread tiene su contador local."]),ee=c.useRef(null),[ae,rt]=c.useState([{id:1,status:"idle",version:0},{id:2,status:"idle",version:0},{id:3,status:"idle",version:0},{id:4,status:"idle",version:0}]),[jt,xe]=c.useState(!1),[Me,De]=c.useState(0),[Ge,qe]=c.useState(500),[Se,Xe]=c.useState(100),[We,xt]=c.useState(0),[Ot,It]=c.useState(0),[Ue,At]=c.useState(["Simulación OCC iniciada. Validación optimista con versionado."]),et=c.useRef(null),[L,re]=c.useState([{id:1,status:"idle",batchSize:0},{id:2,status:"idle",batchSize:0},{id:3,status:"idle",batchSize:0},{id:4,status:"idle",batchSize:0}]),[Ve,ce]=c.useState(!1),[Te,_t]=c.useState(0),[St,tt]=c.useState(500),[Ye,ft]=c.useState([]),[Ct,ve]=c.useState(0),[gt,$e]=c.useState(["Simulación Batching iniciada. Agrupa operaciones en lotes."]),B=c.useRef(null),[U,Dt]=c.useState([{id:1,status:"idle",partition:0},{id:2,status:"idle",partition:1},{id:3,status:"idle",partition:2},{id:4,status:"idle",partition:3}]),[Ke,fe]=c.useState(!1),[$t,Zt]=c.useState(0),[pt,zt]=c.useState(500),[lt,Be]=c.useState([!1,!1,!1,!1]),[Ie,Je]=c.useState(["read","read","read","read"]),[ot,X]=c.useState(["Simulación Fine-grained Locks iniciada. Locks por nodo."]),Oe=c.useRef(null);c.useEffect(()=>{N.current&&(N.current.scrollTop=N.current.scrollHeight)},[v]),c.useEffect(()=>{ge.current&&(ge.current.scrollTop=ge.current.scrollHeight)},[O]),c.useEffect(()=>{$.current&&($.current.scrollTop=$.current.scrollHeight)},[ze]),c.useEffect(()=>{ee.current&&(ee.current.scrollTop=ee.current.scrollHeight)},[ke]),c.useEffect(()=>{et.current&&(et.current.scrollTop=et.current.scrollHeight)},[Ue]),c.useEffect(()=>{B.current&&(B.current.scrollTop=B.current.scrollHeight)},[gt]),c.useEffect(()=>{Oe.current&&(Oe.current.scrollTop=Oe.current.scrollHeight)},[ot]),c.useEffect(()=>{if(!n)return;const _e=setInterval(()=>{if(m(Fe=>Fe+1),Math.random()<.7){const Fe=Math.floor(Math.random()*4)+1,ht=Math.random()<.5?"push":"pop",Lt=ht==="push"?Math.floor(Math.random()*100):void 0,ut={id:Date.now()+Math.random(),type:ht,threadId:Fe,status:"pending",value:Lt,attempts:0};o(Y=>[...Y.slice(-6),ut]),Math.random()<.85?setTimeout(()=>{o(Y=>Y.map(we=>we.id===ut.id?{...we,status:"success"}:we)),ht==="push"&&Lt!==void 0?(b(Y=>[...Y,Lt].slice(-8)),f(Y=>[...Y.slice(-9),`T${Fe}: PUSH(${Lt}) exitoso - CAS success`])):ht==="pop"&&b(Y=>{if(Y.length>0){const we=Y[Y.length-1];return f(Mt=>[...Mt.slice(-9),`T${Fe}: POP() = ${we} - CAS success`]),Y.slice(0,-1)}return f(we=>[...we.slice(-9),`T${Fe}: POP() = null (stack vacío)`]),Y})},h/2):setTimeout(()=>{o(Y=>Y.map(we=>we.id===ut.id?{...we,status:"retry",attempts:(we.attempts||0)+1}:we)),f(Y=>[...Y.slice(-9),`T${Fe}: CAS falló, reintentando ${ht.toUpperCase()}...`]),setTimeout(()=>{o(Y=>Y.map(we=>we.id===ut.id?{...we,status:"success"}:we)),ht==="push"&&Lt!==void 0?(b(Y=>[...Y,Lt].slice(-8)),f(Y=>[...Y.slice(-9),`T${Fe}: PUSH(${Lt}) exitoso tras reintento`])):ht==="pop"&&b(Y=>{if(Y.length>0){const we=Y[Y.length-1];return f(Mt=>[...Mt.slice(-9),`T${Fe}: POP() = ${we} tras reintento`]),Y.slice(0,-1)}return Y})},h/2)},h/3)}},h);return()=>clearInterval(_e)},[n,h]),c.useEffect(()=>{if(!w)return;const _e=setInterval(()=>{z(ut=>ut+1);const Fe=Math.floor(Math.random()*4),ht=j[Fe].partition,Lt=Math.floor(Math.random()*100);_(ut=>ut.map((at,Y)=>Y===Fe?{...at,status:"working"}:at)),T(ut=>[...ut.slice(-9),`T${Fe+1}: Escribiendo ${Lt} en Partición ${ht}`]),setTimeout(()=>{oe(ut=>{const at=new Map(ut),Y=at.get(ht)||[];return at.set(ht,[...Y,Lt].slice(-5)),at}),_(ut=>ut.map((at,Y)=>Y===Fe?{...at,status:"success"}:at)),T(ut=>[...ut.slice(-9),`T${Fe+1}: Escritura exitosa (sin contención)`]),setTimeout(()=>{_(ut=>ut.map((at,Y)=>Y===Fe?{...at,status:"idle"}:at))},P/3)},P/2)},P);return()=>clearInterval(_e)},[w,P,j]),c.useEffect(()=>{if(!ne)return;const _e=setInterval(()=>{Le(Lt=>Lt+1);const Fe=Math.floor(Math.random()*4),ht=J[Fe].partition;de(Lt=>{if(Lt[ht])return A(at=>[...at.slice(-9),`T${Fe+1}: Esperando lock del Stripe ${ht}...`]),W(at=>at.map((Y,we)=>we===Fe?{...Y,status:"waiting"}:Y)),Lt;const ut=[...Lt];return ut[ht]=!0,A(at=>[...at.slice(-9),`T${Fe+1}: Lock adquirido en Stripe ${ht}`]),W(at=>at.map((Y,we)=>we===Fe?{...Y,status:"working"}:Y)),setTimeout(()=>{de(at=>{const Y=[...at];return Y[ht]=!1,Y}),A(at=>[...at.slice(-9),`T${Fe+1}: Lock liberado del Stripe ${ht}`]),W(at=>at.map((Y,we)=>we===Fe?{...Y,status:"success"}:Y)),setTimeout(()=>{W(at=>at.map((Y,we)=>we===Fe?{...Y,status:"idle"}:Y))},I/3)},I/2),ut})},I);return()=>clearInterval(_e)},[ne,I,J]),c.useEffect(()=>{if(!K)return;const _e=setInterval(()=>{q(ht=>ht+1);const Fe=Math.floor(Math.random()*4);k(ht=>ht.map((Lt,ut)=>{if(ut===Fe){const at=(Lt.localValue||0)+1;return je(Y=>[...Y.slice(-9),`T${ut+1}: Incremento local ${Lt.localValue} → ${at} (sin contención)`]),{...Lt,status:"working",localValue:at}}return Lt})),setTimeout(()=>{k(ht=>ht.map((Lt,ut)=>ut===Fe?{...Lt,status:"success"}:Lt)),setTimeout(()=>{k(ht=>ht.map((Lt,ut)=>ut===Fe?{...Lt,status:"idle"}:Lt))},G/3)},G/2)},G);return()=>clearInterval(_e)},[K,G]),c.useEffect(()=>{if(K&&D%3===0){const _e=se.reduce((Fe,ht)=>Fe+(ht.localValue||0),0);R(_e)}},[D,K,se]),c.useEffect(()=>{if(!jt)return;const _e=setInterval(()=>{De(ut=>ut+1);const Fe=Math.floor(Math.random()*4),ht=Math.floor(Math.random()*10)+1,Lt=We;rt(ut=>ut.map((at,Y)=>Y===Fe?{...at,status:"working",version:Lt}:at)),At(ut=>[...ut.slice(-9),`T${Fe+1}: Leyó valor=${Se} (v${Lt}), calculando +${ht}...`]),setTimeout(()=>{const ut=We;Lt===ut?(Xe(at=>at+ht),xt(at=>at+1),rt(at=>at.map((Y,we)=>we===Fe?{...Y,status:"success"}:Y)),At(at=>[...at.slice(-9),`T${Fe+1}: Commit exitoso! ${Se} → ${Se+ht} (v${ut+1})`])):(It(at=>at+1),rt(at=>at.map((Y,we)=>we===Fe?{...Y,status:"retry"}:Y)),At(at=>[...at.slice(-9),`T${Fe+1}: ⚠️ CONFLICTO! Versión cambió (v${Lt}→v${ut}), reintentando...`])),setTimeout(()=>{rt(at=>at.map((Y,we)=>we===Fe?{...Y,status:"idle"}:Y))},Ge/3)},Ge/2)},Ge);return()=>clearInterval(_e)},[jt,Ge,We,Se]),c.useEffect(()=>{if(!Ve)return;const _e=setInterval(()=>{_t(Lt=>Lt+1);const Fe=Math.floor(Math.random()*4),ht=Math.floor(Math.random()*100);re(Lt=>Lt.map((ut,at)=>{if(at===Fe){const Y=(ut.batchSize||0)+1;return{...ut,status:"working",batchSize:Y}}return ut})),ft(Lt=>[...Lt,ht]),$e(Lt=>[...Lt.slice(-9),`T${Fe+1}: Agregó ${ht} al buffer local (tamaño: ${(L[Fe].batchSize||0)+1})`]),(L[Fe].batchSize||0)>=2?setTimeout(()=>{ft(Lt=>{const ut=Lt.slice(-5);return $e(at=>[...at.slice(-9),`📦 Procesando LOTE de ${ut.length} operaciones: [${ut.join(", ")}]`]),ve(at=>at+ut.length),[]}),re(Lt=>Lt.map(ut=>({...ut,batchSize:0,status:"success"}))),setTimeout(()=>{re(Lt=>Lt.map(ut=>({...ut,status:"idle"})))},St/3)},St/2):setTimeout(()=>{re(Lt=>Lt.map((ut,at)=>at===Fe?{...ut,status:"idle"}:ut))},St/3)},St);return()=>clearInterval(_e)},[Ve,St,L]),c.useEffect(()=>{if(!Ke)return;const _e=setInterval(()=>{Zt(ut=>ut+1);const Fe=Math.floor(Math.random()*4),ht=U[Fe].partition;(Math.random()<.7?"read":"write")==="read"?(Je(ut=>{const at=[...ut];return at[ht]="read",at}),Dt(ut=>ut.map((at,Y)=>Y===Fe?{...at,status:"working"}:at)),X(ut=>[...ut.slice(-9),`T${Fe+1}: Leyendo Nodo ${ht} (lectura concurrente permitida)`]),setTimeout(()=>{Dt(ut=>ut.map((at,Y)=>Y===Fe?{...at,status:"success"}:at)),setTimeout(()=>{Dt(ut=>ut.map((at,Y)=>Y===Fe?{...at,status:"idle"}:at))},pt/3)},pt/2)):Be(ut=>{if(ut[ht])return X(Y=>[...Y.slice(-9),`T${Fe+1}: Esperando lock exclusivo del Nodo ${ht}...`]),Dt(Y=>Y.map((we,Mt)=>Mt===Fe?{...we,status:"waiting"}:we)),ut;const at=[...ut];return at[ht]=!0,Je(Y=>{const we=[...Y];return we[ht]="write",we}),X(Y=>[...Y.slice(-9),`T${Fe+1}: Lock exclusivo adquirido en Nodo ${ht} (escritura)`]),Dt(Y=>Y.map((we,Mt)=>Mt===Fe?{...we,status:"working"}:we)),setTimeout(()=>{Be(Y=>{const we=[...Y];return we[ht]=!1,we}),X(Y=>[...Y.slice(-9),`T${Fe+1}: Lock liberado del Nodo ${ht}`]),Dt(Y=>Y.map((we,Mt)=>Mt===Fe?{...we,status:"success"}:we)),setTimeout(()=>{Dt(Y=>Y.map((we,Mt)=>Mt===Fe?{...we,status:"idle"}:we))},pt/3)},pt/2),at})},pt);return()=>clearInterval(_e)},[Ke,pt,U]);const st=()=>{l(!1),m(0),o([]),b([]),f(["Simulación Lock-free reiniciada."])},Rt=()=>{C(!1),z(0),_(_e=>_e.map(Fe=>({...Fe,status:"idle"}))),oe(new Map([[0,[]],[1,[]],[2,[]],[3,[]]])),T(["Simulación de Particionamiento reiniciada."])},Qe=()=>{Ee(!1),Le(0),W(_e=>_e.map(Fe=>({...Fe,status:"idle"}))),de([!1,!1,!1,!1]),A(["Simulación Lock Striping reiniciada."])},He=()=>{M(!1),q(0),k([{id:1,status:"idle",localValue:0},{id:2,status:"idle",localValue:0},{id:3,status:"idle",localValue:0},{id:4,status:"idle",localValue:0}]),R(0),je(["Simulación Thread-local reiniciada."])},mt=()=>{xe(!1),De(0),rt(_e=>_e.map(Fe=>({...Fe,status:"idle",version:0}))),Xe(100),xt(0),It(0),At(["Simulación OCC reiniciada."])},Jt=()=>{ce(!1),_t(0),re([{id:1,status:"idle",batchSize:0},{id:2,status:"idle",batchSize:0},{id:3,status:"idle",batchSize:0},{id:4,status:"idle",batchSize:0}]),ft([]),ve(0),$e(["Simulación Batching reiniciada."])},pa=()=>{fe(!1),Zt(0),Dt(_e=>_e.map(Fe=>({...Fe,status:"idle"}))),Be([!1,!1,!1,!1]),Je(["read","read","read","read"]),X(["Simulación Fine-grained Locks reiniciada."])};return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(fp,{className:"size-12 text-orange-500"}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"⚡ Contención de Recursos"})]}),e.jsxs("p",{className:"text-lg text-gray-300 leading-relaxed",children:["La ",e.jsx("span",{className:"font-bold text-orange-400",children:"Contención de Recursos"})," ocurre cuando múltiples threads o procesos compiten por el mismo recurso compartido, causando degradación del rendimiento debido a la espera y sincronización excesiva. Este problema es crítico en sistemas de alta concurrencia."]}),e.jsx("div",{className:"mt-4 p-4 bg-orange-900/30 border border-orange-700/50 rounded-lg",children:e.jsxs("p",{className:"text-orange-200",children:[e.jsx("span",{className:"font-bold",children:"Impacto:"})," La contención puede causar hasta un 90% de degradación del rendimiento en sistemas con muchos cores, convirtiendo locks en cuellos de botella críticos. Las soluciones se enfocan en reducir o eliminar la necesidad de sincronización tradicional."]})})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs(Da,{type:"multiple",defaultValue:["soluciones","demostracion"],className:"space-y-4",children:[e.jsxs(sa,{value:"soluciones",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Soluciones (Pseudocódigo)"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"lockfree",className:"px-6 pb-6",children:[e.jsxs(Qt,{className:"grid grid-cols-7 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"lockfree",children:"🔓 Lock-free"}),e.jsx(le,{value:"partitioning",children:"🧩 Particionamiento"}),e.jsx(le,{value:"striping",children:"🎨 Striping"}),e.jsx(le,{value:"threadlocal",children:"🧵 Thread-local"}),e.jsx(le,{value:"optimistic",children:"✨ Optimistic"}),e.jsx(le,{value:"batching",children:"📦 Batching"}),e.jsx(le,{value:"granularity",children:"🔬 Granularidad"})]}),e.jsx(ue,{value:"lockfree",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-blue-400 mb-4",children:"🔓 Lock-free Data Structures"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Estructuras de datos que garantizan progreso del sistema sin usar locks, mediante operaciones atómicas como CAS (Compare-And-Swap)."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Lock-free Stack (Treiber Stack)
estructura Node<T> {
  valor: T
  siguiente: AtomicReference<Node<T>>
}

estructura LockFreeStack<T> {
  cabeza: AtomicReference<Node<T>> = null
}

función push(stack: LockFreeStack<T>, valor: T) {
  nuevoNodo = new Node(valor)
  
  loop:
    cabezaActual = cargar_atomico(stack.cabeza)
    nuevoNodo.siguiente = cabezaActual
    
    // Intenta actualizar cabeza atómicamente
    si compare_and_swap(stack.cabeza, cabezaActual, nuevoNodo):
      retornar  // Éxito
    // Si falla, otro thread modificó la cabeza, reintentar
}

función pop(stack: LockFreeStack<T>): T | null {
  loop:
    cabezaActual = cargar_atomico(stack.cabeza)
    
    si cabezaActual == null:
      retornar null
    
    siguiente = cabezaActual.siguiente
    
    // Intenta mover cabeza al siguiente nodo
    si compare_and_swap(stack.cabeza, cabezaActual, siguiente):
      retornar cabezaActual.valor
    // Reintentar si falló
}

// Lock-free Queue (Michael-Scott Queue)
estructura LockFreeQueue<T> {
  cabeza: AtomicReference<Node<T>>
  cola: AtomicReference<Node<T>>
}

función inicializarQueue() -> LockFreeQueue<T> {
  nodoSentinel = new Node(null)
  queue = new LockFreeQueue()
  queue.cabeza = nodoSentinel
  queue.cola = nodoSentinel
  retornar queue
}

función enqueue(queue: LockFreeQueue<T>, valor: T) {
  nuevoNodo = new Node(valor)
  nuevoNodo.siguiente = null
  
  loop:
    colaActual = cargar_atomico(queue.cola)
    siguienteActual = cargar_atomico(colaActual.siguiente)
    
    si colaActual == cargar_atomico(queue.cola):
      si siguienteActual == null:
        // Intenta enlazar nuevo nodo
        si compare_and_swap(colaActual.siguiente, null, nuevoNodo):
          // Intenta mover cola
          compare_and_swap(queue.cola, colaActual, nuevoNodo)
          retornar
      sino:
        // Ayudar a otro thread
        compare_and_swap(queue.cola, colaActual, siguienteActual)
}

función dequeue(queue: LockFreeQueue<T>): T | null {
  loop:
    cabezaActual = cargar_atomico(queue.cabeza)
    colaActual = cargar_atomico(queue.cola)
    siguienteActual = cargar_atomico(cabezaActual.siguiente)
    
    si cabezaActual == cargar_atomico(queue.cabeza):
      si cabezaActual == colaActual:
        si siguienteActual == null:
          retornar null  // Queue vacía
        // Ayudar a mover cola
        compare_and_swap(queue.cola, colaActual, siguienteActual)
      sino:
        valor = siguienteActual.valor
        si compare_and_swap(queue.cabeza, cabezaActual, siguienteActual):
          retornar valor
}

// Lock-free Counter
estructura LockFreeCounter {
  valor: AtomicInteger = 0
}

función incrementar(counter: LockFreeCounter, delta: entero = 1): entero {
  loop:
    valorActual = cargar_atomico(counter.valor)
    nuevoValor = valorActual + delta
    
    si compare_and_swap(counter.valor, valorActual, nuevoValor):
      retornar nuevoValor
}

// Ventajas: Sin bloqueos, escalabilidad, tolerancia a fallos
// Desventajas: Complejidad, ABA problem, overhead de CAS`})}),e.jsx("div",{className:"mt-4 p-3 bg-blue-900/30 border border-blue-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Sin deadlocks ni bloqueos, excelente escalabilidad.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Complejidad de implementación, problema ABA."]})})]})}),e.jsx(ue,{value:"partitioning",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-green-400 mb-4",children:"🧩 Particionamiento de Recursos"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Divide un recurso compartido en múltiples particiones independientes, reduciendo la contención al permitir acceso concurrente a diferentes particiones."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Hash Table Particionada
estructura Particion<K, V> {
  datos: Mapa<K, V>
  lock: Lock
}

estructura HashTableParticionada<K, V> {
  particiones: Arreglo<Particion<K, V>>
  numParticiones: entero
}

función crear(numParticiones: entero) -> HashTableParticionada<K, V> {
  tabla = new HashTableParticionada()
  tabla.numParticiones = numParticiones
  tabla.particiones = new Arreglo<Particion>(numParticiones)
  
  para i en 0..numParticiones-1:
    tabla.particiones[i] = new Particion()
    tabla.particiones[i].datos = new Mapa()
    tabla.particiones[i].lock = new Lock()
  
  retornar tabla
}

función obtenerParticion(tabla: HashTableParticionada<K, V>, clave: K) -> entero {
  hashCode = hash(clave)
  retornar hashCode % tabla.numParticiones
}

función insertar(tabla: HashTableParticionada<K, V>, clave: K, valor: V) {
  indiceParticion = obtenerParticion(tabla, clave)
  particion = tabla.particiones[indiceParticion]
  
  particion.lock.adquirir()
  particion.datos[clave] = valor
  particion.lock.liberar()
}

función obtener(tabla: HashTableParticionada<K, V>, clave: K) -> V | null {
  indiceParticion = obtenerParticion(tabla, clave)
  particion = tabla.particiones[indiceParticion]
  
  particion.lock.adquirir()
  valor = particion.datos.obtener(clave)
  particion.lock.liberar()
  
  retornar valor
}

función eliminar(tabla: HashTableParticionada<K, V>, clave: K) {
  indiceParticion = obtenerParticion(tabla, clave)
  particion = tabla.particiones[indiceParticion]
  
  particion.lock.adquirir()
  particion.datos.eliminar(clave)
  particion.lock.liberar()
}

// Contador Particionado (para reducir contención)
estructura ContadorParticionado {
  contadores: Arreglo<AtomicInteger>
  numParticiones: entero
}

función incrementar(contador: ContadorParticionado) {
  threadId = obtenerThreadId()
  particion = threadId % contador.numParticiones
  
  incrementar_atomico(contador.contadores[particion])
}

función obtenerTotal(contador: ContadorParticionado) -> entero {
  suma = 0
  para i en 0..contador.numParticiones-1:
    suma += cargar_atomico(contador.contadores[i])
  retornar suma
}

// Ejemplo de uso con base de datos
estructura BaseDatosParticionada {
  shards: Arreglo<Shard>
  numShards: entero
}

función routearConsulta(db: BaseDatosParticionada, userId: entero) -> Shard {
  shardId = userId % db.numShards
  retornar db.shards[shardId]
}

// Beneficio: Reducción de contención proporcional al número de particiones
// Costo: Operaciones globales más complejas (ej: contar total)`})}),e.jsx("div",{className:"mt-4 p-3 bg-green-900/30 border border-green-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-green-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Escalabilidad lineal, fácil de implementar.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Operaciones globales costosas, posible desbalance."]})})]})}),e.jsx(ue,{value:"striping",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-400 mb-4",children:"🎨 Lock Striping"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Técnica que usa múltiples locks para proteger diferentes secciones de una estructura de datos, similar al particionamiento pero con locks explícitos por segmento."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// ConcurrentHashMap estilo Java
estructura Segment<K, V> {
  tabla: Arreglo<Entry<K, V>>
  lock: ReentrantLock
  tamaño: AtomicInteger
}

estructura Entry<K, V> {
  clave: K
  valor: V
  hash: entero
  siguiente: Entry<K, V> | null
}

estructura StripedHashMap<K, V> {
  segmentos: Arreglo<Segment<K, V>>
  numSegmentos: entero
  mascara: entero  // numSegmentos - 1
}

función crear(concurrencyLevel: entero) -> StripedHashMap<K, V> {
  // Redondear a potencia de 2
  numSegmentos = siguientePotenciaDe2(concurrencyLevel)
  
  mapa = new StripedHashMap()
  mapa.numSegmentos = numSegmentos
  mapa.mascara = numSegmentos - 1
  mapa.segmentos = new Arreglo<Segment>(numSegmentos)
  
  para i en 0..numSegmentos-1:
    mapa.segmentos[i] = new Segment()
    mapa.segmentos[i].lock = new ReentrantLock()
    mapa.segmentos[i].tabla = new Arreglo<Entry>(16)
    mapa.segmentos[i].tamaño = new AtomicInteger(0)
  
  retornar mapa
}

función obtenerSegmento(mapa: StripedHashMap<K, V>, hash: entero) -> Segment<K, V> {
  // Usar bits altos del hash para mejor distribución
  indice = (hash >>> 16) & mapa.mascara
  retornar mapa.segmentos[indice]
}

función put(mapa: StripedHashMap<K, V>, clave: K, valor: V): V | null {
  hash = hash(clave)
  segmento = obtenerSegmento(mapa, hash)
  
  segmento.lock.adquirir()
  intentar:
    // Buscar en la cadena
    indiceTabla = hash & (segmento.tabla.longitud - 1)
    entrada = segmento.tabla[indiceTabla]
    
    mientras entrada != null:
      si entrada.hash == hash Y entrada.clave == clave:
        valorViejo = entrada.valor
        entrada.valor = valor
        retornar valorViejo
      entrada = entrada.siguiente
    
    // Insertar nueva entrada
    nuevaEntrada = new Entry(clave, valor, hash)
    nuevaEntrada.siguiente = segmento.tabla[indiceTabla]
    segmento.tabla[indiceTabla] = nuevaEntrada
    
    incrementar_atomico(segmento.tamaño)
    
    retornar null
  finalmente:
    segmento.lock.liberar()
}

función get(mapa: StripedHashMap<K, V>, clave: K): V | null {
  hash = hash(clave)
  segmento = obtenerSegmento(mapa, hash)
  
  // Lectura optimista sin lock
  indiceTabla = hash & (segmento.tabla.longitud - 1)
  entrada = segmento.tabla[indiceTabla]
  
  mientras entrada != null:
    si entrada.hash == hash Y entrada.clave == clave:
      retornar entrada.valor
    entrada = entrada.siguiente
  
  retornar null
}

función size(mapa: StripedHashMap<K, V>) -> entero {
  tamaño = 0
  
  // Adquirir todos los locks para garantizar consistencia
  para segmento en mapa.segmentos:
    segmento.lock.adquirir()
  
  intentar:
    para segmento en mapa.segmentos:
      tamaño += cargar_atomico(segmento.tamaño)
    retornar tamaño
  finalmente:
    para segmento en mapa.segmentos:
      segmento.lock.liberar()
}

// Lock Striping en Array
estructura StripedArray<T> {
  datos: Arreglo<T>
  locks: Arreglo<Lock>
  numLocks: entero
}

función obtenerLock(array: StripedArray<T>, indice: entero) -> Lock {
  lockIndice = indice % array.numLocks
  retornar array.locks[lockIndice]
}

función set(array: StripedArray<T>, indice: entero, valor: T) {
  lock = obtenerLock(array, indice)
  
  lock.adquirir()
  array.datos[indice] = valor
  lock.liberar()
}

// Ventaja: Concurrencia proporcional al número de stripes
// Nota: Java's ConcurrentHashMap usa esta técnica (16 segmentos por defecto)`})}),e.jsx("div",{className:"mt-4 p-3 bg-purple-900/30 border border-purple-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-purple-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Balance entre simplicidad y concurrencia.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Operaciones que cruzan segmentos son costosas."]})})]})}),e.jsx(ue,{value:"threadlocal",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-400 mb-4",children:"🧵 Thread-local Storage"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Cada thread mantiene su propia copia de los datos, eliminando completamente la contención para lecturas y escrituras locales."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Thread-local Storage Básico
estructura ThreadLocalStorage<T> {
  valores: Mapa<ThreadId, T>
  lock: Lock
  valorInicial: función() -> T
}

función obtener(tls: ThreadLocalStorage<T>) -> T {
  threadId = obtenerThreadId()
  
  tls.lock.adquirir()
  si no tls.valores.contiene(threadId):
    tls.valores[threadId] = tls.valorInicial()
  valor = tls.valores[threadId]
  tls.lock.liberar()
  
  retornar valor
}

función establecer(tls: ThreadLocalStorage<T>, valor: T) {
  threadId = obtenerThreadId()
  
  tls.lock.adquirir()
  tls.valores[threadId] = valor
  tls.lock.liberar()
}

// Contador con Thread-local (sin contención)
estructura ThreadLocalCounter {
  contadores: ThreadLocalStorage<AtomicInteger>
}

función incrementar(counter: ThreadLocalCounter) {
  localCounter = counter.contadores.obtener()
  incrementar_atomico(localCounter)
}

función obtenerTotal(counter: ThreadLocalCounter) -> entero {
  suma = 0
  para valor en counter.contadores.valores.valores():
    suma += cargar_atomico(valor)
  retornar suma
}

// Pool de Objetos Thread-local
estructura ThreadLocalPool<T> {
  pools: ThreadLocalStorage<Cola<T>>
  fabricaObjetos: función() -> T
}

función obtenerObjeto(pool: ThreadLocalPool<T>) -> T {
  colaLocal = pool.pools.obtener()
  
  si no colaLocal.vacia():
    retornar colaLocal.desencolar()
  sino:
    retornar pool.fabricaObjetos()
}

función devolverObjeto(pool: ThreadLocalPool<T>, objeto: T) {
  colaLocal = pool.pools.obtener()
  colaLocal.encolar(objeto)
}

// Ejemplo: Generador de IDs Thread-local
estructura ThreadLocalIdGenerator {
  contadores: ThreadLocalStorage<entero>
  offsetPorThread: entero
}

función crear(numThreads: entero) -> ThreadLocalIdGenerator {
  gen = new ThreadLocalIdGenerator()
  gen.offsetPorThread = 1000000  // Espacio por thread
  gen.contadores = new ThreadLocalStorage(() => 0)
  retornar gen
}

función siguienteId(gen: ThreadLocalIdGenerator) -> entero {
  threadId = obtenerThreadId()
  contador = gen.contadores.obtener()
  nuevoContador = contador + 1
  gen.contadores.establecer(nuevoContador)
  
  retornar (threadId * gen.offsetPorThread) + nuevoContador
}

// Agregación Thread-local (reduce escrituras globales)
estructura ThreadLocalAggregator<T> {
  valoresLocales: ThreadLocalStorage<T>
  funcionCombinar: función(T, T) -> T
  valorNeutro: T
}

función agregar(agg: ThreadLocalAggregator<T>, valor: T) {
  localVal = agg.valoresLocales.obtener()
  nuevoVal = agg.funcionCombinar(localVal, valor)
  agg.valoresLocales.establecer(nuevoVal)
}

función obtenerResultado(agg: ThreadLocalAggregator<T>) -> T {
  resultado = agg.valorNeutro
  
  para valorLocal en agg.valoresLocales.valores.valores():
    resultado = agg.funcionCombinar(resultado, valorLocal)
  
  retornar resultado
}

// Uso: Buffer de escritura Thread-local
estructura ThreadLocalWriteBuffer<T> {
  buffers: ThreadLocalStorage<Lista<T>>
  tamaño_lote: entero
  procesarLote: función(Lista<T>)
}

función escribir(buffer: ThreadLocalWriteBuffer<T>, item: T) {
  bufferLocal = buffer.buffers.obtener()
  bufferLocal.agregar(item)
  
  si bufferLocal.tamaño() >= buffer.tamaño_lote:
    buffer.procesarLote(bufferLocal)
    bufferLocal.limpiar()
}

// Ventajas: Cero contención, excelente rendimiento
// Desventajas: Uso de memoria (copia por thread), agregación costosa`})}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-900/30 border border-yellow-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Cero contención, rendimiento máximo.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Mayor uso de memoria, agregación compleja."]})})]})}),e.jsx(ue,{value:"optimistic",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-cyan-400 mb-4",children:"✨ Optimistic Concurrency Control"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Asume que los conflictos son raros y permite operaciones concurrentes sin locks, validando al final y reintentando si hubo conflicto."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Control de Concurrencia Optimista con Versionado
estructura VersionedData<T> {
  datos: T
  version: AtomicInteger
}

función leerOptimista<T>(datos: VersionedData<T>) -> (T, entero) {
  loop:
    version = cargar_atomico(datos.version)
    valor = datos.datos  // Lectura sin lock
    versionDespues = cargar_atomico(datos.version)
    
    // Verificar que no hubo escritura durante la lectura
    si version == versionDespues Y (version % 2) == 0:
      retornar (valor, version)
    // Reintentar si hubo escritura
}

función escribirOptimista<T>(datos: VersionedData<T>, nuevoValor: T) {
  loop:
    versionActual = cargar_atomico(datos.version)
    
    // Marcar como "en escritura" (versión impar)
    si compare_and_swap(datos.version, versionActual, versionActual + 1):
      datos.datos = nuevoValor
      
      // Completar escritura (versión par)
      almacenar_atomico(datos.version, versionActual + 2)
      retornar
    // Reintentar si otro thread tomó el lock
}

// Transacciones Optimistas (estilo STM - Software Transactional Memory)
estructura Transaccion {
  lecturas: Mapa<Variable, entero>  // Variable -> versión leída
  escrituras: Mapa<Variable, Valor>
  estado: ACTIVA | COMMITED | ABORTADA
}

función iniciarTransaccion() -> Transaccion {
  tx = new Transaccion()
  tx.lecturas = new Mapa()
  tx.escrituras = new Mapa()
  tx.estado = ACTIVA
  retornar tx
}

función leer<T>(tx: Transaccion, variable: VersionedData<T>) -> T {
  // Verificar si ya escribimos esta variable
  si tx.escrituras.contiene(variable):
    retornar tx.escrituras[variable]
  
  // Leer valor y registrar versión
  (valor, version) = leerOptimista(variable)
  tx.lecturas[variable] = version
  
  retornar valor
}

función escribir<T>(tx: Transaccion, variable: VersionedData<T>, valor: T) {
  tx.escrituras[variable] = valor
}

función commit(tx: Transaccion) -> booleano {
  // Fase 1: Validación
  para (variable, versionLeida) en tx.lecturas:
    versionActual = cargar_atomico(variable.version)
    
    si versionActual != versionLeida:
      tx.estado = ABORTADA
      retornar falso  // Conflicto detectado
  
  // Fase 2: Aplicar escrituras
  para (variable, valor) en tx.escrituras:
    escribirOptimista(variable, valor)
  
  tx.estado = COMMITED
  retornar verdadero
}

función ejecutarConReintentos<T>(operacion: función() -> T, maxReintentos: entero) -> T {
  para intento en 1..maxReintentos:
    tx = iniciarTransaccion()
    
    resultado = operacion()  // Ejecutar en contexto de tx
    
    si commit(tx):
      retornar resultado
    
    // Backoff exponencial antes de reintentar
    esperar(random(0, 2^intento))
  
  lanzar_error("Demasiados reintentos")
}

// OCC para Base de Datos
estructura RegistroDB {
  datos: Mapa<Clave, Valor>
  version: entero
  bloqueado: booleano
}

función leerRegistro(db: BaseDatos, clave: Clave) -> (Valor, entero) {
  registro = db.registros[clave]
  retornar (registro.datos, registro.version)
}

función actualizarRegistro(db: BaseDatos, clave: Clave, 
                           nuevoValor: Valor, versionEsperada: entero) -> booleano {
  registro = db.registros[clave]
  
  // Intentar adquirir lock
  si compare_and_swap(registro.bloqueado, falso, verdadero):
    si registro.version == versionEsperada:
      registro.datos = nuevoValor
      registro.version++
      registro.bloqueado = falso
      retornar verdadero
    sino:
      registro.bloqueado = falso
      retornar falso  // Versión cambiada, abortar
  
  retornar falso  // No se pudo adquirir lock
}

// Ejemplo: Transferencia bancaria optimista
función transferir(cuentaOrigen: Cuenta, cuentaDestino: Cuenta, monto: decimal) {
  loop:
    // Leer valores actuales
    (saldoOrigen, versionOrigen) = leerOptimista(cuentaOrigen.saldo)
    (saldoDestino, versionDestino) = leerOptimista(cuentaDestino.saldo)
    
    si saldoOrigen < monto:
      lanzar_error("Fondos insuficientes")
    
    // Calcular nuevos saldos
    nuevoSaldoOrigen = saldoOrigen - monto
    nuevoSaldoDestino = saldoDestino + monto
    
    // Intentar actualizar (validación implícita)
    si actualizarRegistro(cuentaOrigen, nuevoSaldoOrigen, versionOrigen):
      si actualizarRegistro(cuentaDestino, nuevoSaldoDestino, versionDestino):
        retornar  // Éxito
      sino:
        // Revertir primera actualización
        actualizarRegistro(cuentaOrigen, saldoOrigen, versionOrigen + 1)
    // Reintentar transacción completa
}

// Ventaja: Excelente para baja contención
// Desventaja: Reintentos costosos en alta contención`})}),e.jsx("div",{className:"mt-4 p-3 bg-cyan-900/30 border border-cyan-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-cyan-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Sin locks en lectura, ideal para baja contención.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Reintentos frecuentes en alta contención."]})})]})}),e.jsx(ue,{value:"batching",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-pink-400 mb-4",children:"📦 Batching"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Agrupa múltiples operaciones individuales en lotes, reduciendo la frecuencia de sincronización y amortizando el costo de los locks."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Batching de Operaciones
estructura OperationBatcher<T> {
  cola: ColaThreadSafe<Operacion<T>>
  tamañoLote: entero
  procesarLote: función(Lista<Operacion<T>>)
  threadProcesador: Thread
}

estructura Operacion<T> {
  tipo: INSERTAR | ACTUALIZAR | ELIMINAR
  datos: T
  callback: función(Resultado)
}

función crear(tamañoLote: entero) -> OperationBatcher<T> {
  batcher = new OperationBatcher()
  batcher.cola = new ColaThreadSafe()
  batcher.tamañoLote = tamañoLote
  
  // Iniciar thread procesador
  batcher.threadProcesador = iniciarThread(() => {
    procesarContinuamente(batcher)
  })
  
  retornar batcher
}

función procesarContinuamente(batcher: OperationBatcher<T>) {
  mientras verdadero:
    lote = new Lista<Operacion<T>>()
    
    // Esperar primera operación (bloqueante)
    primeraOp = batcher.cola.desencolar()
    lote.agregar(primeraOp)
    
    // Recolectar operaciones adicionales (no bloqueante)
    mientras lote.tamaño() < batcher.tamañoLote:
      op = batcher.cola.intentarDesencolar(timeout: 10ms)
      si op == null:
        break
      lote.agregar(op)
    
    // Procesar lote completo
    batcher.procesarLote(lote)
}

función agregar(batcher: OperationBatcher<T>, op: Operacion<T>) {
  batcher.cola.encolar(op)
}

// Batching de Escrituras a Base de Datos
estructura DatabaseBatchWriter<T> {
  buffer: Lista<T>
  lock: Lock
  tamañoLote: entero
  timeoutMs: entero
  ultimoFlush: Timestamp
}

función insertar(writer: DatabaseBatchWriter<T>, item: T) {
  writer.lock.adquirir()
  
  writer.buffer.agregar(item)
  ahoraMs = obtenerTiempoMs()
  
  debeFlush = (writer.buffer.tamaño() >= writer.tamañoLote) O
              (ahoraMs - writer.ultimoFlush >= writer.timeoutMs)
  
  si debeFlush:
    flush(writer)
  
  writer.lock.liberar()
}

función flush(writer: DatabaseBatchWriter<T>) {
  si writer.buffer.vacio():
    retornar
  
  // Hacer copia del buffer
  itemsParaProcesar = copiar(writer.buffer)
  writer.buffer.limpiar()
  writer.ultimoFlush = obtenerTiempoMs()
  
  // Procesar fuera del lock
  writer.lock.liberar()
  
  // Escritura en lote a la base de datos
  ejecutarBatchInsert(itemsParaProcesar)
  
  writer.lock.adquirir()
}

// Log Batching (combinar múltiples logs)
estructura LogBatcher {
  bufferLocal: ThreadLocalStorage<Lista<LogEntry>>
  bufferGlobal: ColaThreadSafe<LogEntry>
  tamañoLoteLocal: entero
  threadWriter: Thread
}

función log(batcher: LogBatcher, mensaje: string, nivel: LogLevel) {
  bufferLocal = batcher.bufferLocal.obtener()
  
  entrada = new LogEntry(mensaje, nivel, obtenerTimestamp())
  bufferLocal.agregar(entrada)
  
  si bufferLocal.tamaño() >= batcher.tamañoLoteLocal:
    flushLocal(batcher, bufferLocal)
}

función flushLocal(batcher: LogBatcher, bufferLocal: Lista<LogEntry>) {
  para entrada en bufferLocal:
    batcher.bufferGlobal.encolar(entrada)
  
  bufferLocal.limpiar()
}

función procesadorGlobal(batcher: LogBatcher) {
  mientras verdadero:
    lote = new Lista<LogEntry>()
    
    // Recolectar hasta 1000 entradas o 100ms timeout
    timeout = 100  // ms
    inicioMs = obtenerTiempoMs()
    
    mientras lote.tamaño() < 1000 Y 
          (obtenerTiempoMs() - inicioMs) < timeout:
      entrada = batcher.bufferGlobal.intentarDesencolar(10ms)
      si entrada != null:
        lote.agregar(entrada)
    
    si lote.tamaño() > 0:
      escribirLogsADisco(lote)
}

// Batching con Coalescing (combinar operaciones duplicadas)
estructura CoalescingBatcher<K, V> {
  pendientes: MapaConcurrente<K, V>
  lock: Lock
  threadProcesador: Thread
}

función actualizar(batcher: CoalescingBatcher<K, V>, clave: K, valor: V) {
  // Última escritura gana (coalescing)
  batcher.pendientes.put(clave, valor)
}

función procesarPeriodicamente(batcher: CoalescingBatcher<K, V>) {
  mientras verdadero:
    esperar(100ms)  // Intervalo de batching
    
    batcher.lock.adquirir()
    
    // Tomar snapshot de pendientes
    snapshot = copiar(batcher.pendientes)
    batcher.pendientes.limpiar()
    
    batcher.lock.liberar()
    
    // Procesar fuera del lock
    para (clave, valor) en snapshot:
      aplicarActualizacion(clave, valor)
}

// Request Batching para RPCs
estructura RPCBatcher<Req, Resp> {
  solicitudesPendientes: Lista<(Req, Promise<Resp>)>
  lock: Lock
  tamañoLote: entero
}

función enviarSolicitud(batcher: RPCBatcher<Req, Resp>, req: Req) -> Promise<Resp> {
  promesa = new Promise<Resp>()
  
  batcher.lock.adquirir()
  batcher.solicitudesPendientes.agregar((req, promesa))
  
  si batcher.solicitudesPendientes.tamaño() >= batcher.tamañoLote:
    procesarLote(batcher)
  
  batcher.lock.liberar()
  
  retornar promesa
}

función procesarLote(batcher: RPCBatcher<Req, Resp>) {
  lote = copiar(batcher.solicitudesPendientes)
  batcher.solicitudesPendientes.limpiar()
  
  // Enviar todas las solicitudes en un solo RPC
  solicitudes = extraerSolicitudes(lote)
  respuestas = enviarBatchRPC(solicitudes)
  
  // Resolver promesas
  para i en 0..lote.tamaño()-1:
    lote[i].promesa.resolver(respuestas[i])
}

// Ventaja: Amortiza costo de locks, reduce overhead de I/O
// Trade-off: Latencia vs throughput`})}),e.jsx("div",{className:"mt-4 p-3 bg-pink-900/30 border border-pink-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-pink-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Amortiza costos de sincronización, mayor throughput.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Mayor latencia, complejidad en manejo de errores."]})})]})}),e.jsx(ue,{value:"granularity",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-orange-400 mb-4",children:"🔬 Reducir Granularidad de Locks"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Usar locks más finos que protejan solo las secciones críticas mínimas necesarias, permitiendo mayor concurrencia."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Mal: Lock Grueso (protege todo el objeto)
estructura ListaConLockGrueso<T> {
  datos: Arreglo<T>
  tamaño: entero
  lock: Lock  // Un solo lock para todo
}

función agregar(lista: ListaConLockGrueso<T>, item: T) {
  lista.lock.adquirir()
  
  lista.datos[lista.tamaño] = item
  lista.tamaño++
  
  lista.lock.liberar()
}

función obtener(lista: ListaConLockGrueso<T>, indice: entero) -> T {
  lista.lock.adquirir()
  
  item = lista.datos[indice]
  
  lista.lock.liberar()
  
  retornar item
}
// Problema: Lectores bloquean a otros lectores

// Mejor: Lock Fino (read-write lock)
estructura ListaConRWLock<T> {
  datos: Arreglo<T>
  tamaño: AtomicInteger
  rwlock: ReadWriteLock
}

función agregar(lista: ListaConRWLock<T>, item: T) {
  lista.rwlock.writeLock().adquirir()
  
  indice = cargar_atomico(lista.tamaño)
  lista.datos[indice] = item
  incrementar_atomico(lista.tamaño)
  
  lista.rwlock.writeLock().liberar()
}

función obtener(lista: ListaConRWLock<T>, indice: entero) -> T {
  lista.rwlock.readLock().adquirir()
  
  item = lista.datos[indice]
  
  lista.rwlock.readLock().liberar()
  
  retornar item
}
// Ventaja: Múltiples lectores concurrentes

// Óptimo: Lock por Nodo (linked list)
estructura Nodo<T> {
  valor: T
  siguiente: Nodo<T> | null
  lock: Lock
}

estructura ListaEnlazadaFinaGrain<T> {
  cabeza: Nodo<T>
  lockCabeza: Lock
}

función buscar(lista: ListaEnlazadaFinaGrain<T>, valorBuscado: T) -> Nodo<T> | null {
  lista.lockCabeza.adquirir()
  nodo = lista.cabeza
  
  si nodo != null:
    nodo.lock.adquirir()
  
  lista.lockCabeza.liberar()
  
  mientras nodo != null:
    si nodo.valor == valorBuscado:
      nodo.lock.liberar()
      retornar nodo
    
    // Hand-over-hand locking
    siguiente = nodo.siguiente
    si siguiente != null:
      siguiente.lock.adquirir()
    
    nodo.lock.liberar()
    nodo = siguiente
  
  retornar null
}

función insertar(lista: ListaEnlazadaFinaGrain<T>, valor: T) {
  nuevoNodo = new Nodo(valor)
  nuevoNodo.lock = new Lock()
  
  lista.lockCabeza.adquirir()
  
  pred = null
  curr = lista.cabeza
  
  si curr != null:
    curr.lock.adquirir()
  
  // Buscar posición de inserción
  mientras curr != null Y curr.valor < valor:
    si pred != null:
      pred.lock.liberar()
    
    pred = curr
    curr = curr.siguiente
    
    si curr != null:
      curr.lock.adquirir()
  
  // Insertar
  nuevoNodo.siguiente = curr
  
  si pred == null:
    lista.cabeza = nuevoNodo
    lista.lockCabeza.liberar()
  sino:
    pred.siguiente = nuevoNodo
    pred.lock.liberar()
    lista.lockCabeza.liberar()
  
  si curr != null:
    curr.lock.liberar()
}

// Lock Splitting (separar locks para diferentes propiedades)
estructura CuentaBancaria {
  saldo: decimal
  lockSaldo: Lock
  
  transacciones: Lista<Transaccion>
  lockTransacciones: Lock
  
  metadatos: Mapa<string, string>
  lockMetadatos: Lock
}

función depositar(cuenta: CuentaBancaria, monto: decimal) {
  // Solo lock de saldo necesario
  cuenta.lockSaldo.adquirir()
  cuenta.saldo += monto
  cuenta.lockSaldo.liberar()
  
  // Lock separado para transacciones
  cuenta.lockTransacciones.adquirir()
  cuenta.transacciones.agregar(new Transaccion(DEPOSITO, monto))
  cuenta.lockTransacciones.liberar()
}

función obtenerMetadato(cuenta: CuentaBancaria, clave: string) -> string {
  // No interfiere con operaciones de saldo
  cuenta.lockMetadatos.adquirir()
  valor = cuenta.metadatos[clave]
  cuenta.lockMetadatos.liberar()
  
  retornar valor
}

// Lock Ordering (para evitar deadlock con locks finos)
función transferir(cuentaA: CuentaBancaria, cuentaB: CuentaBancaria, monto: decimal) {
  // Adquirir locks en orden consistente (por ID)
  primera = cuentaA.id < cuentaB.id ? cuentaA : cuentaB
  segunda = cuentaA.id < cuentaB.id ? cuentaB : cuentaA
  
  primera.lockSaldo.adquirir()
  segunda.lockSaldo.adquirir()
  
  si cuentaA.saldo >= monto:
    cuentaA.saldo -= monto
    cuentaB.saldo += monto
  
  segunda.lockSaldo.liberar()
  primera.lockSaldo.liberar()
}

// Ejemplo: HashMap con Lock por Bucket
estructura HashMapFinoGrain<K, V> {
  buckets: Arreglo<Lista<Entry<K,V>>>
  locks: Arreglo<Lock>
}

función put(mapa: HashMapFinoGrain<K, V>, clave: K, valor: V) {
  hash = hash(clave)
  bucketIndice = hash % mapa.buckets.longitud
  
  // Solo lock del bucket específico
  mapa.locks[bucketIndice].adquirir()
  
  bucket = mapa.buckets[bucketIndice]
  para entry en bucket:
    si entry.clave == clave:
      entry.valor = valor
      mapa.locks[bucketIndice].liberar()
      retornar
  
  bucket.agregar(new Entry(clave, valor))
  
  mapa.locks[bucketIndice].liberar()
}

// Principios:
// 1. Lock solo lo mínimo necesario
// 2. Mantener locks el menor tiempo posible
// 3. Evitar operaciones costosas dentro de locks
// 4. Usar locks de lectura/escritura cuando sea apropiado
// 5. Considerar lock-free para casos críticos`})}),e.jsx("div",{className:"mt-4 p-3 bg-orange-900/30 border border-orange-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-orange-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Mayor concurrencia, mejor escalabilidad.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Mayor complejidad, riesgo de deadlocks."]})})]})})]})})]}),e.jsxs(sa,{value:"demostracion",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(La,{className:"size-5"}),e.jsx("span",{children:"Demostraciones Interactivas"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"lockfree-demo",className:"px-6 pb-6",children:[e.jsxs(Qt,{className:"grid grid-cols-7 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"lockfree-demo",children:"🔓 Lock-free"}),e.jsx(le,{value:"part-demo",children:"🧩 Particiones"}),e.jsx(le,{value:"stripe-demo",children:"🎨 Striping"}),e.jsx(le,{value:"tls-demo",children:"🧵 TLS"}),e.jsx(le,{value:"opt-demo",children:"✨ Optimistic"}),e.jsx(le,{value:"batch-demo",children:"📦 Batching"}),e.jsx(le,{value:"gran-demo",children:"🔬 Fine-grained"})]}),e.jsx(ue,{value:"lockfree-demo",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-400 mb-4",children:"🔓 Demostración: Lock-free Data Structures"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Visualización de operaciones lock-free usando CAS (Compare-And-Swap). Observa cómo las operaciones se reintentan cuando fallan."}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>l(!n),className:`px-4 py-2 rounded font-semibold flex items-center gap-2 ${n?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:n?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:st,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"})," Reiniciar"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Tiempo: ",e.jsxs("span",{className:"text-blue-400 font-mono",children:[d,"s"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["Velocidad: ",e.jsxs("span",{className:"text-blue-400",children:[h,"ms"]})]}),e.jsx(dt,{value:[h],onValueChange:_e=>x(_e[0]),min:100,max:1e3,step:50,className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-400 mb-3",children:"Stack Lock-free"}),e.jsx("div",{className:"space-y-2",children:g.length===0?e.jsx("div",{className:"text-gray-500 text-sm text-center py-4",children:"Stack vacío"}):g.slice().reverse().map((_e,Fe)=>e.jsx("div",{className:"bg-blue-600/20 border border-blue-500 rounded px-3 py-2 text-center font-mono text-blue-300",children:_e},Fe))})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-400 mb-3",children:"Operaciones Recientes"}),e.jsx("div",{className:"space-y-2",children:s.map(_e=>e.jsxs("div",{className:`rounded px-3 py-2 text-sm ${_e.status==="success"?"bg-green-600/20 border border-green-500 text-green-300":_e.status==="retry"?"bg-yellow-600/20 border border-yellow-500 text-yellow-300":"bg-gray-700 border border-gray-600 text-gray-300"}`,children:["T",_e.threadId,": ",_e.type.toUpperCase(),_e.value!==void 0&&`(${_e.value})`,_e.status==="retry"&&` [Reintento ${_e.attempts}]`]},_e.id))})]})]}),e.jsxs("div",{className:"bg-black rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-400 mb-2",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:N,className:"font-mono text-xs text-green-400 space-y-1 max-h-40 overflow-y-auto",children:v.map((_e,Fe)=>e.jsx("div",{children:_e},Fe))})]})]})}),e.jsx(ue,{value:"part-demo",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-green-400 mb-4",children:"🧩 Demostración: Particionamiento de Recursos"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Visualización de datos particionados. Cada thread accede a su partición sin contención."}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>C(!w),className:`px-4 py-2 rounded font-semibold flex items-center gap-2 ${w?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:w?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:Rt,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"})," Reiniciar"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Tiempo: ",e.jsxs("span",{className:"text-green-400 font-mono",children:[E,"s"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["Velocidad: ",e.jsxs("span",{className:"text-green-400",children:[P,"ms"]})]}),e.jsx(dt,{value:[P],onValueChange:_e=>V(_e[0]),min:100,max:1e3,step:50,className:"w-full"})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[0,1,2,3].map(_e=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-semibold text-green-400 mb-2",children:["Partición ",_e]}),e.jsxs("div",{className:"text-xs text-gray-400 mb-2",children:["Thread ",_e+1]}),e.jsx("div",{className:"space-y-1",children:(Z.get(_e)||[]).map((Fe,ht)=>e.jsx("div",{className:"bg-green-600/20 border border-green-500 rounded px-2 py-1 text-center font-mono text-green-300 text-sm",children:Fe},ht))})]},_e))}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-green-400 mb-3",children:"Estado de Threads"}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:j.map(_e=>e.jsxs("div",{className:`rounded px-3 py-2 text-center text-sm font-semibold ${_e.status==="working"?"bg-yellow-600/30 border border-yellow-500 text-yellow-300":_e.status==="success"?"bg-green-600/30 border border-green-500 text-green-300":"bg-gray-700 border border-gray-600 text-gray-400"}`,children:["T",_e.id," → P",_e.partition,e.jsx("div",{className:"text-xs mt-1",children:_e.status})]},_e.id))})]}),e.jsxs("div",{className:"bg-black rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-green-400 mb-2",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:ge,className:"font-mono text-xs text-green-400 space-y-1 max-h-40 overflow-y-auto",children:O.map((_e,Fe)=>e.jsx("div",{children:_e},Fe))})]})]})}),e.jsx(ue,{value:"stripe-demo",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-400 mb-4",children:"🎨 Demostración: Lock Striping"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Visualización de locks por stripe. Threads pueden trabajar en diferentes stripes simultáneamente."}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ee(!ne),className:`px-4 py-2 rounded font-semibold flex items-center gap-2 ${ne?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:ne?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:Qe,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"})," Reiniciar"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Tiempo: ",e.jsxs("span",{className:"text-purple-400 font-mono",children:[Ce,"s"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["Velocidad: ",e.jsxs("span",{className:"text-purple-400",children:[I,"ms"]})]}),e.jsx(dt,{value:[I],onValueChange:_e=>Q(_e[0]),min:100,max:1e3,step:50})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[0,1,2,3].map(_e=>e.jsxs("div",{className:`rounded-lg p-4 border-2 ${F[_e]?"bg-red-600/20 border-red-500":"bg-gray-800/50 border-gray-600"}`,children:[e.jsxs("h4",{className:"text-sm font-semibold text-purple-400 mb-2",children:["Stripe ",_e]}),e.jsx("div",{className:"text-center py-6",children:F[_e]?e.jsx("div",{className:"text-red-400 font-bold text-2xl",children:"🔒 LOCKED"}):e.jsx("div",{className:"text-green-400 font-bold text-2xl",children:"🔓 FREE"})})]},_e))}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-purple-400 mb-3",children:"Estado de Threads"}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:J.map(_e=>e.jsxs("div",{className:`rounded px-3 py-2 text-center text-sm font-semibold ${_e.status==="waiting"?"bg-yellow-600/30 border border-yellow-500 text-yellow-300 animate-pulse":_e.status==="working"?"bg-purple-600/30 border border-purple-500 text-purple-300":_e.status==="success"?"bg-green-600/30 border border-green-500 text-green-300":"bg-gray-700 border border-gray-600 text-gray-400"}`,children:["T",_e.id," → S",_e.partition,e.jsx("div",{className:"text-xs mt-1",children:_e.status})]},_e.id))})]}),e.jsxs("div",{className:"bg-black rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-purple-400 mb-2",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:$,className:"font-mono text-xs text-green-400 space-y-1 max-h-40 overflow-y-auto",children:ze.map((_e,Fe)=>e.jsx("div",{children:_e},Fe))})]})]})}),e.jsx(ue,{value:"tls-demo",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-4",children:"🧵 Demostración: Thread-local Storage"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Cada thread mantiene su propio contador local. No hay contención entre threads."}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>M(!K),className:`px-4 py-2 rounded font-semibold flex items-center gap-2 ${K?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:K?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:He,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"})," Reiniciar"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Tiempo: ",e.jsxs("span",{className:"text-yellow-400 font-mono",children:[D,"s"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["Velocidad: ",e.jsxs("span",{className:"text-yellow-400",children:[G,"ms"]})]}),e.jsx(dt,{value:[G],onValueChange:_e=>be(_e[0]),min:100,max:1e3,step:50})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-6",children:se.map(_e=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-semibold text-yellow-400 mb-2",children:["Thread ",_e.id]}),e.jsxs("div",{className:`text-center py-6 rounded ${_e.status==="working"?"bg-yellow-600/20 animate-pulse":"bg-gray-700/50"}`,children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-300",children:_e.localValue||0}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:_e.status})]})]},_e.id))}),e.jsxs("div",{className:"bg-gradient-to-r from-yellow-900/30 to-orange-900/30 border border-yellow-700 rounded-lg p-6 text-center mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-yellow-400 mb-2",children:"Valor Global (Suma de Locales)"}),e.jsx("div",{className:"text-5xl font-bold text-yellow-300",children:Ne}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Sin contención en incrementos individuales"})]}),e.jsxs("div",{className:"bg-black rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-yellow-400 mb-2",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:ee,className:"font-mono text-xs text-green-400 space-y-1 max-h-40 overflow-y-auto",children:ke.map((_e,Fe)=>e.jsx("div",{children:_e},Fe))})]})]})}),e.jsx(ue,{value:"opt-demo",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-cyan-400 mb-4",children:"✨ Demostración: Optimistic Concurrency Control"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Visualización de transacciones optimistas con versionado. Detecta conflictos al commit."}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>xe(!jt),className:`px-4 py-2 rounded font-semibold flex items-center gap-2 ${jt?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:jt?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:mt,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"})," Reiniciar"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Tiempo: ",e.jsxs("span",{className:"text-cyan-400 font-mono",children:[Me,"s"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["Velocidad: ",e.jsxs("span",{className:"text-cyan-400",children:[Ge,"ms"]})]}),e.jsx(dt,{value:[Ge],onValueChange:_e=>qe(_e[0]),min:100,max:1e3,step:50})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-cyan-900/30 to-blue-900/30 border border-cyan-700 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-6 text-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-cyan-400 mb-2",children:"Valor Compartido"}),e.jsx("div",{className:"text-4xl font-bold text-cyan-300",children:Se})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-cyan-400 mb-2",children:"Versión Actual"}),e.jsxs("div",{className:"text-4xl font-bold text-cyan-300",children:["v",We]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-red-400 mb-2",children:"Conflictos"}),e.jsx("div",{className:"text-4xl font-bold text-red-300",children:Ot})]})]})}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-cyan-400 mb-3",children:"Estado de Threads"}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:ae.map(_e=>e.jsxs("div",{className:`rounded px-3 py-2 text-center text-sm font-semibold ${_e.status==="retry"?"bg-red-600/30 border border-red-500 text-red-300 animate-pulse":_e.status==="working"?"bg-cyan-600/30 border border-cyan-500 text-cyan-300":_e.status==="success"?"bg-green-600/30 border border-green-500 text-green-300":"bg-gray-700 border border-gray-600 text-gray-400"}`,children:["T",_e.id,e.jsx("div",{className:"text-xs mt-1",children:_e.status}),_e.version!==void 0&&e.jsxs("div",{className:"text-xs",children:["v",_e.version]})]},_e.id))})]}),e.jsxs("div",{className:"bg-black rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-cyan-400 mb-2",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:et,className:"font-mono text-xs text-green-400 space-y-1 max-h-40 overflow-y-auto",children:Ue.map((_e,Fe)=>e.jsx("div",{children:_e},Fe))})]})]})}),e.jsx(ue,{value:"batch-demo",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-pink-400 mb-4",children:"📦 Demostración: Batching"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Operaciones se agrupan en lotes antes de procesarse, reduciendo overhead de sincronización."}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ce(!Ve),className:`px-4 py-2 rounded font-semibold flex items-center gap-2 ${Ve?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:Ve?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:Jt,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"})," Reiniciar"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Tiempo: ",e.jsxs("span",{className:"text-pink-400 font-mono",children:[Te,"s"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["Velocidad: ",e.jsxs("span",{className:"text-pink-400",children:[St,"ms"]})]}),e.jsx(dt,{value:[St],onValueChange:_e=>tt(_e[0]),min:100,max:1e3,step:50})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-pink-900/30 border border-pink-700 rounded-lg p-4 text-center",children:[e.jsx("h4",{className:"text-sm font-semibold text-pink-400 mb-2",children:"Cola de Operaciones"}),e.jsx("div",{className:"text-4xl font-bold text-pink-300",children:Ye.length})]}),e.jsxs("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4 text-center",children:[e.jsx("h4",{className:"text-sm font-semibold text-green-400 mb-2",children:"Operaciones Procesadas"}),e.jsx("div",{className:"text-4xl font-bold text-green-300",children:Ct})]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-pink-400 mb-3",children:"Cola de Lote Actual"}),e.jsx("div",{className:"flex gap-2 flex-wrap min-h-[60px]",children:Ye.length===0?e.jsx("div",{className:"text-gray-500 text-sm",children:"Cola vacía"}):Ye.map((_e,Fe)=>e.jsx("div",{className:"bg-pink-600/20 border border-pink-500 rounded px-3 py-1 font-mono text-pink-300",children:_e},Fe))})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-pink-400 mb-3",children:"Buffer Local por Thread"}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:L.map(_e=>e.jsxs("div",{className:`rounded px-3 py-2 text-center text-sm font-semibold ${_e.status==="working"?"bg-pink-600/30 border border-pink-500 text-pink-300":_e.status==="success"?"bg-green-600/30 border border-green-500 text-green-300":"bg-gray-700 border border-gray-600 text-gray-400"}`,children:["T",_e.id,e.jsxs("div",{className:"text-xs mt-1",children:["Buffer: ",_e.batchSize||0]}),e.jsx("div",{className:"text-xs",children:_e.status})]},_e.id))})]}),e.jsxs("div",{className:"bg-black rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-pink-400 mb-2",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:B,className:"font-mono text-xs text-green-400 space-y-1 max-h-40 overflow-y-auto",children:gt.map((_e,Fe)=>e.jsx("div",{children:_e},Fe))})]})]})}),e.jsx(ue,{value:"gran-demo",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-orange-400 mb-4",children:"🔬 Demostración: Fine-grained Locks"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Locks por nodo permiten acceso concurrente a diferentes nodos. Lecturas concurrentes, escrituras exclusivas."}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>fe(!Ke),className:`px-4 py-2 rounded font-semibold flex items-center gap-2 ${Ke?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:Ke?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"})," Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"})," Iniciar"]})}),e.jsxs("button",{onClick:pa,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-semibold flex items-center gap-2",children:[e.jsx(it,{className:"size-4"})," Reiniciar"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Tiempo: ",e.jsxs("span",{className:"text-orange-400 font-mono",children:[$t,"s"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["Velocidad: ",e.jsxs("span",{className:"text-orange-400",children:[pt,"ms"]})]}),e.jsx(dt,{value:[pt],onValueChange:_e=>zt(_e[0]),min:100,max:1e3,step:50})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[0,1,2,3].map(_e=>e.jsxs("div",{className:`rounded-lg p-4 border-2 ${lt[_e]?"bg-red-600/20 border-red-500":Ie[_e]==="read"?"bg-blue-600/20 border-blue-500":"bg-gray-800/50 border-gray-600"}`,children:[e.jsxs("h4",{className:"text-sm font-semibold text-orange-400 mb-2",children:["Nodo ",_e]}),e.jsx("div",{className:"text-center py-6",children:lt[_e]?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-red-400 font-bold text-xl",children:"🔒 WRITE LOCK"}),e.jsx("div",{className:"text-xs text-red-300 mt-2",children:"Exclusivo"})]}):Ie[_e]==="read"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-blue-400 font-bold text-xl",children:"📖 READING"}),e.jsx("div",{className:"text-xs text-blue-300 mt-2",children:"Concurrente"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-green-400 font-bold text-xl",children:"🔓 FREE"}),e.jsx("div",{className:"text-xs text-green-300 mt-2",children:"Disponible"})]})})]},_e))}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-orange-400 mb-3",children:"Estado de Threads"}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:U.map(_e=>e.jsxs("div",{className:`rounded px-3 py-2 text-center text-sm font-semibold ${_e.status==="waiting"?"bg-yellow-600/30 border border-yellow-500 text-yellow-300 animate-pulse":_e.status==="working"?"bg-orange-600/30 border border-orange-500 text-orange-300":_e.status==="success"?"bg-green-600/30 border border-green-500 text-green-300":"bg-gray-700 border border-gray-600 text-gray-400"}`,children:["T",_e.id," → N",_e.partition,e.jsx("div",{className:"text-xs mt-1",children:_e.status})]},_e.id))})]}),e.jsxs("div",{className:"bg-black rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-orange-400 mb-2",children:"📋 Registro de Eventos"}),e.jsx("div",{ref:Oe,className:"font-mono text-xs text-green-400 space-y-1 max-h-40 overflow-y-auto",children:ot.map((_e,Fe)=>e.jsx("div",{children:_e},Fe))})]})]})})]})})]})]})})]})}const p2=Sa("/ActividadesSeminarioSO/actividad11/contencion-recursos")({component:m2});function h2(){return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto px-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"text-5xl",children:"⚡"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Condición de Carrera"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Race Condition"})]})]})})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"bg-white text-gray-900 rounded-lg p-8 mb-8 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(La,{className:"size-6 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Descripción del Problema"})]}),e.jsxs("p",{className:"text-gray-700 leading-relaxed mb-4",children:["Una ",e.jsx("strong",{className:"text-red-600",children:"condición de carrera"})," (race condition) ocurre cuando dos o más threads acceden a datos compartidos simultáneamente y al menos uno de ellos modifica los datos. El resultado final depende del orden de ejecución de los threads, lo que puede llevar a comportamientos impredecibles y errores difíciles de reproducir."]}),e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded mt-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(yn,{className:"size-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-red-900 mb-2",children:"¿Por qué es peligroso?"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Las condiciones de carrera pueden causar corrupción de datos, resultados incorrectos, crashes del sistema e incluso vulnerabilidades de seguridad. Son especialmente peligrosas porque pueden aparecer de manera intermitente y ser difíciles de depurar."})]})]})})]}),e.jsxs(Da,{type:"multiple",defaultValue:["soluciones","demostracion"],className:"space-y-4",children:[e.jsxs(sa,{value:"soluciones",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Soluciones"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"mutex",className:"w-full",children:[e.jsxs(Qt,{className:"w-full justify-start flex-wrap h-auto gap-2 bg-gray-900 p-2",children:[e.jsx(le,{value:"mutex",children:"Mutex"}),e.jsx(le,{value:"semaforos",children:"Semáforos"}),e.jsx(le,{value:"atomicas",children:"Variables Atómicas"}),e.jsx(le,{value:"monitores",children:"Monitores"}),e.jsx(le,{value:"rwlocks",children:"Locks Lectura/Escritura"})]}),e.jsx(ue,{value:"mutex",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Mutex (Mutual Exclusion)"}),e.jsx("p",{className:"text-gray-300",children:"Un mutex garantiza que solo un thread pueda acceder a la sección crítica a la vez. Cuando un thread adquiere el mutex, todos los demás deben esperar."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Mutex para proteger contador compartido

// Declaración de recursos compartidos
COMPARTIDO contador = 0
COMPARTIDO mutex = NuevoMutex()

PROCEDIMIENTO incrementar():
    mutex.adquirir()           // Entrar a sección crítica
    
    // Sección crítica - solo un thread a la vez
    temp = contador
    temp = temp + 1
    contador = temp
    
    mutex.liberar()            // Salir de sección crítica
FIN PROCEDIMIENTO

PROCEDIMIENTO thread_worker(id):
    PARA i = 1 HASTA 1000:
        incrementar()
    FIN PARA
    
    IMPRIMIR "Thread", id, "terminado"
FIN PROCEDIMIENTO

// Programa principal
CREAR thread1 QUE EJECUTE thread_worker(1)
CREAR thread2 QUE EJECUTE thread_worker(2)

ESPERAR thread1
ESPERAR thread2

IMPRIMIR "Valor final del contador:", contador  // Resultado: 2000`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Simple, garantiza exclusión mutua, previene condiciones de carrera.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Puede causar contención, reduce concurrencia, riesgo de deadlock."]})})]})}),e.jsx(ue,{value:"semaforos",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Semáforos"}),e.jsx("p",{className:"text-gray-300",children:"Los semáforos permiten controlar el acceso a un recurso mediante un contador. Un semáforo binario (valor 0 o 1) funciona similar a un mutex."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Semáforo binario

// Declaración
COMPARTIDO contador = 0
COMPARTIDO semaforo = NuevoSemaforo(1)  // Valor inicial: 1

PROCEDIMIENTO incrementar():
    semaforo.esperar()         // P(s) o wait(s) - decrementa
    
    // Sección crítica
    contador = contador + 1
    
    semaforo.señalar()         // V(s) o signal(s) - incrementa
FIN PROCEDIMIENTO

// Ejemplo: Semáforo con múltiples recursos
COMPARTIDO recursos_disponibles = NuevoSemaforo(5)  // 5 recursos

PROCEDIMIENTO usar_recurso(id):
    IMPRIMIR "Thread", id, "esperando recurso..."
    recursos_disponibles.esperar()
    
    IMPRIMIR "Thread", id, "usando recurso"
    DORMIR(2)  // Simular trabajo
    
    IMPRIMIR "Thread", id, "liberando recurso"
    recursos_disponibles.señalar()
FIN PROCEDIMIENTO

// Crear 10 threads compitiendo por 5 recursos
PARA i = 1 HASTA 10:
    CREAR thread QUE EJECUTE usar_recurso(i)
FIN PARA`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Flexible, permite múltiples accesos simultáneos, útil para productores-consumidores.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Más complejo que mutex, fácil cometer errores (olvidar señalar)."]})})]})}),e.jsx(ue,{value:"atomicas",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Variables Atómicas"}),e.jsx("p",{className:"text-gray-300",children:"Las operaciones atómicas se ejecutan como una unidad indivisible. El hardware garantiza que no pueden ser interrumpidas."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Variables atómicas

// Declaración de variable atómica
COMPARTIDO ATOMICA contador = 0

PROCEDIMIENTO incrementar_atomico():
    // Operación atómica - garantizada por hardware
    ATOMICO_INCREMENTAR(contador, 1)
    
    // Equivalente a:
    // atomicamente { contador = contador + 1 }
FIN PROCEDIMIENTO

PROCEDIMIENTO compare_and_swap(id):
    intentos = 0
    
    REPETIR:
        viejo = contador
        nuevo = viejo + 1
        intentos = intentos + 1
        
        // CAS: solo actualiza si valor no cambió
        exito = ATOMICO_CAS(contador, viejo, nuevo)
        
    HASTA QUE exito
    
    IMPRIMIR "Thread", id, "exitoso en intento", intentos
FIN PROCEDIMIENTO

// Operaciones atómicas comunes:
ATOMICO_LEER(variable)           // Lectura atómica
ATOMICO_ESCRIBIR(variable, valor) // Escritura atómica
ATOMICO_INTERCAMBIAR(var, nuevo)  // Exchange
ATOMICO_SUMAR(variable, valor)    // Fetch-and-add
ATOMICO_CAS(var, viejo, nuevo)    // Compare-and-swap

// Ejemplo de uso
PROCEDIMIENTO thread_worker():
    PARA i = 1 HASTA 1000:
        ATOMICO_INCREMENTAR(contador, 1)
    FIN PARA
FIN PROCEDIMIENTO

CREAR 10 threads workers
ESPERAR todos los threads
IMPRIMIR "Total:", contador  // Siempre 10000`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Muy rápidas, no requieren locks, sin deadlocks, alta concurrencia.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Solo para operaciones simples, limitadas por hardware, puede causar ABA problem."]})})]})}),e.jsx(ue,{value:"monitores",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Monitores"}),e.jsx("p",{className:"text-gray-300",children:"Un monitor encapsula datos compartidos y métodos de acceso con sincronización implícita. Solo un thread puede estar activo dentro del monitor a la vez."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Monitor

MONITOR ContadorSeguro:
    // Variables privadas del monitor
    PRIVADO contador = 0
    
    // Métodos sincronizados automáticamente
    PROCEDIMIENTO incrementar():
        // Solo un thread puede ejecutar esto a la vez
        contador = contador + 1
    FIN PROCEDIMIENTO
    
    PROCEDIMIENTO decrementar():
        contador = contador - 1
    FIN PROCEDIMIENTO
    
    FUNCION obtener_valor():
        RETORNAR contador
    FIN FUNCION
FIN MONITOR

// Monitor con variables de condición
MONITOR Buffer:
    PRIVADO datos = []
    PRIVADO capacidad = 10
    PRIVADO no_lleno = NuevaCondicion()
    PRIVADO no_vacio = NuevaCondicion()
    
    PROCEDIMIENTO insertar(item):
        // Esperar si el buffer está lleno
        MIENTRAS longitud(datos) >= capacidad:
            no_lleno.esperar()      // Libera el monitor y espera
        FIN MIENTRAS
        
        agregar(datos, item)
        no_vacio.señalar()          // Despertar consumidores
    FIN PROCEDIMIENTO
    
    FUNCION extraer():
        // Esperar si el buffer está vacío
        MIENTRAS longitud(datos) == 0:
            no_vacio.esperar()
        FIN MIENTRAS
        
        item = remover_primero(datos)
        no_lleno.señalar()          // Despertar productores
        RETORNAR item
    FIN FUNCION
FIN MONITOR

// Uso del monitor
COMPARTIDO monitor = NuevoContadorSeguro()

PROCEDIMIENTO thread_incrementador():
    PARA i = 1 HASTA 1000:
        monitor.incrementar()      // Sincronización automática
    FIN PARA
FIN PROCEDIMIENTO`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Sincronización implícita, encapsulación, menos errores de programación.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Overhead mayor, requiere soporte del lenguaje, menos control fino."]})})]})}),e.jsx(ue,{value:"rwlocks",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Locks de Lectura/Escritura"}),e.jsx("p",{className:"text-gray-300",children:"Permiten múltiples lectores simultáneos, pero escritura exclusiva. Optimiza el caso común de muchas lecturas y pocas escrituras."}),e.jsx("div",{className:"bg-black rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-green-400 text-sm",children:e.jsx("code",{children:`// Pseudocódigo: Read-Write Lock

COMPARTIDO datos = []
COMPARTIDO rwlock = NuevoRWLock()

PROCEDIMIENTO leer_datos(id):
    rwlock.adquirir_lectura()   // Múltiples lectores permitidos
    
    // Sección de lectura
    IMPRIMIR "Thread", id, "leyendo:", datos
    DORMIR(1)  // Simular lectura larga
    
    rwlock.liberar_lectura()
FIN PROCEDIMIENTO

PROCEDIMIENTO escribir_datos(id, valor):
    rwlock.adquirir_escritura()  // Acceso exclusivo
    
    // Sección de escritura
    IMPRIMIR "Thread", id, "escribiendo:", valor
    agregar(datos, valor)
    DORMIR(2)  // Simular escritura larga
    
    rwlock.liberar_escritura()
FIN PROCEDIMIENTO

// Implementación interna simplificada
ESTRUCTURA RWLock:
    lectores_activos = 0
    escritor_activo = FALSO
    mutex = NuevoMutex()
    puede_leer = NuevaCondicion()
    puede_escribir = NuevaCondicion()
    
    PROCEDIMIENTO adquirir_lectura():
        mutex.adquirir()
        
        // Esperar si hay escritor activo
        MIENTRAS escritor_activo:
            puede_leer.esperar(mutex)
        FIN MIENTRAS
        
        lectores_activos = lectores_activos + 1
        mutex.liberar()
    FIN PROCEDIMIENTO
    
    PROCEDIMIENTO liberar_lectura():
        mutex.adquirir()
        lectores_activos = lectores_activos - 1
        
        SI lectores_activos == 0:
            puede_escribir.señalar()  // Permitir escritor
        FIN SI
        
        mutex.liberar()
    FIN PROCEDIMIENTO
    
    PROCEDIMIENTO adquirir_escritura():
        mutex.adquirir()
        
        // Esperar a que no haya lectores ni escritores
        MIENTRAS lectores_activos > 0 O escritor_activo:
            puede_escribir.esperar(mutex)
        FIN MIENTRAS
        
        escritor_activo = VERDADERO
        mutex.liberar()
    FIN PROCEDIMIENTO
    
    PROCEDIMIENTO liberar_escritura():
        mutex.adquirir()
        escritor_activo = FALSO
        
        puede_escribir.señalar()   // Permitir otro escritor
        puede_leer.señalar_todos() // Permitir lectores
        
        mutex.liberar()
    FIN PROCEDIMIENTO
FIN ESTRUCTURA

// Uso: 90% lecturas, 10% escrituras
CREAR 9 threads lectores
CREAR 1 thread escritor`})})}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded p-4",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"✅ Ventajas:"})," Alta concurrencia en lecturas, eficiente para lectura-pesada.",e.jsx("br",{}),e.jsx("strong",{children:"⚠️ Desventajas:"})," Más complejo, puede causar starvation de escritores, overhead adicional."]})})]})})]})})]}),e.jsxs(sa,{value:"demostracion",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"size-5"}),e.jsx("span",{children:"Demostración Interactiva"})]})}),e.jsx(na,{children:e.jsx(x2,{})})]})]})]})]})}function x2(){const[s,o]=c.useState("sin-proteccion"),[n,l]=c.useState(!1),[d,m]=c.useState(!1),[h,x]=c.useState(0),[g,b]=c.useState([]),[v,f]=c.useState([]),[N,j]=c.useState(5),[_,w]=c.useState(3),[C,E]=c.useState([50]),z=c.useRef(!1),P=c.useRef(!1),V=c.useRef(null),Z=c.useRef(null),oe=c.useRef(!0),O=()=>2e3-C[0]*19,T=(k,K="text-green-400")=>{b(M=>[...M,{mensaje:`[${new Date().toLocaleTimeString()}] ${k}`,color:K}])};c.useEffect(()=>{oe.current&&V.current&&V.current.scrollIntoView({behavior:"smooth"})},[g]);const ge=()=>{if(!Z.current)return;const{scrollTop:k,scrollHeight:K,clientHeight:M}=Z.current,D=Math.abs(K-M-k)<10;oe.current=D},J=async()=>{for(;z.current&&!P.current;)await new Promise(k=>setTimeout(k,100))},W=async k=>{await new Promise(K=>setTimeout(K,k)),await J()},ne=async k=>{for(let M=0;M<3;M++){if(P.current)return;f(q=>q.map(G=>G.id===k?{...G,estado:"Esperando",color:"bg-gray-600",colorText:"text-gray-400"}:G)),T(`Thread ${k}: Esperando para acceder`,"text-gray-400"),await W(O()*Math.random()),f(q=>q.map(G=>G.id===k?{...G,estado:"Accediendo",color:"bg-red-600",colorText:"text-red-400"}:G)),T(`Thread ${k}: ⚠️ Accediendo SIN protección`,"text-red-400");const D=h;await W(O()*.5),x(D+1),T(`Thread ${k}: Incrementó contador (posible race condition)`,"text-red-300"),f(q=>q.map(G=>G.id===k?{...G,estado:"Trabajando",color:"bg-blue-600",colorText:"text-blue-400"}:G)),await W(O()*.3)}f(M=>M.map(D=>D.id===k?{...D,estado:"Terminado",color:"bg-gray-800",colorText:"text-gray-500"}:D)),T(`Thread ${k}: ✅ Terminado`,"text-green-400")},Ee=async(k,K)=>{for(let D=0;D<3;D++){if(P.current)return;for(f(q=>q.map(G=>G.id===k?{...G,estado:"Esperando lock",color:"bg-yellow-600",colorText:"text-yellow-400"}:G)),T(`Thread ${k}: 🔒 Intentando adquirir mutex`,"text-yellow-400");K.length>0&&K[0]!==k;)if(await W(100),P.current)return;f(q=>q.map(G=>G.id===k?{...G,estado:"Sección crítica",color:"bg-green-600",colorText:"text-green-400"}:G)),T(`Thread ${k}: ✅ Adquirió mutex - En sección crítica`,"text-green-400"),await W(O()*.8),x(q=>q+1),T(`Thread ${k}: Incrementó contador de forma segura`,"text-green-300"),await W(O()*.5),K.shift(),T(`Thread ${k}: 🔓 Liberó mutex`,"text-cyan-400"),f(q=>q.map(G=>G.id===k?{...G,estado:"Trabajando",color:"bg-blue-600",colorText:"text-blue-400"}:G)),await W(O()*.3)}f(D=>D.map(q=>q.id===k?{...q,estado:"Terminado",color:"bg-gray-800",colorText:"text-gray-500"}:q)),T(`Thread ${k}: ✅ Terminado`,"text-green-400")},Ce=async(k,K)=>{for(let D=0;D<3;D++){if(P.current)return;for(f(q=>q.map(G=>G.id===k?{...G,estado:"Esperando semáforo",color:"bg-yellow-600",colorText:"text-yellow-400"}:G)),T(`Thread ${k}: 🔢 Esperando semáforo (valor: ${K.valor})`,"text-yellow-400");K.valor<=0;)if(await W(100),P.current)return;K.valor--,f(q=>q.map(G=>G.id===k?{...G,estado:"Usando recurso",color:"bg-green-600",colorText:"text-green-400"}:G)),T(`Thread ${k}: ✅ Ejecutó wait(S) - Usando recurso (S=${K.valor})`,"text-green-400"),await W(O()*.8),x(q=>q+1),T(`Thread ${k}: Incrementó contador`,"text-green-300"),await W(O()*.5),K.valor++,T(`Thread ${k}: 🔔 Ejecutó signal(S) - Liberó recurso (S=${K.valor})`,"text-cyan-400"),f(q=>q.map(G=>G.id===k?{...G,estado:"Trabajando",color:"bg-blue-600",colorText:"text-blue-400"}:G)),await W(O()*.3)}f(D=>D.map(q=>q.id===k?{...q,estado:"Terminado",color:"bg-gray-800",colorText:"text-gray-500"}:q)),T(`Thread ${k}: ✅ Terminado`,"text-green-400")},Le=async k=>{for(let M=0;M<3;M++){if(P.current)return;f(D=>D.map(q=>q.id===k?{...q,estado:"Preparando CAS",color:"bg-yellow-600",colorText:"text-yellow-400"}:q)),T(`Thread ${k}: ⚛️ Preparando operación atómica`,"text-yellow-400"),await W(O()*.3),f(D=>D.map(q=>q.id===k?{...q,estado:"Ejecutando CAS",color:"bg-green-600",colorText:"text-green-400"}:q)),T(`Thread ${k}: ⚡ Ejecutando ATOMIC_INCREMENT`,"text-green-400"),await W(O()*.2),x(D=>D+1),T(`Thread ${k}: ✅ Operación atómica completada`,"text-green-300"),f(D=>D.map(q=>q.id===k?{...q,estado:"Trabajando",color:"bg-blue-600",colorText:"text-blue-400"}:q)),await W(O()*.3)}f(M=>M.map(D=>D.id===k?{...D,estado:"Terminado",color:"bg-gray-800",colorText:"text-gray-500"}:D)),T(`Thread ${k}: ✅ Terminado`,"text-green-400")},I=async(k,K)=>{for(let D=0;D<3;D++){if(P.current)return;for(f(q=>q.map(G=>G.id===k?{...G,estado:"Esperando monitor",color:"bg-yellow-600",colorText:"text-yellow-400"}:G)),T(`Thread ${k}: 🏛️ Intentando entrar al monitor`,"text-yellow-400");K.ocupado;)if(await W(100),P.current)return;K.ocupado=!0,f(q=>q.map(G=>G.id===k?{...G,estado:"Dentro del monitor",color:"bg-green-600",colorText:"text-green-400"}:G)),T(`Thread ${k}: ✅ Entró al monitor - Ejecutando método sincronizado`,"text-green-400"),await W(O()*.8),x(q=>q+1),T(`Thread ${k}: Incrementó contador (sincronización implícita)`,"text-green-300"),await W(O()*.5),K.ocupado=!1,T(`Thread ${k}: 🚪 Salió del monitor`,"text-cyan-400"),f(q=>q.map(G=>G.id===k?{...G,estado:"Trabajando",color:"bg-blue-600",colorText:"text-blue-400"}:G)),await W(O()*.3)}f(D=>D.map(q=>q.id===k?{...q,estado:"Terminado",color:"bg-gray-800",colorText:"text-gray-500"}:q)),T(`Thread ${k}: ✅ Terminado`,"text-green-400")},Q=async(k,K)=>{const D=k%3===0;for(let q=0;q<3;q++){if(P.current)return;if(D){for(f(G=>G.map(be=>be.id===k?{...be,estado:"Esperando write lock",color:"bg-yellow-600",colorText:"text-yellow-400"}:be)),T(`Thread ${k}: 📝 Esperando write lock`,"text-yellow-400");K.lectores>0||K.escritor;)if(await W(100),P.current)return;K.escritor=!0,f(G=>G.map(be=>be.id===k?{...be,estado:"Escribiendo",color:"bg-purple-600",colorText:"text-purple-400"}:be)),T(`Thread ${k}: ✍️ Adquirió write lock - Escribiendo`,"text-purple-400"),await W(O()*1.2),x(G=>G+1),T(`Thread ${k}: Modificó datos (escritura exclusiva)`,"text-purple-300"),await W(O()*.5),K.escritor=!1,T(`Thread ${k}: 🔓 Liberó write lock`,"text-cyan-400")}else{for(f(G=>G.map(be=>be.id===k?{...be,estado:"Esperando read lock",color:"bg-yellow-600",colorText:"text-yellow-400"}:be)),T(`Thread ${k}: 📖 Esperando read lock`,"text-yellow-400");K.escritor;)if(await W(100),P.current)return;K.lectores++,f(G=>G.map(be=>be.id===k?{...be,estado:`Leyendo (${K.lectores} lectores)`,color:"bg-green-600",colorText:"text-green-400"}:be)),T(`Thread ${k}: 👓 Adquirió read lock - Leyendo (${K.lectores} lectores activos)`,"text-green-400"),await W(O()*.6),T(`Thread ${k}: Leyó datos (compartido con otros lectores)`,"text-green-300"),await W(O()*.4),K.lectores--,T(`Thread ${k}: 🔓 Liberó read lock (${K.lectores} lectores restantes)`,"text-cyan-400")}f(G=>G.map(be=>be.id===k?{...be,estado:"Trabajando",color:"bg-blue-600",colorText:"text-blue-400"}:be)),await W(O()*.3)}f(q=>q.map(G=>G.id===k?{...G,estado:"Terminado",color:"bg-gray-800",colorText:"text-gray-500"}:G)),T(`Thread ${k}: ✅ Terminado`,"text-green-400")},F=async()=>{P.current=!1,z.current=!1,l(!0),m(!1),x(0),b([]);const k=Array.from({length:N},(D,q)=>({id:q+1,estado:"Iniciando",color:"bg-blue-600",colorText:"text-blue-400"}));f(k);const K=N*3;T(`🚀 Iniciando demostración: ${A()}`,"text-cyan-400"),T(`📊 Configuración: ${N} threads, ${_} recursos`,"text-gray-400"),T(`🎯 Objetivo: Incrementar contador ${K} veces (3 por thread)`,"text-gray-400"),T("─".repeat(50),"text-gray-600");const M=[];switch(s){case"sin-proteccion":{for(let D=1;D<=N;D++)M.push(ne(D));await Promise.all(M);break}case"mutex":{const D=Array.from({length:N},(q,G)=>G+1);for(let q=1;q<=N;q++)M.push(Ee(q,D));await Promise.all(M);break}case"semaforo":{const D={valor:_};for(let q=1;q<=N;q++)M.push(Ce(q,D));await Promise.all(M);break}case"atomica":{for(let D=1;D<=N;D++)M.push(Le(D));await Promise.all(M);break}case"monitor":{const D={ocupado:!1};for(let q=1;q<=N;q++)M.push(I(q,D));await Promise.all(M);break}case"rwlock":{const D={lectores:0,escritor:!1};for(let q=1;q<=N;q++)M.push(Q(q,D));await Promise.all(M);break}}P.current||(T("─".repeat(50),"text-gray-600"),T(`🏁 Resultado final: ${h}`,"text-cyan-400"),h===K?T(`✅ ¡Correcto! Se alcanzó el valor esperado (${K})`,"text-green-400"):T(`❌ Race condition detectada! Esperado: ${K}, Obtenido: ${h}`,"text-red-400")),l(!1),m(!1)},de=()=>{z.current=!z.current,m(!d),z.current?T("⏸️ Demostración pausada","text-yellow-400"):T("▶️ Demostración reanudada","text-green-400")},ze=()=>{P.current=!0,z.current=!1,l(!1),m(!1),x(0),b([]),f(Array.from({length:N},(k,K)=>({id:K+1,estado:"Esperando",color:"bg-gray-600",colorText:"text-gray-400"})))},A=()=>({"sin-proteccion":"Sin Protección",mutex:"Mutex",semaforo:"Semáforo",atomica:"Variable Atómica",monitor:"Monitor",rwlock:"Read-Write Lock"})[s]||s,$=k=>{const K=Math.max(3,Math.min(10,N+k));j(K),n||f(Array.from({length:K},(M,D)=>({id:D+1,estado:"Esperando",color:"bg-gray-600",colorText:"text-gray-400"})))},se=k=>{const K=Math.max(1,Math.min(20,_+k));w(K)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"⚙️ Configuración de la Simulación"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Número de Threads"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>$(-1),disabled:n||N<=3,className:"p-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed rounded",children:e.jsx(go,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:N}),e.jsx("div",{className:"text-xs text-gray-400",children:"Min: 3, Max: 10"})]}),e.jsx("button",{onClick:()=>$(1),disabled:n||N>=10,className:"p-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed rounded",children:e.jsx(dr,{className:"size-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Velocidad de Simulación"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(dt,{value:C,onValueChange:E,max:100,step:1,disabled:n,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[e.jsx("span",{children:"Lenta"}),e.jsxs("span",{className:"font-bold text-white",children:[C[0],"%"]}),e.jsx("span",{children:"Rápida"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Recursos Compartidos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>se(-1),disabled:n||_<=1,className:"p-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed rounded",children:e.jsx(go,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:_}),e.jsx("div",{className:"text-xs text-gray-400",children:"Min: 1, Max: 20"})]}),e.jsx("button",{onClick:()=>se(1),disabled:n||_>=20,className:"p-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed rounded",children:e.jsx(dr,{className:"size-4"})})]})]})]})]}),e.jsxs(ia,{value:s,onValueChange:o,className:"w-full",children:[e.jsxs(Qt,{className:"w-full justify-start flex-wrap h-auto gap-2 bg-gray-900 p-2",children:[e.jsx(le,{value:"sin-proteccion",children:"❌ Sin Protección"}),e.jsx(le,{value:"mutex",children:"🔒 Mutex"}),e.jsx(le,{value:"semaforo",children:"🔢 Semáforo"}),e.jsx(le,{value:"atomica",children:"⚛️ Atómica"}),e.jsx(le,{value:"monitor",children:"🏛️ Monitor"}),e.jsx(le,{value:"rwlock",children:"📖 RW Lock"})]}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:F,disabled:n&&!d,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:[e.jsx(nt,{className:"size-5"}),n&&d?"Continuar Demostración":"Ejecutar Demostración"]}),n&&e.jsxs("button",{onClick:de,className:"flex items-center gap-2 bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:[e.jsx(ct,{className:"size-5"}),d?"Reanudar":"Pausar"]}),e.jsxs("button",{onClick:ze,disabled:!n&&g.length===0,className:"flex items-center gap-2 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-800 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:[e.jsx(it,{className:"size-5"}),"Reiniciar"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Estado de Threads"}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:v.map(k=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`size-3 rounded-full ${k.color} animate-pulse flex-shrink-0`}),e.jsxs("span",{className:"text-white font-mono text-sm w-20",children:["Thread ",k.id,":"]}),e.jsx("span",{className:`${k.colorText} text-sm`,children:k.estado})]},k.id))}),e.jsx("div",{className:"mt-6 p-4 bg-gray-800 rounded border border-gray-600",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Contador Compartido"}),e.jsx("div",{className:"text-5xl font-bold text-white font-mono",children:h}),e.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:["Esperado: ",N*3]})]})})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Logs de Ejecución"}),e.jsx("div",{ref:Z,onScroll:ge,className:"bg-black rounded p-4 h-96 overflow-y-auto font-mono text-sm",children:g.length===0?e.jsx("div",{className:"text-gray-500 text-center mt-8",children:'Configura los parámetros y presiona "Ejecutar" para comenzar'}):e.jsxs(e.Fragment,{children:[g.map((k,K)=>e.jsx("div",{className:`${k.color} mb-1`,children:k.mensaje},K)),e.jsx("div",{ref:V})]})})]})]}),e.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-6",children:[s==="sin-proteccion"&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"font-bold text-blue-200 mb-2",children:"❌ Sin Protección"}),e.jsx("p",{className:"text-sm text-blue-100",children:"Los threads acceden al contador simultáneamente sin sincronización. Esto causa race conditions donde múltiples threads leen el mismo valor antes de incrementar, resultando en incrementos perdidos. El resultado final será menor al esperado en la mayoría de las ejecuciones."})]}),s==="mutex"&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"font-bold text-blue-200 mb-2",children:"🔒 Mutex (Mutual Exclusion)"}),e.jsx("p",{className:"text-sm text-blue-100",children:"Un mutex protege la sección crítica garantizando que solo un thread pueda incrementar el contador a la vez. Los threads se organizan en una cola y esperan su turno, eliminando completamente las race conditions. El resultado siempre será exacto."})]}),s==="semaforo"&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"font-bold text-blue-200 mb-2",children:"🔢 Semáforo"}),e.jsx("p",{className:"text-sm text-blue-100",children:"Un semáforo controla el acceso mediante un contador. Permite que múltiples threads (hasta el límite del semáforo) accedan simultáneamente al recurso. Usa operaciones wait(S) para decrementar y signal(S) para incrementar. Ideal cuando hay múltiples recursos disponibles."})]}),s==="atomica"&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"font-bold text-blue-200 mb-2",children:"⚛️ Variable Atómica"}),e.jsx("p",{className:"text-sm text-blue-100",children:"Las operaciones atómicas garantizan que el incremento se realiza como una unidad indivisible a nivel de hardware. Usa instrucciones especiales del procesador (como Compare-And-Swap) sin necesidad de locks explícitos. Es la solución más eficiente y rápida. El resultado siempre es exacto."})]}),s==="monitor"&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"font-bold text-blue-200 mb-2",children:"🏛️ Monitor"}),e.jsx("p",{className:"text-sm text-blue-100",children:"Un monitor encapsula datos y métodos con sincronización automática. Solo un thread puede estar activo dentro del monitor a la vez. La sincronización es implícita, reduciendo errores de programación. Común en lenguajes orientados a objetos como Java (synchronized)."})]}),s==="rwlock"&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"font-bold text-blue-200 mb-2",children:"📖 Read-Write Lock"}),e.jsx("p",{className:"text-sm text-blue-100",children:"Permite múltiples lectores simultáneos pero escritura exclusiva. Los threads lectores (📖) pueden acceder al mismo tiempo, mientras que los escritores (📝) requieren acceso exclusivo. Optimiza escenarios donde las lecturas son más frecuentes que las escrituras."})]})]})]})]})]})}const f2=Sa("/ActividadesSeminarioSO/actividad11/condicion-carrera")({component:h2});function g2(){const[s,o]=c.useState([{id:1,status:"idle",lockHeld:!1},{id:2,status:"idle",lockHeld:!1},{id:3,status:"idle",lockHeld:!1},{id:4,status:"idle",lockHeld:!1}]),[n,l]=c.useState(!1),[d,m]=c.useState(0),[h,x]=c.useState(500),[g,b]=c.useState([!1,!1,!1,!1]),[v,f]=c.useState(0),[N,j]=c.useState(["Simulación Fine-grained Locking iniciada. Locks independientes por sección."]),_=c.useRef(null),[w,C]=c.useState([{id:1,status:"idle"},{id:2,status:"idle"},{id:3,status:"idle"},{id:4,status:"idle"}]),[E,z]=c.useState(!1),[P,V]=c.useState(0),[Z,oe]=c.useState(500),[O,T]=c.useState(0),[ge,J]=c.useState(0),[W,ne]=c.useState(["Simulación Lock-free iniciada. Operaciones sin bloqueos."]),Ee=c.useRef(null),[Ce,Le]=c.useState([{id:1,status:"idle"},{id:2,status:"idle"},{id:3,status:"idle"},{id:4,status:"idle"}]),[I,Q]=c.useState(!1),[F,de]=c.useState(0),[ze,A]=c.useState(500),[$,se]=c.useState([]),[k,K]=c.useState(0),[M,D]=c.useState(["Simulación Non-blocking I/O iniciada. Event loop procesando requests."]),q=c.useRef(null),[G,be]=c.useState([{id:1,status:"idle",task:void 0},{id:2,status:"idle",task:void 0},{id:3,status:"idle",task:void 0},{id:4,status:"idle",task:void 0}]),[Ne,R]=c.useState(!1),[ke,je]=c.useState(0),[ee,ae]=c.useState(500),[rt,jt]=c.useState([]),[xe,Me]=c.useState(0),[De,Ge]=c.useState(["Simulación Thread Pool iniciada. Pool de 4 workers."]),qe=c.useRef(null),[Se,Xe]=c.useState([]),[We,xt]=c.useState(!1),[Ot,It]=c.useState(0),[Ue,At]=c.useState(500),[et,L]=c.useState(0),[re,Ve]=c.useState(0),[ce,Te]=c.useState(["Simulación Async/Await iniciada. Ejecución concurrente sin bloqueos."]),_t=c.useRef(null),[St,tt]=c.useState([{id:1,status:"idle",lockHeld:!1},{id:2,status:"idle",lockHeld:!1},{id:3,status:"idle",lockHeld:!1},{id:4,status:"idle",lockHeld:!1}]),[Ye,ft]=c.useState(!1),[Ct,ve]=c.useState(0),[gt,$e]=c.useState(500),[B,U]=c.useState(0),[Dt,Ke]=c.useState(0),[fe,$t]=c.useState(["Simulación Scope Reducido iniciada. Minimizando tiempo en sección crítica."]),Zt=c.useRef(null),[pt,zt]=c.useState([{id:1,status:"idle"},{id:2,status:"idle"},{id:3,status:"idle"},{id:4,status:"idle"}]),[lt,Be]=c.useState(!1),[Ie,Je]=c.useState(0),[ot,X]=c.useState(500),[Oe,st]=c.useState([!1,!1,!1,!1]),[Rt,Qe]=c.useState(0),[He,mt]=c.useState(["Simulación Lazy Initialization iniciada. Recursos se inicializan solo cuando se necesitan."]),Jt=c.useRef(null);c.useEffect(()=>{_.current&&(_.current.scrollTop=_.current.scrollHeight)},[N]),c.useEffect(()=>{Ee.current&&(Ee.current.scrollTop=Ee.current.scrollHeight)},[W]),c.useEffect(()=>{q.current&&(q.current.scrollTop=q.current.scrollHeight)},[M]),c.useEffect(()=>{qe.current&&(qe.current.scrollTop=qe.current.scrollHeight)},[De]),c.useEffect(()=>{_t.current&&(_t.current.scrollTop=_t.current.scrollHeight)},[ce]),c.useEffect(()=>{Zt.current&&(Zt.current.scrollTop=Zt.current.scrollHeight)},[fe]),c.useEffect(()=>{Jt.current&&(Jt.current.scrollTop=Jt.current.scrollHeight)},[He]),c.useEffect(()=>{if(!n)return;const Y=setInterval(()=>{m(Ze=>Ze+1);const we=Math.floor(Math.random()*4),Mt=Math.floor(Math.random()*4);b(Ze=>{if(Ze[Mt])return f(Tt=>Tt+1),j(Tt=>[...Tt.slice(-9),`T${we+1}: Bloqueado esperando Sección ${Mt}`]),o(Tt=>Tt.map((Na,Pa)=>Pa===we?{...Na,status:"blocked"}:Na)),Ze;const vt=[...Ze];return vt[Mt]=!0,j(Tt=>[...Tt.slice(-9),`T${we+1}: Lock adquirido en Sección ${Mt}`]),o(Tt=>Tt.map((Na,Pa)=>Pa===we?{...Na,status:"working",lockHeld:!0}:Na)),setTimeout(()=>{b(Tt=>{const Na=[...Tt];return Na[Mt]=!1,Na}),j(Tt=>[...Tt.slice(-9),`T${we+1}: Lock liberado de Sección ${Mt}`]),o(Tt=>Tt.map((Na,Pa)=>Pa===we?{...Na,status:"idle",lockHeld:!1}:Na))},h/2),vt})},h);return()=>clearInterval(Y)},[n,h]),c.useEffect(()=>{if(!E)return;const Y=setInterval(()=>{V(Ze=>Ze+1);const we=Math.floor(Math.random()*4);C(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,status:"working"}:vt)),Math.random()<.9?(T(Ze=>Ze+1),ne(Ze=>[...Ze.slice(-9),`W${we+1}: Operación CAS exitosa sin bloqueos`]),setTimeout(()=>{C(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,status:"idle"}:vt))},Z/3)):(J(Ze=>Ze+1),ne(Ze=>[...Ze.slice(-9),`W${we+1}: CAS falló, reintentando (sin bloqueo)`]),setTimeout(()=>{T(Ze=>Ze+1),ne(Ze=>[...Ze.slice(-9),`W${we+1}: Operación exitosa tras reintento`]),C(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,status:"idle"}:vt))},Z/2))},Z);return()=>clearInterval(Y)},[E,Z]),c.useEffect(()=>{if(!I)return;const Y=setInterval(()=>{if(de(we=>we+1),Math.random()<.7){const we=Date.now()+Math.random();se(Ze=>[...Ze,we].slice(-8)),D(Ze=>[...Ze.slice(-9),`📨 Nueva solicitud I/O recibida (ID: ${Math.floor(we%1e3)})`]);const Mt=Math.floor(Math.random()*4);Le(Ze=>Ze.map((vt,Tt)=>Tt===Mt?{...vt,status:"working"}:vt)),setTimeout(()=>{se(Ze=>Ze.filter(vt=>vt!==we)),K(Ze=>Ze+1),D(Ze=>[...Ze.slice(-9),`✅ I/O completado por W${Mt+1} (sin bloquear otros)`]),Le(Ze=>Ze.map((vt,Tt)=>Tt===Mt?{...vt,status:"idle"}:vt))},ze)}},ze/2);return()=>clearInterval(Y)},[I,ze]),c.useEffect(()=>{if(!Ne)return;const Y=setInterval(()=>{if(je(Mt=>Mt+1),Math.random()<.6&&rt.length<12){const Mt={id:Date.now()+Math.random(),status:"pending",type:["compute","io","db"][Math.floor(Math.random()*3)]};jt(Ze=>[...Ze,Mt]),Ge(Ze=>[...Ze.slice(-9),`📋 Nueva tarea agregada a la cola (${Mt.type})`])}const we=G.findIndex(Mt=>Mt.status==="idle");we!==-1&&rt.length>0&&jt(Mt=>{const[Ze,...vt]=Mt;return be(Tt=>Tt.map((Na,Pa)=>Pa===we?{...Na,status:"working",task:Ze.id}:Na)),Ge(Tt=>[...Tt.slice(-9),`⚙️ Worker ${we+1} procesando tarea ${Ze.type}`]),setTimeout(()=>{Me(Tt=>Tt+1),be(Tt=>Tt.map((Na,Pa)=>Pa===we?{...Na,status:"idle",task:void 0}:Na)),Ge(Tt=>[...Tt.slice(-9),`✅ Worker ${we+1} completó tarea`])},ee),vt})},ee/2);return()=>clearInterval(Y)},[Ne,ee,G,rt.length]),c.useEffect(()=>{if(!We)return;const Y=setInterval(()=>{if(It(we=>we+1),Math.random()<.7){const we=Date.now()+Math.random(),Mt=Math.floor(Math.random()*3)+1,Ze={id:we,status:"executing",duration:Mt,startTime:Ot};Xe(vt=>[...vt.slice(-6),Ze]),L(vt=>vt+1),Te(vt=>[...vt.slice(-9),`🚀 Async task iniciada (durará ${Mt}s)`]),setTimeout(()=>{Xe(vt=>vt.map(Tt=>Tt.id===we?{...Tt,status:"completed"}:Tt)),L(vt=>vt-1),Ve(vt=>vt+1),Te(vt=>[...vt.slice(-9),"✅ Async task completada sin bloquear otras"])},Mt*Ue)}},Ue/2);return()=>clearInterval(Y)},[We,Ue,Ot]),c.useEffect(()=>{if(!Ye)return;const Y=setInterval(()=>{ve(Ze=>Ze+1);const we=Math.floor(Math.random()*4),Mt=Math.floor(Math.random()*30)+10;tt(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,status:"working"}:vt)),$t(Ze=>[...Ze.slice(-9),`T${we+1}: Preparando datos fuera de lock...`]),setTimeout(()=>{tt(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,lockHeld:!0}:vt)),$t(Ze=>[...Ze.slice(-9),`T${we+1}: Lock adquirido (solo ${Mt}ms)`]),U(Ze=>Ze+Mt),setTimeout(()=>{tt(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,status:"idle",lockHeld:!1}:vt)),$t(Ze=>[...Ze.slice(-9),`T${we+1}: Lock liberado rápidamente`]),Ke(B/(Ct||1))},Mt)},gt/2)},gt);return()=>clearInterval(Y)},[Ye,gt,B,Ct]),c.useEffect(()=>{if(!lt)return;const Y=setInterval(()=>{Je(Ze=>Ze+1);const we=Math.floor(Math.random()*4),Mt=Math.floor(Math.random()*4);Qe(Ze=>Ze+1),Oe[Mt]?(zt(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,status:"working"}:vt)),mt(Ze=>[...Ze.slice(-9),`W${we+1}: Usando Recurso ${Mt} (ya inicializado)`]),setTimeout(()=>{zt(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,status:"idle"}:vt))},ot/3)):(zt(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,status:"waiting"}:vt)),mt(Ze=>[...Ze.slice(-9),`W${we+1}: Inicializando Recurso ${Mt} por primera vez...`]),setTimeout(()=>{st(Ze=>{const vt=[...Ze];return vt[Mt]=!0,vt}),zt(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,status:"working"}:vt)),mt(Ze=>[...Ze.slice(-9),`W${we+1}: Recurso ${Mt} inicializado y listo`]),setTimeout(()=>{zt(Ze=>Ze.map((vt,Tt)=>Tt===we?{...vt,status:"idle"}:vt))},ot/3)},ot))},ot);return()=>clearInterval(Y)},[lt,ot,Oe]);const pa=()=>{l(!1),m(0),o(Y=>Y.map(we=>({...we,status:"idle",lockHeld:!1}))),b([!1,!1,!1,!1]),f(0),j(["Simulación Fine-grained Locking reiniciada."])},_e=()=>{z(!1),V(0),C(Y=>Y.map(we=>({...we,status:"idle"}))),T(0),J(0),ne(["Simulación Lock-free reiniciada."])},Fe=()=>{Q(!1),de(0),Le(Y=>Y.map(we=>({...we,status:"idle"}))),se([]),K(0),D(["Simulación Non-blocking I/O reiniciada."])},ht=()=>{R(!1),je(0),be(Y=>Y.map(we=>({...we,status:"idle",task:void 0}))),jt([]),Me(0),Ge(["Simulación Thread Pool reiniciada."])},Lt=()=>{xt(!1),It(0),Xe([]),L(0),Ve(0),Te(["Simulación Async/Await reiniciada."])},ut=()=>{ft(!1),ve(0),tt(Y=>Y.map(we=>({...we,status:"idle",lockHeld:!1}))),U(0),Ke(0),$t(["Simulación Scope Reducido reiniciada."])},at=()=>{Be(!1),Je(0),zt(Y=>Y.map(we=>({...we,status:"idle"}))),st([!1,!1,!1,!1]),Qe(0),mt(["Simulación Lazy Initialization reiniciada."])};return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(Nb,{className:"size-12 text-red-500"}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"🚫 Bloqueos Innecesarios"})]}),e.jsxs("p",{className:"text-lg text-gray-300 leading-relaxed",children:["Los ",e.jsx("span",{className:"font-bold text-red-400",children:"Bloqueos Innecesarios"})," son sincronizaciones que podrían evitarse o reducirse mediante técnicas más eficientes. Estos bloqueos reducen el paralelismo y degradan el rendimiento del sistema al forzar la serialización de operaciones que podrían ejecutarse concurrentemente."]}),e.jsx("div",{className:"mt-4 p-4 bg-red-900/30 border border-red-700/50 rounded-lg",children:e.jsxs("p",{className:"text-red-200",children:[e.jsx("span",{className:"font-bold",children:"Problema:"})," Locks excesivos o de granularidad gruesa pueden reducir la concurrencia en un 80-90%. Las técnicas modernas permiten eliminar o minimizar bloqueos, mejorando significativamente el throughput y la latencia."]})})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs(Da,{type:"multiple",defaultValue:["soluciones","demostracion"],className:"space-y-4",children:[e.jsxs(sa,{value:"soluciones",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Soluciones (Pseudocódigo)"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"fine",className:"px-6 pb-6",children:[e.jsxs(Qt,{className:"grid grid-cols-7 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"fine",children:"🔐 Fine-grained"}),e.jsx(le,{value:"lockfree",children:"🔓 Lock-free"}),e.jsx(le,{value:"nonblocking",children:"⚡ Non-blocking"}),e.jsx(le,{value:"threadpool",children:"👥 Thread Pool"}),e.jsx(le,{value:"async",children:"🔄 Async/Await"}),e.jsx(le,{value:"scope",children:"📏 Scope"}),e.jsx(le,{value:"lazy",children:"💤 Lazy Init"})]}),e.jsx(ue,{value:"fine",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-blue-400 mb-4",children:"🔐 Fine-grained Locking"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Usar locks específicos para cada sección independiente en lugar de un lock global, aumentando el paralelismo."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Mal: Lock Grueso (serializa TODO)
estructura SistemaGrueso {
  usuarios: Lista<Usuario>
  productos: Lista<Producto>
  pedidos: Lista<Pedido>
  lockGlobal: Lock  // ❌ Un solo lock para todo
}

función agregarUsuario(sistema: SistemaGrueso, usuario: Usuario) {
  sistema.lockGlobal.adquirir()  // Bloquea TODO
  
  sistema.usuarios.agregar(usuario)
  
  sistema.lockGlobal.liberar()
}

función agregarProducto(sistema: SistemaGrueso, producto: Producto) {
  sistema.lockGlobal.adquirir()  // Bloquea incluso usuarios y pedidos
  
  sistema.productos.agregar(producto)
  
  sistema.lockGlobal.liberar()
}
// Problema: Operaciones independientes se bloquean mutuamente

// Bien: Fine-grained Locking
estructura SistemaFino {
  usuarios: Lista<Usuario>
  lockUsuarios: Lock
  
  productos: Lista<Producto>
  lockProductos: Lock
  
  pedidos: Lista<Pedido>
  lockPedidos: Lock
}

función agregarUsuario(sistema: SistemaFino, usuario: Usuario) {
  sistema.lockUsuarios.adquirir()  // Solo lock de usuarios
  
  sistema.usuarios.agregar(usuario)
  
  sistema.lockUsuarios.liberar()
}

función agregarProducto(sistema: SistemaFino, producto: Producto) {
  sistema.lockProductos.adquirir()  // Lock independiente
  
  sistema.productos.agregar(producto)
  
  sistema.lockProductos.liberar()
  // Puede ejecutarse concurrentemente con agregarUsuario()
}

// Lista Enlazada con Hand-over-hand Locking
estructura NodoFino<T> {
  valor: T
  siguiente: NodoFino<T> | null
  lock: Lock
}

función buscar(lista: ListaFina<T>, valor: T) -> booleano {
  pred = null
  curr = lista.cabeza
  
  lista.lockCabeza.adquirir()
  si curr != null:
    curr.lock.adquirir()
  
  mientras curr != null:
    si curr.valor == valor:
      curr.lock.liberar()
      si pred != null:
        pred.lock.liberar()
      lista.lockCabeza.liberar()
      retornar verdadero
    
    // Hand-over-hand: adquirir siguiente antes de liberar actual
    siguiente = curr.siguiente
    si siguiente != null:
      siguiente.lock.adquirir()
    
    si pred != null:
      pred.lock.liberar()
    
    pred = curr
    curr = siguiente
  
  si pred != null:
    pred.lock.liberar()
  lista.lockCabeza.liberar()
  
  retornar falso
}

// Hash Table con Lock por Bucket
estructura HashMapFino<K, V> {
  buckets: Arreglo<Lista<Entry<K,V>>>
  locks: Arreglo<Lock>
  numBuckets: entero
}

función put(mapa: HashMapFino<K, V>, clave: K, valor: V) {
  hash = hash(clave)
  bucketIdx = hash % mapa.numBuckets
  
  // Solo lock del bucket específico
  mapa.locks[bucketIdx].adquirir()
  
  bucket = mapa.buckets[bucketIdx]
  para entry en bucket:
    si entry.clave == clave:
      entry.valor = valor
      mapa.locks[bucketIdx].liberar()
      retornar
  
  bucket.agregar(new Entry(clave, valor))
  mapa.locks[bucketIdx].liberar()
}

// Ventaja: Operaciones en diferentes buckets son concurrentes
// Mejora: Paralelismo proporcional al número de locks`})}),e.jsx("div",{className:"mt-4 p-3 bg-blue-900/30 border border-blue-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Permite concurrencia en secciones independientes.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Mayor complejidad, cuidado con deadlocks."]})})]})}),e.jsx(ue,{value:"lockfree",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-green-400 mb-4",children:"🔓 Lock-free Algorithms"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Eliminar completamente los locks usando operaciones atómicas. Sin bloqueos = sin contención."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Mal: Contador con Lock
estructura ContadorConLock {
  valor: entero
  lock: Lock
}

función incrementar(contador: ContadorConLock) {
  contador.lock.adquirir()  // ❌ Serializa accesos
  
  contador.valor++
  
  contador.lock.liberar()
}
// Problema: Threads esperan innecesariamente

// Bien: Contador Lock-free
estructura ContadorLockFree {
  valor: AtomicInteger
}

función incrementar(contador: ContadorLockFree) {
  // Sin locks, operación atómica
  incrementar_atomico(contador.valor)
}

// Stack Lock-free (Treiber Stack)
estructura NodoStack<T> {
  valor: T
  siguiente: AtomicReference<NodoStack<T>>
}

estructura StackLockFree<T> {
  cabeza: AtomicReference<NodoStack<T>>
}

función push(stack: StackLockFree<T>, valor: T) {
  nuevoNodo = new NodoStack(valor)
  
  loop:
    cabezaActual = cargar_atomico(stack.cabeza)
    nuevoNodo.siguiente = cabezaActual
    
    // Intenta actualizar cabeza atómicamente
    si compare_and_swap(stack.cabeza, cabezaActual, nuevoNodo):
      retornar  // Éxito sin bloqueos
    // Si falla, reintentar (sin esperar lock)
}

función pop(stack: StackLockFree<T>) -> T | null {
  loop:
    cabezaActual = cargar_atomico(stack.cabeza)
    
    si cabezaActual == null:
      retornar null
    
    siguiente = cabezaActual.siguiente
    
    si compare_and_swap(stack.cabeza, cabezaActual, siguiente):
      retornar cabezaActual.valor
    // Reintentar sin bloquear
}

// Queue Lock-free (Michael-Scott Queue)
estructura QueueLockFree<T> {
  cabeza: AtomicReference<Nodo<T>>
  cola: AtomicReference<Nodo<T>>
}

función enqueue(queue: QueueLockFree<T>, valor: T) {
  nuevoNodo = new Nodo(valor)
  nuevoNodo.siguiente = null
  
  loop:
    colaActual = cargar_atomico(queue.cola)
    siguienteActual = cargar_atomico(colaActual.siguiente)
    
    si colaActual == cargar_atomico(queue.cola):
      si siguienteActual == null:
        si compare_and_swap(colaActual.siguiente, null, nuevoNodo):
          compare_and_swap(queue.cola, colaActual, nuevoNodo)
          retornar
      sino:
        compare_and_swap(queue.cola, colaActual, siguienteActual)
}

función dequeue(queue: QueueLockFree<T>) -> T | null {
  loop:
    cabezaActual = cargar_atomico(queue.cabeza)
    colaActual = cargar_atomico(queue.cola)
    siguienteActual = cargar_atomico(cabezaActual.siguiente)
    
    si cabezaActual == cargar_atomico(queue.cabeza):
      si cabezaActual == colaActual:
        si siguienteActual == null:
          retornar null
        compare_and_swap(queue.cola, colaActual, siguienteActual)
      sino:
        valor = siguienteActual.valor
        si compare_and_swap(queue.cabeza, cabezaActual, siguienteActual):
          retornar valor
}

// Lista enlazada Lock-free (Harris Linked List)
función eliminar(lista: ListaLockFree<T>, valor: T) -> booleano {
  loop:
    (pred, curr) = buscar(lista, valor)
    
    si curr == null O curr.valor != valor:
      retornar falso
    
    // Marcar nodo para eliminación (bit marking)
    siguiente = cargar_atomico(curr.siguiente)
    si está_marcado(siguiente):
      continue
    
    // Intentar marcar
    si compare_and_swap(curr.siguiente, siguiente, marcar(siguiente)):
      // Intentar desenlazar físicamente
      compare_and_swap(pred.siguiente, curr, siguiente)
      retornar verdadero
}

// Ventajas:
// - Sin bloqueos = sin contención
// - Sin deadlocks
// - Progreso garantizado del sistema
// - Escalabilidad en múltiples cores

// Desventajas:
// - Complejidad de implementación
// - Problema ABA (requiere gestión de memoria especial)
// - Overhead de CAS en alta contención`})}),e.jsx("div",{className:"mt-4 p-3 bg-green-900/30 border border-green-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-green-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Elimina bloqueos completamente, máximo paralelismo.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Complejidad, problema ABA, overhead de CAS."]})})]})}),e.jsx(ue,{value:"nonblocking",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-400 mb-4",children:"⚡ Non-blocking I/O"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Evitar bloqueos en operaciones de I/O usando event loops y callbacks asíncronos."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Mal: I/O Bloqueante
función servidorBloqueante() {
  socket = crearSocket()
  socket.bind(puerto)
  socket.listen()
  
  mientras verdadero:
    cliente = socket.accept()  // ❌ BLOQUEA hasta nueva conexión
    datos = cliente.read()     // ❌ BLOQUEA hasta recibir datos
    
    respuesta = procesarDatos(datos)
    
    cliente.write(respuesta)   // ❌ BLOQUEA hasta enviar
    cliente.close()
}
// Problema: Un thread bloqueado por cliente (escalabilidad limitada)

// Bien: Non-blocking I/O con Event Loop
estructura EventLoop {
  selectores: Selector
  handlers: Mapa<Socket, Handler>
}

función servidorNoBlockeante() {
  eventLoop = new EventLoop()
  serverSocket = crearSocket()
  serverSocket.setNonBlocking(verdadero)
  serverSocket.bind(puerto)
  serverSocket.listen()
  
  eventLoop.registrar(serverSocket, LEER, onNuevaConexion)
  
  // Event loop (sin bloqueos)
  mientras verdadero:
    eventos = eventLoop.selectores.select(timeout: 0)  // No bloquea
    
    para evento en eventos:
      handler = eventLoop.handlers[evento.socket]
      handler(evento)
}

función onNuevaConexion(evento: Evento) {
  cliente = evento.socket.accept()
  cliente.setNonBlocking(verdadero)
  
  // Registrar para futuras lecturas
  eventLoop.registrar(cliente, LEER, onDatosRecibidos)
}

función onDatosRecibidos(evento: Evento) {
  cliente = evento.socket
  
  intentar:
    datos = cliente.read()
    
    si datos == EOF:
      eventLoop.desregistrar(cliente)
      cliente.close()
      retornar
    
    // Procesar sin bloquear
    procesarAsync(datos, función(respuesta) {
      // Registrar para escritura cuando esté listo
      eventLoop.registrar(cliente, ESCRIBIR, onListoParaEscribir, respuesta)
    })
  
  capturar WouldBlock:
    // No hay datos aún, seguir esperando
    pasar

función onListoParaEscribir(evento: Evento, respuesta: bytes) {
  cliente = evento.socket
  
  intentar:
    bytesEscritos = cliente.write(respuesta)
    
    si bytesEscritos == longitud(respuesta):
      // Escritura completa
      eventLoop.desregistrar(cliente, ESCRIBIR)
      eventLoop.registrar(cliente, LEER, onDatosRecibidos)
    sino:
      // Escritura parcial, continuar después
      respuestaRestante = respuesta[bytesEscritos:]
      eventLoop.actualizar(cliente, ESCRIBIR, onListoParaEscribir, respuestaRestante)
  
  capturar WouldBlock:
    // Socket no listo, seguir esperando
    pasar

// Ejemplo Node.js style (callback-based)
función leerArchivoAsync(ruta: string, callback: (datos: bytes) -> void) {
  // Inicia operación I/O en background
  operacionIO = iniciarLecturaAsync(ruta)
  
  // Registra callback (sin bloquear)
  operacionIO.onCompleted(función(datos) {
    callback(datos)
  })
  
  // Retorna inmediatamente
}

// Cliente HTTP no bloqueante
función fetchMultiple(urls: Lista<string>) -> Lista<Respuesta> {
  respuestas = []
  pendientes = longitud(urls)
  
  para url en urls:
    httpClienteAsync.get(url, función(respuesta) {
      respuestas.agregar(respuesta)
      pendientes--
      
      si pendientes == 0:
        procesarTodasRespuestas(respuestas)
    })
  
  // Retorna sin esperar (event loop maneja callbacks)
}

// Reactor Pattern (epoll/kqueue)
estructura Reactor {
  epoll: EPollDescriptor
  handlers: Mapa<fd, Handler>
}

función ejecutar(reactor: Reactor) {
  mientras verdadero:
    eventos = reactor.epoll.wait(timeout: -1)
    
    para evento en eventos:
      fd = evento.fileDescriptor
      handler = reactor.handlers[fd]
      
      si evento.tipo == EPOLL_IN:
        handler.onLeer(fd)
      sino si evento.tipo == EPOLL_OUT:
        handler.onEscribir(fd)
      sino si evento.tipo == EPOLL_ERR:
        handler.onError(fd)
}

// Ventajas:
// - Un solo thread maneja miles de conexiones
// - Sin overhead de context switch
// - Escalabilidad (C10K problem resuelto)
// - Memoria constante por conexión

// Casos de uso:
// - Servidores web (nginx, Node.js)
// - Bases de datos (Redis, memcached)
// - Proxies de alta performance`})}),e.jsx("div",{className:"mt-4 p-3 bg-purple-900/30 border border-purple-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-purple-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Miles de conexiones con un solo thread.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Callback hell, complejidad de debugging."]})})]})}),e.jsx(ue,{value:"threadpool",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-400 mb-4",children:"👥 Thread Pools"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Reutilizar threads para evitar overhead de creación/destrucción constante."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Mal: Crear Thread por Tarea
función procesarTareaMal(tarea: Tarea) {
  thread = new Thread(función() {  // ❌ Crea nuevo thread
    tarea.ejecutar()
  })
  thread.start()
  thread.join()  // ❌ Espera bloquea
}
// Overhead: ~1-2ms por creación thread, cientos de MB memoria

// Bien: Thread Pool
estructura ThreadPool {
  workers: Lista<Thread>
  colaTrabajos: Queue<Tarea>
  mutex: Lock
  condicion: ConditionVariable
  ejecutando: booleano
}

función crearThreadPool(numThreads: entero) -> ThreadPool {
  pool = new ThreadPool()
  pool.colaTrabajos = new Queue()
  pool.ejecutando = verdadero
  
  para i en 0 hasta numThreads:
    worker = new Thread(funcionWorker, pool)
    worker.start()
    pool.workers.agregar(worker)
  
  retornar pool
}

función funcionWorker(pool: ThreadPool) {
  mientras verdadero:
    pool.mutex.adquirir()
    
    // Esperar hasta que haya trabajo
    mientras pool.colaTrabajos.estaVacia() Y pool.ejecutando:
      pool.condicion.wait(pool.mutex)
    
    si no pool.ejecutando:
      pool.mutex.liberar()
      break
    
    tarea = pool.colaTrabajos.dequeue()
    pool.mutex.liberar()
    
    // Ejecutar sin lock
    tarea.ejecutar()
}

función submit(pool: ThreadPool, tarea: Tarea) {
  pool.mutex.adquirir()
  
  pool.colaTrabajos.enqueue(tarea)
  pool.condicion.signal()  // Despertar un worker
  
  pool.mutex.liberar()
}

función shutdown(pool: ThreadPool) {
  pool.mutex.adquirir()
  pool.ejecutando = falso
  pool.condicion.broadcast()  // Despertar todos
  pool.mutex.liberar()
  
  para worker en pool.workers:
    worker.join()
}

// Thread Pool con Futures
estructura Future<T> {
  valor: T | null
  completo: booleano
  mutex: Lock
  condicion: ConditionVariable
}

función submitConResultado(pool: ThreadPool, tarea: () -> T) -> Future<T> {
  future = new Future<T>()
  
  tareaWrapper = función() {
    resultado = tarea()
    
    future.mutex.adquirir()
    future.valor = resultado
    future.completo = verdadero
    future.condicion.broadcast()
    future.mutex.liberar()
  }
  
  submit(pool, tareaWrapper)
  retornar future
}

función get(future: Future<T>) -> T {
  future.mutex.adquirir()
  
  mientras no future.completo:
    future.condicion.wait(future.mutex)
  
  resultado = future.valor
  future.mutex.liberar()
  
  retornar resultado
}

// Work Stealing Thread Pool (Java ForkJoinPool style)
estructura WorkStealingPool {
  workers: Lista<Worker>
  colas: Lista<Deque<Tarea>>  // Una cola por worker
}

estructura Worker {
  id: entero
  cola: Deque<Tarea>
  pool: WorkStealingPool
}

función ejecutarWorker(worker: Worker) {
  mientras verdadero:
    // Intentar tarea de cola propia (extremo local)
    tarea = worker.cola.pollFirst()
    
    si tarea == null:
      // Intentar robar de otra cola (extremo remoto)
      tarea = intentarRobar(worker.pool, worker.id)
    
    si tarea != null:
      tarea.ejecutar()
    sino:
      dormir(1)  // No hay trabajo
}

función intentarRobar(pool: WorkStealingPool, idPropio: entero) -> Tarea | null {
  // Intentar robar de colas de otros workers
  para i en 0 hasta longitud(pool.colas):
    si i == idPropio:
      continue
    
    tarea = pool.colas[i].pollLast()  // Desde el otro extremo
    si tarea != null:
      retornar tarea
  
  retornar null
}

// Thread Pool con Prioridades
estructura ThreadPoolConPrioridades {
  workers: Lista<Thread>
  colaAlta: Queue<Tarea>
  colaMedia: Queue<Tarea>
  colaBaja: Queue<Tarea>
  mutex: Lock
  condicion: ConditionVariable
}

función obtenerSiguienteTarea(pool: ThreadPoolConPrioridades) -> Tarea | null {
  pool.mutex.adquirir()
  
  mientras todasColasVacias(pool):
    pool.condicion.wait(pool.mutex)
  
  tarea = null
  si no pool.colaAlta.estaVacia():
    tarea = pool.colaAlta.dequeue()
  sino si no pool.colaMedia.estaVacia():
    tarea = pool.colaMedia.dequeue()
  sino:
    tarea = pool.colaBaja.dequeue()
  
  pool.mutex.liberar()
  retornar tarea
}

// Ajuste dinámico de tamaño
función ajustarTamaño(pool: ThreadPool, carga: real) {
  si carga > 0.8 Y pool.numThreads < MAX_THREADS:
    // Alta carga: agregar workers
    agregarWorker(pool)
  sino si carga < 0.2 Y pool.numThreads > MIN_THREADS:
    // Baja carga: reducir workers
    removerWorker(pool)
}

// Ventajas:
// - Reutilización reduce overhead (100x más rápido)
// - Memoria fija (no crece con tareas)
// - Control de concurrencia (límite threads)

// Casos de uso:
// - Servidores (Tomcat, Apache)
// - Procesamiento paralelo
// - Tareas I/O bound`})}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-900/30 border border-yellow-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Reutilización, control de recursos.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Complejidad de tuning, posible starvation."]})})]})}),e.jsx(ue,{value:"async",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-cyan-400 mb-4",children:"🔄 Async/Await Patterns"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Sintaxis síncrona para código asíncrono, evitando bloqueos con corutinas."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Mal: Código Síncrono Bloqueante
función obtenerDatosUsuarioMal(userId: entero) -> Usuario {
  // Cada llamada BLOQUEA el thread
  usuario = db.query("SELECT * FROM users WHERE id = ?", userId)  // ❌ Bloquea ~50ms
  pedidos = db.query("SELECT * FROM orders WHERE user_id = ?", userId)  // ❌ Bloquea ~30ms
  perfil = http.get("https://api.com/profile/" + userId)  // ❌ Bloquea ~200ms
  
  retornar combinar(usuario, pedidos, perfil)
}
// Total: ~280ms bloqueado, thread inactivo

// Bien: Async/Await (No Bloqueante)
async función obtenerDatosUsuario(userId: entero) -> Usuario {
  // Lanza 3 operaciones concurrentemente
  tareaUsuario = db.queryAsync("SELECT * FROM users WHERE id = ?", userId)
  tareaPedidos = db.queryAsync("SELECT * FROM orders WHERE user_id = ?", userId)
  tareaPerfil = http.getAsync("https://api.com/profile/" + userId)
  
  // Espera sin bloquear (thread hace otro trabajo)
  usuario = await tareaUsuario     // Retorna cuando completa
  pedidos = await tareaPedidos
  perfil = await tareaPerfil
  
  retornar combinar(usuario, pedidos, perfil)
}
// Total: ~200ms (paralelo), thread NO bloqueado

// Implementación de Async/Await con Corutinas
estructura Corutina {
  estado: enum { CREADA, EJECUTANDO, SUSPENDIDA, COMPLETADA }
  pilaEjecucion: Pila
  punteroInstruccion: entero
  valorRetorno: any
}

función async_función(funcion: () -> T) -> Corutina {
  corutina = new Corutina()
  corutina.estado = CREADA
  corutina.pilaEjecucion = new Pila()
  
  retornar corutina
}

función await(corutina: Corutina, tarea: Tarea) -> T {
  si tarea.completa():
    retornar tarea.resultado()
  
  // Suspender corutina (sin bloquear thread)
  corutina.estado = SUSPENDIDA
  
  // Registrar callback para reanudar
  tarea.onCompleted(función(resultado) {
    corutina.valorRetorno = resultado
    corutina.estado = EJECUTANDO
    scheduler.encolar(corutina)  // Reanudar después
  })
  
  // Ceder control (thread ejecuta otra cosa)
  scheduler.yield()
}

// Scheduler de Corutinas
estructura Scheduler {
  colaListas: Queue<Corutina>
  ejecutando: Corutina | null
}

función ejecutar(scheduler: Scheduler) {
  mientras verdadero:
    si scheduler.colaListas.estaVacia():
      // No hay trabajo, dormir o hacer I/O
      epoll.wait()
      continue
    
    corutina = scheduler.colaListas.dequeue()
    scheduler.ejecutando = corutina
    
    // Ejecutar hasta siguiente await
    ejecutarCorutina(corutina)
    
    si corutina.estado == COMPLETADA:
      // Liberar recursos
      liberarCorutina(corutina)
    sino si corutina.estado == SUSPENDIDA:
      // Esperando I/O, ya encolada para reanudar
      continue
}

// Async con múltiples tareas concurrentes
async función procesarMultiple(items: Lista<Item>) -> Lista<Resultado> {
  tareas = []
  
  para item en items:
    tarea = procesarItemAsync(item)
    tareas.agregar(tarea)
  
  // Espera todas concurrentemente
  resultados = await all(tareas)
  
  retornar resultados
}

función all(tareas: Lista<Tarea<T>>) -> Tarea<Lista<T>> {
  pendientes = longitud(tareas)
  resultados = new Lista<T>(longitud(tareas))
  tareaCompuesta = new Tarea<Lista<T>>()
  
  para i, tarea en enumerar(tareas):
    tarea.onCompleted(función(resultado) {
      resultados[i] = resultado
      pendientes--
      
      si pendientes == 0:
        tareaCompuesta.completar(resultados)
    })
  
  retornar tareaCompuesta
}

// Async con timeout
async función conTimeout(tarea: Tarea<T>, timeout: entero) -> T {
  temporizador = crearTemporizador(timeout)
  
  resultado = await race([tarea, temporizador])
  
  si resultado == TIMEOUT:
    lanzar TimeoutError()
  
  retornar resultado
}

// Generador asíncrono
async función* leerArchivoPorLineas(archivo: string) {
  handle = await abrirAsync(archivo)
  
  mientras verdadero:
    linea = await handle.leerLineaAsync()
    
    si linea == EOF:
      break
    
    yield linea  // Retorna valor y suspende
  
  await handle.cerrarAsync()
}

// Uso de generador
async función procesarArchivo(ruta: string) {
  async para linea en leerArchivoPorLineas(ruta):
    await procesarLineaAsync(linea)
}

// Stream asíncrono con backpressure
estructura StreamAsync<T> {
  buffer: Queue<T>
  capacidad: entero
  productorSuspendido: booleano
  consumidorEsperando: Promise | null
}

async función escribir(stream: StreamAsync<T>, item: T) {
  mientras stream.buffer.tamaño() >= stream.capacidad:
    // Backpressure: esperar espacio
    await stream.espacioDisponible()
  
  stream.buffer.enqueue(item)
  
  si stream.consumidorEsperando != null:
    stream.consumidorEsperando.resolver(item)
}

async función leer(stream: StreamAsync<T>) -> T {
  si stream.buffer.estaVacia():
    // Esperar nuevo item
    item = await new Promise(función(resolve) {
      stream.consumidorEsperando = resolve
    })
    retornar item
  
  retornar stream.buffer.dequeue()
}

// Ventajas:
// - Sintaxis clara (parece código síncrono)
// - Alto concurrency (miles de corutinas/thread)
// - Sin bloqueos (cooperative multitasking)
// - Memoria eficiente

// Casos de uso:
// - I/O intensivo (servidores web, APIs)
// - Pipelines de datos
// - Interfaces de usuario responsivas`})}),e.jsx("div",{className:"mt-4 p-3 bg-cyan-900/30 border border-cyan-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-cyan-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Sintaxis clara, alta concurrencia sin bloqueos.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Debugging complejo, propagación de async."]})})]})}),e.jsx(ue,{value:"scope",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-pink-400 mb-4",children:"📏 Reducir Scope Crítico"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Minimizar el tiempo dentro de secciones críticas, moviendo trabajo fuera de los locks."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Mal: Scope Crítico Extenso
estructura Cache {
  datos: Mapa<string, Valor>
  lock: Lock
}

función obtenerOMal(cache: Cache, clave: string) -> Valor {
  cache.lock.adquirir()  // ❌ Lock demasiado temprano
  
  // Trabajo que NO necesita lock (serializado innecesariamente)
  claveNormalizada = clave.toLower().trim()
  timestamp = obtenerTimestamp()
  
  si cache.datos.contiene(claveNormalizada):
    valor = cache.datos[claveNormalizada]
    
    // Cálculo pesado dentro del lock ❌
    si timestamp - valor.timestamp < TTL:
      valorDeserializado = deserializar(valor.datos)  // ❌ Lento
      valorProcesado = procesarValor(valorDeserializado)  // ❌ Muy lento
      
      cache.lock.liberar()
      retornar valorProcesado
  
  // Query DB dentro del lock ❌
  valorDB = db.query(claveNormalizada)  // ❌ 50ms bloqueado
  valorSerializado = serializar(valorDB)  // ❌ Lento
  
  cache.datos[claveNormalizada] = new CacheEntry(valorSerializado, timestamp)
  
  cache.lock.liberar()  // ❌ Lock mantenido ~55ms
  retornar valorDB
}
// Problema: Lock retenido durante I/O y procesamiento (contención alta)

// Bien: Scope Crítico Mínimo
función obtenerO(cache: Cache, clave: string) -> Valor {
  // Trabajo fuera del lock
  claveNormalizada = clave.toLower().trim()
  timestamp = obtenerTimestamp()
  
  // Lock solo para acceso al mapa
  cache.lock.adquirir()
  valorBruto = cache.datos[claveNormalizada]
  cache.lock.liberar()  // ✅ Liberado rápido (~1μs)
  
  si valorBruto != null:
    // Deserialización fuera del lock
    valorDeserializado = deserializar(valorBruto.datos)
    
    si timestamp - valorBruto.timestamp < TTL:
      // Procesamiento fuera del lock
      retornar procesarValor(valorDeserializado)
  
  // Query DB sin lock
  valorDB = db.query(claveNormalizada)  // Sin bloquear otros
  valorSerializado = serializar(valorDB)
  
  // Lock solo para actualizar mapa
  cache.lock.adquirir()
  cache.datos[claveNormalizada] = new CacheEntry(valorSerializado, timestamp)
  cache.lock.liberar()  // ✅ Liberado rápido (~1μs)
  
  retornar valorDB
}

// Lista enlazada: inserción ordenada
función insertarOrdenadoMal(lista: Lista, valor: entero) {
  lista.lock.adquirir()  // ❌ Lock todo el tiempo
  
  nodo = lista.cabeza
  
  // Búsqueda dentro del lock ❌
  mientras nodo != null Y nodo.valor < valor:
    nodo = nodo.siguiente
  
  // Creación del nodo dentro del lock ❌
  nuevoNodo = new Nodo(valor)
  
  // Inserción
  nuevoNodo.siguiente = nodo
  // ... enlazar
  
  lista.lock.liberar()
}

función insertarOrdenado(lista: Lista, valor: entero) {
  // Crear nodo ANTES del lock
  nuevoNodo = new Nodo(valor)
  
  lista.lock.adquirir()
  
  nodo = lista.cabeza
  
  // Búsqueda e inserción (mínimo necesario)
  mientras nodo != null Y nodo.valor < valor:
    nodo = nodo.siguiente
  
  nuevoNodo.siguiente = nodo
  // ... enlazar
  
  lista.lock.liberar()  // ✅ Scope reducido 50%
}

// Patrón: Copiar-Modificar-Actualizar
estructura ConfiguracionCompartida {
  datos: AtomicReference<Config>
}

función actualizarConfigMal(config: ConfiguracionCompartida, nuevos: Cambios) {
  lock.adquirir()  // ❌ Bloquea lectores
  
  configActual = config.datos.cargar()
  
  // Modificación lenta dentro del lock ❌
  para cambio en nuevos:
    aplicarCambio(configActual, cambio)
  
  validar(configActual)  // ❌ Lento
  
  config.datos.almacenar(configActual)
  
  lock.liberar()
}

función actualizarConfig(config: ConfiguracionCompartida, nuevos: Cambios) {
  // Cargar sin lock (lectores no bloqueados)
  configActual = config.datos.cargar()
  
  // Clonar y modificar SIN lock
  configNueva = clonar(configActual)
  para cambio en nuevos:
    aplicarCambio(configNueva, cambio)
  
  validar(configNueva)
  
  // Solo CAS atómico (sin lock)
  compare_and_swap(config.datos, configActual, configNueva)
  // ✅ Sin bloqueos, lectores siempre pueden leer
}

// Preparar trabajo antes del lock
función enviarMensajeMal(conexion: Conexion, mensaje: Mensaje) {
  conexion.lock.adquirir()  // ❌ Lock temprano
  
  // Serialización dentro del lock ❌
  bytes = mensaje.serializar()  // 5ms
  
  // Compresión dentro del lock ❌
  bytesComprimidos = comprimir(bytes)  // 10ms
  
  // Envío
  conexion.socket.enviar(bytesComprimidos)
  
  conexion.lock.liberar()  // ❌ Retenido 15ms
}

función enviarMensaje(conexion: Conexion, mensaje: Mensaje) {
  // Preparar TODO fuera del lock
  bytes = mensaje.serializar()
  bytesComprimidos = comprimir(bytes)
  
  // Lock solo para envío por socket
  conexion.lock.adquirir()
  conexion.socket.enviar(bytesComprimidos)
  conexion.lock.liberar()  // ✅ ~0.1ms
}

// Double-checked locking (evitar lock en caso común)
estructura Singleton {
  instancia: AtomicReference<Objeto>
  lock: Lock
}

función obtenerInstancia(singleton: Singleton) -> Objeto {
  // Primera verificación SIN lock (rápido)
  instancia = singleton.instancia.cargar()
  si instancia != null:
    retornar instancia
  
  // Caso raro: necesita inicialización
  singleton.lock.adquirir()
  
  // Segunda verificación CON lock
  instancia = singleton.instancia.cargar()
  si instancia != null:
    singleton.lock.liberar()
    retornar instancia
  
  // Crear instancia
  instancia = crearInstancia()
  singleton.instancia.almacenar(instancia)
  
  singleton.lock.liberar()
  retornar instancia
}

// Principios:
// 1. Lock lo más tarde posible
// 2. Liberar lo más temprano posible
// 3. Mover I/O fuera del lock
// 4. Mover cómputo pesado fuera del lock
// 5. Preparar datos antes del lock
// 6. Usar atomic operations para lecturas`})}),e.jsx("div",{className:"mt-4 p-3 bg-pink-900/30 border border-pink-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-pink-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Reduce contención drásticamente (10-100x mejora).",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Requiere análisis cuidadoso del código."]})})]})}),e.jsx(ue,{value:"lazy",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-bold text-orange-400 mb-4",children:"💤 Lazy Initialization"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Inicializar recursos solo cuando se necesitan, evitando sincronización prematura."}),e.jsx("pre",{className:"bg-black rounded p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-green-400",children:`// Mal: Inicialización Eager (al inicio)
estructura SistemaMal {
  cache: Cache
  conexionDB: BaseDatos
  servicioExterno: Cliente
  logger: Logger
  metricas: Metricas
  // ... 20 componentes más
}

función inicializarSistemaMal() -> SistemaMal {
  sistema = new SistemaMal()
  
  // Inicializa TODO al inicio (lento, puede no usarse)
  sistema.cache = new Cache(capacidad: 10000)  // ❌ 500ms
  sistema.conexionDB = conectarDB(config)      // ❌ 2s
  sistema.servicioExterno = new Cliente(url)   // ❌ 1s
  sistema.logger = new Logger(archivo)         // ❌ 200ms
  sistema.metricas = new Metricas(config)      // ❌ 300ms
  // ... más inicializaciones ❌
  
  // Startup: 5+ segundos, incluso si no se usa todo
  retornar sistema
}

// Bien: Lazy Initialization
estructura Sistema {
  cache: Cache | null
  cacheLock: Lock
  
  conexionDB: BaseDatos | null
  dbLock: Lock
  
  // ... otros componentes
}

función obtenerCache(sistema: Sistema) -> Cache {
  // Double-checked locking
  si sistema.cache != null:
    retornar sistema.cache
  
  sistema.cacheLock.adquirir()
  
  si sistema.cache != null:
    sistema.cacheLock.liberar()
    retornar sistema.cache
  
  // Inicializar solo cuando se necesita
  sistema.cache = new Cache(capacidad: 10000)
  
  sistema.cacheLock.liberar()
  retornar sistema.cache
}

función obtenerDB(sistema: Sistema) -> BaseDatos {
  si sistema.conexionDB != null:
    retornar sistema.conexionDB
  
  sistema.dbLock.adquirir()
  
  si sistema.conexionDB != null:
    sistema.dbLock.liberar()
    retornar sistema.conexionDB
  
  sistema.conexionDB = conectarDB(config)
  
  sistema.dbLock.liberar()
  retornar sistema.conexionDB
}
// Ventaja: Startup ~10ms, componentes se crean solo cuando se usan

// Lazy con std::call_once (C++ style)
estructura RecursoLazy<T> {
  recurso: T | null
  bandera: AtomicFlag
}

función obtener(lazy: RecursoLazy<T>, inicializador: () -> T) -> T {
  si lazy.recurso != null:
    retornar lazy.recurso
  
  si atomic_flag_test_and_set(lazy.bandera) == falso:
    // Primera llamada: inicializar
    lazy.recurso = inicializador()
  sino:
    // Otro thread está inicializando, esperar
    mientras lazy.recurso == null:
      cpu_relax()
  
  retornar lazy.recurso
}

// Lazy con holder idiom (thread-safe en Java)
estructura SinClienteLazy {
  estructura Holder {
    constante INSTANCIA = new SinClient()
  }
  
  función obtenerInstancia() -> SinClient {
    retornar Holder.INSTANCIA
    // Inicializado solo cuando Holder se carga (thread-safe)
  }
}

// Lazy para colecciones
estructura CacheLazy<K, V> {
  datos: Mapa<K, V>
  fabricas: Mapa<K, () -> V>
  lock: Lock
}

función obtener(cache: CacheLazy<K, V>, clave: K) -> V {
  // Verificación rápida
  cache.lock.adquirir()
  si cache.datos.contiene(clave):
    valor = cache.datos[clave]
    cache.lock.liberar()
    retornar valor
  cache.lock.liberar()
  
  // Crear valor (fuera del lock si es posible)
  fabrica = cache.fabricas[clave]
  valor = fabrica()
  
  // Almacenar
  cache.lock.adquirir()
  cache.datos[clave] = valor
  cache.lock.liberar()
  
  retornar valor
}

// Lazy con CompletableFuture (async)
estructura RecursoAsync<T> {
  promesa: AtomicReference<Future<T>>
}

async función obtenerAsync(recurso: RecursoAsync<T>, inicializador: async () -> T) -> T {
  future = recurso.promesa.cargar()
  
  si future != null:
    retornar await future
  
  // Iniciar inicialización
  nuevaPromesa = inicializador()
  
  si compare_and_swap(recurso.promesa, null, nuevaPromesa):
    // Este thread ganó, esperar resultado
    retornar await nuevaPromesa
  sino:
    // Otro thread ganó, usar su promesa
    retornar await recurso.promesa.cargar()
}

// Lazy con expiración (timed lazy)
estructura RecursoTimedLazy<T> {
  recurso: T | null
  timestampCreacion: entero
  ttl: entero
  lock: Lock
}

función obtener(lazy: RecursoTimedLazy<T>, fabrica: () -> T) -> T {
  ahora = obtenerTimestamp()
  
  lazy.lock.adquirir()
  
  si lazy.recurso != null Y (ahora - lazy.timestampCreacion < lazy.ttl):
    recurso = lazy.recurso
    lazy.lock.liberar()
    retornar recurso
  
  // Recrear si expiró
  lazy.recurso = fabrica()
  lazy.timestampCreacion = ahora
  
  recurso = lazy.recurso
  lazy.lock.liberar()
  
  retornar recurso
}

// Thread-local lazy (sin sincronización)
estructura ThreadLocalLazy<T> {
  threadLocals: Mapa<ThreadID, T>
  fabrica: () -> T
}

función obtenerLocal(lazy: ThreadLocalLazy<T>) -> T {
  tid = obtenerThreadID()
  
  // Sin lock: cada thread su propia copia
  si no lazy.threadLocals.contiene(tid):
    lazy.threadLocals[tid] = lazy.fabrica()
  
  retornar lazy.threadLocals[tid]
}

// Patrón: Lazy con precondiciones
estructura ConexionPoolLazy {
  pool: ConexionPool | null
  config: Config
  lock: Lock
}

función obtenerConexion(poolLazy: ConexionPoolLazy) -> Conexion {
  poolLazy.lock.adquirir()
  
  si poolLazy.pool == null:
    // Validar config antes de inicializar
    validarConfiguracion(poolLazy.config)
    
    // Inicializar pool
    poolLazy.pool = new ConexionPool(poolLazy.config)
    
    // Warm-up inicial
    para i en 0 hasta poolLazy.config.minConexiones:
      poolLazy.pool.agregarConexion()
  
  pool = poolLazy.pool
  poolLazy.lock.liberar()
  
  retornar pool.obtenerConexion()
}

// Ventajas:
// - Startup rápido (inicialización bajo demanda)
// - Menor uso de memoria (recursos no usados no se crean)
// - Evita trabajo innecesario
// - Reduce locks al inicio (menos contención)

// Casos de uso:
// - Singletons
// - Conexiones DB/Red
// - Cachés grandes
// - Recursos costosos
// - Plugins/Módulos opcionales`})}),e.jsx("div",{className:"mt-4 p-3 bg-orange-900/30 border border-orange-700/50 rounded",children:e.jsxs("p",{className:"text-sm text-orange-200",children:[e.jsx("span",{className:"font-bold",children:"Ventaja:"})," Startup rápido, recursos solo cuando se usan.",e.jsx("span",{className:"font-bold",children:" Desventaja:"})," Primera llamada más lenta, complejidad en thread-safety."]})})]})})]})})]}),e.jsxs(sa,{value:"demostracion",className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx(ra,{className:"text-xl font-bold text-white hover:no-underline px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(La,{className:"size-5"}),e.jsx("span",{children:"Demostraciones Interactivas"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"demo-fine",className:"px-6 pb-6",children:[e.jsxs(Qt,{className:"grid grid-cols-7 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"demo-fine",children:"🔐 Fine-grained"}),e.jsx(le,{value:"demo-lockfree",children:"🔓 Lock-free"}),e.jsx(le,{value:"demo-io",children:"⚡ Non-blocking"}),e.jsx(le,{value:"demo-pool",children:"👥 Pool"}),e.jsx(le,{value:"demo-async",children:"🔄 Async"}),e.jsx(le,{value:"demo-scope",children:"📏 Scope"}),e.jsx(le,{value:"demo-lazy",children:"💤 Lazy"})]}),e.jsx(ue,{value:"demo-fine",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-blue-400",children:"Demo: Fine-grained Locking"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>l(!n),className:`px-4 py-2 rounded flex items-center gap-2 ${n?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"}`,children:[n?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),n?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:pa,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("span",{className:"text-gray-400",children:["Tiempo: ",d,"s"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",h,"ms"]}),e.jsx(dt,{value:[h],onValueChange:([Y])=>x(Y),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Threads"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:s.map(Y=>e.jsx("div",{className:`p-3 rounded border-2 ${Y.status==="working"?"bg-blue-900/50 border-blue-500":Y.status==="blocked"?"bg-red-900/50 border-red-500 animate-pulse":"bg-gray-800 border-gray-600"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["T",Y.id]}),e.jsx("div",{className:"text-sm font-bold",children:Y.status==="idle"?"💤":Y.status==="blocked"?"🚫":"⚙️"}),e.jsx("div",{className:"text-xs",children:Y.lockHeld?"🔒":""})]})},Y.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Secciones (Locks Independientes)"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:g.map((Y,we)=>e.jsx("div",{className:`p-3 rounded border-2 ${Y?"bg-red-900/50 border-red-500":"bg-green-900/50 border-green-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["Sección ",we]}),e.jsx("div",{className:"text-2xl",children:Y?"🔒":"🔓"})]})},we))}),e.jsxs("div",{className:"mt-3 p-2 bg-gray-800 rounded text-center",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Threads Bloqueados"}),e.jsx("div",{className:"text-lg font-bold text-red-400",children:v})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:_,className:"bg-black rounded p-3 h-48 overflow-y-auto font-mono text-xs text-green-400",children:N.map((Y,we)=>e.jsx("div",{children:Y},we))})]})]})}),e.jsx(ue,{value:"demo-lockfree",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-green-400",children:"Demo: Lock-free Algorithms"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>z(!E),className:`px-4 py-2 rounded flex items-center gap-2 ${E?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:[E?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),E?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:_e,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("span",{className:"text-gray-400",children:["Tiempo: ",P,"s"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",Z,"ms"]}),e.jsx(dt,{value:[Z],onValueChange:([Y])=>oe(Y),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Workers"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:w.map(Y=>e.jsx("div",{className:`p-3 rounded border-2 ${Y.status==="working"?"bg-green-900/50 border-green-500":"bg-gray-800 border-gray-600"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["W",Y.id]}),e.jsx("div",{className:"text-2xl",children:Y.status==="working"?"⚙️":"💤"})]})},Y.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Métricas"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Operaciones CAS"}),e.jsx("div",{className:"text-lg font-bold text-green-400",children:O})]}),e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Reintentos"}),e.jsx("div",{className:"text-lg font-bold text-yellow-400",children:ge})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Estado"}),e.jsxs("div",{className:"p-4 bg-green-900/30 border border-green-700/50 rounded text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:"🔓"}),e.jsx("div",{className:"text-sm text-green-300",children:"Sin Locks"}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:"Operaciones atómicas CAS"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:Ee,className:"bg-black rounded p-3 h-48 overflow-y-auto font-mono text-xs text-green-400",children:W.map((Y,we)=>e.jsx("div",{children:Y},we))})]})]})}),e.jsx(ue,{value:"demo-io",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-400",children:"Demo: Non-blocking I/O"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>Q(!I),className:`px-4 py-2 rounded flex items-center gap-2 ${I?"bg-red-600 hover:bg-red-700":"bg-purple-600 hover:bg-purple-700"}`,children:[I?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),I?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:Fe,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("span",{className:"text-gray-400",children:["Tiempo: ",F,"s"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",ze,"ms"]}),e.jsx(dt,{value:[ze],onValueChange:([Y])=>A(Y),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Event Loop Workers"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Ce.map(Y=>e.jsx("div",{className:`p-3 rounded border-2 ${Y.status==="working"?"bg-purple-900/50 border-purple-500":"bg-gray-800 border-gray-600"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["W",Y.id]}),e.jsx("div",{className:"text-2xl",children:Y.status==="working"?"📡":"💤"})]})},Y.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Requests Pendientes"}),e.jsx("div",{className:"p-4 bg-gray-800 rounded h-32 overflow-y-auto",children:$.length===0?e.jsx("div",{className:"text-center text-gray-500 text-xs",children:"Sin requests pendientes"}):$.map(Y=>e.jsxs("div",{className:"text-xs text-purple-400 mb-1",children:["📨 Request #",Math.floor(Y%1e3)]},Y))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Estadísticas"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Pendientes"}),e.jsx("div",{className:"text-lg font-bold text-purple-400",children:$.length})]}),e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Completados"}),e.jsx("div",{className:"text-lg font-bold text-green-400",children:k})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:q,className:"bg-black rounded p-3 h-48 overflow-y-auto font-mono text-xs text-purple-400",children:M.map((Y,we)=>e.jsx("div",{children:Y},we))})]})]})}),e.jsx(ue,{value:"demo-pool",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-400",children:"Demo: Thread Pool"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>R(!Ne),className:`px-4 py-2 rounded flex items-center gap-2 ${Ne?"bg-red-600 hover:bg-red-700":"bg-yellow-600 hover:bg-yellow-700"}`,children:[Ne?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),Ne?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:ht,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("span",{className:"text-gray-400",children:["Tiempo: ",ke,"s"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",ee,"ms"]}),e.jsx(dt,{value:[ee],onValueChange:([Y])=>ae(Y),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Workers del Pool"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:G.map(Y=>e.jsx("div",{className:`p-3 rounded border-2 ${Y.status==="working"?"bg-yellow-900/50 border-yellow-500":"bg-gray-800 border-gray-600"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["Worker ",Y.id]}),e.jsx("div",{className:"text-xl",children:Y.status==="working"?"⚙️":"💤"}),Y.task&&e.jsxs("div",{className:"text-xs text-yellow-400 mt-1",children:["Task #",Math.floor(Y.task%100)]})]})},Y.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Cola de Tareas"}),e.jsx("div",{className:"p-4 bg-gray-800 rounded h-32 overflow-y-auto",children:rt.length===0?e.jsx("div",{className:"text-center text-gray-500 text-xs",children:"Cola vacía"}):rt.map(Y=>e.jsxs("div",{className:"text-xs text-yellow-400 mb-1",children:["📋 ",Y.type," Task"]},Y.id))}),e.jsxs("div",{className:"mt-2 text-center text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Tareas en cola:"})," ",e.jsx("span",{className:"font-bold text-yellow-400",children:rt.length})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Estadísticas"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Tareas Completadas"}),e.jsx("div",{className:"text-lg font-bold text-green-400",children:xe})]}),e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Workers Activos"}),e.jsxs("div",{className:"text-lg font-bold text-yellow-400",children:[G.filter(Y=>Y.status==="working").length,"/4"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:qe,className:"bg-black rounded p-3 h-48 overflow-y-auto font-mono text-xs text-yellow-400",children:De.map((Y,we)=>e.jsx("div",{children:Y},we))})]})]})}),e.jsx(ue,{value:"demo-async",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-cyan-400",children:"Demo: Async/Await Patterns"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>xt(!We),className:`px-4 py-2 rounded flex items-center gap-2 ${We?"bg-red-600 hover:bg-red-700":"bg-cyan-600 hover:bg-cyan-700"}`,children:[We?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),We?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:Lt,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("span",{className:"text-gray-400",children:["Tiempo: ",Ot,"s"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",Ue,"ms"]}),e.jsx(dt,{value:[Ue],onValueChange:([Y])=>At(Y),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Async Tasks en Ejecución"}),e.jsx("div",{className:"space-y-2",children:Se.length===0?e.jsx("div",{className:"text-center text-gray-500 text-sm p-8",children:"Sin tasks activas"}):Se.map(Y=>e.jsx("div",{className:`p-3 rounded border-2 ${Y.status==="executing"?"bg-cyan-900/50 border-cyan-500":"bg-green-900/50 border-green-500"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs text-gray-400",children:["Task #",Math.floor(Y.id%1e3)]}),e.jsx("span",{className:"ml-3 text-sm",children:Y.status==="executing"?"🔄 Ejecutando":"✅ Completada"})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Duración: ",Y.duration,"s"]})]})},Y.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Métricas"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Tasks Activas"}),e.jsx("div",{className:"text-lg font-bold text-cyan-400",children:et})]}),e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Completadas"}),e.jsx("div",{className:"text-lg font-bold text-green-400",children:re})]}),e.jsxs("div",{className:"p-4 bg-cyan-900/30 border border-cyan-700/50 rounded text-center mt-4",children:[e.jsx("div",{className:"text-2xl mb-1",children:"🔄"}),e.jsx("div",{className:"text-xs text-cyan-300",children:"Concurrencia sin bloqueos"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:_t,className:"bg-black rounded p-3 h-48 overflow-y-auto font-mono text-xs text-cyan-400",children:ce.map((Y,we)=>e.jsx("div",{children:Y},we))})]})]})}),e.jsx(ue,{value:"demo-scope",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-pink-400",children:"Demo: Reducir Scope Crítico"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>ft(!Ye),className:`px-4 py-2 rounded flex items-center gap-2 ${Ye?"bg-red-600 hover:bg-red-700":"bg-pink-600 hover:bg-pink-700"}`,children:[Ye?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),Ye?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:ut,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("span",{className:"text-gray-400",children:["Tiempo: ",Ct,"s"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",gt,"ms"]}),e.jsx(dt,{value:[gt],onValueChange:([Y])=>$e(Y),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Threads"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:St.map(Y=>e.jsx("div",{className:`p-3 rounded border-2 ${Y.status==="working"?"bg-pink-900/50 border-pink-500":"bg-gray-800 border-gray-600"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["T",Y.id]}),e.jsx("div",{className:"text-xl",children:Y.status==="working"?"⚙️":"💤"}),Y.lockHeld&&e.jsx("div",{className:"text-lg mt-1",children:"🔒"})]})},Y.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Tiempo en Lock"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Total Acumulado"}),e.jsxs("div",{className:"text-lg font-bold text-pink-400",children:[B,"ms"]})]}),e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Promedio por Op"}),e.jsxs("div",{className:"text-lg font-bold text-yellow-400",children:[Dt.toFixed(1),"ms"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Estrategia"}),e.jsx("div",{className:"p-4 bg-pink-900/30 border border-pink-700/50 rounded",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"📏"}),e.jsx("div",{className:"text-xs text-pink-300",children:"Scope Mínimo"}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:"Preparar fuera, lock solo para actualizar"})]})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:Zt,className:"bg-black rounded p-3 h-48 overflow-y-auto font-mono text-xs text-pink-400",children:fe.map((Y,we)=>e.jsx("div",{children:Y},we))})]})]})}),e.jsx(ue,{value:"demo-lazy",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-orange-400",children:"Demo: Lazy Initialization"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>Be(!lt),className:`px-4 py-2 rounded flex items-center gap-2 ${lt?"bg-red-600 hover:bg-red-700":"bg-orange-600 hover:bg-orange-700"}`,children:[lt?e.jsx(ct,{className:"size-4"}):e.jsx(nt,{className:"size-4"}),lt?"Pausar":"Iniciar"]}),e.jsxs("button",{onClick:at,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded flex items-center gap-2",children:[e.jsx(it,{className:"size-4"}),"Reiniciar"]}),e.jsxs("span",{className:"text-gray-400",children:["Tiempo: ",Ie,"s"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Velocidad: ",ot,"ms"]}),e.jsx(dt,{value:[ot],onValueChange:([Y])=>X(Y),min:100,max:1e3,step:50,className:"w-64"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Workers"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:pt.map(Y=>e.jsx("div",{className:`p-3 rounded border-2 ${Y.status==="working"?"bg-orange-900/50 border-orange-500":Y.status==="waiting"?"bg-yellow-900/50 border-yellow-500 animate-pulse":"bg-gray-800 border-gray-600"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["W",Y.id]}),e.jsx("div",{className:"text-xl",children:Y.status==="waiting"?"⏳":Y.status==="working"?"⚙️":"💤"})]})},Y.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Recursos"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Oe.map((Y,we)=>e.jsx("div",{className:`p-3 rounded border-2 ${Y?"bg-green-900/50 border-green-500":"bg-gray-800 border-gray-600"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["Recurso ",we]}),e.jsx("div",{className:"text-2xl",children:Y?"✅":"💤"}),e.jsx("div",{className:"text-xs text-gray-400",children:Y?"Inicializado":"Lazy"})]})},we))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-3",children:"Estadísticas"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Total Accesos"}),e.jsx("div",{className:"text-lg font-bold text-orange-400",children:Rt})]}),e.jsxs("div",{className:"p-3 bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Inicializados"}),e.jsxs("div",{className:"text-lg font-bold text-green-400",children:[Oe.filter(Y=>Y).length,"/4"]})]}),e.jsxs("div",{className:"p-4 bg-orange-900/30 border border-orange-700/50 rounded text-center",children:[e.jsx("div",{className:"text-2xl mb-1",children:"💤"}),e.jsx("div",{className:"text-xs text-orange-300",children:"Init on-demand"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2",children:"Log de Eventos"}),e.jsx("div",{ref:Jt,className:"bg-black rounded p-3 h-48 overflow-y-auto font-mono text-xs text-orange-400",children:He.map((Y,we)=>e.jsx("div",{children:Y},we))})]})]})})]})})]})]})})]})}const b2=Sa("/ActividadesSeminarioSO/actividad11/bloqueos-innecesarios")({component:g2});function v2(){const[s,o]=c.useState(!1),[n,l]=c.useState(1e3),[d,m]=c.useState({nodes:[{id:"A",value:"A",version:0,next:"B"},{id:"B",value:"B",version:0,next:"C"},{id:"C",value:"C",version:0,next:null}],head:"A",version:0}),[h,x]=c.useState(["📦 Stack inicializado: A(v0) → B(v0) → C(v0)"]),[,g]=c.useState(0),[b,v]=c.useState(!1),[f,N]=c.useState(1e3),[j,_]=c.useState({nodes:[{id:"A",value:"A",next:"B"},{id:"B",value:"B",next:"C"},{id:"C",value:"C",next:null}],head:"A",version:0}),[w,C]=c.useState([]),[E,z]=c.useState([]),[P,V]=c.useState(["🛡️ Sistema de Hazard Pointers inicializado"]),[,Z]=c.useState(0),[oe,O]=c.useState(!1),[T,ge]=c.useState(1e3),[J,W]=c.useState({nodes:[{id:"A",value:"A",version:0,next:"B"},{id:"B",value:"B",version:0,next:null}],head:"A",version:0}),[ne,Ee]=c.useState({pointer1:null,version1:0,pointer2:null,version2:0}),[Ce,Le]=c.useState(["⚛️ Sistema DCAS (128-bit CAS) inicializado"]),[,I]=c.useState(0),[Q,F]=c.useState(!1),[de,ze]=c.useState(1e3),[A,$]=c.useState({nodes:[{id:"A",value:"A",next:"B"},{id:"B",value:"B",next:"C"},{id:"C",value:"C",next:null}],head:"A",version:0}),[se,k]=c.useState(0),[K,M]=c.useState([0,0]),[D,q]=c.useState(new Map),[G,be]=c.useState(["🗑️ Epoch-Based Reclamation inicializado (epoch 0)"]),[,Ne]=c.useState(0),[R,ke]=c.useState(!1),[je,ee]=c.useState(1e3),[ae,rt]=c.useState({nodes:[{id:"A",value:"A",next:"B"},{id:"B",value:"B",next:"C"},{id:"C",value:"C",next:null}],head:"A",version:0}),[jt,xe]=c.useState({active:!1,address:null,value:null}),[Me,De]=c.useState(["🔗 Sistema LL/SC inicializado"]),[,Ge]=c.useState(0),qe=c.useRef(null),Se=c.useRef(null),Xe=c.useRef(null),We=c.useRef(null),xt=c.useRef(null);c.useEffect(()=>{qe.current&&(qe.current.scrollTop=qe.current.scrollHeight)},[h]),c.useEffect(()=>{Se.current&&(Se.current.scrollTop=Se.current.scrollHeight)},[P]),c.useEffect(()=>{Xe.current&&(Xe.current.scrollTop=Xe.current.scrollHeight)},[Ce]),c.useEffect(()=>{We.current&&(We.current.scrollTop=We.current.scrollHeight)},[G]),c.useEffect(()=>{xt.current&&(xt.current.scrollTop=xt.current.scrollHeight)},[Me]),c.useEffect(()=>{if(!s)return;const L=setInterval(()=>{g(re=>{const Ve=re+1;return Ve===1?x(ce=>[...ce,"🔵 Thread 1: Inicia pop() - lee head = A(v0)"]):Ve===2?(x(ce=>[...ce,"🔴 Thread 2: pop() exitoso - A(v0) → B(v1)"]),m(ce=>({...ce,head:"B",version:1,nodes:ce.nodes.map(Te=>Te.id==="B"?{...Te,version:1}:Te)}))):Ve===3?(x(ce=>[...ce,"🔴 Thread 2: pop() exitoso - B(v1) → C(v2)"]),m(ce=>({...ce,head:"C",version:2,nodes:ce.nodes.map(Te=>Te.id==="C"?{...Te,version:2}:Te)}))):Ve===4?(x(ce=>[...ce,"🔴 Thread 2: push(A) exitoso - C(v2) → A(v3)"]),m(ce=>({...ce,head:"A",version:3,nodes:[{id:"A",value:"A",version:3,next:"C"},...ce.nodes.filter(Te=>Te.id!=="A")]}))):Ve===5?x(ce=>[...ce,"⚠️ Head es A nuevamente, pero versión cambió: v0 → v3"]):Ve===6?x(ce=>[...ce,"🔵 Thread 1: Intenta CAS(A, v0) → (B, v1)"]):Ve===7&&(x(ce=>[...ce,"❌ CAS FALLA: expected=(A, v0) != actual=(A, v3)","✅ ABA DETECTADO: versioning previno corrupción"]),o(!1)),Ve})},n);return()=>clearInterval(L)},[s,n]),c.useEffect(()=>{if(!b)return;const L=setInterval(()=>{Z(re=>{const Ve=re+1;return Ve===1?(V(ce=>[...ce,"🔵 Thread 1: acquire() hazard pointer"]),C(["A"])):Ve===2?V(ce=>[...ce,"🔵 Thread 1: protect(head) → HP[0] = A"]):Ve===3?V(ce=>[...ce,"🔴 Thread 2: pop() - intenta remover A"]):Ve===4?(V(ce=>[...ce,"🔴 Thread 2: CAS exitoso, A removido del stack"]),_(ce=>({...ce,head:"B"}))):Ve===5?(V(ce=>[...ce,"🔴 Thread 2: retire(A) - agregado a retire list"]),z(["A"])):Ve===6?V(ce=>[...ce,"🔴 Thread 2: scan() - verifica hazard pointers"]):Ve===7?V(ce=>[...ce,"⚠️ A está protegido por HP[0], NO se puede liberar","✅ Hazard pointer previene use-after-free"]):Ve===8?(V(ce=>[...ce,"🔵 Thread 1: release(HP[0]) - A ya no está protegido"]),C([])):Ve===9?V(ce=>[...ce,"🔴 Thread 2: scan() nuevamente"]):Ve===10&&(V(ce=>[...ce,"✅ A no está protegido, se puede liberar: free(A)"]),z([]),_(ce=>({...ce,nodes:ce.nodes.filter(Te=>Te.id!=="A")})),v(!1)),Ve})},f);return()=>clearInterval(L)},[b,f]),c.useEffect(()=>{if(!oe)return;const L=setInterval(()=>{I(re=>{const Ve=re+1;return Ve===1?(Le(ce=>[...ce,"🔵 Thread 1: Inicia pop() - lee (pointer=A, version=0)"]),Ee({pointer1:"A",version1:0,pointer2:"B",version2:1})):Ve===2?(Le(ce=>[...ce,"🔴 Thread 2: DCAS exitoso - (A,v0) → (B,v1)"]),W(ce=>({...ce,head:"B",version:1}))):Ve===3?(Le(ce=>[...ce,"🔴 Thread 2: DCAS exitoso - (B,v1) → (null,v2)"]),W(ce=>({...ce,head:null,version:2}))):Ve===4?(Le(ce=>[...ce,"🔴 Thread 2: push(A) - DCAS exitoso (null,v2) → (A,v3)"]),W(ce=>({...ce,head:"A",version:3,nodes:[{id:"A",value:"A",version:3,next:null}]}))):Ve===5?Le(ce=>[...ce,"⚠️ Puntero volvió a A, pero versión: v0 → v3"]):Ve===6?Le(ce=>[...ce,"🔵 Thread 1: DCAS intenta (A,v0) → (B,v1)"]):Ve===7&&(Le(ce=>[...ce,"❌ DCAS FALLA: (pointer,version) no coinciden","   Expected: (A, 0)","   Actual:   (A, 3)","✅ DCAS detectó cambio intermedio"]),Ee({pointer1:null,version1:0,pointer2:null,version2:0}),O(!1)),Ve})},T);return()=>clearInterval(L)},[oe,T]),c.useEffect(()=>{if(!Q)return;const L=setInterval(()=>{Ne(re=>{const Ve=re+1;return Ve===1?(be(ce=>[...ce,"🔵 Thread 1: enterEpoch() - thread epoch = 0"]),M([0,-1])):Ve===2?be(ce=>[...ce,"🔵 Thread 1: pop() en progreso..."]):Ve===3?(be(ce=>[...ce,"🔴 Thread 2: enterEpoch() - thread epoch = 0"]),M([0,0])):Ve===4?(be(ce=>[...ce,"🔴 Thread 2: pop(A) exitoso - retire(A) en epoch 0"]),$(ce=>({...ce,head:"B"})),q(new Map([[0,["A"]]]))):Ve===5?(be(ce=>[...ce,"🔴 Thread 2: exitEpoch() - thread epoch = -1"]),M([0,-1])):Ve===6?(be(ce=>[...ce,"🔵 Thread 1: exitEpoch() - thread epoch = -1"]),M([-1,-1])):Ve===7?be(ce=>[...ce,"⚙️ Todos los threads salieron del epoch 0"]):Ve===8?(be(ce=>[...ce,"✅ Avanzar global epoch: 0 → 1"]),k(1)):Ve===9&&(be(ce=>[...ce,"🗑️ Liberar nodos del epoch 0: free(A)","✅ Safe: ningún thread está en epoch 0"]),q(new Map),$(ce=>({...ce,nodes:ce.nodes.filter(Te=>Te.id!=="A")})),F(!1)),Ve})},de);return()=>clearInterval(L)},[Q,de]),c.useEffect(()=>{if(!R)return;const L=setInterval(()=>{Ge(re=>{const Ve=re+1;return Ve===1?(De(ce=>[...ce,"🔵 Thread 1: LL(&head) - lee A, activa link register"]),xe({active:!0,address:"head",value:"A"})):Ve===2?De(ce=>[...ce,"🔴 Thread 2: pop(A) - escribe en head"]):Ve===3?(De(ce=>[...ce,"🔴 Thread 2: head = A → B (ESCRITURA detectada por HW)"]),rt(ce=>({...ce,head:"B"})),xe(ce=>({...ce,active:!1}))):Ve===4?De(ce=>[...ce,"🔴 Thread 2: pop(B), luego push(A)"]):Ve===5?(De(ce=>[...ce,"🔴 Thread 2: head = B → C"]),rt(ce=>({...ce,head:"C"}))):Ve===6?(De(ce=>[...ce,"🔴 Thread 2: push(A) → head = C → A"]),rt(ce=>({...ce,head:"A",nodes:[{id:"A",value:"A",next:"C"},...ce.nodes.filter(Te=>Te.id!=="A")]}))):Ve===7?De(ce=>[...ce,"⚠️ Head volvió a A (ABA ocurrió)"]):Ve===8?De(ce=>[...ce,"🔵 Thread 1: SC(&head, B) - intenta escribir"]):Ve===9&&(De(ce=>[...ce,"❌ SC FALLA: link register inactivo","   Hardware detectó escritura intermedia","✅ LL/SC detectó ABA automáticamente"]),ke(!1)),Ve})},je);return()=>clearInterval(L)},[R,je]);const Ot=()=>{o(!1),g(0),m({nodes:[{id:"A",value:"A",version:0,next:"B"},{id:"B",value:"B",version:0,next:"C"},{id:"C",value:"C",version:0,next:null}],head:"A",version:0}),x(["📦 Stack reinicializado: A(v0) → B(v0) → C(v0)"])},It=()=>{v(!1),Z(0),_({nodes:[{id:"A",value:"A",next:"B"},{id:"B",value:"B",next:"C"},{id:"C",value:"C",next:null}],head:"A",version:0}),C([]),z([]),V(["🛡️ Sistema reinicializado"])},Ue=()=>{O(!1),I(0),W({nodes:[{id:"A",value:"A",version:0,next:"B"},{id:"B",value:"B",version:0,next:null}],head:"A",version:0}),Ee({pointer1:null,version1:0,pointer2:null,version2:0}),Le(["⚛️ Sistema DCAS reinicializado"])},At=()=>{F(!1),Ne(0),$({nodes:[{id:"A",value:"A",next:"B"},{id:"B",value:"B",next:"C"},{id:"C",value:"C",next:null}],head:"A",version:0}),k(0),M([0,0]),q(new Map),be(["🗑️ Sistema EBR reinicializado (epoch 0)"])},et=()=>{ke(!1),Ge(0),rt({nodes:[{id:"A",value:"A",next:"B"},{id:"B",value:"B",next:"C"},{id:"C",value:"C",next:null}],head:"A",version:0}),xe({active:!1,address:null,value:null}),De(["🔗 Sistema LL/SC reinicializado"])};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-900/50 to-red-900/50 border-b border-orange-700/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(yn,{className:"size-8 text-orange-400"}),e.jsx("h1",{className:"text-4xl font-bold",children:"ABA Problem"})]}),e.jsxs("p",{className:"text-lg text-gray-300 leading-relaxed",children:["El ",e.jsx("span",{className:"text-orange-400 font-semibold",children:"problema ABA"})," ocurre en programación concurrente lock-free cuando un valor cambia de A → B → A, y un thread usando CAS (Compare-And-Swap) no detecta que el valor intermedio B existió, asumiendo incorrectamente que nada ha cambiado."]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{className:"bg-orange-900/30 border border-orange-700/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-orange-300 mb-2",children:"⚠️ Problema"}),e.jsx("p",{className:"text-sm text-gray-300",children:"CAS(expected: A, new: C) puede tener éxito incluso si el valor pasó por B, causando corrupción de memoria, use-after-free, o estados inconsistentes en estructuras de datos."})]}),e.jsxs("div",{className:"bg-red-900/30 border border-red-700/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-red-300 mb-2",children:"✅ Soluciones"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Versioning/tagging, hazard pointers, DCAS, garbage collection, o instrucciones LL/SC que detectan cualquier cambio intermedio en la memoria."})]})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs(Da,{type:"multiple",defaultValue:["pseudocodigos","demos"],className:"space-y-4",children:[e.jsxs(sa,{value:"pseudocodigos",className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(ra,{className:"text-xl font-bold px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{className:"size-5"}),e.jsx("span",{children:"Pseudocódigos de las Soluciones"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"ps-versioning",className:"px-6 pb-6",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs(Qt,{className:"grid grid-cols-5 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"ps-versioning",children:"🔖 Versioning"}),e.jsx(le,{value:"ps-hazard",children:"🛡️ Hazard"}),e.jsx(le,{value:"ps-dcas",children:"⚛️ DCAS"}),e.jsx(le,{value:"ps-gc",children:"🗑️ GC"}),e.jsx(le,{value:"ps-llsc",children:"🔗 LL/SC"})]})}),e.jsx(ue,{value:"ps-versioning",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-blue-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-400 mb-4",children:"🔖 Versioning / Tagged Pointers"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"1. Tagged Pointer Básico"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Empaquetar puntero + versión en un solo valor atómico

estructura TaggedPointer<T> {
  pointer: T*              // Puntero real (48-52 bits)
  version: entero          // Versión/tag (12-16 bits)
}

// Empaquetar en un entero de 64 bits
función pack(ptr: T*, version: entero) -> uint64 {
  // Asumir que punteros usan 48 bits (arquitecturas x86-64)
  // Los 16 bits superiores se usan para versión
  ptrBits = (uint64)ptr & 0x0000FFFFFFFFFFFF
  versionBits = ((uint64)version & 0xFFFF) << 48
  retornar ptrBits | versionBits
}

// Desempaquetar
función unpack(tagged: uint64) -> (T*, entero) {
  ptr = (T*)(tagged & 0x0000FFFFFFFFFFFF)
  version = (entero)((tagged >> 48) & 0xFFFF)
  retornar (ptr, version)
}

// Uso con CAS
función compareAndSwap(location: Atomic<uint64>, 
                      expected: TaggedPointer<T>,
                      newPtr: T*) -> booleano {
  
  expectedPacked = pack(expected.pointer, expected.version)
  newVersion = expected.version + 1  // INCREMENTAR versión
  newPacked = pack(newPtr, newVersion)
  
  retornar location.compareAndSwap(expectedPacked, newPacked)
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"2. Lock-Free Stack con Versioning"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura Node<T> {
  value: T
  next: Node<T>*
}

estructura VersionedStack<T> {
  head: Atomic<uint64>  // Empaqueta (Node*, version)
}

función push(stack: VersionedStack<T>, value: T) {
  newNode = allocate(Node<T>)
  newNode.value = value
  
  mientras true:
    // Leer head actual
    currentPacked = stack.head.load()
    (currentHead, currentVersion) = unpack(currentPacked)
    
    // Preparar nuevo nodo
    newNode.next = currentHead
    
    // CAS con versión incrementada
    expectedPacked = currentPacked
    newVersion = currentVersion + 1
    newPacked = pack(newNode, newVersion)
    
    si stack.head.compareAndSwap(expectedPacked, newPacked):
      retornar  // Éxito
    
    // Fallo: otro thread modificó head, reintentar
}

función pop(stack: VersionedStack<T>) -> T {
  mientras true:
    currentPacked = stack.head.load()
    (currentHead, currentVersion) = unpack(currentPacked)
    
    si currentHead == null:
      throw EmptyStackException()
    
    // Leer siguiente nodo
    nextNode = currentHead.next
    
    // CAS con versión incrementada
    expectedPacked = currentPacked
    newVersion = currentVersion + 1
    newPacked = pack(nextNode, newVersion)
    
    si stack.head.compareAndSwap(expectedPacked, newPacked):
      value = currentHead.value
      // PROBLEMA: ¿Cuándo liberar currentHead?
      // Solución: combinar con hazard pointers o GC
      retornar value
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"3. Escenario ABA Resuelto"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Ejemplo: Stack con 3 nodos A→B→C

// Estado inicial: head = (A, version: 0)
head = pack(A, 0)

// Thread 1: pop() - lee (A, 0)
T1_expected = (A, 0)
T1_new = (B, 1)  // Quiere avanzar a B con versión 1

// Thread 2: pop() dos veces, luego push(A)
T2_pop1 = (A, 0) → (B, 1)    // Version incrementada a 1
T2_pop2 = (B, 1) → (C, 2)    // Version incrementada a 2
T2_push = (C, 2) → (A, 3)    // Version incrementada a 3

// Head ahora: (A, 3) ← DIFERENTE versión!

// Thread 1: intenta CAS con (A, 0) → (B, 1)
expected = pack(A, 0)
actual = pack(A, 3)
// CAS FALLA porque 0 != 3, aunque puntero sea A

// ✅ ABA DETECTADO: versión previene corrupción`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"4. Double-Width CAS (128-bit)"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// En sistemas de 64-bit, usar CAS de 128-bit

estructura DoubleWord {
  pointer: uint64    // Puntero completo de 64-bit
  version: uint64    // Versión completa de 64-bit
}

// x86-64: CMPXCHG16B
función DCAS(location: Atomic<DoubleWord>,
             expected: DoubleWord,
             new: DoubleWord) -> booleano {
  
  // Atomic compare-and-swap de 128 bits
  retornar compareAndSwap128(
    location,
    expected.pointer, expected.version,
    new.pointer, new.version
  )
}

función push128(stack: VersionedStack, value: T) {
  newNode = allocate(Node)
  newNode.value = value
  
  mientras true:
    current = stack.head.load()  // Load 128-bit
    newNode.next = current.pointer
    
    new = DoubleWord {
      pointer: (uint64)newNode,
      version: current.version + 1
    }
    
    si DCAS(stack.head, current, new):
      retornar
}

// Ventajas:
// - Punteros completos de 64-bit (sin limitación de 48-bit)
// - Versión de 64-bit (prácticamente imposible overflow)
// - Más robusto para sistemas de larga duración`})]}),e.jsx("div",{className:"p-4 bg-blue-900/30 border border-blue-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Ventajas:"})," Simple de implementar, bajo overhead, compatible con la mayoría de arquitecturas.",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"Desventajas:"})," Versión puede hacer overflow (requiere cuidado), en 64-bit solo 48-52 bits para puntero, aún necesita resolver memory reclamation."]})}),e.jsx("div",{className:"p-4 bg-blue-900/30 border border-blue-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," Lock-free stacks/queues, concurrent data structures, memoria transaccional, sistemas embebidos, bibliotecas como libcds, Folly (Facebook)."]})})]})]})}),e.jsx(ue,{value:"ps-hazard",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-green-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-green-400 mb-4",children:"🛡️ Hazard Pointers"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"1. Estructura Básica"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Hazard Pointers: sistema para safe memory reclamation

estructura HazardPointer {
  pointer: Atomic<void*>     // Puntero "protegido"
  active: Atomic<booleano>   // Si está en uso
  threadId: entero           // Thread dueño
}

estructura HazardPointerRecord {
  hazards: Array<HazardPointer>  // K hazards por thread
  retireList: List<void*>        // Nodos a liberar
  K: entero = 2                  // Número de hazards por thread
}

// Pool global de hazard pointers
global hazardPointers: Array<HazardPointerRecord>

función acquire() -> HazardPointer* {
  threadId = currentThread().id
  record = hazardPointers[threadId]
  
  // Buscar slot libre
  para cada hp en record.hazards:
    si no hp.active.load():
      si hp.active.compareAndSwap(false, true):
        retornar &hp
  
  throw NoHazardPointerAvailable()
}

función release(hp: HazardPointer*) {
  hp.pointer.store(null)
  hp.active.store(false)
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"2. Proteger Punteros"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Proteger un puntero antes de desreferenciarlo

función protect(source: Atomic<Node*>, hp: HazardPointer*) -> Node* {
  mientras true:
    // Leer puntero
    ptr = source.load()
    
    // PUBLICAR en hazard pointer
    hp.pointer.store(ptr)
    
    // Verificar que no cambió (evitar race condition)
    si source.load() == ptr:
      retornar ptr  // Protegido exitosamente
    
    // Cambió: reintentar
}

// Uso en operación lock-free
función pop(stack: LockFreeStack) -> T {
  hp = acquire()  // Obtener hazard pointer
  
  intentar:
    mientras true:
      // Proteger head antes de desreferenciar
      head = protect(stack.head, hp)
      
      si head == null:
        throw EmptyStackException()
      
      next = head.next  // Safe: head está protegido
      
      si stack.head.compareAndSwap(head, next):
        value = head.value
        retire(head)  // Marcar para liberación posterior
        retornar value
  
  finalmente:
    release(hp)  // Liberar hazard pointer
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"3. Retire y Scan"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Marcar nodo para liberación (no liberar inmediatamente)

función retire(node: Node*) {
  threadId = currentThread().id
  record = hazardPointers[threadId]
  
  // Agregar a lista de retirados
  record.retireList.add(node)
  
  // Si lista crece mucho, intentar limpiar
  si record.retireList.size() >= THRESHOLD:
    scan()
}

// Escanear hazard pointers y liberar nodos seguros
función scan() {
  threadId = currentThread().id
  record = hazardPointers[threadId]
  
  // Paso 1: Recolectar todos los hazard pointers activos
  protectedPointers = Set<void*>()
  
  para cada threadRecord en hazardPointers:
    para cada hp en threadRecord.hazards:
      si hp.active.load():
        ptr = hp.pointer.load()
        si ptr != null:
          protectedPointers.add(ptr)
  
  // Paso 2: Liberar nodos no protegidos
  newRetireList = List<void*>()
  
  para cada node en record.retireList:
    si node no está en protectedPointers:
      free(node)  // ¡SAFE! Nadie lo está usando
    sino:
      newRetireList.add(node)  // Aún protegido, mantener
  
  record.retireList = newRetireList
}

// Constantes típicas
THRESHOLD = K * N * 2
// K = hazards por thread
// N = número de threads`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"4. Stack Completo con Hazard Pointers"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`estructura SafeLockFreeStack<T> {
  head: Atomic<Node<T>*>
}

función push(stack: SafeLockFreeStack<T>, value: T) {
  newNode = allocate(Node<T>)
  newNode.value = value
  
  mientras true:
    currentHead = stack.head.load()
    newNode.next = currentHead
    
    si stack.head.compareAndSwap(currentHead, newNode):
      retornar  // Push exitoso, no necesita hazard pointer
}

función pop(stack: SafeLockFreeStack<T>) -> T {
  hp = acquire()  // Obtener hazard pointer
  
  intentar:
    mientras true:
      // PROTEGER head
      head = protect(stack.head, hp)
      
      si head == null:
        throw EmptyStackException()
      
      // Desreferenciar SAFE (protegido por hazard pointer)
      next = head.next
      value = head.value
      
      si stack.head.compareAndSwap(head, next):
        // Pop exitoso
        retire(head)  // Marcar para liberación
        retornar value
      
      // CAS falló: otro thread modificó, reintentar
  
  finalmente:
    release(hp)  // IMPORTANTE: siempre liberar
}

// ✅ Resuelve ABA: incluso si A→B→A ocurre,
//    el nodo original A no puede ser liberado
//    mientras esté protegido por hazard pointer`})]}),e.jsx("div",{className:"p-4 bg-green-900/30 border border-green-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-200",children:[e.jsx("span",{className:"font-bold",children:"Ventajas:"})," No requiere GC, control explícito de memoria, predecible, sin pausas, funciona en C/C++.",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"Desventajas:"})," Overhead de scan, complejidad de implementación, requiere gestión cuidadosa de hazard pointers."]})}),e.jsx("div",{className:"p-4 bg-green-900/30 border border-green-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," Folly (Facebook), libcds, sistemas C++ lock-free, bases de datos (RocksDB), high-frequency trading, sistemas embebidos sin GC."]})})]})]})}),e.jsx(ue,{value:"ps-dcas",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-purple-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-400 mb-4",children:"⚛️ DCAS (Double Compare-And-Swap)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"1. DCAS en Hardware"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// DCAS: comparar y swapear DOS ubicaciones atómicamente

// x86-64: CMPXCHG16B (128-bit CAS)
función CMPXCHG16B(addr: *uint128,
                   expected1: uint64, expected2: uint64,
                   new1: uint64, new2: uint64) -> booleano {
  
  // Atomic: si *addr == (expected1, expected2)
  //         entonces *addr = (new1, new2)
  //         retornar true
  //         sino retornar false
  
  // Implementación en assembly (x86-64)
  asm {
    mov rax, expected1
    mov rdx, expected2
    mov rbx, new1
    mov rcx, new2
    lock cmpxchg16b [addr]
    setz al  // al = 1 si éxito
  }
}

// ARM: No tiene DCAS nativo
// PowerPC: LDARX/STDCX (LL/SC puede simular DCAS)

// ⚠️ DCAS verdadero es RARO en hardware
// La mayoría usa LL/SC o word-based CAS`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"2. DCAS para ABA con Versioning"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Usar DCAS para actualizar puntero + versión atómicamente

estructura VersionedPointer {
  pointer: uint64
  version: uint64
}

función DCAS_push(stack: Atomic<VersionedPointer>, value: T) {
  newNode = allocate(Node)
  newNode.value = value
  
  mientras true:
    current = stack.load()  // Lee ambos: pointer y version
    newNode.next = (Node*)current.pointer
    
    nuevo = VersionedPointer {
      pointer: (uint64)newNode,
      version: current.version + 1  // Incrementar versión
    }
    
    // DCAS: comparar (pointer, version) y actualizar ambos
    si CMPXCHG16B(&stack,
                  current.pointer, current.version,
                  nuevo.pointer, nuevo.version):
      retornar  // Éxito
    
    // Fallo: otro thread modificó, reintentar
}

// ✅ Ventaja sobre CAS simple:
//    - Puntero completo de 64-bit (no limitado a 48-bit)
//    - Versión completa de 64-bit (no overflow en práctica)
//    - Actualización atómica de ambos campos`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"3. Simular DCAS con MCAS"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// MCAS: Multi-word Compare-And-Swap
// Extender a N palabras (no solo 2)

estructura MCASDescriptor {
  status: Atomic<enum { UNDECIDED, SUCCEEDED, FAILED }>
  words: Array<{
    address: Atomic<uint64>*
    expected: uint64
    new: uint64
  }>
}

función MCAS(descriptor: MCASDescriptor) -> booleano {
  // Fase 1: LOCK todas las palabras
  para cada word en descriptor.words:
    mientras true:
      current = word.address.load()
      
      si current == word.expected:
        // Intentar "lockear" con puntero a descriptor
        si word.address.compareAndSwap(current, &descriptor):
          break  // Locked
      sino si current == &descriptor:
        break  // Ya locked por nosotros
      sino:
        // Valor cambió o locked por otro: ABORT
        descriptor.status.store(FAILED)
        unlock_all(descriptor)
        retornar false
  
  // Fase 2: COMMIT (todos locked exitosamente)
  descriptor.status.store(SUCCEEDED)
  
  para cada word en descriptor.words:
    word.address.store(word.new)
  
  retornar true
}

// Uso para stack lock-free
función MCAS_push(stack: Stack, value: T) {
  mientras true:
    head = stack.head.load()
    version = stack.version.load()
    
    descriptor = MCASDescriptor {
      status: UNDECIDED,
      words: [
        { address: &stack.head, expected: head, new: newNode },
        { address: &stack.version, expected: version, new: version + 1 }
      ]
    }
    
    si MCAS(descriptor):
      retornar
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"4. DCAS vs LL/SC"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Comparación de primitivas atómicas

tabla ComparacionPrimitivas:

| Primitiva | Arquitecturas      | ABA Protection | Complejidad |
|-----------|-------------------|----------------|-------------|
| CAS       | x86, ARM, POWER   | ❌ No          | Baja        |
| DCAS      | x86-64 (CMPXCHG16B)| ✅ Con version | Media       |
| LL/SC     | ARM, POWER, RISC-V | ✅ Sí          | Media       |
| MCAS      | Software emulado   | ✅ Sí          | Alta        |

// LL/SC (Load-Linked / Store-Conditional)
// Detecta CUALQUIER escritura entre LL y SC

función LL_SC_push(stack: Stack, value: T) {
  mientras true:
    // LL: Load-Linked (marca dirección para monitoreo)
    head = LoadLinked(&stack.head)
    newNode.next = head
    
    // SC: Store-Conditional (falla si hubo escritura)
    si StoreConditional(&stack.head, newNode):
      retornar  // Éxito
    
    // SC falló: otra escritura ocurrió (incluso A→B→A)
    // ✅ LL/SC DETECTA todos los cambios intermedios
}

// DCAS solo detecta cambios si usamos versioning
// LL/SC detecta cambios automáticamente`})]}),e.jsx("div",{className:"p-4 bg-purple-900/30 border border-purple-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-purple-200",children:[e.jsx("span",{className:"font-bold",children:"Ventajas:"})," Actualización atómica de múltiples palabras, no requiere tagged pointers, más limpio conceptualmente.",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"Desventajas:"})," DCAS hardware es raro (solo x86-64), emulación por software tiene alto overhead, no portable."]})}),e.jsx("div",{className:"p-4 bg-purple-900/30 border border-purple-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-purple-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," Implementaciones académicas, algoritmos MCAS (Harris et al.), sistemas experimentales, research en STM (Software Transactional Memory)."]})})]})]})}),e.jsx(ue,{value:"ps-gc",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-yellow-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-4",children:"🗑️ Garbage Collection"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"1. GC Resuelve ABA Automáticamente"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// En lenguajes con GC (Java, Go, C#), ABA se resuelve naturalmente

// Java: Lock-Free Stack sin worries de ABA
clase LockFreeStack<T> {
  AtomicReference<Node<T>> head = new AtomicReference<>(null);
  
  void push(T value) {
    Node<T> newNode = new Node<>(value);
    
    while (true) {
      Node<T> currentHead = head.get();
      newNode.next = currentHead;
      
      // CAS simple: no necesita versioning
      if (head.compareAndSet(currentHead, newNode)) {
        return;  // Éxito
      }
      // Fallo: reintentar
    }
  }
  
  T pop() {
    while (true) {
      Node<T> currentHead = head.get();
      
      if (currentHead == null) {
        throw new EmptyStackException();
      }
      
      Node<T> next = currentHead.next;
      
      // CAS: incluso si A→B→A ocurre...
      if (head.compareAndSet(currentHead, next)) {
        // ✅ SAFE: GC garantiza que el objeto A original
        //    no puede ser reusado hasta que nadie lo referencie
        return currentHead.value;
      }
    }
  }
}

// ¿Por qué funciona?
// - GC rastrea referencias activas
// - Nodo A original no se libera hasta que:
//   1. No hay referencias desde head
//   2. No hay referencias locales (stack frames)
//   3. Pasa GC cycle completo
// - Si A reaparece en head, es un NUEVO objeto A'
//   con diferente dirección de memoria
// - CAS compara direcciones físicas, no valores`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"2. Epoch-Based Reclamation (EBR)"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Alternativa ligera a GC completo: Epoch-Based Reclamation

estructura EpochManager {
  globalEpoch: Atomic<entero> = 0
  threadEpochs: Array<Atomic<entero>>  // Epoch por thread
  retireLists: Map<entero, List<void*>>  // Nodos por epoch
}

función enterEpoch() {
  threadId = currentThread().id
  global = globalEpoch.load()
  threadEpochs[threadId].store(global)
}

función exitEpoch() {
  threadId = currentThread().id
  threadEpochs[threadId].store(INACTIVE)
}

función retire(node: void*) {
  currentEpoch = globalEpoch.load()
  retireLists[currentEpoch].add(node)
  
  tryAdvanceEpoch()
}

función tryAdvanceEpoch() {
  currentEpoch = globalEpoch.load()
  
  // Verificar si todos los threads salieron del epoch viejo
  minEpoch = currentEpoch
  para cada threadEpoch en threadEpochs:
    epoch = threadEpoch.load()
    si epoch != INACTIVE Y epoch < minEpoch:
      minEpoch = epoch
  
  // Si todos avanzaron, incrementar epoch global
  si minEpoch == currentEpoch:
    globalEpoch.compareAndSwap(currentEpoch, currentEpoch + 1)
    
    // Liberar nodos de epochs viejos (safe ahora)
    para epoch en 0 hasta currentEpoch - 2:
      para cada node en retireLists[epoch]:
        free(node)  // ✅ SAFE: nadie lo está usando
      retireLists[epoch].clear()
}

// Uso en operaciones lock-free
función pop(stack: Stack) -> T {
  enterEpoch()  // Anunciar que estamos en epoch actual
  
  intentar:
    mientras true:
      head = stack.head.load()
      si head == null:
        throw EmptyStackException()
      
      next = head.next
      si stack.head.compareAndSwap(head, next):
        value = head.value
        retire(head)  // Marcar para liberación futura
        retornar value
  finalmente:
    exitEpoch()  // Salir del epoch
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"3. Reference Counting Atómico"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Otra aproximación: reference counting con operaciones atómicas

estructura RefCountedNode<T> {
  value: T
  next: Atomic<RefCountedNode<T>*>
  refCount: Atomic<entero>
}

función addRef(node: RefCountedNode<T>*) {
  si node != null:
    node.refCount.fetchAdd(1)
}

función release(node: RefCountedNode<T>*) {
  si node != null:
    oldCount = node.refCount.fetchSub(1)
    si oldCount == 1:
      // Última referencia: liberar
      nextNode = node.next.load()
      release(nextNode)  // Recursivo
      free(node)
}

función pop(stack: Stack) -> T {
  mientras true:
    head = stack.head.load()
    si head == null:
      throw EmptyStackException()
    
    addRef(head)  // Incrementar refcount
    
    // Verificar que sigue siendo head (race condition)
    si stack.head.load() != head:
      release(head)
      continue  // Reintentar
    
    next = head.next.load()
    addRef(next)
    
    si stack.head.compareAndSwap(head, next):
      value = head.value
      release(head)  // Decrementar refcount
      release(head)  // Decrementar por la referencia que teníamos
      retornar value
    sino:
      release(next)
      release(head)
      // Reintentar
}

// ⚠️ Problemas:
// - Overhead alto de atomic increment/decrement
// - Ciclos de referencias (memory leak)
// - Complicado de implementar correctamente`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"4. Comparación de Métodos GC"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`tabla ComparacionGC:

| Método              | Overhead | Pausas | Complejidad | Lenguajes    |
|---------------------|----------|--------|-------------|--------------|
| GC Completo         | Alto     | Sí     | Baja*       | Java, Go, C# |
| Epoch-Based (EBR)   | Bajo     | No     | Media       | C/C++, Rust  |
| Hazard Pointers     | Medio    | No     | Alta        | C/C++        |
| Reference Counting  | Alto     | No     | Alta        | C++, Swift   |

// * Baja para el desarrollador; alta para implementación de GC

// Elegir método según requisitos:

función elegirMetodo(requisitos: Requisitos) -> Metodo {
  si requisitos.lenguaje == JAVA o GO:
    retornar GC_COMPLETO  // Viene gratis con el lenguaje
  
  si requisitos.latenciaCritica Y requisitos.sinPausas:
    retornar EPOCH_BASED  // Rust crossbeam-epoch
  
  si requisitos.controlExplicito:
    retornar HAZARD_POINTERS  // Folly, libcds
  
  si requisitos.compatibilidadSmartPointers:
    retornar REFERENCE_COUNTING  // C++ shared_ptr
  
  retornar GC_COMPLETO  // Default más seguro
}`})]}),e.jsx("div",{className:"p-4 bg-yellow-900/30 border border-yellow-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Ventajas:"})," Simple para el desarrollador, seguro por defecto, no requiere gestión manual de memoria.",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"Desventajas:"})," Pausas de GC (stop-the-world), overhead de memoria, no disponible en C/C++ sin bibliotecas externas."]})}),e.jsx("div",{className:"p-4 bg-yellow-900/30 border border-yellow-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," Java concurrent collections, Go sync package, C# concurrent collections, Rust crossbeam (EBR), aplicaciones empresariales."]})})]})]})}),e.jsx(ue,{value:"ps-llsc",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-cyan-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-cyan-400 mb-4",children:"🔗 Load-Linked / Store-Conditional"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-cyan-300 mb-3",children:"1. Primitivas LL/SC"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// LL/SC: alternativa superior a CAS para prevenir ABA

// Load-Linked: leer valor y "marcar" dirección para monitoreo
función LL(address: *T) -> T {
  // Hardware registra:
  // 1. La dirección leída
  // 2. El valor leído
  // 3. Activa "link register" o "reservation"
  
  valor = *address
  CPU.linkRegister.address = address
  CPU.linkRegister.active = true
  retornar valor
}

// Store-Conditional: escribir solo si nadie más escribió
función SC(address: *T, newValue: T) -> booleano {
  // Hardware verifica:
  // 1. Link register activo?
  // 2. Dirección coincide?
  // 3. ¿Hubo alguna escritura desde LL?
  
  si no CPU.linkRegister.active:
    retornar false  // No hay LL previo
  
  si CPU.linkRegister.address != address:
    retornar false  // Dirección incorrecta
  
  si CPU.monitorDetectedWrite:
    // ✅ CLAVE: detecta CUALQUIER escritura, incluso A→B→A
    CPU.linkRegister.active = false
    retornar false
  
  // Todo OK: escribir
  *address = newValue
  CPU.linkRegister.active = false
  retornar true  // Éxito
}

// ARM: LDREX/STREX
// PowerPC: LDARX/STDCX
// RISC-V: LR/SC
// MIPS: LL/SC`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-cyan-300 mb-3",children:"2. Stack con LL/SC"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Lock-Free Stack usando LL/SC (sin versioning!)

estructura Node<T> {
  value: T
  next: Node<T>*
}

función push(stack: Stack<T>, value: T) {
  newNode = allocate(Node<T>)
  newNode.value = value
  
  mientras true:
    // LL: load-linked del head
    currentHead = LL(&stack.head)
    newNode.next = currentHead
    
    // SC: store-conditional del nuevo head
    si SC(&stack.head, newNode):
      retornar  // Éxito
    
    // SC falló: hubo escritura intermedia, reintentar
}

función pop(stack: Stack<T>) -> T {
  mientras true:
    // LL: load-linked del head
    head = LL(&stack.head)
    
    si head == null:
      throw EmptyStackException()
    
    // Leer siguiente (no necesita protección especial)
    next = head.next
    value = head.value
    
    // SC: intentar actualizar head
    si SC(&stack.head, next):
      // ✅ Éxito: garantizado que nadie escribió
      //    entre LL y SC, incluso si A→B→A ocurrió
      free(head)  // SAFE: podemos liberar inmediatamente
      retornar value
    
    // SC falló: otra escritura, reintentar
}

// ✅ Ventaja sobre CAS:
//    - No necesita versioning/tagging
//    - Detecta automáticamente A→B→A
//    - Más simple conceptualmente`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-cyan-300 mb-3",children:"3. LL/SC vs CAS"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// Comparación detallada

// Escenario: A→B→A

// Con CAS (sin versioning):
head = stack.head.load()  // Lee A
// ... Thread 2: pop A, pop B, push A (mismo puntero)
// head sigue siendo A (reusado)
si stack.head.CAS(A, next):
  // ❌ ÉXITO INCORRECTO: no detectó cambios intermedios
  // Potencial corrupción de memoria

// Con LL/SC:
head = LL(&stack.head)  // Lee A, activa monitor
// ... Thread 2: pop A (ESCRITURA detectada por hardware)
si SC(&stack.head, next):
  // ✅ FALLA: hardware detectó la escritura
  // Incluso si valor volvió a A

// Tabla comparativa:

tabla CAS_vs_LLSC:

| Aspecto          | CAS                    | LL/SC                  |
|------------------|------------------------|------------------------|
| ABA Detection    | ❌ No (sin versioning) | ✅ Sí (automático)     |
| Versioning       | ✅ Requerido           | ❌ No requerido        |
| Spurious Fails   | ❌ No                  | ✅ Sí (context switch) |
| Portabilidad     | ✅ Alta (x86, ARM)     | ⚠️ Media (ARM, POWER)  |
| Complejidad      | Media (con tagging)    | Baja                   |
| Memory Order     | Debe especificarse     | Automático             |`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-cyan-300 mb-3",children:"4. Implementación en ARM64"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// ARM64: LDXR/STXR (Load-Exclusive/Store-Exclusive)

// Assembly ARM64 para push
función push_arm64(stack: *Node, newNode: *Node) {
  asm {
retry:
    // LDXR: Load-Exclusive (equivalente a LL)
    ldxr    x1, [x0]        // x1 = *stack, marca exclusiva
    str     x1, [newNode]   // newNode->next = x1
    
    // STXR: Store-Exclusive (equivalente a SC)
    stxr    w2, newNode, [x0]  // *stack = newNode si exclusiva
    cbnz    w2, retry       // Si w2 != 0, falló, retry
    
    // w2 == 0: éxito
    ret
  }
}

// C con intrinsics
función push_intrinsic(stack: _Atomic(Node*), newNode: Node*) {
  mientras true:
    // __atomic_load_exclusive
    currentHead = __builtin_arm_ldrex(&stack)
    newNode->next = currentHead
    
    // __atomic_store_exclusive
    si __builtin_arm_strex(newNode, &stack) == 0:
      retornar  // Éxito
    
    // Falló: reintentar
}

// RISC-V: LR.W/SC.W
función pop_riscv(stack: *Node) -> Node* {
  asm {
retry:
    lr.w.aq   a1, (a0)      // a1 = *stack, acquire semantics
    beqz      a1, empty     // if null, empty
    
    lw        a2, 0(a1)     // a2 = head->next
    sc.w.rl   a3, a2, (a0)  // *stack = a2, release semantics
    bnez      a3, retry     // if failed, retry
    
    mv        a0, a1        // return head
    ret
    
empty:
    li        a0, 0
    ret
  }
}`})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-cyan-300 mb-3",children:"5. Limitaciones y Spurious Failures"}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:`// ⚠️ LL/SC puede fallar espuriamente (spurious failure)

// Causas de spurious failure:
// 1. Context switch entre LL y SC
// 2. Caché invalidation
// 3. Otras escrituras en la misma cache line
// 4. Interrupciones
// 5. Implementación conservadora del hardware

función pop_con_spurious(stack: Stack) -> T {
  reintentos = 0
  
  mientras true:
    head = LL(&stack.head)
    
    si head == null:
      throw EmptyStackException()
    
    next = head.next
    
    si SC(&stack.head, next):
      retornar head.value  // Éxito
    
    reintentos++
    si reintentos > MAX_RETRIES:
      // Posible livelock: demasiados spurious failures
      backoff()  // Esperar antes de reintentar
      reintentos = 0
}

// Mitigación: exponential backoff
función backoff() {
  sleepTime = random(1, 1000) * 2^reintentos
  sleep(min(sleepTime, MAX_SLEEP))
}

// Recomendación: minimizar trabajo entre LL y SC
función pop_optimizado(stack: Stack) -> T {
  mientras true:
    head = LL(&stack.head)
    
    si head == null:
      throw EmptyStackException()
    
    // ⚠️ MINIMIZAR código entre LL y SC
    // No llamar funciones, no hacer I/O, no locks
    
    si SC(&stack.head, head.next):
      // Hacer trabajo pesado DESPUÉS de SC
      value = head.value
      free(head)
      retornar value
}`})]}),e.jsx("div",{className:"p-4 bg-cyan-900/30 border border-cyan-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-cyan-200",children:[e.jsx("span",{className:"font-bold",children:"Ventajas:"})," Detecta ABA automáticamente, no requiere versioning, más simple que CAS+tagging, semantics más limpias.",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"Desventajas:"})," Spurious failures requieren retry loops, no disponible en x86, puede tener más contención que CAS, implementación depende del hardware."]})}),e.jsx("div",{className:"p-4 bg-cyan-900/30 border border-cyan-700/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-cyan-200",children:[e.jsx("span",{className:"font-bold",children:"Casos de Uso:"})," ARM-based systems (mobile, embedded), PowerPC servers, RISC-V systems, algoritmos lock-free académicos, investigación en arquitecturas de computadoras."]})})]})]})})]})})]}),e.jsxs(sa,{value:"demos",className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(ra,{className:"text-xl font-bold px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vn,{className:"size-5"}),e.jsx("span",{children:"Demostraciones Interactivas"})]})}),e.jsx(na,{children:e.jsxs(ia,{defaultValue:"demo-versioning",className:"px-6 pb-6",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs(Qt,{className:"grid grid-cols-5 gap-2 bg-gray-900/50 p-2",children:[e.jsx(le,{value:"demo-versioning",children:"🔖 Versioning"}),e.jsx(le,{value:"demo-hazard",children:"🛡️ Hazard"}),e.jsx(le,{value:"demo-dcas",children:"⚛️ DCAS"}),e.jsx(le,{value:"demo-gc",children:"🗑️ GC"}),e.jsx(le,{value:"demo-llsc",children:"🔗 LL/SC"})]})}),e.jsx(ue,{value:"demo-versioning",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-blue-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-400 mb-4",children:"Demo: Versioning Detecta ABA"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>o(!s),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors ${s?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:Ot,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",n,"ms"]}),e.jsx(dt,{value:[n],onValueChange:([L])=>l(L),min:200,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"Stack State"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"HEAD →"}),d.head&&e.jsx("div",{className:"flex items-center gap-2",children:d.nodes.filter(L=>{let re=d.head;for(;re;){if(re===L.id)return!0;re=d.nodes.find(ce=>ce.id===re)?.next||null}return!1}).map((L,re)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"bg-blue-600 px-3 py-2 rounded",children:[e.jsx("span",{className:"font-bold",children:L.value}),e.jsxs("span",{className:"text-xs text-blue-200 ml-1",children:["(v",L.version,")"]})]}),re<d.nodes.length-1&&L.next&&e.jsx("span",{className:"text-gray-400",children:"→"})]},L.id))}),!d.head&&e.jsx("span",{className:"text-gray-500 italic",children:"null"})]}),e.jsxs("div",{className:"mt-2 text-xs text-blue-300",children:["Global Version: ",d.version]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:qe,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:h.map((L,re)=>e.jsx("div",{className:"text-gray-300",children:L},re))})]})]})}),e.jsx(ue,{value:"demo-hazard",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-green-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-green-400 mb-4",children:"Demo: Hazard Pointers"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>v(!b),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors ${b?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"}`,children:b?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:It,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",f,"ms"]}),e.jsx(dt,{value:[f],onValueChange:([L])=>N(L),min:200,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"Hazard Pointers"}),e.jsx("div",{className:"flex gap-2",children:w.length>0?w.map((L,re)=>e.jsxs("div",{className:"bg-green-600 px-3 py-2 rounded font-bold",children:["HP[",re,"] = ",L]},re)):e.jsx("span",{className:"text-gray-500 italic",children:"No hay hazard pointers activos"})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"Retire List"}),e.jsx("div",{className:"flex gap-2",children:E.length>0?E.map((L,re)=>e.jsx("div",{className:"bg-orange-600 px-3 py-2 rounded font-bold",children:L},re)):e.jsx("span",{className:"text-gray-500 italic",children:"Lista vacía"})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"Stack"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"HEAD →"}),j.head&&e.jsx("div",{className:"flex items-center gap-2",children:j.nodes.filter(L=>{let re=j.head;for(;re;){if(re===L.id)return!0;re=j.nodes.find(ce=>ce.id===re)?.next||null}return!1}).map((L,re,Ve)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`px-3 py-2 rounded ${w.includes(L.id)?"bg-green-600 ring-2 ring-green-400":"bg-green-700"}`,children:e.jsx("span",{className:"font-bold",children:L.value})}),re<Ve.length-1&&e.jsx("span",{className:"text-gray-400",children:"→"})]},L.id))})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-green-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:Se,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:P.map((L,re)=>e.jsx("div",{className:"text-gray-300",children:L},re))})]})]})}),e.jsx(ue,{value:"demo-dcas",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-purple-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-400 mb-4",children:"Demo: DCAS (128-bit CAS)"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>O(!oe),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors ${oe?"bg-yellow-600 hover:bg-yellow-700":"bg-purple-600 hover:bg-purple-700"}`,children:oe?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:Ue,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",T,"ms"]}),e.jsx(dt,{value:[T],onValueChange:([L])=>ge(L),min:200,max:2e3,step:100,className:"w-full"})]})]}),ne.pointer1&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"DCAS Operation"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-purple-900/30 p-3 rounded",children:[e.jsx("div",{className:"text-purple-300 font-bold mb-1",children:"Expected"}),e.jsxs("div",{children:["Pointer: ",ne.pointer1]}),e.jsxs("div",{children:["Version: ",ne.version1]})]}),e.jsxs("div",{className:"bg-purple-900/30 p-3 rounded",children:[e.jsx("div",{className:"text-purple-300 font-bold mb-1",children:"New"}),e.jsxs("div",{children:["Pointer: ",ne.pointer2||"null"]}),e.jsxs("div",{children:["Version: ",ne.version2]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"Stack State"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"HEAD →"}),J.head?e.jsx("div",{className:"flex items-center gap-2",children:J.nodes.filter(L=>{let re=J.head;for(;re;){if(re===L.id)return!0;re=J.nodes.find(ce=>ce.id===re)?.next||null}return!1}).map((L,re,Ve)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"bg-purple-600 px-3 py-2 rounded",children:[e.jsx("span",{className:"font-bold",children:L.value}),e.jsxs("span",{className:"text-xs text-purple-200 ml-1",children:["(v",L.version,")"]})]}),re<Ve.length-1&&L.next&&e.jsx("span",{className:"text-gray-400",children:"→"})]},L.id))}):e.jsx("span",{className:"text-gray-500 italic",children:"null"})]}),e.jsxs("div",{className:"mt-2 text-xs text-purple-300",children:["Version: ",J.version]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:Xe,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:Ce.map((L,re)=>e.jsx("div",{className:"text-gray-300",children:L},re))})]})]})}),e.jsx(ue,{value:"demo-gc",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-yellow-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-4",children:"Demo: Epoch-Based Reclamation"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>F(!Q),className:"flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors bg-yellow-600 hover:bg-yellow-700",children:Q?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:At,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",de,"ms"]}),e.jsx(dt,{value:[de],onValueChange:([L])=>ze(L),min:200,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"Epoch Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-yellow-300 font-bold",children:"Global Epoch:"})," ",se]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-yellow-300 font-bold",children:"Thread 1:"})," ",K[0]===-1?"inactive":K[0]]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-yellow-300 font-bold",children:"Thread 2:"})," ",K[1]===-1?"inactive":K[1]]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"Retire Lists por Epoch"}),D.size>0?e.jsx("div",{className:"space-y-2",children:Array.from(D.entries()).map(([L,re])=>e.jsxs("div",{className:"bg-yellow-900/30 p-2 rounded",children:[e.jsxs("span",{className:"text-yellow-300 font-bold",children:["Epoch ",L,":"]})," ",re.join(", ")]},L))}):e.jsx("span",{className:"text-gray-500 italic",children:"No hay nodos pendientes"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"Stack"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"HEAD →"}),A.head&&e.jsx("div",{className:"flex items-center gap-2",children:A.nodes.filter(L=>{let re=A.head;for(;re;){if(re===L.id)return!0;re=A.nodes.find(ce=>ce.id===re)?.next||null}return!1}).map((L,re,Ve)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-yellow-600 px-3 py-2 rounded font-bold",children:L.value}),re<Ve.length-1&&e.jsx("span",{className:"text-gray-400",children:"→"})]},L.id))})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:We,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:G.map((L,re)=>e.jsx("div",{className:"text-gray-300",children:L},re))})]})]})}),e.jsx(ue,{value:"demo-llsc",className:"mt-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-cyan-700/50",children:[e.jsx("h3",{className:"text-xl font-bold text-cyan-400 mb-4",children:"Demo: Load-Linked / Store-Conditional"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("button",{onClick:()=>ke(!R),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-colors ${R?"bg-yellow-600 hover:bg-yellow-700":"bg-cyan-600 hover:bg-cyan-700"}`,children:R?e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"size-4"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"size-4"}),"Iniciar"]})}),e.jsxs("button",{onClick:et,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition-colors",children:[e.jsx(it,{className:"size-4"}),"Reset"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-gray-300",children:["Velocidad: ",je,"ms"]}),e.jsx(dt,{value:[je],onValueChange:([L])=>ee(L),min:200,max:2e3,step:100,className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-cyan-300 mb-3",children:"Link Register (Hardware)"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-cyan-300 font-bold",children:"Active:"}),e.jsx("span",{className:`px-2 py-1 rounded font-bold ${jt.active?"bg-green-600 text-white":"bg-gray-600 text-gray-300"}`,children:jt.active?"YES":"NO"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-cyan-300 font-bold",children:"Address:"})," ",jt.address||"none"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-cyan-300 font-bold",children:"Value:"})," ",jt.value||"none"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-cyan-300 mb-3",children:"Stack"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"HEAD →"}),ae.head?e.jsx("div",{className:"flex items-center gap-2",children:ae.nodes.filter(L=>{let re=ae.head;for(;re;){if(re===L.id)return!0;re=ae.nodes.find(ce=>ce.id===re)?.next||null}return!1}).map((L,re,Ve)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`px-3 py-2 rounded font-bold ${jt.active&&jt.value===L.id?"bg-cyan-600 ring-2 ring-cyan-400":"bg-cyan-700"}`,children:L.value}),re<Ve.length-1&&e.jsx("span",{className:"text-gray-400",children:"→"})]},L.id))}):e.jsx("span",{className:"text-gray-500 italic",children:"null"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-bold text-cyan-300 mb-3",children:"Event Log"}),e.jsx("div",{ref:xt,className:"bg-black/50 rounded p-3 font-mono text-xs space-y-1 max-h-48 overflow-y-auto",children:Me.map((L,re)=>e.jsx("div",{className:"text-gray-300",children:L},re))})]})]})})]})})]})]})})]})}const y2=Sa("/ActividadesSeminarioSO/actividad11/aba")({component:v2}),N2=WE.update({id:"/ActividadesSeminarioSO/",path:"/ActividadesSeminarioSO/",getParentRoute:()=>Aa}),j2=XE.update({id:"/ActividadesSeminarioSO/actividad14/",path:"/ActividadesSeminarioSO/actividad14/",getParentRoute:()=>Aa}),_2=aR.update({id:"/ActividadesSeminarioSO/actividad13/",path:"/ActividadesSeminarioSO/actividad13/",getParentRoute:()=>Aa}),S2=nR.update({id:"/ActividadesSeminarioSO/actividad12/",path:"/ActividadesSeminarioSO/actividad12/",getParentRoute:()=>Aa}),w2=lR.update({id:"/ActividadesSeminarioSO/actividad11/",path:"/ActividadesSeminarioSO/actividad11/",getParentRoute:()=>Aa}),T2=FR.update({id:"/ActividadesSeminarioSO/actividad11/thundering-herd",path:"/ActividadesSeminarioSO/actividad11/thundering-herd",getParentRoute:()=>Aa}),A2=GR.update({id:"/ActividadesSeminarioSO/actividad11/starvation",path:"/ActividadesSeminarioSO/actividad11/starvation",getParentRoute:()=>Aa}),C2=KR.update({id:"/ActividadesSeminarioSO/actividad11/priority-inversion",path:"/ActividadesSeminarioSO/actividad11/priority-inversion",getParentRoute:()=>Aa}),k2=XR.update({id:"/ActividadesSeminarioSO/actividad11/memory-consistency",path:"/ActividadesSeminarioSO/actividad11/memory-consistency",getParentRoute:()=>Aa}),E2=ZR.update({id:"/ActividadesSeminarioSO/actividad11/lost-wakeup",path:"/ActividadesSeminarioSO/actividad11/lost-wakeup",getParentRoute:()=>Aa}),R2=e2.update({id:"/ActividadesSeminarioSO/actividad11/livelock",path:"/ActividadesSeminarioSO/actividad11/livelock",getParentRoute:()=>Aa}),L2=a2.update({id:"/ActividadesSeminarioSO/actividad11/lectura-escritura",path:"/ActividadesSeminarioSO/actividad11/lectura-escritura",getParentRoute:()=>Aa}),P2=r2.update({id:"/ActividadesSeminarioSO/actividad11/false-sharing",path:"/ActividadesSeminarioSO/actividad11/false-sharing",getParentRoute:()=>Aa}),M2=o2.update({id:"/ActividadesSeminarioSO/actividad11/eventos",path:"/ActividadesSeminarioSO/actividad11/eventos",getParentRoute:()=>Aa}),I2=c2.update({id:"/ActividadesSeminarioSO/actividad11/deadlock",path:"/ActividadesSeminarioSO/actividad11/deadlock",getParentRoute:()=>Aa}),O2=u2.update({id:"/ActividadesSeminarioSO/actividad11/convoying",path:"/ActividadesSeminarioSO/actividad11/convoying",getParentRoute:()=>Aa}),D2=p2.update({id:"/ActividadesSeminarioSO/actividad11/contencion-recursos",path:"/ActividadesSeminarioSO/actividad11/contencion-recursos",getParentRoute:()=>Aa}),z2=f2.update({id:"/ActividadesSeminarioSO/actividad11/condicion-carrera",path:"/ActividadesSeminarioSO/actividad11/condicion-carrera",getParentRoute:()=>Aa}),q2=b2.update({id:"/ActividadesSeminarioSO/actividad11/bloqueos-innecesarios",path:"/ActividadesSeminarioSO/actividad11/bloqueos-innecesarios",getParentRoute:()=>Aa}),U2=y2.update({id:"/ActividadesSeminarioSO/actividad11/aba",path:"/ActividadesSeminarioSO/actividad11/aba",getParentRoute:()=>Aa}),B2={ActividadesSeminarioSOIndexRoute:N2,ActividadesSeminarioSOActividad11AbaRoute:U2,ActividadesSeminarioSOActividad11BloqueosInnecesariosRoute:q2,ActividadesSeminarioSOActividad11CondicionCarreraRoute:z2,ActividadesSeminarioSOActividad11ContencionRecursosRoute:D2,ActividadesSeminarioSOActividad11ConvoyingRoute:O2,ActividadesSeminarioSOActividad11DeadlockRoute:I2,ActividadesSeminarioSOActividad11EventosRoute:M2,ActividadesSeminarioSOActividad11FalseSharingRoute:P2,ActividadesSeminarioSOActividad11LecturaEscrituraRoute:L2,ActividadesSeminarioSOActividad11LivelockRoute:R2,ActividadesSeminarioSOActividad11LostWakeupRoute:E2,ActividadesSeminarioSOActividad11MemoryConsistencyRoute:k2,ActividadesSeminarioSOActividad11PriorityInversionRoute:C2,ActividadesSeminarioSOActividad11StarvationRoute:A2,ActividadesSeminarioSOActividad11ThunderingHerdRoute:T2,ActividadesSeminarioSOActividad11IndexRoute:w2,ActividadesSeminarioSOActividad12IndexRoute:S2,ActividadesSeminarioSOActividad13IndexRoute:_2,ActividadesSeminarioSOActividad14IndexRoute:j2},V2=Aa._addFileChildren(B2)._addFileTypes(),$2=Vw({routeTree:V2});aS.createRoot(document.getElementById("root")).render(e.jsx(c.StrictMode,{children:e.jsx(Hw,{router:$2})}));
